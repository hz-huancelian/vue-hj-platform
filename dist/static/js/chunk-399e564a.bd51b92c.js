(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-399e564a","chunk-1a585c67","chunk-009e9625","chunk-8333dcf4","chunk-2a043bf4","chunk-a5cf6d98","chunk-56a07752","chunk-279b650c","chunk-f94f5786","chunk-32293978","chunk-9d081380","chunk-51a23240","chunk-7b83fca0"],{"0139":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form",{attrs:{model:e.searchForm,inline:""}},[a("el-form-item",{attrs:{label:"合同编号:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"合同编号"},model:{value:e.searchForm.contCode,callback:function(t){e.$set(e.searchForm,"contCode",t)},expression:"searchForm.contCode"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1),a("el-table",{attrs:{data:e.taskData,stripe:"",border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无任务信息\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"contCode",label:"合同编号",width:"185px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"latestScheduleDate",label:"上次调度日期",align:"center"}}),a("el-table-column",{attrs:{prop:"finishProgress",label:"计划调度完成进度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.scheduledPlanNum)+"/"+e._s(a.planNum)+"\n      ")]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看任务")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("333d"),l=a("b199"),n={0:"待调度",1:"调度中",2:"调度完成"},i={components:{Pagination:s["a"]},data:function(){return{TASK_STATUS:n,searchForm:{scheduCircle:"",contCode:"",projectName:"",scheduStatus:"",pageNumber:1,pageSize:10},total:0,taskData:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;l["f"](this.searchForm).then((function(t){e.taskData=t.result.records||[],e.total=t.result.total}))},handleDetail:function(e){this.$router.push("/other/orderReportTaskList/".concat(e.taskId))}}},c=i,d=(a("a6f4"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"6753e9d6",null);t["default"]=u.exports},"019c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"套餐名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"套餐名称"},model:{value:e.searchForm.groupName,callback:function(t){e.$set(e.searchForm,"groupName",t)},expression:"searchForm.groupName"}})],1),a("el-form-item",{attrs:{label:"套餐类型:"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"套餐类型"},model:{value:e.searchForm.groupType,callback:function(t){e.$set(e.searchForm,"groupType",t)},expression:"searchForm.groupType"}},[a("el-option",{attrs:{value:"0",label:"自由因子套餐"}}),a("el-option",{attrs:{value:"1",label:"同系因子套餐"}})],1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.factorGroupData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},border:""}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无套餐,\n          ")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"small"},on:{click:e.handleCreate}},[e._v("新建因子套餐")])],1)])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"groupName",label:"套餐名称",align:"center"}}),a("el-table-column",{attrs:{label:"套餐类型",align:"center",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s("0"===a.groupType?"自由因子套餐":"同系因子套餐")+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"套餐说明","show-overflow-tooltip":!0,align:"center"}}),a("el-table-column",{attrs:{prop:"groupDesc",label:"检测因子","show-overflow-tooltip":!0,align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row.groupId)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.groupId)}}},[e._v("删除")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleCopy(t.row.groupId)}}},[e._v("复制")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{visible:e.choseMealVisible,top:"35vh",width:"400px"},on:{"update:visible":function(t){e.choseMealVisible=t}}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v("\n      选择新增套餐类型\n      "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"500",trigger:"hover"}},[a("div",[e._v("\n                同系因子套餐：可以将某个检测标准中可同时检测的多个因子进行打包（要求标准号相同）\n          如： 苯系物、挥发性卤代烃、有机氯农药等，并可对该同系因子套餐进行总价设定，\n          若该同系因子套餐中所含因子单价合计大于等于设定的总价，则以设定的总价作为该套餐的报价，\n          若小于则以所含因子单价合计作为该套餐的报价。同时报价时可以选择该套餐内的部分或全部因子作为一个单因子属性进行点位和频次的设置，\n          在采样分配时该套餐内的因子无需进行合样操作，实验室分析时该套餐内的因子作为一组进行实验室数据录入。\n          "),a("br"),e._v("\n                自由因子套餐：该类型套餐可用于具有固定或相似监测方案的项目，可自由选择因子库中的因子进行组合，后续套餐内所选因子会分拆独立出来，后续流程与因子库中的其他因子无异。\n        ")]),a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1),a("ul",{staticClass:"icon-list"},[a("li",{on:{click:e.handleSameCreate}},[a("span",[a("svg-icon",{attrs:{"icon-class":"dcqrs"}}),a("span",{staticClass:"icon-name"},[e._v("同系因子套餐")])],1)]),a("li",{on:{click:e.handleFreeCreate}},[a("span",[a("svg-icon",{attrs:{"icon-class":"ddrw"}}),a("span",{staticClass:"icon-name"},[e._v("自由因子套餐")])],1)])])]),a("el-dialog",{attrs:{title:e.titleMap[e.factorGroupDialogStatus],visible:e.factorGroupDialogVisible,fullscreen:"","modal-append-to-body":!1,"before-close":e.handleDialogClose,center:""},on:{"update:visible":function(t){e.factorGroupDialogVisible=t}}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("套餐基础信息"),a("i",{staticClass:"el-input__icon"})])]),a("el-form",{ref:"factorGroupForm",attrs:{model:e.factorGroupForm,inline:"","label-width":"90px"}},[a("el-form-item",{attrs:{prop:"groupName",label:"套餐名称:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"套餐名称",maxlength:"10","show-word-limit":""},model:{value:e.factorGroupForm.groupName,callback:function(t){e.$set(e.factorGroupForm,"groupName",t)},expression:"factorGroupForm.groupName"}})],1),a("el-form-item",{attrs:{prop:"authType",label:"认证类型:"}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"检测类型",disabled:"edit"===e.factorGroupDialogStatus},on:{change:e.checkAutype},model:{value:e.factorGroupForm.authType,callback:function(t){e.$set(e.factorGroupForm,"authType",t)},expression:"factorGroupForm.authType"}},[a("el-option",{attrs:{value:"0",label:"CMA"}}),a("el-option",{attrs:{value:"1",label:"CNAS"}})],1)],1),a("el-form-item",{attrs:{prop:"remark",label:"套餐说明:"}},[a("el-input",{attrs:{placeholder:"套餐说明",type:"textarea",rows:3,maxlength:"50"},model:{value:e.factorGroupForm.remark,callback:function(t){e.$set(e.factorGroupForm,"remark",t)},expression:"factorGroupForm.remark"}})],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("待选因子"),a("i",{staticClass:"el-input__icon"})])]),a("factor-list",{attrs:{"auth-type":e.factorGroupForm.authType,"chose-row":e.currentRow},on:{pageChose:e.handleChose}})],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("已选因子"),a("i",{staticClass:"el-input__icon"})])]),a("el-table",{attrs:{data:e.factorChoseData,size:"small",stripe:"","highlight-current-row":"","max-height":"400","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                暂无因子\n              ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象","min-width":"100",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"标准名称","min-width":"160",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"标准有效性",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(e.STOKEN_STUTS[a.methodStatus])+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"price",label:"检测费用",align:"center"}}),a("el-table-column",{attrs:{prop:"cmaFlg",label:"CMA",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cmaFlg?"success":"danger"}},[e._v(e._s("1"===r.cmaFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"cnasFlg",label:"CNAS",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cnasFlg?"success":"danger"}},[e._v(e._s("1"===r.cnasFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"extAssistFlg",label:"检测能力",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:r.extAssistFlg&&"0"===r.extAssistFlg?"success":"danger"}},[e._v(e._s(r.extAssistFlg&&"0"===r.extAssistFlg?"有":"无"))])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleRowDel(t.row,t.$index)}}},[e._v(" 删除")])]}}])})],2)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.factorGroupDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1),a("el-dialog",{attrs:{title:"同系因子套餐",visible:e.factorSameVisible,fullscreen:"","modal-append-to-body":!1,"before-close":e.handleSameDialogClose,center:""},on:{"update:visible":function(t){e.factorSameVisible=t}}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("套餐基础信息"),a("i",{staticClass:"el-input__icon"})])]),a("el-form",{ref:"factorGroupForm",attrs:{model:e.factorGroupForm,inline:"","label-width":"90px"}},[a("el-form-item",{attrs:{prop:"groupName",label:"套餐名称:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"同系套餐名称",maxlength:"10","show-word-limit":""},model:{value:e.factorGroupForm.groupName,callback:function(t){e.$set(e.factorGroupForm,"groupName",t)},expression:"factorGroupForm.groupName"}})],1),a("el-form-item",{attrs:{prop:"groupCost",label:"套餐价格:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{type:"number",placeholder:"套餐价格"},model:{value:e.factorGroupForm.groupCost,callback:function(t){e.$set(e.factorGroupForm,"groupCost",t)},expression:"factorGroupForm.groupCost"}})],1),a("el-form-item",{attrs:{prop:"remark",label:"套餐说明:"}},[a("el-input",{attrs:{placeholder:"套餐说明",type:"textarea",rows:3,maxlength:"50","show-word-limit":""},model:{value:e.factorGroupForm.remark,callback:function(t){e.$set(e.factorGroupForm,"remark",t)},expression:"factorGroupForm.remark"}})],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("待选因子"),a("i",{staticClass:"el-input__icon"})])]),a("factor-same-list",{attrs:{"clear-type":e.cleanAttr,"chose-row":e.currentRow},on:{pageChose:e.handleSameChose}})],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("已选因子"),a("i",{staticClass:"el-input__icon"})])]),a("el-table",{attrs:{data:e.factorChoseData,size:"small",stripe:"","highlight-current-row":"","max-height":"400","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                暂无因子\n              ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"标准名称","min-width":"160",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"标准有效性",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(e.STOKEN_STUTS[a.methodStatus])+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"price",label:"检测费用",align:"center"}}),a("el-table-column",{attrs:{prop:"cmaFlg",label:"CMA",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cmaFlg?"success":"danger"}},[e._v(e._s("1"===r.cmaFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"cnasFlg",label:"CNAS",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cnasFlg?"success":"danger"}},[e._v(e._s("1"===r.cnasFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"extAssistFlg",label:"检测能力",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:r.extAssistFlg&&"0"===r.extAssistFlg?"success":"danger"}},[e._v(e._s(r.extAssistFlg&&"0"===r.extAssistFlg?"有":"无"))])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleRowDel(t.row,t.$index)}}},[e._v(" 删除")])]}}])})],2)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.factorSameVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1),a("el-dialog",{attrs:{title:"套餐详情",visible:e.factorGroupVisible,width:"75%",top:"5vh"},on:{"update:visible":function(t){e.factorGroupVisible=t}}},[a("el-table",{attrs:{data:e.showGroupData,stripe:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"160",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"检测费用",align:"center"}}),a("el-table-column",{attrs:{prop:"cmaFlg",label:"CMA",width:"60px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cmaFlg?"success":"danger"}},[e._v(e._s("1"===r.cmaFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"cnasFlg",label:"CNAS",width:"60px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cnasFlg?"success":"danger"}},[e._v(e._s("1"===r.cnasFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"extAssistFlg",label:"检测能力",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:r.extAssistFlg&&"0"===r.extAssistFlg?"success":"danger"}},[e._v(e._s(r.extAssistFlg&&"0"===r.extAssistFlg?"有":"无"))])]}}])})],1)],1)],1)},o=[],s=(a("7514"),a("ac6a"),a("5df3"),a("f400"),a("f858")),l=a("b705"),n=a("333d"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"innerSearchForm",attrs:{model:e.searchForm,inline:!0}},[a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{size:"small",clearable:"",filterable:"",placeholder:"检测对象"},on:{change:e.findSecClass},model:{value:e.searchForm.classId,callback:function(t){e.$set(e.searchForm,"classId",t)},expression:"searchForm.classId"}},e._l(e.classArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{size:"small",clearable:"",filterable:"",placeholder:"检测类别"},on:{change:e.handleSearch},model:{value:e.secdClassId,callback:function(t){e.secdClassId=t},expression:"secdClassId"}},e._l(e.secClassArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测因子:"}},[a("el-input",{attrs:{size:"small",placeholder:"检测因子"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",{attrs:{label:"标准号:"}},[a("el-input",{attrs:{size:"small",placeholder:"标准号"},model:{value:e.searchForm.standardNo,callback:function(t){e.$set(e.searchForm,"standardNo",t)},expression:"searchForm.standardNo"}})],1),a("el-form-item",{attrs:{label:"标准名称:"}},[a("el-input",{attrs:{size:"small",placeholder:"标准名称"},model:{value:e.searchForm.standardName,callback:function(t){e.$set(e.searchForm,"standardName",t)},expression:"searchForm.standardName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary",size:"small"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("div",[a("el-table",{ref:"compData",staticStyle:{width:"100%"},attrs:{stripe:"",size:"small",data:e.factorData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"300px"},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无因子\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象","min-width":"100",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"标准名称","min-width":"160",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"标准有效性",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e.STOKEN_STUTS[a.methodStatus])+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"price",label:"检测费用",align:"center"}}),a("el-table-column",{attrs:{prop:"cmaFlg",label:"CMA",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cmaFlg?"success":"danger"}},[e._v(e._s("1"===r.cmaFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"cnasFlg",label:"CNAS",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cnasFlg?"success":"danger"}},[e._v(e._s("1"===r.cnasFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"extAssistFlg",label:"检测能力",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:r.extAssistFlg&&"0"===r.extAssistFlg?"success":"danger"}},[e._v(e._s(r.extAssistFlg&&"0"===r.extAssistFlg?"有":"无"))])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},c=[],d=(a("7f7f"),a("96cf"),a("3b8d")),u={0:"现行",1:"自定义标准",2:"试行"},p={components:{Pagination:n["a"]},props:{showSelect:{type:Boolean,default:!0},authType:{type:String,default:""},choseRow:{type:Object,default:function(){return{}}},clearType:{type:String,default:""}},data:function(){return{STOKEN_STUTS:u,searchForm:{classId:"",factorName:"",authType:"",standardNo:"",standardName:"",pageNumber:1,pageSize:10},total:0,factorData:[],categoryArray:[],classArray:[],secClassArray:[],secdClassId:""}},watch:{clearType:function(){this.searchForm={classId:"",factorName:"",authType:"",standardNo:"",standardName:"",pageNumber:1,pageSize:10},this.factorData=[]},choseRow:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t),t&&this.$refs.compData.toggleRowSelection(t,!1);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},created:function(){console.log(":::"+this.$store.state.user.resetForm),this.getClassList()},methods:{getClassList:function(){var e=this;l["a"]().then((function(t){e.classArray=t.result||[]}))},findSecClass:function(e){var t=this;this.secdClassId="",this.searchForm.pageNumber=1,e.length>0&&l["d"](e).then((function(e){t.secClassArray=e.result||[]}))},handleSearch:function(){var e=this;this.secdClassId&&this.secdClassId.length>0?(this.searchForm.authType="",s["h"](this.searchForm).then((function(t){200===t.code&&(e.factorData=t.result.records||[],e.total=t.result.total)}))):this.$message.warning("请先选择对应的检测类别和认证类型!")},handleSelectionChange:function(e){var t=this;if(e&&e.length>0){var a=this.secClassArray.find((function(e){return e.id===t.secdClassId}));e.forEach((function(e){t.$set(e,"secdClassId",t.secdClassId),t.$set(e,"secdClassName",a.name)}))}this.$emit("pageChose",e)}}},m=p,h=(a("ff4f"),a("2877")),f=Object(h["a"])(m,i,c,!1,null,"89202144",null),b=f.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"innerSearchForm",attrs:{model:e.searchForm,inline:!0}},[a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"145px"},attrs:{clearable:"",filterable:"",placeholder:"检测对象"},on:{change:e.findSecClass},model:{value:e.searchForm.classId,callback:function(t){e.$set(e.searchForm,"classId",t)},expression:"searchForm.classId"}},e._l(e.classArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"145px"},attrs:{clearable:"",filterable:"",placeholder:"检测类别"},on:{change:e.handleSearch},model:{value:e.secdClassId,callback:function(t){e.secdClassId=t},expression:"secdClassId"}},e._l(e.secClassArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测因子:"}},[a("el-input",{staticStyle:{width:"145px"},attrs:{placeholder:"检测因子"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",{attrs:{label:"标准号:"}},[a("el-input",{staticStyle:{width:"145px"},attrs:{placeholder:"标准号"},model:{value:e.searchForm.standardNo,callback:function(t){e.$set(e.searchForm,"standardNo",t)},expression:"searchForm.standardNo"}})],1),a("el-form-item",{attrs:{label:"标准名称:"}},[a("el-input",{staticStyle:{width:"145px"},attrs:{placeholder:"标准名称"},model:{value:e.searchForm.standardName,callback:function(t){e.$set(e.searchForm,"standardName",t)},expression:"searchForm.standardName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary",size:"small"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("div",[a("el-table",{ref:"compData",staticStyle:{width:"100%"},attrs:{stripe:"",size:"small",border:"",data:e.factorData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"300px"},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无因子\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"55",align:"center",selectable:e.checkSelectable}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象","min-width":"100",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"标准名称","min-width":"160",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"标准有效性",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e.STOKEN_STUTS[a.methodStatus])+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"price",label:"检测费用",align:"center"}}),a("el-table-column",{attrs:{prop:"cmaFlg",label:"CMA",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cmaFlg?"success":"danger"}},[e._v(e._s("1"===r.cmaFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"cnasFlg",label:"CNAS",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cnasFlg?"success":"danger"}},[e._v(e._s("1"===r.cnasFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"extAssistFlg",label:"检测能力",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:r.extAssistFlg&&"0"===r.extAssistFlg?"success":"danger"}},[e._v(e._s(r.extAssistFlg&&"0"===r.extAssistFlg?"有":"无"))])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},v=[],y={0:"现行",1:"自定义标准",2:"试行"},F={name:"FactorSame",components:{Pagination:n["a"]},props:{showSelect:{type:Boolean,default:!0},choseRow:{type:Object,default:function(){return{}}},clearType:{type:String,default:""}},data:function(){return{STOKEN_STUTS:y,searchForm:{classId:"",factorName:"",authType:"",standardNo:"",standardName:"",dataEntryStep:"2",pageNumber:1,pageSize:10},total:0,factorData:[],categoryArray:[],classArray:[],secClassArray:[],secdClassId:"",currentStandNo:"",currentRows:[]}},watch:{clearType:function(){this.searchForm={classId:"",factorName:"",pageNumber:1,pageSize:10},this.factorData=[]},choseRow:function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t),t&&this.$refs.compData.toggleRowSelection(t,!1);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},created:function(){console.log(":::"+this.$store.state.user.resetForm),this.getClassList(),this.currentStandNo="",this.currentRows=[]},methods:{getClassList:function(){var e=this;l["a"]().then((function(t){e.classArray=t.result||[]}))},findSecClass:function(e){var t=this;this.secdClassId="",this.searchForm.pageNumber=1,""!==e?l["d"](e).then((function(e){t.secClassArray=e.result||[]})):this.secClassArray=[]},handleSearch:function(){var e=this;this.secdClassId&&this.secdClassId.length>0?(this.searchForm.authType="",s["h"](this.searchForm).then((function(t){200===t.code&&(e.factorData=t.result.records||[],e.total=t.result.total)}))):this.$message.warning("请先选择对应的检测类别和认证类型!")},handleSelectionChange:function(e){var t=this;if(e.length>0&&(this.currentStandNo=e[0].standardNo),e&&e.length>0){var a=this.secClassArray.find((function(e){return e.id===t.secdClassId}));e.forEach((function(e){t.$set(e,"secdClassId",t.secdClassId),t.$set(e,"secdClassName",a.name)}))}this.$emit("pageChose",e),this.currentRows=e},checkRow:function(e){return e.standardNo===this.currentStandNo||0===this.currentRows.length},checkSelectable:function(e){return this.checkRow(e)}}},w=F,k=(a("eb74"),Object(h["a"])(w,g,v,!1,null,"1c3b525e",null)),_=k.exports,S=a("9612"),x={0:"现行",1:"自定义标准",2:"试行"},C={components:{Pagination:n["a"],FactorList:b,FactorSameList:_},data:function(){return{STOKEN_STUTS:x,factorGroupData:[],searchForm:{groupName:"",groupType:"",authType:"",pageNumber:1,pageSize:10},total:0,titleMap:{edit:"修改套餐",create:"新增套餐"},factorGroupForm:{groupId:"",groupName:"",authType:"0",groupType:"",groupCost:"",remark:"",factorStandardIds:[]},factorGroupRules:{groupName:[{required:!0,message:"套餐名称",trigger:"blur"}]},factorGroupDialogStatus:"create",factorGroupDialogVisible:!1,factorGroupVisible:!1,factorChoseData:[],showGroupData:[],secdItems:{},currentRow:{},choseMealVisible:!1,factorSameVisible:!1,cleanAttr:""}},created:function(){this.getFactorDict(),this.handleSearch()},methods:{getFactorDict:function(){var e=this;l["e"]().then((function(t){if(200===t.code&&t.result){var a=new Map;t.result.forEach((function(e){a.set(e.id,e.children)})),console.log(a),e.secdItems=a}}))},handleSearch:function(){var e=this;s["g"](this.searchForm).then((function(t){200===t.code&&(e.factorGroupData=t.result.records||[],e.total=t.result.total)}))},handleCreate:function(){this.choseMealVisible=!0},handleFreeCreate:function(){this.choseMealVisible=!1,this.clearForm(),this.cleanAttr=S["b"].v4().replaceAll("-",""),this.factorGroupForm.groupType="0",this.factorGroupDialogStatus="create",this.factorGroupDialogVisible=!0,Object.assign({classId:"",factorName:"",authType:"",pageNumber:1,pageSize:10},this.$options.data().innerSearchForm)},handleSameCreate:function(){this.clearForm(),this.factorGroupDialogStatus="create",this.cleanAttr=S["b"].v4().replaceAll("-",""),this.factorGroupForm.groupType="1",this.factorSameVisible=!0,Object.assign({classId:"",factorName:"",authType:"",pageNumber:1,pageSize:10},this.$options.data().innerSearchForm)},handleUpdate:function(e){this.factorGroupDialogStatus="edit",this.factorGroupForm.groupId=e.groupId,this.factorGroupForm.groupName=e.groupName,this.factorGroupForm.groupType=e.groupType,this.factorGroupForm.groupCost=e.groupCost?e.groupCost:"",this.factorGroupForm.authType=e.authType,this.factorGroupForm.remark=e.remark,"0"===e.groupType?this.getFactorChoses(e.groupId):this.getFactorSameChoses(e.groupId),this.$store.dispatch("user/resetCompForm","1")},getFactorChoses:function(e){var t=this;s["c"](e).then((function(e){200===e.code&&(t.factorChoseData=e.result||[]),t.factorGroupDialogVisible=!0}))},getFactorSameChoses:function(e){var t=this;s["c"](e).then((function(e){200===e.code&&(t.factorChoseData=e.result||[]),t.factorSameVisible=!0}))},confirmDialog:function(){if(!this.factorGroupForm.groupName||this.factorChoseData.length<=0)this.$message.warning("套餐名称、因子项不能为空");else{var e=this.factorChoseData.find((function(e){return e.secdClassId}));if(e){if("1"===this.factorGroupForm.groupType){var t=[];if(this.factorChoseData.forEach((function(e){var a=t.find((function(t){return t.standardNo===e.standardNo}));a||t.push(e)})),t.length>1)return void this.$message.error("同系套餐只能针对一个标准号配置")}this.factorChoseData.length<=1?this.$message.error("同系套餐因子必须超过1个"):"create"===this.factorGroupDialogStatus?this.confirmCreate():this.confirmUpdate()}else this.$message.warning("二级类别不能为空")}},confirmCreate:function(){var e=this,t=0,a={groupName:this.factorGroupForm.groupName,remark:this.factorGroupForm.remark,authType:this.factorGroupForm.authType,groupType:this.factorGroupForm.groupType,groupCost:""!==this.factorGroupForm.groupCost?this.factorGroupForm.groupCost:"",factorStandardIds:this.factorChoseData.map((function(e){return t=parseFloat(t+e.price),{checkStandardId:e.standardCode,secdClassId:e.secdClassId,factorName:e.factorName}}))};"1"===this.factorGroupForm.groupType&&t<=this.factorGroupForm.groupCost&&(a.groupCost=t),s["j"](a).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.factorGroupDialogVisible=!1,e.factorSameVisible=!1})).catch((function(){}))},confirmUpdate:function(){var e=this,t=0,a={groupId:this.factorGroupForm.groupId,groupName:this.factorGroupForm.groupName,authType:this.factorGroupForm.authType,remark:this.factorGroupForm.remark,groupType:this.factorGroupForm.groupType,groupCost:""!==this.factorGroupForm.groupCost?this.factorGroupForm.groupCost:"",factorStandardIds:this.factorChoseData.map((function(e){return t=parseFloat(t+e.price),{checkStandardId:e.standardCode,secdClassId:e.secdClassId,factorName:e.factorName}}))};"1"===this.factorGroupForm.groupType&&t<=this.factorGroupForm.groupCost&&(a.groupCost=t),s["i"](a).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.factorGroupDialogVisible=!1,e.factorSameVisible=!1})).catch((function(){}))},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["b"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleCopy:function(e){var t=this;this.$confirm("确定复制?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},clearForm:function(){this.factorGroupForm={groupId:"",groupName:"",authType:"0",groupType:"",groupCost:"",remark:"",factorStandardIds:[]},this.factorChoseData=[]},handleChose:function(e){var t=this;e&&e.forEach((function(e){var a=t.factorChoseData.find((function(t){return t.id===e.id&&e.secdClassId&&t.secdClassId===e.secdClassId}));!a&&e.secdClassId&&t.factorChoseData.push(e)}))},handleSameChose:function(e){var t=this;e&&e.forEach((function(e){var a=t.factorChoseData.find((function(t){return t.id===e.id&&e.secdClassId&&t.secdClassId===e.secdClassId&&e.standardNo===t.standardNo}));!a&&e.secdClassId&&t.factorChoseData.push(e)}))},checkAutype:function(){this.factorChoseData=[]},handleRowDel:function(e,t){this.factorChoseData.splice(t,1),this.currentRow=e},handleDetail:function(e){var t=this;s["c"](e).then((function(e){t.showGroupData=e.result||[],t.factorGroupVisible=!0}))},handleDialogClose:function(e){this.factorGroupDialogVisible=!1,this.$store.dispatch("user/resetCompForm",""),e()},handleSameDialogClose:function(e){this.factorGroupDialogVisible=!1,this.$store.dispatch("user/resetCompForm",""),e()}}},N=C,I=(a("f8e1"),Object(h["a"])(N,r,o,!1,null,"b068041e",null));t["default"]=I.exports},"01a7":function(e,t,a){"use strict";a("b894")},"024c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{ref:"stockTable",staticClass:"table-item",staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.taskData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"totalSamples",label:"样品总数","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"inBoundSamples",label:"入库样品数",align:"center"}}),a("el-table-column",{attrs:{prop:"outBoundSamples",label:"出库样品数",width:"100px",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("d43b"),l=a("333d"),n={6:"在库",7:"部分出库",8:"已出库"},i={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},c={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){var t={6:"",7:"success",8:"success"};return t[e]}},data:function(){return{STOCK_STATUS:n,CHECK_STATUS:i,taskData:[],searchForm:{jobId:"",sampItemId:"",sampStatus:"",date:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleDetailForm:{collectUser:"",sampleProperties:"",sampleFixative:"",collectRemark:"",collectLocation:"",collectIamge1:"",collectIamge2:"",collectIamge3:"",collectIamge4:"",factorName:""},currentSample:"",approveForm:{sampItemId:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],multipleSelection:[],downVisible:!1,recordForm:{taskId:"",classId:"",secClassId:"",sampleDate:""},classArray:[],secClassArray:[],sampleDetails:[],sampleDataInfo:[],sampleSecInfo:[],currentSelectionRow:{jobId:"",secdClassName:"",storeData:""}}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["d"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.taskData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){this.$router.push("/other/stockList/".concat(e.sampTaskId))}}},d=c,u=(a("ad06"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"21360c50",null);t["default"]=p.exports},"02b0":function(e,t,a){},"02f2":function(e,t,a){},"0340":function(e,t,a){"use strict";a("9fcc")},"0375":function(e,t,a){"use strict";a("ae64")},"03d5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.taskData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务周期",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"采样进度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.completeSampCount)+"/"+e._s(a.sampCount)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 确认样品")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("47bc"),l=a("333d"),n={0:"待分配",1:"采样中"},i={components:{Pagination:l["a"]},data:function(){return{SAMPLE_STATUS:n,taskData:[],searchForm:{jobId:"",pageNumber:1,pageSize:20},total:0}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["v"](this.searchForm).then((function(t){200===t.code&&(e.taskData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){this.$router.push("/other/masterConfirm/".concat(e.sampTaskId))}}},c=i,d=(a("43dd"),a("407e"),a("9f079"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"4f05b7be",null);t["default"]=u.exports},"04a5":function(e,t,a){"use strict";a("6ba2")},"059d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:7}},[a("el-card",{staticClass:"card-left",attrs:{shadow:"never"}},[a("el-input",{attrs:{placeholder:"输入名称"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.deptTreeData,props:e.defaultProps,"highlight-current":"","default-expand-all":"","filter-node-method":e.filterNode,"expand-on-click-node":!1},on:{"node-click":e.onSelectDepart}})],1)],1),a("el-col",{attrs:{span:17}},[a("el-card",{staticClass:"card-right",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("当前部门: "),a("i",{staticClass:"el-input__icon"})]),e._v(e._s(e.currentDeptName)+"\n          "),e.currentDeptId&&e.currentDeptId.length>0?a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]):e._e(),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.departData,border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                    暂无部门\n                  ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"deptName",label:"下级部门名称",align:"center"}}),a("el-table-column",{attrs:{prop:"platformDeptName",label:"部门职能",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",[e._v(e._s(r.platformDeptName))])]}}])}),a("el-table-column",{attrs:{prop:"deptDesc",label:"描述",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",width:"140px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],2)],1)])],1)],1),a("el-dialog",{attrs:{title:e.titleMap[e.deptDialogStatus],visible:e.departVisible,center:""},on:{"update:visible":function(t){e.departVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{ref:"departForm",attrs:{model:e.departForm,rules:e.departRules,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"deptName",label:"部门名称:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请录入部门名称",maxlength:"15","show-word-limit":""},model:{value:e.departForm.deptName,callback:function(t){e.$set(e.departForm,"deptName",t)},expression:"departForm.deptName"}})],1),a("el-form-item",{attrs:{prop:"platformDeptId",label:"部门职能:"}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"业务流转权限关联"},model:{value:e.departForm.platformDeptId,callback:function(t){e.$set(e.departForm,"platformDeptId",t)},expression:"departForm.platformDeptId"}},e._l(Object.keys(e.plDeptmentArray),(function(t){return a("el-option",{key:t,attrs:{label:e.plDeptmentArray[t],value:t}})})),1)],1),a("el-form-item",{attrs:{label:"部门描述:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",rows:4,maxlength:"50","show-word-limit":"",placeholder:"请录入部门描述"},model:{value:e.departForm.deptDesc,callback:function(t){e.$set(e.departForm,"deptDesc",t)},expression:"departForm.deptDesc"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.departVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDepart}},[e._v("保存")])],1)])],1)},o=[],s=a("db72"),l=a("fe05"),n=a("b705"),i={name:"DeptList",data:function(){return{deptTreeData:[],defaultProps:{children:"children",label:"deptName",id:"id"},titleMap:{edit:"修改部门",create:"新增部门"},posTitleMap:{edit:"修改岗位",create:"新增岗位"},deptDialogStatus:"create",currentDeptId:"",currentDeptName:"",departData:[],filterText:"",departVisible:!1,departForm:{parentDeptId:"",platformDeptId:"",deptId:"",deptName:"",deptDesc:""},departRules:{deptName:[{required:!0,message:"部门名称",trigger:"blur"}],platformDeptId:[{required:!0,message:"请选择平台流转权限",trigger:"change"}]},currentTreeItem:{},departName:"",roleListArray:[],currentNode:{},currentResolve:{},plDeptmentArray:[]}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},created:function(){this.getDicKey("plDeptmentArray",1001),this.getDeptTreeList()},methods:{getDicKey:function(e,t){var a=this;Object(n["g"])(t).then((function(t){200===t.code&&(a[e]=t.result)}))},getDeptTreeList:function(){var e=this;this.deptTreeData=[],l["getDeptTreeList"]().then((function(t){var a=t.result||{};e.deptTreeData.push(a)}))},getPlDepartList:function(){},filterNode:function(e,t){return!e||-1!==t.deptName.indexOf(e)},loadNode:function(e,t){var a=this;this.currentNode=e,this.currentResolve=t;var r=e.data;if(this.currentDeptId=r.id,this.currentDeptName=r.deptName,0===e.level)return t([{id:-1001,deptName:this.$store.getters.userInfo.organName||"当前机构",children:[]}]);this.currentDeptId?(this.departData=[],l["findTopDeptListByParentId"](this.currentDeptId).then((function(e){200===e.code&&e.result?(a.departData=e.result.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{parentName:a.currentDeptName})}))||[],t(e.result)):t([])})).catch((function(){t([])}))):t([])},onSelectDepart:function(e){var t=this;e.id!==this.currentDeptId&&(this.currentDeptId=e.id,this.currentDeptName=e.deptName,this.$nextTick((function(){t.handleSearch()})))},confirmDepart:function(){var e=this;this.$refs.departForm.validate((function(t){if(t)if("create"===e.deptDialogStatus){var a={parentDeptId:e.departForm.parentDeptId,platformDeptId:e.departForm.platformDeptId,deptName:e.departForm.deptName,deptDesc:e.departForm.deptDesc};l["createDeptInfo"](a).then((function(t){200===t.code&&(e.handleSearch(),e.getDeptTreeList(),e.departVisible=!1)}))}else{var r={deptId:e.departForm.deptId,platformDeptId:e.departForm.platformDeptId,deptName:e.departForm.deptName,deptDesc:e.departForm.deptDesc};l["updateDeptInfo"](r).then((function(t){200===t.code&&(e.handleSearch(),e.getDeptTreeList(),e.departVisible=!1)}))}}))},handleSearch:function(){var e=this;this.currentDeptId&&(this.departData=[],l["findTopDeptListByParentId"](this.currentDeptId).then((function(t){200===t.code&&t.result&&(e.departData=t.result.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{parentName:e.currentDeptName})}))||[])})).catch((function(){})))},handleCreate:function(){this.clearForm(),this.departForm.parentDeptId=this.currentDeptId,this.deptDialogStatus="create",this.departVisible=!0},handleUpdate:function(e){this.clearForm(),this.departForm.deptId=e.id,this.departForm.platformDeptId=e.platformDeptId,this.departForm.deptName=e.deptName||"",this.departForm.deptDesc=e.deptDesc||"",this.deptDialogStatus="edit",this.departVisible=!0},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["delDeptById"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch(),t.getDeptTreeList()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},appendDepart:function(e){this.currentTreeItem=e,this.deptDialogStatus="create",this.departName="",this.departVisible=!0},updateDepart:function(e){this.currentTreeItem=e,this.deptDialogStatus="edit",this.departName=e.deptName,this.departVisible=!0},removeDepart:function(e,t){var a=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["delDeptById"](t.id).then((function(e){200===e.code&&(a.getDepartList(),a.currentDeptId="",a.positionData=[])}))}))},clearForm:function(){this.departForm={parentDeptId:"",platformDeptId:"",deptId:"",deptName:"",deptDesc:""}}}},c=i,d=(a("1431"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"79049886",null);t["default"]=u.exports},"062b":function(e,t,a){},"067a":function(e,t,a){"use strict";a("39da")},"068f":function(e,t,a){"use strict";a("a933")},"06d8":function(e,t,a){},"0772":function(e,t,a){"use strict";a("a37b7")},"0812":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"checkTime",label:"审核时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1):e._e(),r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1):e._e()],1)],1)]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报告签发确认",visible:e.issueVisible,center:""},on:{"update:visible":function(t){e.issueVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.issueForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.issueForm.auditFlag,callback:function(t){e.$set(e.issueForm,"auditFlag",t)},expression:"issueForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.issueForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.issueForm.auditReason,callback:function(t){e.$set(e.issueForm,"auditReason",t)},expression:"issueForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.issueVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmIssueDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("db72"),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{searchForm:{jobId:"",projectName:"",pageNumber:1,pageSize:10},total:0,reportData:[],issueVisible:!1,issueForm:{id:"",auditFlag:"1",remark:""}}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["d"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)},handleIssue:function(e){this.issueForm.id=e.id,this.issueForm.auditFlag="1",this.issueForm.remark="",this.issueVisible=!0},confirmIssueDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["i"](e.issueForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.issueVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},p=u,m=(a("da72"),a("2877")),h=Object(m["a"])(p,r,o,!1,null,"70be85f0",null);t["default"]=h.exports},"0844":function(e,t,a){},"0867":function(e,t,a){},"08d0":function(e,t,a){"use strict";a("4dcb")},"0a37":function(e,t,a){e.exports=a.p+"static/img/shoujitianchong.59da20d4.png"},"0a82":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"progress-item",staticStyle:{"padding-top":"15px"}},[a("span",[e._v("采样任务(已完成: 52)")]),a("el-progress",{staticStyle:{"padding-top":"8px"},attrs:{percentage:e.sampleNum}})],1),a("div",{staticClass:"progress-item"},[a("span",[e._v("检测任务(已完成: 38)")]),a("el-progress",{staticStyle:{"padding-top":"8px"},attrs:{percentage:e.testNum,color:"#e6a23c"}})],1),a("div",{staticClass:"progress-item"},[a("span",[e._v("报告编织任务(已完成: 38)")]),a("el-progress",{staticStyle:{"padding-top":"8px"},attrs:{percentage:e.reportNum,color:"#6f7ad3"}})],1)])},o=[],s=(a("c5f6"),{filters:{statusFilter:function(e){var t={success:"success",pending:"danger"};return t[e]}},props:{taskForm:{type:Object,default:function(){return{sampleNum:0,testNum:0,reportNum:0}}},sampleNum:{type:Number,default:10},testNum:{type:Number,default:20},reportNum:{type:Number,default:30}},data:function(){return{statisticsData:{article_count:1024,pageviews_count:1024}}}}),l=s,n=(a("dda9"),a("65a8"),a("2877")),i=Object(n["a"])(l,r,o,!1,null,"1864f68b",null);t["default"]=i.exports},"0b5a":function(e,t,a){},"0bb4":function(e,t,a){},"0bf7":function(e,t,a){"use strict";a("d637")},"0c06":function(e,t,a){"use strict";a("206a9")},"0cc4":function(e,t,a){"use strict";a("7504")},"0dea":function(e,t,a){},"0def":function(e,t,a){"use strict";a("6723")},"0e6b":function(e,t,a){},"0ef1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),a("el-form-item",{attrs:{label:"报价单状态:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"报价单状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(Object.keys(e.ACCOUNT_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.ACCOUNT_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.orderData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无历史报价单\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",fixed:"left","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"报价单号",sortable:"","min-width":"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkType",label:"检测类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("0"===a.checkType?"委托检测":"样品送检")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"certificationType",label:"认证类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.certificationType?"CMA":"CNAS")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"consignorName",label:"客户名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"finishDate",label:"客户要求完成时间",width:"140",align:"center"}}),a("el-table-column",{attrs:{prop:"createUserId",label:"报价人",align:"center"}}),a("el-table-column",{attrs:{prop:"draftAmount",label:"费用总计(元)",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.status)}},[e._v("\n            "+e._s(e.ACCOUNT_STATUS[r.status])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"270"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleCopy(r)}}},[e._v(" 复制")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleHisApproveDetail(r)}}},[e._v(" 审核历史")]),a("el-dropdown",{attrs:{size:"medium"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n              下载"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("WORD下载")])],1),a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleExcelDownload(r)}}},[a("el-dropdown-item",[e._v("EXCEL下载")])],1)],1)],1)]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报价单("+e.orderDetailForm.offerId+")",visible:e.detailVisible,top:"5vh",width:"70%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"135px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户名称:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorName||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系人:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinker||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinkerPhone||""))])],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户要求完成时间:"}},[e._v(e._s(e._f("Time2Format")(e.orderDetailForm.offerBaseVo.finishDate)))])],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.remark||""))])],1)],1)],1),e._l(e.orderDetailPlans,(function(t,r){return a("div",{key:r},[a("el-divider",[e._v(e._s(t.planName)+"-计划因子列表")]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0"}},[a("thead",[a("tr",[a("th",{attrs:{rowspan:"2"}},[e._v("序号")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测类别")]),a("th",{attrs:{colspan:"3"}},[e._v("检测项目")]),a("th",{attrs:{rowspan:"2"}},[e._v("频次(次/天)")]),a("th",{attrs:{rowspan:"2"}},[e._v("天数")]),a("th",{attrs:{rowspan:"2"}},[e._v("监测频次")]),a("th",{attrs:{rowspan:"2"}},[e._v("执行次数")]),a("th",{attrs:{rowspan:"2"}},[e._v("总数")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测单价(元)")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测费(元)")])]),a("tr",[a("th",[e._v("序号")]),a("th",[e._v("检测位置")]),a("th",[e._v("因子")])])]),a("tbody",[e._l(t.factorTdos,(function(r,o){return a("tr",{key:o},[0==r.frIndex?[a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.id))]),a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.secName))])]:e._e(),a("td",[e._v(e._s(r.sid))]),a("td",[e._v(e._s(r.factorPoint))]),a("td",[e._v(e._s(r.factorName)+e._s(r.meanName&&r.meanName.length>0?"("+r.meanName+")":""))]),a("td",[e._v(e._s(r.frequency))]),a("td",[e._v(e._s(r.dayCount))]),0==o?[a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.checkFreq))]),a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.execTimes))])]:e._e(),a("td",[e._v(e._s(Number(r.frequency*r.dayCount*t.execTimes).toFixed(0)))]),a("td",[e._v(e._s(r.costPerTime))]),a("td",[e._v(e._s(parseFloat(r.costPerTime*r.frequency*r.dayCount*t.execTimes).toFixed(2)))])],2)})),a("tr",[a("td",{attrs:{colspan:"11"}},[e._v("检测费合计")]),a("td",[e._v(e._s(parseFloat(t.checkFee*t.execTimes).toFixed(2)))])])],2)])])],1)})),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0  "}},[a("tbody",[a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("检测费合计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.checkAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告编制费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.reportAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告加急费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.expediteAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("采样费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.laborAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("差旅费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.tripAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("税额")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.taxAmount)))])]),e.orderDetailForm.selfCostVos?e._l(e.orderDetailForm.selfCostVos,(function(t,r){return a("tr",{key:r},[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(t.selfName))]),a("td",[e._v(e._s(e._f("MoneyFormat")(t.amount)))])])})):e._e(),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("总计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.sysAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("优惠价")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.draftAmount)))])]),a("tr",[a("td",{staticStyle:{width:"20%"}},[e._v("大写：")]),a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(e._f("Money2Chinese")(e.orderDetailForm.costVo.draftAmount)))])])],2)])])],2),a("el-dialog",{attrs:{title:"审核历史",visible:e.hisApproveVisible,width:"75%"},on:{"update:visible":function(t){e.hisApproveVisible=t}}},[a("el-table",{attrs:{data:e.approveDetails,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:0==r.isPass?"success":"danger"}},[e._v(e._s(0==r.isPass?"审核通过":"审核不通过"))])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"审核说明",align:"center"}}),a("el-table-column",{attrs:{prop:"approvalUserName",label:"审批用户",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"审批时间",align:"center"}})],1)],1)],1)},o=[],s=(a("7514"),a("5df3"),a("f400"),a("75fc")),l=(a("ac6a"),a("e601")),n=a("333d"),i=a("b429"),c={3:"审核通过",4:"作废"},d={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},u={name:"OrderList",components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success",4:"danger"};return t[e]}},data:function(){return{ACCOUNT_STATUS:c,CHECK_STATUS:d,orderData:[],defaultProps:{children:"children",label:"name",id:"id"},searchForm:{id:"",projectName:"",status:"",pageNumber:1,pageSize:10},total:0,titleMap:{edit:"报价单修改",create:"报价单新增"},orderForm:{offerId:"",offerInfoTdo:{projectName:"",checkType:"0",certificationType:"1",status:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:"",offerer:"",finishDate:"",checkCircle:"0",checkTaskCount:"",remark:""},factorTdos:[],offerCostTdo:{id:"",reportAmount:0,reportAmountRate:10,expediteAmount:0,expediteAmountRate:0,laborAmount:0,tripAmount:0,taxAmount:"",taxAmountRate:6,checkAmount:0,sysAmount:0,draftAmount:0},selfCostTdos:[]},otherPrice:"",orderDialogStatus:"create",orderDialogVisible:!1,departmentArray:[],orderActiveName:"1",factorData:[],priceArray:[],innerPriceVisible:!1,addPriceForm:{selfName:"",amount:0},factorVisible:!1,showPriceForm:{},showChoseData:[],factTotal:0,factorForm:{classId:"",factorName:"",pageNumber:1,pageSize:10},factorMultipleSelection:[],choseFatcors:[],addressArray:[],setDay:1,frequency:1,currentNodeId:"",lookPosition:"",currentNodeName:"",detailVisible:!1,orderDetailForm:{offerId:"",offerBaseVo:{consignorName:"",consignorLinker:"",consignorLinkerPhone:"",createUserName:"",finishDate:"",remark:"",checkCircle:"",checkTaskCount:""},offerPlanVos:[],costVo:{},selfCostVos:[],factorTdos:[]},approveDetails:[],hisApproveVisible:!1,orderDetailPlans:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;l["d"](this.searchForm).then((function(t){200===t.code&&(e.orderData=t.result.records||[],e.total=t.result.total)}))},handleCopy:function(e){var t=this;this.$confirm("确定复制?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["b"](e.id).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleDetail:function(e){var t=this;l["f"](e.id).then((function(e){if(200===e.code){var a=[];t.orderDetailForm.offerId=e.result.offerId||"",t.orderDetailForm.offerBaseVo=e.result.offerBaseVo||{},t.orderDetailForm.costVo=e.result.costVo||{},t.orderDetailForm.selfCostVos=e.result.selfCostVos||[],t.orderDetailForm.offerPlanVos=a=e.result.offerPlanVos.map((function(e){return e.planFactorVoList&&e.planFactorVoList.length>0&&(e.planFactorVoList.forEach((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}})),t.$set(e,"oldPlanFactors",e.planFactorVoList)),e}))||[],t.orderDetailPlans=t.doProcessOrder(a)||[],t.detailVisible=!0}}))},doProcessOrder:function(e){var t=this;if(e&&e.length>0){var a=Object(s["a"])(e);return a.forEach((function(e){var a=t.doProcessDate(e.planFactorVoList);t.$set(e,"factorTdos",a)})),a}},doProcessDate:function(e){var t=this;if(e&&e.length>0){var a=[],r=new Map,o=[],s=1;return e.forEach((function(e,t){var o=a.find((function(t){return t.secdClassName===e.secdClassName}));if(o||(a.push({id:s,secdClassName:e.secdClassName,totalPrice:0,detailLength:0}),s++),r.get(e.secdClassName)){var l=r.get(e.secdClassName);l.push(e)}else{var n=[];n.push(e),r.set(e.secdClassName,n)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName);a&&a.length>0&&a.forEach((function(r,s){var l=o.find((function(e){return e.secName===r.secdClassName}));l?t.$set(r,"frIndex",1):t.$set(r,"frIndex",0),t.$set(r,"id",e.id),t.$set(r,"sid",e.id+"."+(s+1)),t.$set(r,"secName",e.secdClassName),t.$set(r,"detailLength",a.length),t.$set(r,"dateType",0),o.push(r)}))})),o}return[]},countTotal:function(e,t){var a=0;return a=e.reduce((function(e,a,r,o){return a[t]?e+a[t]:e}),0),a},handleDownload:function(e){var t="/api/word/downLoadOffer?offerId="+e.id;window.open(t)},handleExcelDownload:function(e){var t="/api/word/downLoadOfferExcel?offerId="+e.id;window.open(t)},handleHisApproveDetail:function(e){var t=this;i["a"](e.id).then((function(e){t.approveDetails=e.result||[]})),this.hisApproveVisible=!0}}},p=u,m=(a("067a"),a("398e"),a("2877")),h=Object(m["a"])(p,r,o,!1,null,"f2e588f0",null);t["default"]=h.exports},"0f17":function(e,t,a){},"0ffe":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"commitCheckTime",label:"提交审核时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),a("div",{staticClass:"erc-divider-vertical"}),r.reportMakeUserId===e.userId||e.checkPermission(["sqqzi"])?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r)}}},[e._v("审核")]),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1):e._e(),r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1):e._e()],1)],1)]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报告审核",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("db72"),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u=(a("4328"),{1:"未生成",2:"制作中",3:"待提交审批",4:"待审核",5:"待签发",6:"完成",7:"已驳回"}),p={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{REPORT_STATUS:u,searchForm:{jobId:"",projectName:"",reportStatus:"",pageNumber:1,pageSize:10},total:0,reportData:[],approveVisible:!1,approveForm:{id:"",auditFlag:"1",remark:""},issueVisible:!1,issueForm:{id:"",auditFlag:"1",remark:""},basicForm:{cmaNumber:"",cnasNumber:"",tel:"",fax:"",address:"",website:"",postCode:"",logoImageId:"",watermarkImageId:""},basicRules:{cmaNumber:[{required:!0,message:"请录入CMA证书号",trigger:"blur"}],cnasNumber:[{required:!0,message:"请录入CNAS证书号",trigger:"blur"}],tel:[{required:!0,message:"请录入电话",trigger:"blur"}],fax:[{required:!0,message:"请录入传真",trigger:"blur"}],postCode:[{required:!0,message:"请录入邮政编码",trigger:"blur"}],website:[{required:!0,message:"请录入网址",trigger:"blur"}],address:[{required:!0,message:"请录入详细地址",trigger:"blur"}],logoImageId:[{required:!0,message:"请上传企业Logo图片",trigger:"blur"}],watermarkImageId:[{required:!0,message:"请上传报告水印图片",trigger:"blur"}]},logoImageList:[],waterImageList:[],dialogImageUrl:"",basicVisible:!1,dialogVisible:!1,logoFileList:[],waterFileList:[],uploadVisible:!1,uploadForm:{id:"",reportCode:"",reportFile:""},uploadRules:{reportFile:[{required:!0,message:"请上传报告信息",trigger:"blur"}]},fileList:[],hideLogoUploadEdit:!1,hideUploadEdit:!1,downloadLoading:!1}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["b"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)},handleApprove:function(e){this.approveForm.id=e.id,this.approveForm.auditFlag="1",this.approveForm.remark="",this.approveVisible=!0},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["g"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.approveVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},m=p,h=(a("9f32"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"27bdca1a",null);t["default"]=f.exports},1002:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-article",attrs:{"element-loading-text":"PDF文件查看"}},[a("iframe",{staticClass:"prism-player",attrs:{src:e.pdfUrl,frameborder:"0",width:"100%",height:"750px"}})])},o=[],s={data:function(){return{pdfUrl:""}},created:function(){this.$route.params.path&&("1"===this.$route.params.type||1===this.$route.params.type?this.pdfUrl=this.$store.getters.sysBaseUrl+"/file/ht/upload/"+this.$route.params.path:this.pdfUrl=this.$store.getters.sysBaseUrl+"/file/report/"+this.$route.params.path)},methods:{}},l=s,n=(a("01a7"),a("2877")),i=Object(n["a"])(l,r,o,!1,null,null,null);t["default"]=i.exports},1095:function(e,t,a){},"10b9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-card",{staticStyle:{height:"400px","overflow-y":"auto"},attrs:{shadow:"never"}},e._l(e.factorGroupData,(function(t,r){return a("div",{key:r,staticClass:"text dialog-item",on:{click:function(a){return e.choseItem(t)}}},[e._v("\n          "+e._s(t.groupName)+"\n        ")])})),0)],1),a("el-col",{attrs:{span:20}},[a("el-table",{ref:"groupMultipleTable",attrs:{data:e.factorList,border:"",height:"500px","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleGroupSelectionChange,select:e.groupSelect}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测对象",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"价格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(e._f("MoneyFormat")(a.price))+" 元\n          ")]}}])})],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("已选因子")]),a("el-row",{staticStyle:{"min-height":"36px","line-height":"30px"}},[a("el-col",{attrs:{span:2}},[a("span",[e._v("已选中因子:")])]),a("el-col",{attrs:{span:22}},[e.choseGroupFatcors&&e.choseGroupFatcors.length>0?e._l(e.choseGroupFatcors,(function(t){return a("el-tag",{key:t.id,staticStyle:{margin:"2px 3px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleGroupClose(t)}}},[e._v("\n          "+e._s(t.factorName)+"\n        ")])})):[e._v("\n        无\n      ")]],2)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("因子配置")]),a("el-form",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},["002001"===e.currentNodeId?a("el-form-item",{attrs:{label:"均值类型:","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择均值类型"},on:{change:e.changeMeanType},model:{value:e.meanType,callback:function(t){e.meanType=t},expression:"meanType"}},[a("el-option",{attrs:{value:"0",label:"日均值"}}),a("el-option",{attrs:{value:"1",label:"时均值"}}),a("el-option",{attrs:{value:"2",label:"八小时均值"}})],1)],1):e._e()],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"天数:","label-width":"100px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.setDay,callback:function(t){e.setDay=t},expression:"setDay"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"频次(次/天):","label-width":"110px"}},[a("el-input-number",{attrs:{"controls-position":"right",max:e.maxTotal,min:1,step:1,precision:0},model:{value:e.frequency,callback:function(t){e.frequency=t},expression:"frequency"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.addressArray&&e.addressArray.length>0?"检测位置1:":"检测位置:","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:e.lookPosition,callback:function(t){e.lookPosition=t},expression:"lookPosition"}})],1)],1)],1),a("el-row",[e._l(e.addressArray,(function(t,r){return a("el-col",{key:t.key,attrs:{span:24}},[a("el-form-item",{attrs:{label:"检测位置"+(r+2)+":","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),"002001"!==e.currentNodeId&&"002003"!==e.currentNodeId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeAddDomain(t)}}},[e._v("删除")]):e._e()],1)],1)})),"002003"!==e.currentNodeId&&"002001"!==e.currentNodeId?a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addAddress}},[e._v("添加位置")])],1)],1):e._e()],2)],1),a("el-divider"),a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-button",{attrs:{type:""},on:{click:e.cancelComfig}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmGroupChoseFactor}},[e._v("确 定")])],1)],1)],1)},o=[],s=(a("c5f6"),a("20d6"),a("7514"),a("ac6a"),a("f858")),l=a("9612"),n={0:"日均值",1:"时均值",2:"八小时均值"},i={props:{clearType:{type:String,default:""}},data:function(){return{MEAN_STATUS:n,factorGroupData:[],currentNodeId:"",factorList:[],meanType:"",currentNodeName:"",choseGroupFatcors:[],maxTotal:10,setDay:1,frequency:1,addressArray:[],lookPosition:"",currentForm:{},multiplGroupeSelection:[]}},watch:{clearType:function(){this.factorList=[],this.addressArray=[],this.choseGroupFatcors=[],this.multiplGroupeSelection=[],this.setDay=1,this.frequency=1,this.currentForm={},this.lookPosition=""}},created:function(){this.getFactorGroup()},methods:{getFactorGroup:function(){var e=this;s["f"]().then((function(t){200===t.code&&(e.factorGroupData=t.result||[])}))},handleGroupSelectionChange:function(e){var t=this;if(this.multiplGroupeSelection=e,e&&e.length>0){var a=0;e.forEach((function(e){a=parseFloat(e.price+a),a>t.currentForm.groupCost&&(a=t.currentForm.groupCost)})),e.forEach((function(e){var r=t.choseGroupFatcors.find((function(t){return t.standardCode===e.standardCode}));if(0===t.choseGroupFatcors.length){var o=[];o.push(e);var s={standardCode:e.standardCode,className:e.className,standardNo:e.standardNo,standardName:e.standardName,isFactor:"1",factorName:t.getFactorName(o),secdClassId:e.secdClassId,secdClassName:e.secdClassName,frequency:e.frequency,dayCount:e.dayCount,costPerTime:a,subCheckStandards:o};t.choseGroupFatcors.push(s)}else if(!r){var l=t.choseGroupFatcors[0].subCheckStandards;l.push(e),t.choseGroupFatcors[0].factorName=t.getFactorName(l),t.choseGroupFatcors[0].costPerTime=a}})),this.currentNodeId=this.choseGroupFatcors[0].secdClassId}else this.currentNodeId="";0===this.addressArray.length&&("002003"===this.currentNodeId?this.$nextTick((function(){for(var e=0;e<4;e++)t.addressArray.push({value:"",windNum:3,key:Date.now()+e})})):"002001"===this.currentNodeId&&this.$nextTick((function(){for(var e=0;e<3;e++)t.addressArray.push({value:"",windNum:3,key:Date.now()+e})})))},getFactorName:function(e){if(1===e.length)return this.currentForm.groupName+"("+e[0].factorName+")";var t="";e.forEach((function(e){t+=e.factorName+","}));var a=this.currentForm.groupName+"("+t.substring(0,20)+"...)";return a},groupSelect:function(e,t){if(e&&-1===e.indexOf(t)){var a=this.choseGroupFatcors.findIndex((function(e){return e.standardCode===t.standardCode}));this.choseGroupFatcors.splice(a,1)}},choseItem:function(e){var t=this;this.factorList=[],this.multiplGroupeSelection=[],this.choseGroupFatcors=[],this.currentForm=e,this.setDay=1,this.frequency=1,this.maxTotal=10,this.addressArray=[],this.currentNodeId="",this.currentNodeName="",this.meanType="",this.factorsPrice=e.groupCost,e.groupId&&s["c"](e.groupId).then((function(e){200===e.code&&e.result&&(t.factorList=e.result||[])}))},handleGroupClose:function(e){this.choseGroupFatcors.splice(this.choseGroupFatcors.indexOf(e),1),this.$refs.groupMultipleTable.toggleRowSelection(e,!1)},changeMeanType:function(e){var t=0;"0"===e?this.maxTotal=t=1:"1"===e?this.maxTotal=t=4:"2"===e&&(this.maxTotal=t=2),this.frequency>t&&(this.frequency=t)},addAddress:function(){var e=this;this.$nextTick((function(){e.addressArray.push({value:"",windNum:3,key:Date.now()})}))},removeAddDomain:function(e){var t=this.addressArray.indexOf(e);-1!==t&&this.addressArray.splice(t,1)},confirmGroupChoseFactor:function(){var e=this;if(!this.choseGroupFatcors||this.choseGroupFatcors.length<=0)this.$message.warning("因子不能为空");else if(!this.lookPosition||this.lookPosition.length<=0)this.$message.warning("初始检测位置不能为空");else{var t={};"002001"===this.currentNodeId&&(this.$set(t,"meanType",this.meanType),this.$set(t,"meanName",this.MEAN_STATUS[this.meanType]));var a="";"002001"!==this.currentNodeId&&"002003"!==this.currentNodeId||(a=this.currentNodeId);var r=this.choseGroupFatcors.map((function(r){var o=r.standardCode,s=r.className,n=r.standardName,i=r.secdClassId,c=r.standardNo,d=r.secdClassName,u=r.factorName,p=r.subCheckStandards,m=l["b"].v4().replaceAll("-",""),h=0;p&&p.length>0&&p.forEach((function(e){h+=e.price})),e.currentForm.groupCost<=h&&(h=e.currentForm.groupCost);var f=parseFloat(h*e.frequency*e.setDay).toFixed(2);return e.$set(r,"factorGroupKey",m),{standardCode:o,className:s,standardName:n,factorName:u,isFactor:"1",secdClassId:i,standardNo:c,secdClassName:d,frequency:e.frequency,dayCount:e.setDay,totalNum:Number(e.frequency*e.setDay).toFixed(0),costPerTime:Number(h).toFixed(2),totalCost:f,meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,factorPoint:e.lookPosition,groupClassId:""!==a?a+"/"+o:"",dynamicParam:JSON.stringify(t),subCheckStandards:p,factorGroupKey:m}}));this.addressArray&&this.addressArray.length>0&&this.addressArray.forEach((function(o){o.value&&o.value.length>0&&e.choseGroupFatcors.forEach((function(s){var l=s.standardCode,n=s.className,i=s.standardName,c=s.secdClassId,d=s.secdClassName,u=s.standardNo,p=s.factorName,m=s.costPerTime,h=s.subCheckStandards,f=s.factorGroupKey,b=parseFloat(m*e.frequency*e.setDay).toFixed(2);r.push({standardCode:l,className:n,standardName:i,isFactor:"1",factorName:p,standardNo:u,secdClassId:c,secdClassName:d,frequency:e.frequency,dayCount:e.setDay,costPerTime:m,totalNum:Number(e.frequency*e.setDay).toFixed(0),totalCost:b,factorPoint:o.value,remark:"",meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+l:"",dynamicParam:JSON.stringify(t),subCheckStandards:h,factorGroupKey:f})}))})),this.formComfig(r),this.factorGroupVisible=!1}},formComfig:function(e){this.$emit("handleConfim",e)},cancelComfig:function(){this.$emit("handleCancel",!1)}}},c=i,d=(a("74ad"),a("6a47"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"7b777032",null);t["default"]=u.exports},"119d":function(e,t,a){},1328:function(e,t,a){"use strict";a("bc7b")},1335:function(e,t,a){"use strict";a("b32e")},1353:function(e,t,a){},1381:function(e,t,a){},"13b6":function(e,t,a){"use strict";a("a34c")},1431:function(e,t,a){"use strict";a("b66d")},"145f":function(e,t,a){},"15d4":function(e,t,a){"use strict";a.d(t,"e",(function(){return o})),a.d(t,"l",(function(){return s})),a.d(t,"n",(function(){return l})),a.d(t,"p",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"o",(function(){return c})),a.d(t,"f",(function(){return d})),a.d(t,"k",(function(){return u})),a.d(t,"m",(function(){return p})),a.d(t,"r",(function(){return m})),a.d(t,"s",(function(){return h})),a.d(t,"b",(function(){return f})),a.d(t,"q",(function(){return b})),a.d(t,"c",(function(){return g})),a.d(t,"g",(function(){return v})),a.d(t,"i",(function(){return y})),a.d(t,"j",(function(){return F})),a.d(t,"d",(function(){return w}));var r=a("b775");function o(e){return Object(r["a"])({url:"/checkTask/findByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/checkTask/findHistoryByCondition",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/checkTask/getCheckFactorInfos",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/checkTask/getOfferFactorsByTaskId/".concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"/checkTask/assignmentsFactor",method:"post",data:e})}function c(){return Object(r["a"])({url:"/checkTask/getCheckUsers",method:"get"})}function d(e){return Object(r["a"])({url:"/checkFactor/findAuditCheckFactorByCondition",method:"get",params:e})}function u(e){return Object(r["a"])({url:"/checkFactor/findHistoryByCondition",method:"get",params:e})}function p(e){return Object(r["a"])({url:"/checkFactor/findSubFactorByCheckStandId/".concat(e),method:"get"})}function m(e){return Object(r["a"])({url:"/checkFactor/saveCheckFactorData",method:"post",data:e})}function h(e){return Object(r["a"])({url:"/checkFactor/submitCheckFactor",method:"get",params:e})}function f(e){return Object(r["a"])({url:"/checkFactor/auditCheckFactor",method:"post",data:e})}function b(e){return Object(r["a"])({url:"/checkFactor/sampDrawApply",method:"post",data:e})}function g(e){return Object(r["a"])({url:"/checkFactor/batchAuditCheckFactor",method:"post",data:e})}function v(e){return Object(r["a"])({url:"/checkTask/findCheckTaskByCondition",method:"get",params:e})}function y(e){return Object(r["a"])({url:"/checkTask/findCheckTaskDetailByCondition0",method:"get",params:e})}function F(e){return Object(r["a"])({url:"/checkTask/findCheckTaskDetailByCondition1",method:"get",params:e})}function w(e){return Object(r["a"])({url:"/checkFactor/batchSampDrawApply",method:"post",data:e})}},1735:function(e,t,a){},1852:function(e,t,a){"use strict";a("b196")},1899:function(e,t,a){},"18f5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"任务状态"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.checkTaskStatus,callback:function(t){e.$set(e.searchForm,"checkTaskStatus",t)},expression:"searchForm.checkTaskStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"checkTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.checkTaskStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.checkTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"scheduUser",label:"任务下发人",width:"135",align:"center"}}),a("el-table-column",{attrs:{prop:"jobRemark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.checkTaskStatus>0?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]):e._e(),"0"===t.row.checkTaskStatus?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleSchedTask(t.row)}}},[e._v(" 任务分配")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{staticStyle:{},attrs:{title:"因子详情",visible:e.detailVisible,width:"80%",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("checkSample",{attrs:{"task-id":e.checkTaskId}})],1),a("el-dialog",{attrs:{title:"任务分配",visible:e.laborTaskVisible,width:"75%",top:"2vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.laborTaskVisible=t}}},[a("el-row",{staticStyle:{height:"400px"},attrs:{gutter:10}},[a("el-col",{attrs:{span:10}},[a("el-card",{staticStyle:{height:"400px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("待分配检测因子"),a("i",{staticClass:"el-input__icon"})])]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.factorData,stripe:"",border:"","max-height":"300",size:"small","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测对象",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"fbFlag",label:"状态",align:"center",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"0"===r.fbFlag?"success":"danger"}},[e._v(e._s("0"===r.fbFlag?"自检":"分包"))])]}}])})],1)],1)],1),a("el-col",{attrs:{span:14}},[a("el-card",{staticStyle:{height:"400px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("实验室人员列表"),a("i",{staticClass:"el-input__icon"})])]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userData,stripe:"",border:"",size:"small","max-height":"380","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"empName",align:"center",label:"员工姓名"}}),a("el-table-column",{attrs:{prop:"username",align:"center",label:"员工账号"}}),a("el-table-column",{attrs:{prop:"cnt",align:"center",label:"待完成因子数"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.checkPerson(r)}}},[e._v("因子分配")])]}}])})],1)],1)],1)],1),a("el-row",{staticStyle:{"margin-top":"5px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.choseData,stripe:"",border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"empName",label:"员工姓名",align:"center"}}),a("el-table-column",{attrs:{prop:"username",label:"员工账号",align:"center"}}),a("el-table-column",{attrs:{prop:"factorNames",label:"检测因子","min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.factorNames?e._l(r.factorNames,(function(t,r){return a("el-row",{key:r,staticStyle:{width:"100%",height:"25px"}},[a("el-col",{attrs:{span:24}},[e._v("\n                  "+e._s(t.factorName)+"\n                ")])],1)})):e._e()]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,o=t.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelFactor(r,o)}}},[e._v("移除")])]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.laborTaskVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1)],1)},o=[],s=(a("7514"),a("75fc")),l=(a("ac6a"),a("15d4")),n=a("3188"),i=a("333d"),c=a("4328"),d=a.n(c),u={0:"待分配",1:"检测中"},p={components:{Pagination:i["a"],checkSample:n["default"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:u,sampleData:[],searchForm:{jobId:"",projectName:"",checkTaskStatus:"",pageNumber:1,pageSize:10},total:0,checkTaskId:"",detailVisible:!1,userData:[],laborTaskVisible:!1,currentRow:{},multipleSelection:[],factorData:[],choseData:[],loading:!1}},created:function(){this.getPersons(),this.handleSearch()},methods:{handleSearch:function(){var e=this;l["e"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},getPersons:function(){var e=this;l["o"]().then((function(t){e.userData=t.result||[]}))},handleDetail:function(e){this.checkTaskId=e.checkTaskId,this.detailVisible=!0},handleSchedTask:function(e){var t=this;this.currentRow=Object.assign({},e),this.choseData=[],this.factorData=[],l["p"](e.checkTaskId).then((function(e){200===e.code&&e.result&&(t.factorData=e.result||[]),t.laborTaskVisible=!0}))},confirmDialog:function(){var e=this;if(this.factorData.length>0)this.$message.warning("因子需要一次分配完成");else if(this.choseData&&0!==this.choseData.length){this.loading=!0;var t=this.choseData.map((function(e){var t="";return e.factorNames&&e.factorNames.forEach((function(e){""===t?t=e.jobPlanFactorId:t+=","+e.jobPlanFactorId})),{checkUser:e.userId,jobPlanFactorId:t}})),a={checkTaskId:this.currentRow.checkTaskId,params:t};l["a"](d.a.stringify({param:JSON.stringify(a)})).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.laborTaskVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"}),e.loading=!1})).finally((function(){e.loading=!1}))}else this.$message.warning("分配列表不能为空")},handleSelectionChange:function(e){this.multipleSelection=e},handleDelFactor:function(e,t){var a=Object(s["a"])(e.factorNames);this.factorData=this.factorData.concat(a),this.choseData.splice(t,1)},checkPerson:function(e){var t=this;if(this.multipleSelection&&this.multipleSelection.length>0){var a=this.choseData.find((function(t){return t.userId===e.userId}));a?a.factorNames=a.factorNames.concat(this.multipleSelection):this.choseData.push({userId:e.userId,empName:e.empName,username:e.username,factorNames:this.multipleSelection}),this.multipleSelection.forEach((function(e){var a=t.factorData.indexOf(e);t.factorData.splice(a,1)})),this.multipleSelection=[]}else this.$message.warning("至少选择一个因子")}}},m=p,h=(a("3b7f"),a("fd95"),a("49eb"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"23ec1a9f",null);t["default"]=f.exports},"1a27":function(e,t,a){"use strict";a("3107")},"1b3b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.taskData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务周期",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])},[a("template",{slot:"header"},[e._v("\n          任务周期 "),a("i",{staticClass:"el-input__icon "}),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"任务调度时录入的任务开始日期和结束日期"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1)],2),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"采样进度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.completeSampCount)+"/"+e._s(a.sampCount)+"\n        ")]}}])},[a("template",{slot:"header"},[e._v("\n          采样进度 "),a("i",{staticClass:"el-input__icon "}),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该任务已经入库的样品数/该任务所需采样的总样品数"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1)],2),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 审核样品")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("47bc"),l=a("333d"),n={0:"待分配",1:"采样中"},i={components:{Pagination:l["a"]},data:function(){return{SAMPLE_STATUS:n,taskData:[],searchForm:{jobId:"",pageNumber:1,pageSize:20},total:0}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["u"](this.searchForm).then((function(t){200===t.code&&(e.taskData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){this.$router.push("/other/masterApproveList/".concat(e.sampTaskId))}}},c=i,d=(a("9f71"),a("237f4"),a("4482"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"71ef824c",null);t["default"]=u.exports},"1c31":function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return n})),a.d(t,"h",(function(){return i})),a.d(t,"g",(function(){return c})),a.d(t,"i",(function(){return d})),a.d(t,"e",(function(){return u})),a.d(t,"k",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"f",(function(){return h}));var r=a("b775");function o(e){return Object(r["a"])({url:"/report/findReportInfosByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/report/findHisReportInfosByCondition",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/report/findReportCheckByPage",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/report/findReportSignByPage",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/report/submitReport",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/report/doAuditReport",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/report/doSignReport",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/report/genReport/".concat(e),method:"get"})}function p(e){return Object(r["a"])({url:"/report/uploadReport",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/reportBase/save",method:"post",data:e})}function h(){return Object(r["a"])({url:"/reportBase/getByOrganId",method:"get"})}},"1c6b":function(e,t,a){},"1c91":function(e,t,a){},"1db4":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wscn-http404-container"},[a("div",{staticClass:"wscn-http404"},[e._m(0),a("div",{staticClass:"bullshit"},[a("div",{staticClass:"bullshit__oops"},[e._v("OOPS!")]),e._m(1),a("div",{staticClass:"bullshit__headline"},[e._v(e._s(e.message))]),a("div",{staticClass:"bullshit__info"},[e._v("Please check that the URL you entered is correct, or click the button below to return to the homepage.")]),a("a",{staticClass:"bullshit__return-home",attrs:{href:"/"}},[e._v("Back to home")])])])])},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pic-404"},[r("img",{staticClass:"pic-404__parent",attrs:{src:a("a36b"),alt:"404"}}),r("img",{staticClass:"pic-404__child left",attrs:{src:a("26fc"),alt:"404"}}),r("img",{staticClass:"pic-404__child mid",attrs:{src:a("26fc"),alt:"404"}}),r("img",{staticClass:"pic-404__child right",attrs:{src:a("26fc"),alt:"404"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bullshit__info"},[e._v("All rights reserved\n        "),a("a",{staticStyle:{color:"#20a0ff"},attrs:{href:"https://wallstreetcn.com",target:"_blank"}},[e._v("wallstreetcn")])])}],s={name:"Page404",computed:{message:function(){return"The webmaster said that you can not enter this page..."}}},l=s,n=(a("283b"),a("2877")),i=Object(n["a"])(l,r,o,!1,null,"7c084612",null);t["default"]=i.exports},"1dfb":function(e,t,a){},"1e09":function(e,t,a){},"1f34":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4,xs:24}},[a("div",{staticClass:"head-container"},[a("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"请输入部门名称",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:e.deptName,callback:function(t){e.deptName=t},expression:"deptName"}})],1),a("div",{staticClass:"head-container"},[a("el-tree",{ref:"tree",attrs:{data:e.deptOptions,props:e.defaultProps,"expand-on-click-node":!1,"filter-node-method":e.filterNode,"default-expand-all":""},on:{"node-click":e.handleNodeClick}})],1)]),a("el-col",{attrs:{span:20,xs:24}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"员工姓名",prop:"empName"}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.empName,callback:function(t){e.$set(e.queryParams,"empName",t)},expression:"queryParams.empName"}})],1),a("el-form-item",{attrs:{label:"手机号码",prop:"phonenumber"}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.phonenumber,callback:function(t){e.$set(e.queryParams,"phonenumber",t)},expression:"queryParams.phonenumber"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l(e.statusOptions,(function(e){return a("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"small"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-upload2"},on:{click:e.handleUpload}},[e._v("批量导入")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("导出")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-refresh"},on:{click:e.handleQuery}},[e._v("刷新")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.userList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"员工工号",align:"center",prop:"empCode","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"员工姓名",align:"center",prop:"empName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"登录账号",align:"center",width:"100px",prop:"username","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"部门",align:"center",prop:"deptName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"岗位",align:"center",prop:"postNames","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"角色",align:"center",prop:"roleNames","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"手机号码",align:"center",prop:"phonenumber",width:"120"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"0"===t.row.status?"success":"danger"}},[e._v(e._s("0"===t.row.status?"正常":"停用"))])]}}])}),e.columns[6].visible?a("el-table-column",{attrs:{label:"创建日期",align:"center",prop:"createTime",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime,"{y}-{m}-{d}")))])]}}],null,!1,3484357996)}):e._e(),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return"-1"!==t.row.deptId?[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")]),"0"===t.row.status?a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("注销")]):e._e(),"1"===t.row.status?a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-success"},on:{click:function(a){return e.handleOnline(t.row)}}},[e._v("启用")]):e._e(),a("el-dropdown",{attrs:{size:"mini"},on:{command:function(a){return e.handleCommand(a,t.row)}}},[a("span",{staticClass:"el-dropdown-link",staticStyle:{"font-size":"12px"}},[a("i",{staticClass:"el-icon-d-arrow-right el-icon--right"}),e._v("更多\n              ")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"handleResetPwd",icon:"el-icon-key"}},[e._v("重置密码")])],1)],1)]:void 0}}],null,!0)})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNumber,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNumber",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)],1),a("el-dialog",{attrs:{title:e.title,visible:e.open,width:"720px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"员工工号",prop:"empCode"}},[a("el-input",{attrs:{placeholder:"请输入员工工号",maxlength:"30"},model:{value:e.form.empCode,callback:function(t){e.$set(e.form,"empCode",t)},expression:"form.empCode"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"员工姓名",prop:"empName"}},[a("el-input",{attrs:{placeholder:"请输入姓名",maxlength:"30"},model:{value:e.form.empName,callback:function(t){e.$set(e.form,"empName",t)},expression:"form.empName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"归属部门",prop:"deptId"}},[a("treeselect",{attrs:{options:e.deptOptions,"show-count":!0,placeholder:"请选择归属部门"},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"手机号码",prop:"phonenumber"}},[a("el-input",{attrs:{placeholder:"请输入手机号码",maxlength:"11"},model:{value:e.form.phonenumber,callback:function(t){e.$set(e.form,"phonenumber",t)},expression:"form.phonenumber"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"个人邮箱",prop:"email"}},[a("el-input",{attrs:{placeholder:"请输入邮箱",maxlength:"50"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"性别"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},e._l(e.sexOptions,(function(e){return a("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n              岗位\n              "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"400",trigger:"hover",content:"岗位是员工在公司里的内部职称，一个员工对应一个岗位，岗位名称可以任意命名，员工岗位与权限没有任何关联。"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getPostInfo},model:{value:e.postId,callback:function(t){e.postId=t},expression:"postId"}},e._l(e.postOptions,(function(e){return a("el-option",{key:e.postId,attrs:{label:e.postName,value:e.postId,disabled:1==e.status}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n              角色\n              "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"角色是平台内设定的统一固定称谓，一个员工可以对应多个角色，\n                也就是说可以同时拥有多个角色的权限，以解决某些员工身兼数职的问题。\n                角色名称是系统默认固定的，但是角色的数据权限和菜单权限管理员可以进行更改，\n                请根据需要谨慎更改。平台后期可能新增角色，但不会对现有角色进行修改，\n                若点击恢复默认权限，则会恢复到平台给予当前角色的默认权限。"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1),a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.form.roleIds,callback:function(t){e.$set(e.form,"roleIds",t)},expression:"form.roleIds"}},e._l(e.roleOptions,(function(e){return a("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId,disabled:1==e.status}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"isAppLogin"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n              小程序\n              "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"允许采样组长/采样员通过手机端进行现场采样录样操作，如果员工的角色含有采样组长或采样员，建议打开允许按钮"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1),a("el-switch",{attrs:{"active-text":"允许","inactive-text":"不允许","active-value":"1","inactive-value":"0"},on:{change:e.switchChange},model:{value:e.form.isAppLogin,callback:function(t){e.$set(e.form,"isAppLogin",t)},expression:"form.isAppLogin"}})],1)],1),a("el-col",{attrs:{span:12}},[1==e.form.isAppLogin?a("el-form-item",{attrs:{label:"小程序角色",prop:"appRoles"}},[a("el-select",{attrs:{multiple:"",clearable:""},model:{value:e.form.appRoles,callback:function(t){e.$set(e.form,"appRoles",t)},expression:"form.appRoles"}},e._l(e.dataAppOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e()],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"批量导入员工",visible:e.uploadVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadVisible=t}}},[a("div",{staticClass:"block"},[a("el-timeline",[a("el-timeline-item",{attrs:{size:"large"}},[a("span",{staticClass:"time-dot",attrs:{slot:"dot"},slot:"dot"},[e._v("\n            1\n          ")]),a("el-row",[a("el-col",{attrs:{span:24}},[e._v("\n              下载模板，批量填写员工信息\n            ")])],1),a("el-row",{staticStyle:{"padding-top":"10px"}},[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.downloadTem()}}},[e._v("模板下载")])],1)],1)],1),a("el-timeline-item",{attrs:{size:"large"}},[a("span",{staticClass:"time-dot",attrs:{slot:"dot"},slot:"dot"},[e._v("\n            2\n          ")]),a("el-row",[a("el-col",{attrs:{span:24}},[e._v("\n              上传填写好的员工信息表格\n            ")])],1),a("el-row",{staticStyle:{"padding-top":"10px"}},[a("el-col",{attrs:{span:24}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{width:"300px"},attrs:{action:"/api/dataImport/uploadEmployee","on-change":e.uploadChange,"file-list":e.excelFileList,accept:".xlsx,.xls",limit:1}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("您只能上传.xlsx,.xls格式的文件")])],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("span",{staticStyle:{color:"red","font-size":"13px"}},[e._v("备注：批量导入员工功能，只会将上传的员工信息列表内的员工新增到系统内，不对原有员工信息做任何替换或修改")])])],1)],1)])],1)},o=[],s=a("db72"),l=(a("ac6a"),a("c0c7")),n=a("fe05"),i=a("74b1"),c=a("3528"),d=a("ca17"),u=a.n(d),p=(a("542c"),{name:"User",components:{Treeselect:u.a},data:function(){return{loading:!1,exportLoading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,userList:null,title:"",deptOptions:void 0,open:!1,deptName:void 0,initPassword:void 0,dateRange:[],statusOptions:[{dictLabel:"正常",dictValue:"0"},{dictLabel:"停用",dictValue:"1"}],sexOptions:[{dictLabel:"男",dictValue:"0"},{dictLabel:"女",dictValue:"1"}],postOptions:[],roleOptions:[],form:{},defaultProps:{children:"children",label:"label",id:"id"},queryParams:{pageNumber:1,pageSize:10,empName:"",phonenumber:"",deptId:void 0},dataAppOptions:[{value:"1",label:"采样组长"},{value:"2",label:"采样员"}],postId:"",columns:[{key:0,label:"用户编号",visible:!0},{key:1,label:"用户名称",visible:!0},{key:2,label:"用户账号",visible:!0},{key:3,label:"部门",visible:!0},{key:4,label:"手机号码",visible:!0},{key:5,label:"状态",visible:!0},{key:6,label:"创建时间",visible:!0}],rules:{empCode:[{required:!0,message:"工号不能为空",trigger:"blur"}],empName:[{required:!0,message:"真实名称不能为空",trigger:"blur"}],email:[{type:"email",message:"'请输入正确的邮箱地址",trigger:["blur","change"]}],phonenumber:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]},excelFileList:[],uploadVisible:!1}},watch:{deptName:function(e){this.$refs.tree.filter(e)}},created:function(){this.getList(),this.getTreeselect(),this.getPostAndRoleList()},methods:{getList:function(){var e=this;this.loading=!0,Object(l["f"])(this.queryParams).then((function(t){e.userList=t.result.records,e.total=t.result.total,e.loading=!1})).catch((function(){e.loading=!1}))},getTreeselect:function(){var e=this;this.deptOptions=[],n["l"]().then((function(t){e.deptOptions=e.doProcessDept(t.result)||[]}))},doProcessDept:function(e){var t=this,a=[];return e.forEach((function(e){var r=Object(s["a"])({},e);r.children&&r.children.length>0?r.children=t.doProcessDept(r.children):r.children=void 0,a.push(r)})),a},getPostInfo:function(){this.form.postIds=[],this.form.postIds.push(this.postId)},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleNodeClick:function(e){"0"!==e.parentId?this.queryParams.deptId=e.id:this.queryParams.deptId="",this.getList()},handleStatusChange:function(e){var t=this,a="0"===e.status?"启用":"停用";this.$confirm('确认要"'+a+'""'+e.userName+'"用户吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(l["changeUserStatus"])(e.userId,e.status)})).then((function(){t.msgSuccess(a+"成功")})).catch((function(){e.status="0"===e.status?"1":"0"}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={userId:void 0,deptId:void 0,empCode:"",empName:"",phonenumber:"",email:"",sex:"",status:"0",isAppLogin:"0",appRoles:[],remark:"",postIds:[],roleIds:[]},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNumber=1,this.getList()},resetQuery:function(){this.dateRange=[],this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.userId})),this.single=1!==e.length,this.multiple=!e.length},handleCommand:function(e,t){switch(e){case"handleResetPwd":this.handleResetPwd(t);break;case"handleAuthRole":this.handleAuthRole(t);break;default:break}},handleAdd:function(){this.reset(),this.open=!0,this.title="添加员工信息"},getPostAndRoleList:function(){var e=this;Object(i["e"])().then((function(t){e.postOptions=t.result||[]})),Object(c["j"])().then((function(t){e.roleOptions=t.result||[]}))},handleUpdate:function(e){var t=this;this.reset(),this.getTreeselect();var a=e.userId;Object(l["d"])(a).then((function(e){t.form=e.result.user,t.postId=e.result.checkedPostIds&&e.result.checkedPostIds.length>0?e.result.checkedPostIds[0]:"",t.$set(t.form,"postIds",e.result.checkedPostIds),t.$set(t.form,"roleIds",e.result.checkedRoleIds),t.$set(t.form,"appRoles",e.result.appRoles),t.$delete(t.form,"loginIp"),t.$delete(t.form,"organId"),t.$delete(t.form,"password"),t.$delete(t.form,"createTime"),t.$delete(t.form,"avatarPath"),t.$delete(t.form,"userType"),t.open=!0,t.title="修改员工信息"}))},handleResetPwd:function(e){var t=this;this.$confirm('是否确认重置用户为"'+e.empName+'"的密码?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(a){a.value;Object(l["h"])(e.userId).then((function(e){t.msgSuccess("重置成功")}))})).catch((function(){}))},handleAuthRole:function(e){var t=e.userId;this.$router.push("/auth/role/"+t)},submitForm:function(){var e=this;"1"!==this.form.isAppLogin||0!==this.form.appRoles.length?this.$refs["form"].validate((function(t){t&&(void 0!==e.form.userId?Object(l["i"])(e.form).then((function(t){e.msgSuccess("修改成功"),e.open=!1,e.getList()})):Object(l["a"])(e.form).then((function(t){e.msgSuccess("新增成功"),e.open=!1,e.getList()})))})):this.msgErrot("小程序角色不能为空")},handleDelete:function(e){var t=this,a=e.userId;this.$confirm('是否确认注销用户为"'+e.empName+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(l["e"])(a)})).then((function(){t.getList(),t.msgSuccess("注销成功")})).catch((function(){}))},handleOnline:function(e){var t=this,a=e.userId;this.$confirm("是否确认启用该账号","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(l["g"])(a)})).then((function(){t.getList(),t.msgSuccess("注销成功")})).catch((function(){}))},switchChange:function(){"0"===this.form.isAppLogin&&(this.form.appRoles=[])},handleDownload:function(){var e=this.$store.getters.sysBaseUrl+"/api/dataImport/exportEmployee";window.open(e)},downloadTem:function(){var e=this.$store.getters.sysBaseUrl+"/api/dataImport/downloadEmployeeExcel";window.open(e)},uploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.fileResult=e.response.result,this.$message({type:"success",message:e.response.message}),this.handleQuery(),this.uploadVisible=!1):(this.$message.error("上传失败!"),this.excelFileList=[])}else this.$message.error("上传失败!"),this.excelFileList=[]},handleUpload:function(){this.uploadVisible=!0,this.excelFileList=[]}}}),m=p,h=(a("ca83"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"5d2610ce",null);t["default"]=f.exports},"1f44":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无样品审核历史信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.sampTaskStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.sampTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handlePrint(t.row)}}},[e._v(" 标签打印")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.taskTitle+" 任务详情",visible:e.taskVisible,center:"",width:"70%",top:"5vh"},on:{"update:visible":function(t){e.taskVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("合同编号: "+e._s(e.taskForm.contCode))])]),a("el-col",{attrs:{span:12}},[a("span",[e._v("报价单号: "+e._s(e.taskForm.offerId))])])],1),a("table",{staticClass:"info-table-new",attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("项目名称:")]),a("td",[e._v(e._s(e.taskForm.projectName))]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托单位:")]),a("td",[e._v(e._s(e.taskForm.consignorName))])]),a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人:")]),a("td",[e._v(e._s(e.taskForm.consignorLinker)+" ")]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人方式:")]),a("td",[e._v(e._s(e.taskForm.consignorLinkerPhone))])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},[e._v("\n          工作要求:\n        ")])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},e._l(e.factorData,(function(t,r){return a("el-row",{key:r},[a("el-col",{attrs:{span:24}},[e._v(e._s(t.secdClassName))]),e._l(t.factList,(function(t){return a("el-col",{key:t.id,attrs:{span:24}},[e._v("\n              "+e._s(t.factorPoint+"（"+t.dayCount+"*"+t.frequency+"）: ")+e._s(t.showFactName)+"\n            ")])}))],2)})),1)])])],1)],1)},o=[],s=(a("7514"),a("ac6a"),a("5df3"),a("f400"),a("47bc")),l=a("333d"),n={0:"待分配",1:"采样中",2:"已完成"},i={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:n,sampleData:[],searchForm:{jobId:"",projectName:"",sampTaskStatus:"0",pageNumber:1,pageSize:50},total:0,taskTitle:"",taskVisible:!1,factorData:[],factorDetailData:[],factorOldDetailData:[],taskForm:{projectName:"",offerId:"",contCode:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:""},sampleTaskVisible:!1,currentRow:{},multipleSelection:[],mergeData:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["p"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.taskTitle=e.projectName,this.taskForm=Object.assign({},e),s["x"](e.sampTaskId).then((function(e){200===e.code&&e.result&&(t.factorData=t.doProcessData(e.result),t.taskVisible=!0)}))},doProcessData:function(e){var t=this,a=[];if(e.length>0){var r=new Map;e.forEach((function(e){var t=a.find((function(t){return t.secdClassName===e.secdClassName}));if(t||a.push({secdClassName:e.secdClassName,factList:[]}),r.get(e.secdClassName)){var o=r.get(e.secdClassName);o.push(e)}else{var s=[];s.push(e),r.set(e.secdClassName,s)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName),o=[];a&&(a.forEach((function(e){var a=o.find((function(t){return t.factorPoint===e.factorPoint&&t.frequency===e.frequency&&t.dayCount===e.dayCount?(t.showFactName=t.showFactName+","+e.factorName,t):null}));a||(t.$set(e,"showFactName",e.factorName),o.push(e))})),e.factList=o)}))}return a},handlePrint:function(e){this.$router.push("/sampleDetail/".concat(e.sampTaskId))}}},c=i,d=(a("fc70"),a("5337"),a("9603"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"156f0619",null);t["default"]=u.exports},"1feb":function(e,t,a){"use strict";a("c82d")},2017:function(e,t,a){"use strict";a("d8d0")},2029:function(e,t,a){},"206a9":function(e,t,a){},2112:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"reportMakeTime",label:"生成时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),r.reportStatus>1?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.reportStatus>1?a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1):e._e(),r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1):e._e()],1)],1):e._e()]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("db72"),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u={1:"未生成",2:"制作中",3:"待提交审批",4:"待审核",5:"待签发",6:"完成",7:"已驳回"},p={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{REPORT_STATUS:u,searchForm:{jobId:"",projectName:"",pageNumber:1,pageSize:10},total:0,reportData:[],hideLogoUploadEdit:!1,hideUploadEdit:!1,downloadLoading:!1}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["a"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleAddReport:function(e){var t=this;this.downloadLoading=!0,n["e"](e.reportCode).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"}),t.downloadLoading=!1})).catch((function(){t.downloadLoading=!1}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)}}},m=p,h=(a("5544"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"edb3ea38",null);t["default"]=f.exports},"22d12":function(e,t,a){},"231c":function(e,t,a){},2335:function(e,t,a){"use strict";a("efb0")},"237f4":function(e,t,a){"use strict";a("0b5a")},24249:function(e,t,a){"use strict";a("6292")},"24be":function(e,t,a){"use strict";a("a8ca")},"24e2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"errPage-container"},[a("el-button",{staticClass:"pan-back-btn",attrs:{icon:"el-icon-arrow-left"},on:{click:e.back}},[e._v("\n    返回\n  ")]),a("el-row",[a("el-col",{attrs:{span:12}},[a("h1",{staticClass:"text-jumbo text-ginormous"},[e._v("\n        Oops!\n      ")]),e._v("\n      gif来源"),a("a",{attrs:{href:"https://zh.airbnb.com/",target:"_blank"}},[e._v("airbnb")]),e._v(" 页面\n      "),a("h2",[e._v("你没有权限去该页面")]),a("h6",[e._v("如有不满请联系你领导")]),a("ul",{staticClass:"list-unstyled"},[a("li",[e._v("或者你可以去:")]),a("li",{staticClass:"link-type"},[a("router-link",{attrs:{to:"/dashboard"}},[e._v("\n            回首页\n          ")])],1),a("li",{staticClass:"link-type"},[a("a",{attrs:{href:"https://www.taobao.com/"}},[e._v("随便看看")])]),a("li",[a("a",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.dialogVisible=!0}}},[e._v("点我看图")])])])]),a("el-col",{attrs:{span:12}},[a("img",{attrs:{src:e.errGif,width:"313",height:"428",alt:"Girl has dropped her ice cream."}})])],1),a("el-dialog",{attrs:{visible:e.dialogVisible,title:"随便看"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{staticClass:"pan-img",attrs:{src:e.ewizardClap}})])],1)},o=[],s=a("cc6c"),l=a.n(s),n={name:"Page401",data:function(){return{errGif:l.a+"?"+ +new Date,ewizardClap:"https://wpimg.wallstcn.com/007ef517-bafd-4066-aae4-6883632d9646",dialogVisible:!1}},methods:{back:function(){this.$route.query.noGoBack?this.$router.push({path:"/dashboard"}):this.$router.go(-1)}}},i=n,c=(a("1a27"),a("2877")),d=Object(c["a"])(i,r,o,!1,null,"35ca77fc",null);t["default"]=d.exports},"26fc":function(e,t,a){e.exports=a.p+"static/img/404_cloud.0f4bc32b.png"},2740:function(e,t,a){},2745:function(e,t,a){"use strict";a("e1db")},"283b":function(e,t,a){"use strict";a("9b98")},"2b1d":function(e,t,a){"use strict";a("119d")},"2bb1":function(e,t,a){"use strict";a("1353")},"2d16":function(e,t,a){},"2d85":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待录入因子列表",name:"2"}},[a("laborList",{attrs:{"check-task-id":e.checkTaskId}})],1),a("el-tab-pane",{attrs:{label:"已录入因子列表",name:"3"}},[a("hisLaborList",{attrs:{"check-task-id":e.checkTaskId}})],1)],1)],1)},o=[],s=a("fdde"),l=a("487f"),n={components:{laborList:s["default"],hisLaborList:l["default"]},data:function(){return{activeName:"2",checkTaskId:""}},created:function(){this.$route.params.checkTaskId&&(this.checkTaskId=this.$route.params.checkTaskId)},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},"2dde":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.user,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"员工姓名",prop:"nickName"}},[a("el-input",{attrs:{maxlength:"30",disabled:""},model:{value:e.user.empName,callback:function(t){e.$set(e.user,"empName",t)},expression:"user.empName"}})],1),a("el-form-item",{attrs:{label:"手机号码",prop:"phonenumber"}},[a("el-input",{attrs:{maxlength:"11"},model:{value:e.user.phonenumber,callback:function(t){e.$set(e.user,"phonenumber",t)},expression:"user.phonenumber"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submit}},[e._v("保存")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.close}},[e._v("关闭")])],1)],1)},o=[],s=a("c0c7"),l={props:{user:{type:Object},oldPhone:{type:String,default:""}},data:function(){return{rules:{empName:[{required:!0,message:"用户姓名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱地址不能为空",trigger:"blur"},{type:"email",message:"'请输入正确的邮箱地址",trigger:["blur","change"]}],phonenumber:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}},methods:{submit:function(){var e=this;this.user.oldPhone!==this.user.phonenumber?this.$refs["form"].validate((function(t){if(t){var a={userId:e.user.userId,empName:e.user.empName,phone:e.user.phonenumber};Object(s["c"])(a).then((function(t){e.msgSuccess("修改成功")}))}})):this.msgSuccess("信息没有改变!")},close:function(){this.$router.push({path:"/"})}}},n=l,i=a("2877"),c=Object(i["a"])(n,r,o,!1,null,null,null);t["default"]=c.exports},"2f1c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待审核报告",name:"1"}},[a("reportTask")],1),a("el-tab-pane",{attrs:{label:"已审核报告",name:"2"}},[a("hisReportTask")],1)],1)],1)},o=[],s=a("6890"),l=a("2112"),n={components:{reportTask:s["default"],hisReportTask:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},"2f56":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.offerId,callback:function(t){e.$set(e.searchForm,"offerId",t)},expression:"searchForm.offerId"}})],1),a("el-form-item",{attrs:{label:"评审状态:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"评审状态"},model:{value:e.searchForm.recordStatus,callback:function(t){e.$set(e.searchForm,"recordStatus",t)},expression:"searchForm.recordStatus"}},e._l(Object.keys(e.APPROVE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.APPROVE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.orderData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",fixed:"left","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"certificationType",label:"认证类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.certificationType?"CMA":"CNAS")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"consignorName",label:"客户名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{label:"评审状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.judgeRecordStatus)}},[e._v("\n            "+e._s(e.APPROVE_STATUS[r.judgeRecordStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"finishDate",label:"完成时间",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"checkTaskCount",label:"任务数",align:"center"}}),a("el-table-column",{attrs:{prop:"checkCircle",label:"周期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e.CHECK_STATUS[a.checkCircle])+"\n        ")]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]),"0"===r.judgeRecordStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"0"===r.judgeRecordStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r)}}},[e._v(" 合同评审")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报价单("+e.orderDetailForm.offerId+")",visible:e.detailVisible,top:"5vh",width:"70%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"135px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户名称:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorName||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系人:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinker||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinkerPhone||""))])],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户要求完成时间:"}},[e._v(e._s(e._f("Time2Format")(e.orderDetailForm.offerBaseVo.finishDate)))])],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.remark||""))])],1)],1)],1),e._l(e.orderDetailPlans,(function(t,r){return a("div",{key:r},[a("el-divider",[e._v("计划"+e._s(r+1)+"因子列表")]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0"}},[a("thead",[a("tr",[a("th",{attrs:{rowspan:"2"}},[e._v("序号")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测类别")]),a("th",{attrs:{colspan:"3"}},[e._v("检测项目")]),a("th",{attrs:{rowspan:"2"}},[e._v("频次(次/天)")]),a("th",{attrs:{rowspan:"2"}},[e._v("天数")]),a("th",{attrs:{rowspan:"2"}},[e._v("监测频次")]),a("th",{attrs:{rowspan:"2"}},[e._v("执行次数")]),a("th",{attrs:{rowspan:"2"}},[e._v("总数")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测单价(元)")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测费(元)")])]),a("tr",[a("th",[e._v("序号")]),a("th",[e._v("检测位置")]),a("th",[e._v("因子")])])]),a("tbody",[e._l(t.factorTdos,(function(r,o){return a("tr",{key:o},[0==r.frIndex?[a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.id))]),a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.secName))])]:e._e(),a("td",[e._v(e._s(r.sid))]),a("td",[e._v(e._s(r.factorPoint))]),a("td",[e._v(e._s(r.factorName)+e._s(r.meanName&&r.meanName.length>0?"("+r.meanName+")":""))]),a("td",[e._v(e._s(r.frequency))]),a("td",[e._v(e._s(r.dayCount))]),0==o?[a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.checkFreq))]),a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.execTimes))])]:e._e(),a("td",[e._v(e._s(Number(r.frequency*r.dayCount*t.execTimes).toFixed(0)))]),a("td",[e._v(e._s(r.costPerTime))]),a("td",[e._v(e._s(parseFloat(r.costPerTime*r.frequency*r.dayCount*t.execTimes).toFixed(2)))])],2)})),a("tr",[a("td",{attrs:{colspan:"11"}},[e._v("检测费合计")]),a("td",[e._v(e._s(parseFloat(t.checkFee*t.execTimes).toFixed(2)))])])],2)])])],1)})),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0  "}},[a("tbody",[a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("检测费合计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.checkAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告编制费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.reportAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告加急费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.expediteAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("采样费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.laborAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("差旅费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.tripAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("税额")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.taxAmount)))])]),e.orderDetailForm.selfCostVos?e._l(e.orderDetailForm.selfCostVos,(function(t,r){return a("tr",{key:r},[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(t.selfName))]),a("td",[e._v(e._s(e._f("MoneyFormat")(t.amount)))])])})):e._e(),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("总计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.sysAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("优惠价")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.draftAmount)))])]),a("tr",[a("td",{staticStyle:{width:"20%"}},[e._v("大写：")]),a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(e._f("Money2Chinese")(e.orderDetailForm.costVo.draftAmount)))])])],2)])])],2),a("el-dialog",{attrs:{title:"评审判定",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("不通过")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50",placeholder:"审核意见"},model:{value:e.approveForm.remark,callback:function(t){e.$set(e.approveForm,"remark",t)},expression:"approveForm.remark"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=(a("7514"),a("5df3"),a("f400"),a("75fc")),l=(a("ac6a"),a("e601")),n=a("e24a"),i=a("333d"),c={0:"待判定",1:"需要评审",2:"不需要评审",3:"报价单作废",4:"部门经理审核",5:"技术负责人审核",6:"评审通过"},d={0:"等待处理",1:"通过",2:"不通过"},u={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},p={name:"TechContList",components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},data:function(){return{TASK_STATUS:c,APPROVE_STATUS:d,CHECK_STATUS:u,orderData:[],searchForm:{offerId:"",projectName:"",recordStatus:"",pageNumber:1,pageSize:10},total:0,detailVisible:!1,orderDetailForm:{offerId:"",offerBaseVo:{consignorName:"",consignorLinker:"",consignorLinkerPhone:"",createUserName:"",finishDate:"",remark:"",checkCircle:"",checkTaskCount:""},factorTdos:[],costVo:{},oncePrice:"",selfCostVos:[]},orderDetailPlans:[],approveVisible:!1,approveForm:{judgeRecordId:"",auditFlag:"0",remark:""}}},created:function(){this.handleSearch()},methods:{handleDetail:function(e){var t=this;l["f"](e.offerId).then((function(e){if(200===e.code){var a=[];t.orderDetailForm.offerId=e.result.offerId||"",t.orderDetailForm.offerBaseVo=e.result.offerBaseVo||{},t.orderDetailForm.costVo=e.result.costVo||{},t.orderDetailForm.selfCostVos=e.result.selfCostVos||[],t.orderDetailForm.offerPlanVos=a=e.result.offerPlanVos.map((function(e){return e.planFactorVoList&&e.planFactorVoList.length>0&&(e.planFactorVoList.forEach((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}})),t.$set(e,"oldPlanFactors",e.planFactorVoList)),e}))||[],t.orderDetailPlans=t.doProcessOrder(a)||[],t.detailVisible=!0}}))},handleSearch:function(){var e=this;n["f"](this.searchForm).then((function(t){200===t.code&&(e.orderData=t.result.records||[],e.total=t.result.total)}))},doProcessOrder:function(e){var t=this;if(e&&e.length>0){var a=Object(s["a"])(e);return a.forEach((function(e){var a=t.doProcessDate(e.planFactorVoList);t.$set(e,"factorTdos",a)})),a}},doProcessDate:function(e){var t=this;if(e&&e.length>0){var a=[],r=new Map,o=[],s=1;return e.forEach((function(e,t){var o=a.find((function(t){return t.secdClassName===e.secdClassName}));if(o||(a.push({id:s,secdClassName:e.secdClassName,totalPrice:0,detailLength:0}),s++),r.get(e.secdClassName)){var l=r.get(e.secdClassName);l.push(e)}else{var n=[];n.push(e),r.set(e.secdClassName,n)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName);a&&a.length>0&&a.forEach((function(r,s){var l=o.find((function(e){return e.secName===r.secdClassName}));l?t.$set(r,"frIndex",1):t.$set(r,"frIndex",0),t.$set(r,"id",e.id),t.$set(r,"sid",e.id+"."+(s+1)),t.$set(r,"secName",e.secdClassName),t.$set(r,"detailLength",a.length),t.$set(r,"dateType",0),o.push(r)}))})),o}return[]},countTotal:function(e,t){var a=0;return a=e.reduce((function(e,a,r,o){return a[t]?e+a[t]:e}),0),a},handleApprove:function(e){this.approveForm.judgeRecordId=e.judgeRecordId,this.approveForm.auditFlag="1",this.approveForm.remark="",this.approveVisible=!0},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["c"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},m=p,h=(a("f2c5"),a("fedf"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"ef9aabb8",null);t["default"]=f.exports},"2f98":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:7}},[a("el-card",{staticClass:"card-left",attrs:{shadow:"never"}},[a("el-input",{attrs:{placeholder:"输入名称"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.deptTreeData,props:e.defaultProps,"highlight-current":"","default-expand-all":"","filter-node-method":e.filterNode,"expand-on-click-node":!1},on:{"node-click":e.onSelectDepart},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,o=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(r.label))]),a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.appendDepart(o)}}},[e._v("\n                添加\n              ")]),"-1001"!==o.id?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.updateDepart(o)}}},[e._v("\n                修改\n              ")]):e._e(),"-1001"!==o.id?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.removeDepart(r,o)}}},[e._v("\n                删除\n              ")]):e._e()],1)])}}])})],1)],1),a("el-col",{attrs:{span:17}},[a("el-card",{staticClass:"card-right",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("当前部门: "),a("i",{staticClass:"el-input__icon"})]),e._v(e._s(e.currentDeptName)+"\n          "),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")]),e.currentDeptId&&"-1001"!==e.currentDeptId&&e.currentDeptId.length>0?a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handlePostCreate}},[e._v("新增岗位")]):e._e()],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.departData,border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                    暂无部门\n                  ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"positionName",label:"岗位名称",align:"center"}}),a("el-table-column",{attrs:{prop:"platformPositionVal",label:"系统角色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",[e._v(e._s(r.platformPositionVal))])]}}])}),a("el-table-column",{attrs:{prop:"positionDesc",label:"岗位描述",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",width:"140px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handlePostUpdate(t.row)}}},[e._v("编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],2)],1)])],1)],1),a("el-dialog",{attrs:{title:e.titleMap[e.deptDialogStatus],visible:e.departVisible,center:""},on:{"update:visible":function(t){e.departVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{ref:"departForm",attrs:{model:e.departForm,rules:e.departRules,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"deptName",label:"部门名称:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请录入部门名称",maxlength:"15","show-word-limit":""},model:{value:e.departForm.deptName,callback:function(t){e.$set(e.departForm,"deptName",t)},expression:"departForm.deptName"}})],1),a("el-form-item",{attrs:{prop:"platformDeptId",label:"部门职能:"}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"业务流转权限关联"},model:{value:e.departForm.platformDeptId,callback:function(t){e.$set(e.departForm,"platformDeptId",t)},expression:"departForm.platformDeptId"}},e._l(Object.keys(e.plDeptmentArray),(function(t){return a("el-option",{key:t,attrs:{label:e.plDeptmentArray[t],value:t}})})),1)],1),a("el-form-item",{attrs:{label:"部门描述:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",rows:4,maxlength:"50","show-word-limit":"",placeholder:"请录入部门描述"},model:{value:e.departForm.deptDesc,callback:function(t){e.$set(e.departForm,"deptDesc",t)},expression:"departForm.deptDesc"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.departVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDepart}},[e._v("保存")])],1)]),a("el-dialog",{attrs:{title:e.postTitleMap[e.postDialogStatus],visible:e.postVisible,center:""},on:{"update:visible":function(t){e.postVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{ref:"postForm",attrs:{model:e.postForm,rules:e.postRules,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"positionName",label:"岗位名称:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请录入岗位名称",maxlength:"15","show-word-limit":""},model:{value:e.postForm.positionName,callback:function(t){e.$set(e.postForm,"positionName",t)},expression:"postForm.positionName"}})],1),a("el-form-item",{attrs:{prop:"platformDeptId",label:"关联系统角色:"}},[a("el-select",{staticStyle:{width:"90%"},attrs:{filterable:"",placeholder:"关联系统角色"},model:{value:e.postForm.platformPositionId,callback:function(t){e.$set(e.postForm,"platformPositionId",t)},expression:"postForm.platformPositionId"}},e._l(Object.keys(e.postionArray),(function(t){return a("el-option",{key:t,attrs:{label:e.postionArray[t],value:t}})})),1)],1),a("el-form-item",{attrs:{label:"岗位描述:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",rows:4,maxlength:"50","show-word-limit":"",placeholder:"请录入岗位描述"},model:{value:e.postForm.positionDesc,callback:function(t){e.$set(e.postForm,"positionDesc",t)},expression:"postForm.positionDesc"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.postVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmPost}},[e._v("保存")])],1)])],1)},o=[],s=a("db72"),l=a("fe05"),n=a("b775");function i(e){return Object(n["a"])({url:"/sys/position/listByDeptId/".concat(e),method:"get"})}function c(e){return Object(n["a"])({url:"/sys/position/add",method:"post",data:e})}function d(e){return Object(n["a"])({url:"/sys/position/modify",method:"post",data:e})}var u=a("b705"),p={name:"DeptList",data:function(){return{deptTreeData:[],defaultProps:{children:"children",label:"deptName",id:"id"},titleMap:{edit:"修改部门",create:"新增部门"},postTitleMap:{edit:"修改岗位",create:"新增岗位"},deptDialogStatus:"create",postDialogStatus:"create",currentDeptId:"",currentDeptName:"",departData:[],filterText:"",departVisible:!1,departForm:{parentDeptId:"",platformDeptId:"",deptId:"",deptName:"",deptDesc:""},departRules:{deptName:[{required:!0,message:"部门名称",trigger:"blur"}],platformDeptId:[{required:!0,message:"请选择平台流转权限",trigger:"change"}]},currentTreeItem:{},departName:"",roleListArray:[],currentNode:{},currentResolve:{},plDeptmentArray:[],postVisible:!1,postForm:{positionId:"",platformPositionId:"",deptId:"",positionName:"",positionDesc:""},postionArray:{},currentPlatformDeptId:"",postRules:{positionName:[{required:!0,message:"请录入岗位名称",trigger:"blur"}],platformPositionId:[{required:!0,message:"请选择系统角色",trigger:"change"}]}}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},created:function(){this.getDicKey("plDeptmentArray",1001),this.getDeptTreeList()},methods:{getDicKey:function(e,t){var a=this;Object(u["g"])(t).then((function(t){200===t.code&&(a[e]=t.result)}))},getDeptTreeList:function(){var e=this;this.deptTreeData=[],l["getDeptTreeList"]().then((function(t){var a=t.result||{};e.deptTreeData.push(a)}))},getPlDepartList:function(){},filterNode:function(e,t){return!e||-1!==t.deptName.indexOf(e)},loadNode:function(e,t){var a=this;this.currentNode=e,this.currentResolve=t;var r=e.data;if(this.currentDeptId=r.id,this.currentDeptName=r.deptName,0===e.level)return t([{id:-1001,deptName:this.$store.getters.userInfo.organName||"当前机构",children:[]}]);this.currentDeptId?(this.departData=[],l["findTopDeptListByParentId"](this.currentDeptId).then((function(e){200===e.code&&e.result?(a.departData=e.result.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{parentName:a.currentDeptName})}))||[],t(e.result)):t([])})).catch((function(){t([])}))):t([])},onSelectDepart:function(e){var t=this;e.id!==this.currentDeptId&&(this.currentPlatformDeptId=e.platformDeptId,this.currentDeptId=e.id,this.currentDeptName=e.deptName,this.$nextTick((function(){t.handleSearch()})))},confirmDepart:function(){var e=this;this.$refs.departForm.validate((function(t){if(t)if("create"===e.deptDialogStatus){var a={parentDeptId:e.departForm.parentDeptId,platformDeptId:e.departForm.platformDeptId,deptName:e.departForm.deptName,deptDesc:e.departForm.deptDesc};l["createDeptInfo"](a).then((function(t){200===t.code&&(e.handleSearch(),e.getDeptTreeList(),e.departVisible=!1)}))}else{var r={deptId:e.departForm.deptId,platformDeptId:e.departForm.platformDeptId,deptName:e.departForm.deptName,deptDesc:e.departForm.deptDesc};l["updateDeptInfo"](r).then((function(t){200===t.code&&(e.handleSearch(),e.getDeptTreeList(),e.departVisible=!1)}))}}))},confirmPost:function(){var e=this;this.$refs.postForm.validate((function(t){t&&("create"===e.postDialogStatus?c(e.postForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.postVisible=!1})):d(e.postForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.postVisible=!1})))})).catch((function(){}))},handleSearch:function(){var e=this;this.currentDeptId&&(this.departData=[],i(this.currentDeptId).then((function(t){200===t.code&&t.result&&(e.departData=t.result.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{parentName:e.currentDeptName})}))||[])})).catch((function(){})))},handlePostCreate:function(){var e=this;this.clearForm(),this.postionArray={},this.postForm.deptId=this.currentDeptId,this.currentPlatformDeptId&&l["dpfindPositionIdByDeptId"](this.currentPlatformDeptId).then((function(t){e.$nextTick((function(){e.postionArray=t.result||{}}))})),this.postDialogStatus="create",this.postVisible=!0},handlePostUpdate:function(e){var t=this;this.clearForm(),this.postionArray={},this.postForm.positionId=e.positionId,this.postForm.platformPositionId=e.platformPositionId,this.postForm.deptId=e.deptId,this.postForm.positionName=e.positionName,this.postForm.positionDesc=e.positionDesc,this.currentPlatformDeptId&&l["dpfindPositionIdByDeptId"](this.currentPlatformDeptId).then((function(e){t.$nextTick((function(){t.postionArray=e.result||{}}))})),this.postDialogStatus="edit",this.postVisible=!0},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["delDeptById"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch(),t.getDeptTreeList()):t.$notify({title:"失败",message:e.message,type:"error"})}))}))},appendDepart:function(e){this.clearForm(),this.departForm.parentDeptId=e.id,this.departForm.platformDeptId=e.platformDeptId,this.deptDialogStatus="create",this.departVisible=!0},updateDepart:function(e){this.clearForm(),this.departForm=e,this.deptDialogStatus="edit",this.departVisible=!0},removeDepart:function(e,t){var a=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["delDeptById"](t.id).then((function(e){200===e.code&&(a.getDeptTreeList(),a.currentDeptId="",a.positionData=[])}))}))},clearForm:function(){this.departForm={parentDeptId:"",platformDeptId:"",deptId:"",deptName:"",deptDesc:""},this.postForm={positionId:"",platformPositionId:"",deptId:"",positionName:"",positionDesc:""}}}},m=p,h=(a("7d05"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"45db0d11",null);t["default"]=f.exports},3107:function(e,t,a){},3188:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.smapleNo,callback:function(t){e.$set(e.searchForm,"smapleNo",t)},expression:"searchForm.smapleNo"}})],1),a("el-form-item",{attrs:{label:"因子名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"因子名称"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",{attrs:{label:"检测状态:"}},[a("el-select",{attrs:{clearable:"",placeholder:"检测状态"},model:{value:e.searchForm.checkStatus,callback:function(t){e.$set(e.searchForm,"checkStatus",t)},expression:"searchForm.checkStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.sampleTaskData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检验标准","min-width":"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"assignUser",label:"分析员",align:"center"}}),a("el-table-column",{attrs:{prop:"checkStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.checkStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.checkStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"checkRes",label:"总计值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkRes&&r.checkRes.length>0?[e._v("\n            "+e._s(r.masterRes)),r.exponRes>0?[e._v("×10"),a("sup",[e._v(e._s(r.exponRes))])]:e._e()]:void 0]}}])})],2)],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)},o=[],s=a("15d4"),l=a("333d"),n={0:"待领样",1:"领样申请",2:"待检测",3:"已录入",4:"待审核",5:"审核通过",6:"审核失败"},i={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"2"===e?"info":"1"===e||"3"===e?"":"4"===e?"warning":"5"===e?"success":"danger"}},props:{taskId:{type:String,default:""}},data:function(){return{SAMPLE_STATUS:n,sampleTaskData:[],searchForm:{smapItemId:"",factorName:"",checkStatus:"",pageNumber:1,pageSize:10},total:0}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;this.searchForm.checkTaskId=this.taskId,s["n"](this.searchForm).then((function(t){200===t.code&&(e.sampleTaskData=t.result.records.map((function(t){if(t.checkRes&&""!==t.checkRes){var a=JSON.parse(t.checkRes);e.$set(t,"masterRes",a.v1?a.v1:0),e.$set(t,"exponRes",a.v2?a.v2:0)}else e.$set(t,"masterRes",0),e.$set(t,"exponRes",0);return t}))||[],e.total=t.result.total)}))}}},c=i,d=(a("b218"),a("72ed"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"0af381f9",null);t["default"]=u.exports},3204:function(e,t,a){"use strict";a("1dfb")},3403:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampleNo,callback:function(t){e.$set(e.searchForm,"sampleNo",t)},expression:"searchForm.sampleNo"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleBatchApprove}},[e._v("批量确认")]),a("el-button",{attrs:{type:""},on:{click:e.goBack}},[e._v("返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"140",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样人",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"finishTime",label:"样品登记时间",width:"190px",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApprove(t.row)}}},[e._v("确认")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:e.showTitle,visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"确认结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:e.showTitle,visible:e.batchApproveVisible,center:""},on:{"update:visible":function(t){e.batchApproveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.batchApprove,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"确认结果:"}},[a("el-radio-group",{model:{value:e.batchApprove.auditFlag,callback:function(t){e.$set(e.batchApprove,"auditFlag",t)},expression:"batchApprove.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.batchApprove.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.batchApprove.auditReason,callback:function(t){e.$set(e.batchApprove,"auditReason",t)},expression:"batchApprove.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.batchApproveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.batchConfirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=(a("6b54"),a("47bc")),l=a("d43b"),n=a("333d"),i={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过"},c={name:"MasterApprove",components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},props:{sampTaskId:{type:String,default:""}},data:function(){return{ACCOUNT_STATUS:i,sampleData:[],searchForm:{jobId:"",sampTaskId:"",sampleNo:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",approveForm:{sampItemId:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],showTitle:"",sampleDetails:[],multipleSelection:[],batchApproveVisible:!1,batchApprove:{sampItemId:"",auditFlag:"1",auditReason:""},sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.searchForm.sampTaskId=this.sampTaskId,this.handleSearch()},methods:{handleSearch:function(){var e=this;""!==this.sampTaskId&&s["i"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";l["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleApprove:function(e){this.approveForm.sampItemId=e.sampItemId,this.approveForm.auditFlag="1",this.approveForm.auditReason="",this.showTitle="样品确认",this.approveVisible=!0},handleBatchApprove:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var e=this.multipleSelection.map((function(e){return e.sampItemId}));this.batchApprove.sampItemId=e.toString(),this.batchApprove.auditFlag="1",this.batchApprove.auditReason="",this.showTitle="样品确认",this.batchApproveVisible=!0}else this.$message.warning("至少选择一个任务进行信息确认")},handleSelectionChange:function(e){this.multipleSelection=e},batchConfirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["b"](e.batchApprove).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.batchApproveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["g"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},goBack:function(){this.$router.back()}}},d=c,u=(a("8497"),a("c736"),a("bb0a"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"19c33e81",null);t["default"]=p.exports},"341a":function(e,t,a){"use strict";a("e5a6")},3437:function(e,t,a){"use strict";a("231c")},"34b0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待审核报告",name:"1"}},[a("signTask")],1),a("el-tab-pane",{attrs:{label:"已审核报告",name:"2"}},[a("hisSignTask")],1)],1)],1)},o=[],s=a("9d50"),l=a("0812"),n={components:{signTask:s["default"],hisSignTask:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},3528:function(e,t,a){"use strict";a.d(t,"l",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"k",(function(){return l})),a.d(t,"a",(function(){return n})),a.d(t,"n",(function(){return i})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return d})),a.d(t,"f",(function(){return u})),a.d(t,"i",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"m",(function(){return h})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"e",(function(){return g}));var r=a("b775");function o(e){return Object(r["a"])({url:"/role/findRolesByCondition",method:"get",params:e})}function s(){return Object(r["a"])({url:"/role/selectRoleAll",method:"get"})}function l(e){return Object(r["a"])({url:"/role/findRoleByRoleId/"+e,method:"get"})}function n(e){return Object(r["a"])({url:"/role/insertRole",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/role/updateRole",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/role/delByRoleId/"+e,method:"get"})}function d(e){return Object(r["a"])({url:"/role/dataScope",method:"put",data:e})}function u(e,t){var a={roleId:e,status:t};return Object(r["a"])({url:"/role/changeStatus",method:"put",data:a})}function p(e){return Object(r["a"])({url:"/role/export",method:"get",params:e})}function m(e){return Object(r["a"])({url:"/role/authUser/allocatedList",method:"get",params:e})}function h(e){return Object(r["a"])({url:"/role/authUser/unallocatedList",method:"get",params:e})}function f(e){return Object(r["a"])({url:"/role/authUser/cancel",method:"put",data:e})}function b(e){return Object(r["a"])({url:"/role/authUser/cancelAll",method:"put",params:e})}function g(e){return Object(r["a"])({url:"/role/authUser/selectAll",method:"put",params:e})}},"35ad":function(e,t,a){"use strict";a.d(t,"f",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"i",(function(){return l})),a.d(t,"k",(function(){return n})),a.d(t,"g",(function(){return i})),a.d(t,"e",(function(){return c})),a.d(t,"l",(function(){return d})),a.d(t,"m",(function(){return u})),a.d(t,"j",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return b}));var r=a("b775");function o(e){return Object(r["a"])({url:"/cont/findContInfosByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/cont/findHisContInfosByCondition",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/cont/findSubContInfosByCondition",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/cont/saveCont",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/cont/findContPerfectInfoById/".concat(e),method:"get"})}function c(e){return Object(r["a"])({url:"/cont/findContFileById/".concat(e),method:"get"})}function d(e){return Object(r["a"])({url:"/cont/saveCont2",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/cont/submitCont/".concat(e),method:"get"})}function p(e){return Object(r["a"])({url:"/cont/invalidCont/".concat(e),method:"get"})}function m(e){return Object(r["a"])({url:"/cont/auditCont",method:"post",data:e})}function h(e){return Object(r["a"])({url:"/approval/contract/findContInfosByCondition",method:"get",params:e})}function f(e){return Object(r["a"])({url:"/approval/contract/findAuditRecordsByContId/".concat(e),method:"get"})}function b(e){return Object(r["a"])({url:"/cont/checkSupContCode",method:"get",params:e})}},"364a":function(e,t,a){"use strict";a("9fde")},3823:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.user,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[a("el-input",{attrs:{placeholder:"请输入旧密码",type:"password","show-password":""},model:{value:e.user.oldPassword,callback:function(t){e.$set(e.user,"oldPassword",t)},expression:"user.oldPassword"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[a("el-input",{attrs:{placeholder:"请输入新密码",type:"password","show-password":""},model:{value:e.user.newPassword,callback:function(t){e.$set(e.user,"newPassword",t)},expression:"user.newPassword"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[a("el-input",{attrs:{placeholder:"请确认密码",type:"password","show-password":""},model:{value:e.user.confirmPassword,callback:function(t){e.$set(e.user,"confirmPassword",t)},expression:"user.confirmPassword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submit}},[e._v("保存")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.close}},[e._v("关闭")])],1)],1)},o=[],s=a("db72"),l=a("78b1"),n={data:function(){var e=this,t=function(t,a,r){e.user.newPassword!==a?r(new Error("两次输入的密码不一致")):r()};return{test:"1test",user:{userId:this.$store.getters.userInfo.userId,oldPassword:"",newPassword:"",confirmPassword:""},rules:{oldPassword:[{required:!0,message:"旧密码不能为空",trigger:"blur"}],newPassword:[{required:!0,message:"新密码不能为空",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{required:!0,validator:t,trigger:"blur"}]}}},methods:{submit:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var a=Object(s["a"])({},e.user);e.$delete(a,"confirmPassword"),Object(l["a"])(a).then((function(t){e.msgSuccess("修改成功")}))}}))},close:function(){this.$router.push({path:"/"})}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},"398e":function(e,t,a){"use strict";a("a555")},"39da":function(e,t,a){},"3a2b":function(e,t,a){},"3b7f":function(e,t,a){"use strict";a("02f2")},"3c3c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"checkTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.checkTaskStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.checkTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"scheduUser",label:"任务下发人",width:"135",align:"center"}}),a("el-table-column",{attrs:{prop:"jobRemark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.checkTaskStatus>0?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"因子详情",visible:e.detailVisible,width:"80%",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("checkSample",{attrs:{"task-id":e.checkTaskId}})],1)],1)},o=[],s=a("15d4"),l=a("3188"),n=a("333d"),i={0:"待分配",1:"检测中",2:"已完成"},c={components:{Pagination:n["a"],checkSample:l["default"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:i,sampleData:[],searchForm:{jobId:"",projectName:"",sampTaskStatus:"2",pageNumber:1,pageSize:10},total:0,checkTaskId:"",detailVisible:!1,userData:[],laborTaskVisible:!1,currentRow:{},factorData:[],choseData:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["l"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){this.checkTaskId=e.checkTaskId,this.detailVisible=!0}}},d=c,u=(a("f163"),a("988e"),a("c7f0"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"ddd5b1b4",null);t["default"]=p.exports},"3d98":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:""},on:{click:e.goBack}},[e._v(" 返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.taskData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无任务信息\n            ")])])])]),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"180px","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",width:"140px","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",width:"140px","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{label:"要求完成时间",width:"190px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+" ~ "+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"进度",align:"center",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",{on:{mousedown:function(t){return e.showInfos(r)}}},[a("el-progress",{attrs:{"text-inside":!0,"stroke-width":14,percentage:r.process}})],1)]}}])}),a("el-table-column",{attrs:{prop:"taskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.taskStatus?"success":"primary"}},[e._v(e._s("1"===r.taskStatus?"已完成":"未完成"))])]}}])}),a("el-table-column",{attrs:{prop:"createTime",width:"155px",label:"创建时间",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("详情")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"任务进度表",visible:e.taskInfosVisible},on:{"update:visible":function(t){e.taskInfosVisible=t}}},[a("div",{staticClass:"block"},[a("el-timeline",e._l(e.activitieModel,(function(t,r){return a("el-timeline-item",{key:r,attrs:{type:t.type,color:t.color,size:t.size,timestamp:t.timestamp}},[e._v("\n          "+e._s(t.content)+"\n        ")])})),1)],1)]),a("el-dialog",{attrs:{title:"因子调度详情",visible:e.factorVisible,width:"80%"},on:{"update:visible":function(t){e.factorVisible=t}}},[a("el-table",{attrs:{data:e.factorData,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别","min-width":"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v("\n          "+e._s(r.factorName)),a("span",{staticStyle:{color:"red"}},[e._v(e._s(r.meanName&&r.meanName.length>0?"("+r.meanName+")":""))])]}}])}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(Number(a.dayCount*a.frequency))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"是否合样",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.hyFlag?"Y":"N")+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"是否分包",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.fbFlag?"Y":"N")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"factorRemark",label:"备注","min-width":"110",align:"center"}})],1)],1)],1)},o=[],s=(a("c5f6"),a("b199")),l=a("333d"),n={components:{Pagination:l["a"]},data:function(){return{taskData:[],searchForm:{taskId:"",jobId:"",pageNumber:1,pageSize:10},total:0,activitieModel:[],taskInfosVisible:!1,factorData:[],factorVisible:!1}},created:function(){this.$route.params.taskId&&(this.searchForm.taskId=this.$route.params.taskId,this.handleSearch())},methods:{handleSearch:function(){var e=this;s["i"](this.searchForm).then((function(t){200===t.code&&(e.taskData=t.result.records.map((function(t){return""!==t.reportStatus&&"6"===t.reportStatus?e.$set(t,"taskStatus","1"):e.$set(t,"taskStatus","0"),e.doProcessList(t),t}))||[],e.total=t.result.total)}))},doProcessList:function(e){var t=[{name:"任务单",content:"任务单",timestamp:"",size:"normal",type:"success"},{name:"采样",content:"采样",timestamp:"",size:"normal",type:"info"},{name:"检测",content:"检测",timestamp:"",size:"normal",type:"info"},{name:"报告生成",content:"报告生成",timestamp:"",size:"normal",type:"info"},{attr:"报告审核",content:"报告审核",timestamp:"",size:"normal",type:"info"},{attr:"报告签发",content:"报告签发",timestamp:"",size:"normal",type:"info"}],a=1;"1"===e.isSampled&&(t[1].type="success",a++),"1"===e.isChecked&&(t[2].type="success",a++),e.reportStatus>=1&&7!==e.reportStatus&&(t[3].type="success",a++),e.reportStatus>=4&&7!==e.reportStatus&&(t[4].type="success",a++),e.reportStatus>=5&&7!==e.reportStatus&&(t[5].type="success",a++),a>=1&&a<3&&(t[1].type="warning",t[2].type="warning"),a>=3&&(t[1].type="success",t[2].type="success",t[3].type="warning",4===a?(t[3].type="success",t[4].type="warning"):5===a?(t[3].type="success",t[4].type="success",t[5].type="warning"):6===a&&(t[3].type="success",t[4].type="success",t[5].type="success")),this.$set(e,"infoList",t),this.$set(e,"process",parseInt(Number(a/6*100).toFixed(0)))},showInfos:function(e){this.activitieModel=[],this.activitieModel=e.infoList,this.taskInfosVisible=!0},handleDetail:function(e){var t=this;s["h"](e.jobId).then((function(e){t.factorData=e.result.map((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}return e})),t.factorVisible=!0}))},goBack:function(){this.$router.back()}}},i=n,c=(a("4d1b"),a("7572"),a("2877")),d=Object(c["a"])(i,r,o,!1,null,"6d19a693",null);t["default"]=d.exports},"3de3":function(e,t,a){"use strict";a("e708")},"3e0d":function(e,t,a){"use strict";a("dd87")},"407e":function(e,t,a){"use strict";a("1899")},"41f4":function(e,t,a){"use strict";a("f2c6")},4245:function(e,t,a){},"43dd":function(e,t,a){"use strict";a("e25d")},4482:function(e,t,a){"use strict";a("ca94")},"44fb":function(e,t,a){"use strict";a("06d8")},4738:function(e,t,a){},"47a90":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-continer"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.smapItemId,callback:function(t){e.$set(e.searchForm,"smapItemId",t)},expression:"searchForm.smapItemId"}})],1),a("el-form-item",{attrs:{label:"因子名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"因子名称"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",{attrs:{label:"检测状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"检测状态"},model:{value:e.searchForm.checkStatus,callback:function(t){e.$set(e.searchForm,"checkStatus",t)},expression:"searchForm.checkStatus"}},e._l(Object.keys(e.CHECK_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.CHECK_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",width:"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"220px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkRes",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkRes&&r.checkRes.length>0?[e._v("\n          "+e._s(r.masterRes)),r.exponRes>0?[e._v("×10"),a("sup",[e._v(e._s(r.exponRes))])]:e._e()]:void 0]}}])}),a("el-table-column",{attrs:{prop:"checkStatus",label:"状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.checkStatus)}},[e._v("\n          "+e._s(e.CHECK_STATUS[r.checkStatus])+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"dataEntryStep",label:"数据操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.dataEntryStep?"danger":""}},[e._v("\n          "+e._s("1"===r.dataEntryStep?"采样录入":"检测录入")+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"assignUser",label:"分析员",align:"center"}}),a("el-table-column",{attrs:{prop:"collectTime",label:"采样时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"endDate",label:"任务截止时间",width:"120px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"190",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkStatus>2?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]):e._e(),r.checkStatus>2?a("div",{staticClass:"erc-divider-vertical"}):e._e(),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleLocalDetail(r)}}},[e._v("采样记录")]),r.assignUserId===e.userId&&"0"===r.checkStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"0"===r.checkStatus&&"噪声"!==r.secdClassName?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApply(r)}}},[e._v("申请领样")]):e._e(),r.assignUserId===e.userId&&"2"===r.checkStatus&&"2"===r.dataEntryStep?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"2"===r.checkStatus&&"2"===r.dataEntryStep?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSetResult(r)}}},[e._v("结果录入")]):e._e(),r.assignUserId===e.userId&&"3"===r.checkStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"3"===r.checkStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r.checkFactorId)}}},[e._v("提交审核")]):e._e()]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"检测详情",visible:e.detailVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticStyle:{width:"700px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.sampleForm.smapItemId))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.sampleForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.sampleForm.standardName))]),a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.sampleForm.remark))]),a("el-form-item",{attrs:{label:"检测结果:"}},[e.sampleForm.checkRes&&e.sampleForm.checkRes.length>0?[e._v("\n            "+e._s(e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v1?e.sampleForm.factorInfo.v1:0)+"\n            "),e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v2>0?[e._v("\n              ×10"),a("sup",[e._v(e._s(e.sampleForm.factorInfo.v2?Number(e.sampleForm.factorInfo.v2):0))])]:e._e()]:[e._v("暂无检测结果")]],2)],1),e.sampleForm.subFactors&&e.sampleForm.subFactors.length>0?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sampleForm.subFactors,border:"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"name",label:"检测因子",width:"130",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.v1?[e._v("\n                "+e._s(r.v1?r.v1:0)+"×10"),a("sup",[e._v(e._s(r.v2?Number(r.v2):0))]),e._v(e._s(e.sampleForm.unitName)+"\n              ")]:e._e()]}}],null,!1,1464253952)})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailVisible=!1}}},[e._v("关 闭")])],1)]),a("el-dialog",{attrs:{title:"样品结果录入",visible:e.testResultVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.testResultVisible=t}}},[a("div",{staticStyle:{width:"650px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.testResultForm.smapItemId))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.testResultForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.testResultForm.standardName))]),a("el-form-item",{attrs:{label:"检测结果:"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"结果值"},model:{value:e.testResultForm.masterRes,callback:function(t){e.$set(e.testResultForm,"masterRes",t)},expression:"testResultForm.masterRes"}},[a("template",{slot:"append"},[e._v("E")])],2)],1),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"幂数"},model:{value:e.testResultForm.subRes,callback:function(t){e.$set(e.testResultForm,"subRes",t)},expression:"testResultForm.subRes"}},[a("template",{slot:"append"},[e._v(e._s(e.testResultForm.unitName))])],2)],1)],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("例:3.45E2=3.45×10²  ;  234E0=234 ; 1.62E-3=1.62×10⁻³")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("无子因子的：输入0代表未检出")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("有子因子的：输入0代表未检出，不填代表未检查此项")])])],1)],1),a("el-form-item",{attrs:{label:"备注:"}},[a("el-input",{attrs:{type:"textarea",maxlength:"50","show-word-limit":"",placeholder:"备注信息",rows:3},model:{value:e.testResultForm.remark,callback:function(t){e.$set(e.testResultForm,"remark",t)},expression:"testResultForm.remark"}})],1)],1),e.subFactorData&&e.subFactorData.length>0?a("div",[a("el-table",{attrs:{data:e.subFactorData,border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"name",label:"检测因子",width:"130",align:"center"}}),a("el-table-column",{attrs:{label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"结果值"},model:{value:r.v1,callback:function(t){e.$set(r,"v1",t)},expression:"row.v1"}},[a("template",{slot:"append"},[e._v("E")])],2)],1),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"幂数"},model:{value:r.v2,callback:function(t){e.$set(r,"v2",t)},expression:"row.v2"}},[a("template",{slot:"append"},[e._v(e._s(e.testResultForm.unitName))])],2)],1)],1)]}}],null,!1,897311354)})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.testResultVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChecks}},[e._v("保存")])],1)]),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},o=[],s=a("db72"),l=a("2f62"),n=a("d43b"),i=a("15d4"),c=a("333d"),d=a("4328"),u=a.n(d),p={0:"待领样",1:"领样已申请",2:"待检测",3:"已录入",4:"待审核",6:"审核失败"},m={components:{Pagination:c["a"]},filters:{statusQualityFilter:function(e){return"0"===e?"info":"2"===e||"1"===e||"4"===e?"":"3"===e||"5"===e?"success":"danger"}},data:function(){return{CHECK_STATUS:p,checkData:[],searchForm:{smapItemId:"",factorName:"",checkStatus:"",pageNumber:1,pageSize:10},total:0,detailVisible:!1,sampleForm:{factorInfo:{},subFactors:{}},subSampleData:[],testResultVisible:!1,testResultForm:{checkFactorId:"",checkRes:"",checkSubRes:"",remark:""},subFactorData:[],sampleVisible:!1,sampleDetails:[],sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",sampleImageList:[],sampleImage:"",sampleDataInfo:[],sampleSecInfo:[]}},computed:Object(s["a"])({},Object(l["b"])(["userId"])),created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;i["f"](this.searchForm).then((function(t){200===t.code&&(e.checkData=t.result.records.map((function(t){if(t.checkRes&&""!==t.checkRes){var a=JSON.parse(t.checkRes);e.$set(t,"masterRes",a.v1?a.v1:""),e.$set(t,"exponRes",a.v2?a.v2:"")}else e.$set(t,"masterRes",""),e.$set(t,"exponRes","");return t}))||[],e.total=t.result.total)}))},handleDetail:function(e){if(this.sampleForm=Object(s["a"])({},e),e.checkSubRes&&e.checkSubRes.length>0){var t=JSON.parse(e.checkSubRes);this.$set(this.sampleForm,"subFactors",t)}if(e.checkRes&&e.checkRes.length>0){var a=JSON.parse(e.checkRes);this.$set(this.sampleForm,"factorInfo",a)}this.detailVisible=!0},handleLocalDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";n["g"](e.smapItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleApply:function(e){var t=this;this.$confirm("确定申请领样?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["q"](u.a.stringify({checkFactorId:e.checkFactorId})).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleSetResult:function(e){var t=this;this.testResultForm=Object(s["a"])({},e),i["m"](e.checkStandardId).then((function(e){t.subFactorData=[],200===e.code&&e.result&&(t.subFactorData=e.result.map((function(e){return{name:e,v1:"",v2:""}}))||[]),t.testResultVisible=!0}))},handleApprove:function(e){var t=this;this.$confirm("确认提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["s"]({checkFactorId:e}).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))}))},confirmChecks:function(){var e=this;this.$confirm("确认提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={checkFactorId:e.testResultForm.checkFactorId,checkRes:JSON.stringify({v1:e.testResultForm.masterRes,v2:e.testResultForm.subRes}),checkSubRes:JSON.stringify(e.subFactorData),remark:e.testResultForm.remark};i["r"](t).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.testResultVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))}))}}},h=m,f=(a("f467"),a("2877")),b=Object(f["a"])(h,r,o,!1,null,"895ef398",null);t["default"]=b.exports},"47bc":function(e,t,a){"use strict";a.d(t,"k",(function(){return o})),a.d(t,"p",(function(){return s})),a.d(t,"x",(function(){return l})),a.d(t,"r",(function(){return n})),a.d(t,"n",(function(){return i})),a.d(t,"g",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"h",(function(){return u})),a.d(t,"c",(function(){return p})),a.d(t,"u",(function(){return m})),a.d(t,"j",(function(){return h})),a.d(t,"m",(function(){return f})),a.d(t,"v",(function(){return b})),a.d(t,"i",(function(){return g})),a.d(t,"l",(function(){return v})),a.d(t,"s",(function(){return y})),a.d(t,"t",(function(){return F})),a.d(t,"q",(function(){return w})),a.d(t,"o",(function(){return k})),a.d(t,"D",(function(){return _})),a.d(t,"B",(function(){return S})),a.d(t,"w",(function(){return x})),a.d(t,"z",(function(){return C})),a.d(t,"G",(function(){return N})),a.d(t,"f",(function(){return I})),a.d(t,"e",(function(){return D})),a.d(t,"a",(function(){return T})),a.d(t,"A",(function(){return $})),a.d(t,"F",(function(){return P})),a.d(t,"y",(function(){return A}));var r=a("b775");function o(e){return Object(r["a"])({url:"/sampTask/findByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/sampTask/findHistoryByCondition",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/sampTask/getOfferFactorsByTaskId/".concat(e),method:"get"})}function n(e){return Object(r["a"])({url:"/sampItem/findByCondition",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/sampItem/findHistoryByCondition",method:"get",params:e})}function c(e){return Object(r["a"])({url:"/sampItem/doAuditSampItemForLeader",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/sampItem/batchDoAuditSampItemForLeader",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/sampItem/doAuditSampItemForManager",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/sampItem/batchDoAuditSampItemForManager",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/sampItem/findSampTaskForManagerByCondition",method:"get",params:e})}function h(e){return Object(r["a"])({url:"/sampItem/findAuditSampItemForManageByCondition",method:"get",params:e})}function f(e){return Object(r["a"])({url:"/sampItem/findHisAuditSampItemForManageByCondition",method:"get",params:e})}function b(e){return Object(r["a"])({url:"/sampItem/findSampleTaskForLeaderByCondition",method:"get",params:e})}function g(e){return Object(r["a"])({url:"/sampItem/findAuditSampItemForLeaderByCondition",method:"get",params:e})}function v(e){return Object(r["a"])({url:"/sampItem/findHisAuditSampItemForLeaderByCondition",method:"get",params:e})}function y(e){return Object(r["a"])({url:"/sampTask/findSampTaskByCondition",method:"get",params:e})}function F(e){return Object(r["a"])({url:"/sampTask/findSampTaskDetailByCondition",method:"get",params:e})}function w(e){return Object(r["a"])({url:"/sampTask/findByCondition",method:"get",params:e})}function k(e){return Object(r["a"])({url:"/sampTask/findHistoryByCondition",method:"get",params:e})}function _(e){return Object(r["a"])({url:"/sampTask/getZjJobFactorsByJobId",method:"get",params:e})}function S(e){return Object(r["a"])({url:"/sampTask/getWbJobFactorsByJobId",method:"get",params:e})}function x(e){return Object(r["a"])({url:"/sampTask/getJobFactorsByJobId/".concat(e),method:"get"})}function C(e){return Object(r["a"])({url:"/sampTask/getSampleListByCondition",method:"get",params:e})}function N(e){return Object(r["a"])({url:"/sampTask/saveSampleList",headers:{"Content-Type":"application/json"},method:"post",data:e})}function I(e){return Object(r["a"])({url:"/sampTask/deleteSampleListById/".concat(e),method:"delete"})}function D(e){return Object(r["a"])({url:"/sampTask/confirmSampleList",method:"post",data:e})}function T(e){return Object(r["a"])({url:"/sampTask/assignFactorPoint",method:"post",data:e})}function $(e){return Object(r["a"])({url:"/sampTask/getSampleTaskPointBySampTaskId/".concat(e),method:"get"})}function P(e){return Object(r["a"])({url:"/sampTask/saveCombinedRemark",method:"post",data:e})}function A(e){return Object(r["a"])({url:"/sampTask/getSampleItemBySampTaskId",method:"get",params:e})}},"487f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-continer"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampleNo,callback:function(t){e.$set(e.searchForm,"sampleNo",t)},expression:"searchForm.sampleNo"}})],1),a("el-form-item",[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"因子名称"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"检测状态"},model:{value:e.searchForm.checkStatus,callback:function(t){e.$set(e.searchForm,"checkStatus",t)},expression:"searchForm.checkStatus"}},[a("el-option",{attrs:{label:"已录入",value:"3"}}),a("el-option",{attrs:{label:"待审核",value:"4"}}),a("el-option",{attrs:{label:"审核通过",value:"5"}})],1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:"primary"},on:{click:e.goBack}},[e._v(" 返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkData,stripe:"",border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无信息\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",width:"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"220px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkRes",label:"检测结果","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkRes&&r.checkRes.length>0?[e._v("\n          "+e._s(r.masterRes)),""!==r.exponRes&&0!==r.exponRes?[e._v("×10"),a("sup",[e._v(e._s(r.exponRes))])]:e._e(),e._v("\n          "+e._s(r.unitName&&"无量纲"!==r.unitName?" "+r.unitName:"")+"\n        ")]:void 0]}}])}),a("el-table-column",{attrs:{prop:"assignUser",label:"分析员",align:"center"}}),a("el-table-column",{attrs:{prop:"collectTime",label:"采样时间",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.collectTime||a.collectDate?[e._v("\n          "+e._s(a.collectTime&&""!=a.collectTime?(a.collectDate?a.collectDate+" ":"")+a.collectTime:a.collectDate)+"\n        ")]:e._e()]}}])}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"dataEntryStep",label:"样品归类",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.sampleType?"danger":""}},[e._v("\n          "+e._s("1"===r.sampleType?"样品分包":"样品自检")+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"checkStatus",label:"检测状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.checkStatus)}},[e._v("\n          "+e._s(e.CHECK_STATUS[r.checkStatus])+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"dataEntryStep",label:"数据操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.dataEntryStep?"danger":""}},[e._v("\n          "+e._s("1"===r.dataEntryStep?"采样录入":"检测录入")+"\n        ")])]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"240px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleLocalDetail(r)}}},[e._v("采样记录")]),r.assignUserId!==e.userId||"2"!==r.checkStatus&&"3"!==r.checkStatus&&"6"!==r.checkStatus?e._e():a("div",{staticClass:"erc-divider-vertical"}),r.assignUserId!==e.userId||"2"!==r.checkStatus&&"3"!==r.checkStatus&&"6"!==r.checkStatus?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSetResult(r)}}},[e._v("结果编辑")]),r.assignUserId===e.userId&&"3"===r.checkStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"3"===r.checkStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r.checkFactorId)}}},[e._v("提交审核")]):e._e()]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"样品详情",visible:e.detailVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticStyle:{width:"700px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.sampleForm.sampleNo))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.sampleForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.sampleForm.standardName))]),a("el-form-item",{attrs:{label:"因子备注:"}},[e._v(e._s(e.sampleForm.factorRemark))]),a("el-form-item",{attrs:{label:"检测备注:"}},[e._v(e._s(e.sampleForm.remark))]),a("el-form-item",{attrs:{label:"检测结果:"}},[e.sampleForm.factorSubsetVos&&e.sampleForm.factorSubsetVos.length>0?[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sampleForm.factorSubsetVos,border:"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"factorName",label:"套餐因子",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v("\n                  "+e._s(r.factorInfo&&r.factorInfo.v1?r.factorInfo.v1:0)+"\n                  "),r.factorInfo&&""!==r.factorInfo.v2&&0!==r.factorInfo.v2?[e._v("\n                    ×10"),a("sup",[e._v(e._s(r.factorInfo.v2?Number(r.factorInfo.v2):0))])]:e._e(),e._v("\n                  "+e._s(r.unitName&&"无量纲"!==r.unitName?" "+r.unitName:"")+"\n                ")]}}],null,!1,2686722662)})],1)]:e.sampleForm.checkRes&&e.sampleForm.checkRes.length>0?[e._v("\n            "+e._s(e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v1?e.sampleForm.factorInfo.v1:0)+"\n            "),e.sampleForm.factorInfo&&""!==e.sampleForm.factorInfo.v2&&0!==e.sampleForm.factorInfo.v2?[e._v("\n              ×10"),a("sup",[e._v(e._s(e.sampleForm.factorInfo.v2?Number(e.sampleForm.factorInfo.v2):0))])]:e._e(),e._v("\n            "+e._s(e.sampleForm.unitName&&"无量纲"!==e.sampleForm.unitName?" "+e.sampleForm.unitName:"")+"\n          ")]:[e._v("暂无检测结果")]],2)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailVisible=!1}}},[e._v("关 闭")])],1)]),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"样品结果录入",visible:e.testResultVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.testResultVisible=t}}},[a("div",{staticStyle:{width:"700px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.testResultForm.sampleNo))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.testResultForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.testResultForm.standardName))]),a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            备注信息\n            "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"新建报价单时业务员录入的针对检测因子的备注信息"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n            :\n          ")],1),e._v("\n          "+e._s(e.testResultForm.factorRemark)+"\n        ")]),a("el-form-item",{attrs:{label:"检测结果:"}},[e._l(e.subFactorData,(function(t,r){return a("el-row",{key:r},[a("el-col",{staticStyle:{"text-align":"right","padding-bottom":"5px"},attrs:{span:4}},[e._v("\n              "+e._s(t.name)+":\n            ")]),a("el-col",{staticStyle:{"margin-left":"10px","padding-bottom":"5px"},attrs:{span:9}},[a("el-input",{attrs:{type:"Number","controls-position":"right",min:0,placeholder:"结果值"},model:{value:t.masterRes,callback:function(a){e.$set(t,"masterRes",a)},expression:"item.masterRes"}},[a("template",{slot:"append"},[e._v("E")])],2)],1),a("el-col",{staticStyle:{"margin-left":"10px","padding-bottom":"5px"},attrs:{span:9}},[a("el-input",{attrs:{type:"Number","controls-position":"right",min:0,placeholder:"幂数"},model:{value:t.subRes,callback:function(a){e.$set(t,"subRes",a)},expression:"item.subRes"}},[t.unitName?a("template",{slot:"append"},[e._v(e._s(t.unitName))]):e._e()],2)],1)],1)})),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("例:3.45E2=3.45×10²  ;  234E0=234 ; 1.62E-3=1.62×10⁻³")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("无子因子的：输入0代表未检出")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("有子因子的：输入0代表未检出，不填代表未检查此项")])])],1)],2),a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            备注\n            "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"分析员录入结果时录入的备注信息，可流转到实验室负责人和报告部门"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n            :\n          ")],1),a("el-input",{attrs:{type:"textarea",maxlength:"50","show-word-limit":"",placeholder:"备注信息",rows:3},model:{value:e.testResultForm.remark,callback:function(t){e.$set(e.testResultForm,"remark",t)},expression:"testResultForm.remark"}})],1),a("el-form-item",{attrs:{label:"检测设备:"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"170px"},attrs:{placeholder:"设备分类"},on:{change:e.handleChangeEqu},model:{value:e.equipmentType,callback:function(t){e.equipmentType=t},expression:"equipmentType"}},e._l(e.level,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"170px"},attrs:{clearable:"",placeholder:"请选择设备型号"},on:{change:e.handleChangeEquType},model:{value:e.equipmentClass,callback:function(t){e.equipmentClass=t},expression:"equipmentClass"}},e._l(e.levelTwo,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"170px"},attrs:{clearable:"",placeholder:"请选择设备编号"},model:{value:e.equipmentId,callback:function(t){e.equipmentId=t},expression:"equipmentId"}},e._l(e.levelThree,(function(e){return a("el-option",{key:e.id,attrs:{label:e.equipmentNumber,value:e.id}})})),1)],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.testResultVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChecks}},[e._v("保存")])],1)])],1)},o=[],s=(a("7f7f"),a("7514"),a("ac6a"),a("db72")),l=a("2f62"),n=a("15d4"),i=a("d43b"),c=a("f564"),d=a("333d"),u={0:"待领样",1:"领样申请",2:"待检测",3:"已录入",4:"待审核",5:"审核通过",6:"审核失败"},p={components:{Pagination:d["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"1"===e||"2"===e||"4"===e?"info":"3"===e?"":"5"===e?"success":"danger"}},props:{checkTaskId:{type:String,default:""}},data:function(){return{CHECK_STATUS:u,checkData:[],searchForm:{smapItemId:"",factorName:"",checkStatus:"",pageNumber:1,pageSize:10},total:0,detailVisible:!1,sampleForm:{factorInfo:{},subFactors:{}},sampleVisible:!1,sampleDetails:[],sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},testResultVisible:!1,testResultForm:{checkFactorId:"",checkRes:"",checkSubRes:"",remark:""},subFactorData:[],currentSample:"",sampleImageList:[],sampleImage:"",sampleDataInfo:[],sampleSecInfo:[],equipmentType:"",equipmentClass:"",equipmentId:"",level:[],levelTwo:[],levelThree:[]}},computed:Object(s["a"])({},Object(l["b"])(["userId"])),created:function(){this.checkTaskId&&this.checkTaskId.length>0&&(this.searchForm.checkTaskId=this.checkTaskId),this.getEquipment(),this.handleSearch()},methods:{handleSearch:function(){var e=this;this.checkTaskId&&this.checkTaskId.length>0&&n["j"](this.searchForm).then((function(t){200===t.code&&(e.checkData=t.result.records.map((function(t){if(t.checkRes&&""!==t.checkRes){var a=JSON.parse(t.checkRes);e.$set(t,"masterRes",a.v1),e.$set(t,"exponRes",a.v2)}else e.$set(t,"masterRes",0),e.$set(t,"exponRes",0);return t}))||[],e.total=t.result.total)}))},handleDetail:function(e){var t=this;if(this.sampleForm=Object(s["a"])({},e),e.factorSubsetVos&&e.factorSubsetVos.length>0&&this.sampleForm.factorSubsetVos.forEach((function(e){var a=JSON.parse(e.checkSubRes);t.$set(e,"factorInfo",a)})),e.checkRes&&e.checkRes.length>0){var a=JSON.parse(e.checkRes);this.$set(this.sampleForm,"factorInfo",a)}this.detailVisible=!0},getEquipment:function(){var e=this;this.level=[],this.levelTwo=[],this.levelThree=[],Object(c["e"])().then((function(t){if(t.result){var a=t.result?t.result:[];""!==a&&(e.level=a)}}))},handleLocalDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";i["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[],t.sampleDataInfo=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[]})),t.sampleVisible=!0)}))},goBack:function(){this.$router.back()},handleSetResult:function(e){if(this.testResultForm=Object(s["a"])({},e),this.subFactorData=[],e.factorSubsetVos&&e.factorSubsetVos.length>0)this.subFactorData=e.factorSubsetVos.map((function(e){var t=JSON.parse(e.checkSubRes);return{id:e.id,name:e.factorName,masterRes:t?t.v1:"",subRes:t?t.v2:"",unitName:e.unitName}}));else{var t=JSON.parse(e.checkRes);this.subFactorData=[{name:e.factorName,masterRes:t?t.v1:"",subRes:t?t.v2:"",unitName:e.unitName}]}var a=JSON.parse(e.checkEquipment);a&&(this.equipmentType=a.equipmentName,this.equipmentClass=a.equipmentModel,this.equipmentId=a.id,this.handleChangeEqu(a.equipmentName),this.handleChangeEquType(a.equipmentModel)),this.testResultVisible=!0},handleApprove:function(e){var t=this;this.$confirm("确认提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["s"]({checkFactorId:e}).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))}))},handleChangeEqu:function(e){this.levelTwo=[],this.levelThree=[];var t=this.level.find((function(t){return t.name===e}));t&&(this.levelTwo=t.children||[])},handleChangeEquType:function(e){this.levelThree=[];var t=this.levelTwo.find((function(t){return t.name===e}));t&&(this.levelThree=t.children||[])},confirmChecks:function(){var e=this;this.$confirm("确认提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t,a=e.levelThree.find((function(t){return t.id===e.equipmentId}));if("0"===e.testResultForm.isFactor){var r={name:e.subFactorData[0].name,v1:e.subFactorData[0].masterRes,v2:e.subFactorData[0].subRes};t={checkFactorId:e.testResultForm.checkFactorId,checkRes:JSON.stringify(r),remark:e.testResultForm.remark,checkEquipment:JSON.stringify(a)}}else{var o=e.subFactorData.map((function(e){var t={name:e.name,v1:e.masterRes,v2:e.subRes};return{id:e.id,unitName:e.unitName,checkSubRes:JSON.stringify(t)}}));t={checkFactorId:e.testResultForm.checkFactorId,checkRes:"",factorSubsetVos:o,remark:e.testResultForm.remark,checkEquipment:JSON.stringify(a)}}n["r"](t).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.testResultVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))}))}}},m=p,h=(a("ed0f"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"375d0bc1",null);t["default"]=f.exports},"48cd":function(e,t,a){},"492b":function(e,t,a){"use strict";a("b440")},"49e6":function(e,t,a){"use strict";a("0844")},"49eb":function(e,t,a){"use strict";a("af96")},"4a53":function(e,t,a){"use strict";a("cc83")},"4b3b":function(e,t,a){var r={"./approve/techApprove":"7162","./approve/techApprove.vue":"7162","./approve/techContApprove":"2f56","./approve/techContApprove.vue":"2f56","./contract":"7ffa","./contract/":"7ffa","./contract/approve":"50cf","./contract/approve/":"50cf","./contract/approve/index":"50cf","./contract/approve/index.vue":"50cf","./contract/components/contractList":"abf0","./contract/components/contractList.vue":"abf0","./contract/components/hisContractList":"a4f2","./contract/components/hisContractList.vue":"a4f2","./contract/index":"7ffa","./contract/index.vue":"7ffa","./contract/subContract":"be5e","./contract/subContract.vue":"be5e","./customer/customerList":"cad1","./customer/customerList.vue":"cad1","./dashboard":"9406","./dashboard/":"9406","./dashboard/black":"60f7","./dashboard/black/":"60f7","./dashboard/black/index":"60f7","./dashboard/black/index.vue":"60f7","./dashboard/components/BoxCard":"0a82","./dashboard/components/BoxCard.vue":"0a82","./dashboard/components/LineChart":"79cf","./dashboard/components/LineChart.vue":"79cf","./dashboard/components/OnlyLineChart":"7dab","./dashboard/components/OnlyLineChart.vue":"7dab","./dashboard/components/PanelGroup":"3e3b","./dashboard/components/PanelGroup.vue":"3e3b","./dashboard/components/PersonChart":"66c1","./dashboard/components/PersonChart.vue":"66c1","./dashboard/components/PieChart":"8e8b","./dashboard/components/PieChart.vue":"8e8b","./dashboard/components/SamllBoxChart":"8447","./dashboard/components/SamllBoxChart.vue":"8447","./dashboard/components/TaskCard":"16d1","./dashboard/components/TaskCard.vue":"16d1","./dashboard/components/TaskCardTwo":"38e9","./dashboard/components/TaskCardTwo.vue":"38e9","./dashboard/components/TaskRegion":"efb1","./dashboard/components/TaskRegion.vue":"efb1","./dashboard/components/mixins/resize":"1e21","./dashboard/components/mixins/resize.js":"1e21","./dashboard/director/components/BarChart":"9175","./dashboard/director/components/BarChart.vue":"9175","./dashboard/director/components/LeftBarChart":"1e14","./dashboard/director/components/LeftBarChart.vue":"1e14","./dashboard/director/components/SalePanelGroup":"e556","./dashboard/director/components/SalePanelGroup.vue":"e556","./dashboard/director/dispatch":"9059","./dashboard/director/dispatch.vue":"9059","./dashboard/director/equipment":"b27c","./dashboard/director/equipment.vue":"b27c","./dashboard/director/laboratory":"aff6","./dashboard/director/laboratory.vue":"aff6","./dashboard/director/laboratoryManage":"412f","./dashboard/director/laboratoryManage.vue":"412f","./dashboard/director/sale":"544b","./dashboard/director/sale.vue":"544b","./dashboard/director/saleManage":"fbcd","./dashboard/director/saleManage.vue":"fbcd","./dashboard/director/sample":"d18a","./dashboard/director/sample.vue":"d18a","./dashboard/director/sampleManage":"f656","./dashboard/director/sampleManage.vue":"f656","./dashboard/director/stock":"46b1","./dashboard/director/stock.vue":"46b1","./dashboard/director/technical":"9b97","./dashboard/director/technical.vue":"9b97","./dashboard/index":"9406","./dashboard/index.vue":"9406","./dashboard/manager":"dcdc6","./dashboard/manager/":"dcdc6","./dashboard/manager/index":"dcdc6","./dashboard/manager/index.vue":"dcdc6","./equipment":"7687","./equipment/":"7687","./equipment/index":"7687","./equipment/index.vue":"7687","./error-page/401":"24e2","./error-page/401.vue":"24e2","./error-page/404":"1db4","./error-page/404.vue":"1db4","./laboratory":"edea","./laboratory/":"edea","./laboratory/approve/approveList":"f199","./laboratory/approve/approveList.vue":"f199","./laboratory/components/hisLaborList":"487f","./laboratory/components/hisLaborList.vue":"487f","./laboratory/components/laborList":"fdde","./laboratory/components/laborList.vue":"fdde","./laboratory/index":"edea","./laboratory/index.vue":"edea","./laboratory/laborTaskIndex":"2d85","./laboratory/laborTaskIndex.vue":"2d85","./laboratory/laboratoryDetail":"fce3","./laboratory/laboratoryDetail.vue":"fce3","./laboratoryTask":"efeb","./laboratoryTask/":"efeb","./laboratoryTask/components/checkSample":"3188","./laboratoryTask/components/checkSample.vue":"3188","./laboratoryTask/components/hisLaborTaskList":"3c3c","./laboratoryTask/components/hisLaborTaskList.vue":"3c3c","./laboratoryTask/components/laborTaskList":"18f5","./laboratoryTask/components/laborTaskList.vue":"18f5","./laboratoryTask/index":"efeb","./laboratoryTask/index.vue":"efeb","./login":"9ed6","./login/":"9ed6","./login/auth-redirect":"b829","./login/auth-redirect.vue":"b829","./login/index":"9ed6","./login/index.vue":"9ed6","./order":"634a","./order/":"634a","./order/approve/approveList":"4f93","./order/approve/approveList.vue":"4f93","./order/components/freeMeal":"85cd","./order/components/freeMeal.vue":"85cd","./order/components/hisOrderList":"0ef1","./order/components/hisOrderList.vue":"0ef1","./order/components/orderList":"5dc5","./order/components/orderList copy":"e2f7","./order/components/orderList copy.vue":"e2f7","./order/components/orderList.vue":"5dc5","./order/components/sameMeal":"10b9","./order/components/sameMeal.vue":"10b9","./order/factor/mealList":"019c","./order/factor/mealList.vue":"019c","./order/index":"634a","./order/index.vue":"634a","./outLaboratory":"6ecf","./outLaboratory/":"6ecf","./outLaboratory/components/hisOutLaborList":"733e","./outLaboratory/components/hisOutLaborList.vue":"733e","./outLaboratory/components/outLaborList":"47a90","./outLaboratory/components/outLaborList.vue":"47a90","./outLaboratory/index":"6ecf","./outLaboratory/index.vue":"6ecf","./profile":"ecac","./profile/":"ecac","./profile/index":"ecac","./profile/index.vue":"ecac","./profile/index_old":"667f","./profile/index_old.vue":"667f","./profile/password":"5589","./profile/password.vue":"5589","./profile/resetPwd":"3823","./profile/resetPwd.vue":"3823","./profile/userAvatar":"88c9","./profile/userAvatar.vue":"88c9","./profile/userInfo":"2dde","./profile/userInfo.vue":"2dde","./report/components/approvel":"0ffe","./report/components/approvel.vue":"0ffe","./report/components/hisApprovel":"cb01","./report/components/hisApprovel.vue":"cb01","./report/components/hisReportTaskList":"2112","./report/components/hisReportTaskList.vue":"2112","./report/components/hisSignTask":"0812","./report/components/hisSignTask.vue":"0812","./report/components/reportTaskList":"6890","./report/components/reportTaskList.vue":"6890","./report/components/signTask":"9d50","./report/components/signTask.vue":"9d50","./report/pdlView":"1002","./report/pdlView.vue":"1002","./report/reportApprovel":"edd6","./report/reportApprovel copy":"d6aa","./report/reportApprovel copy.vue":"d6aa","./report/reportApprovel.vue":"edd6","./report/reportList":"2f1c","./report/reportList.vue":"2f1c","./report/reportSign":"dc80","./report/reportSign copy":"34b0","./report/reportSign copy.vue":"34b0","./report/reportSign.vue":"dc80","./report/reportTask":"9f07","./report/reportTask.vue":"9f07","./sample":"bfb3","./sample/":"bfb3","./sample/approve/approveHisList":"df9b","./sample/approve/approveHisList.vue":"df9b","./sample/approve/approveList":"cb3b","./sample/approve/approveList.vue":"cb3b","./sample/approve/masterApproveList":"3403","./sample/approve/masterApproveList.vue":"3403","./sample/approve/masterHisApproveList":"76d5","./sample/approve/masterHisApproveList.vue":"76d5","./sample/components/hisSampleList":"bc1d","./sample/components/hisSampleList.vue":"bc1d","./sample/components/sampleList":"d23a","./sample/components/sampleList.vue":"d23a","./sample/index":"bfb3","./sample/index.vue":"bfb3","./sample/index_bak":"8d8e","./sample/index_bak.vue":"8d8e","./sample/masterApproveList":"a1b9","./sample/masterApproveList.vue":"a1b9","./sample/masterConfirmList":"6da3","./sample/masterConfirmList.vue":"6da3","./sample/sampleAllList":"6c40","./sample/sampleAllList.vue":"6c40","./sample/sampleApproveTask":"1b3b","./sample/sampleApproveTask.vue":"1b3b","./sample/sampleDetail":"e7bb","./sample/sampleDetail.vue":"e7bb","./sample/sampleTask":"03d5","./sample/sampleTask.vue":"03d5","./sampleTask":"8037","./sampleTask/":"8037","./sampleTask/components/hisSampleTaskList":"ed89","./sampleTask/components/hisSampleTaskList copy":"1f44","./sampleTask/components/hisSampleTaskList copy.vue":"1f44","./sampleTask/components/hisSampleTaskList.vue":"ed89","./sampleTask/components/sampleTaskList":"6bb0","./sampleTask/components/sampleTaskList copy":"5032","./sampleTask/components/sampleTaskList copy.vue":"5032","./sampleTask/components/sampleTaskList.vue":"6bb0","./sampleTask/index":"8037","./sampleTask/index.vue":"8037","./stock":"024c","./stock/":"024c","./stock/inStockList":"76b3","./stock/inStockList.vue":"76b3","./stock/index":"024c","./stock/index.vue":"024c","./stock/outStockList":"fc5a","./stock/outStockList.vue":"fc5a","./stock/stockList":"7eed","./stock/stockList.vue":"7eed","./system/car":"5b77","./system/car/":"5b77","./system/car/index":"5b77","./system/car/index.vue":"5b77","./system/compone":"cbc6","./system/compone.vue":"cbc6","./system/control":"6005","./system/control/":"6005","./system/control/index":"6005","./system/control/index.vue":"6005","./system/dept":"5cfa","./system/dept/":"5cfa","./system/dept/deptList":"059d","./system/dept/deptList.vue":"059d","./system/dept/deptNewList":"2f98","./system/dept/deptNewList.vue":"2f98","./system/dept/index":"5cfa","./system/dept/index.vue":"5cfa","./system/factor/factorList":"9ccb","./system/factor/factorList.vue":"9ccb","./system/judge":"e28f","./system/judge/":"e28f","./system/judge/index":"e28f","./system/judge/index.vue":"e28f","./system/position":"e2e6","./system/position/":"e2e6","./system/position/index":"e2e6","./system/position/index.vue":"e2e6","./system/post":"5788","./system/post/":"5788","./system/post/index":"5788","./system/post/index.vue":"5788","./system/role":"70eb","./system/role/":"70eb","./system/role/authUser":"7054","./system/role/authUser.vue":"7054","./system/role/index":"70eb","./system/role/index.vue":"70eb","./system/role/roleList":"c527","./system/role/roleList.vue":"c527","./system/role/selectUser":"a17e","./system/role/selectUser.vue":"a17e","./system/user":"1f34","./system/user/":"1f34","./system/user/index":"1f34","./system/user/index.vue":"1f34","./system/user/userList":"f0c6","./system/user/userList.vue":"f0c6","./task/components/taskList":"a353","./task/components/taskList.vue":"a353","./task/orderHisReportTask":"0139","./task/orderHisReportTask.vue":"0139","./task/orderOutSource":"53987","./task/orderOutSource.vue":"53987","./task/orderReportTask":"5f21","./task/orderReportTask.vue":"5f21","./task/orderReportTaskList":"3d98","./task/orderReportTaskList.vue":"3d98","./task/orderTask":"b82c","./task/orderTask.vue":"b82c","./task/orderTaskList":"5ae4","./task/orderTaskList.vue":"5ae4","./task/techReview":"a28f","./task/techReview.vue":"a28f"};function o(e){var t=s(e);return a(t)}function s(e){var t=r[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}o.keys=function(){return Object.keys(r)},o.resolve=s,e.exports=o,o.id="4b3b"},"4d1b":function(e,t,a){"use strict";a("0e6b")},"4d2d":function(e,t,a){},"4dcb":function(e,t,a){},"4f93":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"",data:e.orderData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",fixed:"left","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"报价单号",width:"180px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkType",label:"检测类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("0"===a.checkType?"委托检测":"样品送检")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"certificationType",label:"认证类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.certificationType?"CMA":"CNAS")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"consignorName",label:"客户名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"finishDate",label:"完成时间",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.status)}},[e._v("\n            "+e._s(e.ACCOUNT_STATUS[r.status])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"checkTaskCount",label:"任务数",align:"center"}}),a("el-table-column",{attrs:{prop:"draftAmount",label:"费用总计",align:"center"}}),a("el-table-column",{attrs:{prop:"createUserId",label:"报价人",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),"1"===t.row.status?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"1"===t.row.status?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApprove(t.row)}}},[e._v(" 审核")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报价单("+e.orderDetailForm.offerId+")",visible:e.detailVisible,top:"5vh",width:"70%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"135px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户名称:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorName||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系人:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinker||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinkerPhone||""))])],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户要求完成时间:"}},[e._v(e._s(e._f("Time2Format")(e.orderDetailForm.offerBaseVo.finishDate)))])],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.remark||""))])],1)],1)],1),e._l(e.orderDetailPlans,(function(t,r){return a("div",{key:r},[a("el-divider",[e._v("计划"+e._s(r+1)+"因子列表")]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0"}},[a("thead",[a("tr",[a("th",{attrs:{rowspan:"2"}},[e._v("序号")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测类别")]),a("th",{attrs:{colspan:"3"}},[e._v("检测项目")]),a("th",{attrs:{rowspan:"2"}},[e._v("频次(次/天)")]),a("th",{attrs:{rowspan:"2"}},[e._v("天数")]),a("th",{attrs:{rowspan:"2"}},[e._v("监测频次")]),a("th",{attrs:{rowspan:"2"}},[e._v("执行次数")]),a("th",{attrs:{rowspan:"2"}},[e._v("总数")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测单价(元)")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测费(元)")])]),a("tr",[a("th",[e._v("序号")]),a("th",[e._v("检测位置")]),a("th",[e._v("因子")])])]),a("tbody",[e._l(t.factorTdos,(function(r,o){return a("tr",{key:o},[0==r.frIndex?[a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.id))]),a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.secName))])]:e._e(),a("td",[e._v(e._s(r.sid))]),a("td",[e._v(e._s(r.factorPoint))]),a("td",[e._v(e._s(r.factorName)+e._s(r.meanName&&r.meanName.length>0?"("+r.meanName+")":""))]),a("td",[e._v(e._s(r.frequency))]),a("td",[e._v(e._s(r.dayCount))]),0==o?[a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.checkFreq))]),a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.execTimes))])]:e._e(),a("td",[e._v(e._s(Number(r.frequency*r.dayCount*t.execTimes).toFixed(0)))]),a("td",[e._v(e._s(r.costPerTime))]),a("td",[e._v(e._s(parseFloat(r.costPerTime*r.frequency*r.dayCount*t.execTimes).toFixed(2)))])],2)})),a("tr",[a("td",{attrs:{colspan:"11"}},[e._v("检测费合计")]),a("td",[e._v(e._s(parseFloat(t.checkFee*t.execTimes).toFixed(2)))])])],2)])])],1)})),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0  "}},[a("tbody",[a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("检测费合计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.checkAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告编制费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.reportAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告加急费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.expediteAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("采样费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.laborAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("差旅费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.tripAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("税额")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.taxAmount)))])]),e.orderDetailForm.selfCostVos?e._l(e.orderDetailForm.selfCostVos,(function(t,r){return a("tr",{key:r},[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(t.selfName))]),a("td",[e._v(e._s(e._f("MoneyFormat")(t.amount)))])])})):e._e(),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("总计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.sysAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("优惠价")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.draftAmount)))])]),a("tr",[a("td",{staticStyle:{width:"20%"}},[e._v("大写：")]),a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(e._f("Money2Chinese")(e.orderDetailForm.costVo.draftAmount)))])])],2)])])],2),a("el-dialog",{attrs:{title:"报价单审核",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.isPass,callback:function(t){e.$set(e.approveForm,"isPass",t)},expression:"approveForm.isPass"}},[a("el-radio",{attrs:{label:"0"}},[e._v("通过")]),a("el-radio",{attrs:{label:"1"}},[e._v("驳回")])],1)],1),"1"===e.approveForm.isPass?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50",placeholder:"审核意见"},model:{value:e.approveForm.remark,callback:function(t){e.$set(e.approveForm,"remark",t)},expression:"approveForm.remark"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=(a("7514"),a("5df3"),a("f400"),a("75fc")),l=(a("ac6a"),a("b429")),n=a("e601"),i=a("333d"),c={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过"},d={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},u={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},data:function(){return{ACCOUNT_STATUS:c,CHECK_STATUS:d,orderData:[],searchForm:{id:"",projectName:"",status:"1",pageNumber:1,pageSize:10},total:0,approveVisible:!1,detailVisible:!1,orderDetailForm:{offerId:"",offerBaseVo:{consignorName:"",consignorLinker:"",consignorLinkerPhone:"",createUserName:"",finishDate:"",remark:"",checkCircle:"",checkTaskCount:""},factorTdos:[],costVo:{},oncePrice:"",selfCostVos:[]},orderDetailPlans:[],approveForm:{offerId:"",isPass:"0",remark:""}}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;l["b"](this.searchForm).then((function(t){200===t.code&&(e.orderData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;n["f"](e.id).then((function(e){if(200===e.code){var a=[];t.orderDetailForm.offerId=e.result.offerId||"",t.orderDetailForm.offerBaseVo=e.result.offerBaseVo||{},t.orderDetailForm.costVo=e.result.costVo||{},t.orderDetailForm.selfCostVos=e.result.selfCostVos||[],t.orderDetailForm.offerPlanVos=a=e.result.offerPlanVos.map((function(e){return e.planFactorVoList&&e.planFactorVoList.length>0&&(e.planFactorVoList.forEach((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}})),t.$set(e,"oldPlanFactors",e.planFactorVoList)),e}))||[],t.orderDetailPlans=t.doProcessOrder(a)||[],t.detailVisible=!0}}))},doProcessOrder:function(e){var t=this;if(e&&e.length>0){var a=Object(s["a"])(e);return a.forEach((function(e){var a=t.doProcessDate(e.planFactorVoList);t.$set(e,"factorTdos",a)})),a}},doProcessDate:function(e){var t=this;if(e&&e.length>0){var a=[],r=new Map,o=[],s=1;return e.forEach((function(e,t){var o=a.find((function(t){return t.secdClassName===e.secdClassName}));if(o||(a.push({id:s,secdClassName:e.secdClassName,totalPrice:0,detailLength:0}),s++),r.get(e.secdClassName)){var l=r.get(e.secdClassName);l.push(e)}else{var n=[];n.push(e),r.set(e.secdClassName,n)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName);a&&a.length>0&&a.forEach((function(r,s){var l=o.find((function(e){return e.secName===r.secdClassName}));l?t.$set(r,"frIndex",1):t.$set(r,"frIndex",0),t.$set(r,"id",e.id),t.$set(r,"sid",e.id+"."+(s+1)),t.$set(r,"secName",e.secdClassName),t.$set(r,"detailLength",a.length),t.$set(r,"dateType",0),o.push(r)}))})),o}return[]},countTotal:function(e,t){var a=0;return a=e.reduce((function(e,a,r,o){return a[t]?e+a[t]:e}),0),a},handleApprove:function(e){this.approveForm.offerId=e.id,this.approveForm.isPass="0",this.approveForm.remark="",this.approveVisible=!0},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["d"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},p=u,m=(a("08d0"),a("c4ba"),a("c2f9"),a("2877")),h=Object(m["a"])(p,r,o,!1,null,"afb8415c",null);t["default"]=h.exports},5032:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"样品状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.sampTaskStatus,callback:function(t){e.$set(e.searchForm,"sampTaskStatus",t)},expression:"searchForm.sampTaskStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.sampTaskStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.sampTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),t.row.sampTaskStatus>0?a("div",{staticClass:"erc-divider-vertical"}):e._e(),t.row.sampTaskStatus>0?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handlePrint(t.row)}}},[e._v(" 标签打印")]):e._e(),"0"===t.row.sampTaskStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"0"===t.row.sampTaskStatus?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleSchedTask(t.row)}}},[e._v(" 任务分配")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.taskTitle+" 任务详情",visible:e.taskVisible,center:"",width:"70%",top:"5vh"},on:{"update:visible":function(t){e.taskVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("合同编号: "+e._s(e.taskForm.contCode))])]),a("el-col",{attrs:{span:12}},[a("span",[e._v("报价单号: "+e._s(e.taskForm.offerId))])])],1),a("table",{staticClass:"info-table-new",attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("项目名称:")]),a("td",[e._v(e._s(e.taskForm.projectName))]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托单位:")]),a("td",[e._v(e._s(e.taskForm.consignorName))])]),a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人:")]),a("td",[e._v(e._s(e.taskForm.consignorLinker)+" ")]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人方式:")]),a("td",[e._v(e._s(e.taskForm.consignorLinkerPhone))])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},[e._v("\n          工作要求:\n        ")])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},e._l(e.factorData,(function(t,r){return a("el-row",{key:r},[a("el-col",{staticStyle:{"font-weight":"bolder"},attrs:{span:24}},[e._v(e._s(t.secdClassName)+":")]),e._l(t.factList,(function(t){return a("el-col",{key:t.id,attrs:{span:24}},[e._v("\n              "+e._s(t.factorPoint+"（"+t.dayCount+"*"+t.frequency+"）: ")+e._s(t.showFactName)+" "),"1"===t.fbFlag?a("span",{staticStyle:{color:"red"}},[e._v("(分包)")]):e._e()])}))],2)})),1)])])],1),a("el-dialog",{attrs:{title:"采样任务分配",visible:e.sampleTaskVisible,width:"80%",top:"2vh"},on:{"update:visible":function(t){e.sampleTaskVisible=t}}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"任务单号:"}},[e._v("\n            "+e._s(e.currentRow.jobId)+"\n          ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"受检单位:"}},[e._v("\n            "+e._s(e.currentRow.inspectionName)+"\n          ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v("\n            "+e._s(e.currentRow.inspectionLinkerPhone)+"\n          ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"要求完成时间:"}},[e._v("\n            "+e._s(e.currentRow.startDate)+"~"+e._s(e.currentRow.endDate)+"\n          ")])],1)],1)],1),a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"自检因子"}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("span",[e._v("自检因子信息"),a("i",{staticClass:"el-input__icon "})])]),a("el-col",{staticStyle:{padding:"10px","text-align":"right"},attrs:{span:15}},[a("span",{staticStyle:{color:"red",width:"100%"}},[e._v("注意：仅需选取需要合样的因子进行合样，剩余未合样的因子按照默认样品数采样。")])]),a("el-col",{staticStyle:{padding:"5px","text-align":"right"},attrs:{span:5}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.moveFactors}},[e._v("剩余自成样品")]),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.mergeFactors}},[e._v("合样")])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请录入因子名称"},model:{value:e.showFactorName,callback:function(t){e.showFactorName=t},expression:"showFactorName"}})],1)],1),a("el-table",{ref:"choseTable",staticStyle:{width:"100%","padding-top":"10px"},attrs:{stripe:"",size:"small",data:e.filterData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"300px"},on:{"selection-change":e.handleSelectionChange,select:e.handleSelect}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.checkSelectable,align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{label:"状态",align:"center"}},[[a("el-tag",{attrs:{type:""}},[e._v("自检")])]],2)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:6}},[a("span",[e._v("合样列表"),a("i",{staticClass:"el-input__icon "})])]),a("el-col",{staticStyle:{padding:"5px","text-align":"right"},attrs:{span:18}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.sortData}},[e._v("位置排序")]),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.delMergeData}},[e._v("移除合样")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mergeData,size:"small","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"400px"}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"样品数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{label:"采样组长",align:"center",width:"135"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{attrs:{slot:"small",filterable:"",placeholder:"请选择采样组长"},on:{change:function(t){return e.handleChangeRow(r)}},slot:"small",model:{value:r.collectLeaderId,callback:function(t){e.$set(r,"collectLeaderId",t)},expression:"row.collectLeaderId"}},e._l(e.perGroups,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.empName,value:e.userId}})})),1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,o=t.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.delGroupRow(r,o)}}},[e._v("删除")])]}}])})],1)],1)],1),a("el-tab-pane",{attrs:{label:"分包因子"}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("span",[e._v("分包因子信息"),a("i",{staticClass:"el-input__icon "})])]),a("el-col",{staticStyle:{padding:"10px","text-align":"right"},attrs:{span:15}},[a("span",{staticStyle:{color:"red",width:"100%"}},[e._v("注意：仅需选取需要合样的因子进行合样，剩余未合样的因子按照默认样品数采样。")])]),a("el-col",{staticStyle:{padding:"5px","text-align":"right"},attrs:{span:5}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.moveOutFactors}},[e._v("剩余自成样品")]),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.mergeOutFactors}},[e._v("合样")])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请录入因子名称"},model:{value:e.showOutFactorName,callback:function(t){e.showOutFactorName=t},expression:"showOutFactorName"}})],1)],1),a("el-table",{ref:"choseOutTable",staticStyle:{width:"100%","padding-top":"10px"},attrs:{stripe:"",size:"small",data:e.outFilterData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"300px"},on:{"selection-change":e.handleOutSelectionChange,select:e.handleOutSelect}},[a("el-table-column",{attrs:{type:"selection",width:"45",selectable:e.checkOutSelectable,align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"样品数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{label:"状态",align:"center"}},[[a("el-tag",{attrs:{type:"danger"}},[e._v("分包")])]],2)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:6}},[a("span",[e._v("合样列表"),a("i",{staticClass:"el-input__icon "})])]),a("el-col",{staticStyle:{padding:"5px","text-align":"right"},attrs:{span:18}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.sortOutData}},[e._v("位置排序")]),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.delMergeOutData}},[e._v("移除合样")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mergeOutData,size:"small","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"400px"}},[a("el-table-column",{attrs:{type:"index",width:"45",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"样品数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{label:"采样组长",align:"center",width:"135"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{attrs:{slot:"small",filterable:"",placeholder:"请选择采样组长"},on:{change:function(t){return e.handleOutChangeRow(r)}},slot:"small",model:{value:r.collectLeaderId,callback:function(t){e.$set(r,"collectLeaderId",t)},expression:"row.collectLeaderId"}},e._l(e.perGroups,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.empName,value:e.userId}})})),1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,o=t.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.delOutGroupRow(r,o)}}},[e._v("删除")])]}}])})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleTaskVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1)],1)},o=[],s=a("db72"),l=(a("28a5"),a("75fc")),n=(a("55dd"),a("7514"),a("ac6a"),a("5df3"),a("f400"),a("3b2b"),a("47bc")),i=a("b705"),c=a("333d"),d=a("4328"),u=a.n(d),p={0:"待分配",1:"采样中"},m={components:{Pagination:c["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:p,sampleData:[],searchForm:{jobId:"",projectName:"",sampTaskStatus:"",pageNumber:1,pageSize:50},total:0,taskTitle:"",taskVisible:!1,factorData:[],factorDetailData:[],factorOldDetailData:[],factorOutDetailData:[],factorOldOutDetailData:[],taskForm:{projectName:"",offerId:"",contCode:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:""},sampleTaskVisible:!1,currentRow:{},multipleSelection:[],multipleOutSelection:[],perGroups:[],mergeData:[],mergeOutData:[],currentSelectionRow:{secdClassId:"",factorPoint:"",frequency:"",dayCount:""},currentOutSelectionRow:{secdClassId:"",factorPoint:"",frequency:"",dayCount:""},showFactorName:"",showOutFactorName:""}},computed:{filterData:function(){if(this.showFactorName&&this.showFactorName.length>0){var e=new RegExp(this.showFactorName.trim());return this.factorDetailData.filter((function(t){return e.test(t.factorName)}))}return this.factorDetailData},outFilterData:function(){if(this.showOutFactorName&&this.showOutFactorName.length>0){var e=new RegExp(this.showOutFactorName.trim());return this.factorOutDetailData.filter((function(t){return e.test(t.factorName)}))}return this.factorOutDetailData}},created:function(){this.getFactorPeople(),this.handleSearch()},methods:{getFactorPeople:function(){var e=this;i["c"]().then((function(t){e.perGroups=t.result||[]}))},handleSearch:function(){var e=this;n["k"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.taskTitle=e.projectName,this.taskForm=Object.assign({},e),n["x"](e.sampTaskId).then((function(e){200===e.code&&e.result&&(t.factorData=t.doProcessData(e.result),t.taskVisible=!0)}))},doProcessData:function(e){var t=this,a=[];if(e.length>0){var r=new Map;e.forEach((function(e){var t=a.find((function(t){return t.secdClassName===e.secdClassName&&t.fbFlag===e.fbFlag}));if(t||a.push({secdClassName:e.secdClassName,fbFlag:e.fbFlag,factList:[]}),r.get(e.secdClassName+"-"+e.fbFlag)){var o=r.get(e.secdClassName+"-"+e.fbFlag);o.push(e)}else{var s=[];s.push(e),r.set(e.secdClassName+"-"+e.fbFlag,s)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName+"-"+e.fbFlag),o=[];a&&(a.forEach((function(a){var r=o.find((function(e){return e.factorPoint===a.factorPoint&&e.frequency===a.frequency&&e.dayCount===a.dayCount?(e.showFactName=e.showFactName+","+a.factorName,e):null}));r||(t.$set(a,"showFactName",a.factorName),t.$set(a,"fbFlag",e.fbFlag),o.push(a))})),e.factList=o.sort((function(e,t){return e.checkStandardId>t.checkStandardId?-1:e.checkStandardId<t.checkStandardId?1:0})))}))}return a},handleSchedTask:function(e){var t=this;this.currentRow=Object.assign({},e),this.factorDetailData=[],this.factorOldDetailData=[],this.mergeData=[],this.factorOutDetailData=[],this.factorOldOutDetailData=[],this.mergeOutData=[],n["getZjOfferFactorsByTaskId"](e.sampTaskId).then((function(e){200===e.code&&e.result&&(t.factorDetailData=e.result||[],t.factorOldDetailData=Object(l["a"])(e.result)||[]),t.sampleTaskVisible=!0,t.clearSelectionRow()})),n["getWbOfferFactorsByTaskId"](e.sampTaskId).then((function(e){200===e.code&&e.result&&(t.factorOutDetailData=e.result||[],t.factorOldOutDetailData=Object(l["a"])(e.result)||[]),t.clearOutSelectionRow()}))},confirmDialog:function(){var e=this;if(this.factorDetailData&&this.factorDetailData.length>0)this.$message.warning("剩余样品请进行自成样品操作！");else if(this.factorOutDetailData&&this.factorOutDetailData.length>0)this.$message.warning("剩余分包样品请进行自成样品操作！");else{var t=this.mergeData.find((function(e){return!e.collectLeaderId||e.collectLeaderId.length<=0}));if(t)this.$message.error("采样组长不能为空");else{var a=this.mergeOutData.find((function(e){return!e.collectLeaderId||e.collectLeaderId.length<=0}));a?this.$message.error("分包样品采样组长不能为空"):this.$confirm("确定提交合样?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.factorDetailData.map((function(e){var t=e.collectLeaderId,a=e.offerFactorId;return{collectLeaderId:t,offerFactorId:a,sampleType:"0"}})),a=e.mergeData.map((function(e){var t=e.collectLeaderId,a=e.offerFactorId;return{collectLeaderId:t,offerFactorId:a,sampleType:"0"}})),r=t.concat(a),o=[];if(e.mergeOutData&&e.mergeOutData.length>0){var s=e.factorOutDetailData.map((function(e){var t=e.collectLeaderId,a=e.offerFactorId;return{collectLeaderId:t,offerFactorId:a,sampleType:"1"}})),l=e.mergeOutData.map((function(e){var t=e.collectLeaderId,a=e.offerFactorId;return{collectLeaderId:t,offerFactorId:a,sampleType:"1"}}));o=s.concat(l)}var i=r.concat(o),c={sampTaskId:e.currentRow.sampTaskId,params:i};n["combinedSampleAndAssignments"](u.a.stringify({param:JSON.stringify(c)})).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.sampleTaskVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},delGroupRow:function(e,t){var a=this,r=e.offerFactorId.split(",");r.forEach((function(e){var t=a.factorOldDetailData.find((function(t){return t.offerFactorId===e}));t&&a.factorDetailData.push(t)})),this.mergeData.splice(t,1)},delOutGroupRow:function(e,t){var a=this,r=e.offerFactorId.split(",");r.forEach((function(e){var t=a.factorOldOutDetailData.find((function(t){return t.offerFactorId===e}));t&&a.factorOutDetailData.push(t)})),this.mergeOutData.splice(t,1)},handleSelectionChange:function(e){this.multipleSelection=e},handleOutSelectionChange:function(e){this.multipleOutSelection=e},clearSelectionRow:function(){this.currentSelectionRow={secdClassId:"",factorPoint:"",frequency:"",dayCount:""}},clearOutSelectionRow:function(){this.currentOutSelectionRow={secdClassId:"",factorPoint:"",frequency:"",dayCount:""}},handleSelect:function(e,t){e.length>0?(this.currentSelectionRow.secdClassId=t.secdClassId,this.currentSelectionRow.factorPoint=t.factorPoint,this.currentSelectionRow.frequency=t.frequency,this.currentSelectionRow.dayCount=t.dayCount):this.clearSelectionRow()},handleOutSelect:function(e,t){e.length>0?(this.currentOutSelectionRow.secdClassId=t.secdClassId,this.currentOutSelectionRow.factorPoint=t.factorPoint,this.currentOutSelectionRow.frequency=t.frequency,this.currentOutSelectionRow.dayCount=t.dayCount):this.clearOutSelectionRow()},checkRow:function(e){return!this.currentSelectionRow.secdClassId||""===this.currentSelectionRow.secdClassId||e.secdClassId===this.currentSelectionRow.secdClassId&&e.factorPoint===this.currentSelectionRow.factorPoint&&e.frequency===this.currentSelectionRow.frequency&&e.dayCount===this.currentSelectionRow.dayCount},checkSelectable:function(e){return this.checkRow(e)},checkOutSelectable:function(e){return!this.currentOutSelectionRow.secdClassId||""===this.currentOutSelectionRow.secdClassId||e.secdClassId===this.currentOutSelectionRow.secdClassId&&e.factorPoint===this.currentOutSelectionRow.factorPoint&&e.frequency===this.currentOutSelectionRow.frequency&&e.dayCount===this.currentOutSelectionRow.dayCount},delMergeData:function(){this.mergeData=[],this.factorDetailData=Object(l["a"])(this.factorOldDetailData),this.clearSelectionRow(),this.$refs.choseTable.clearSelection()},delMergeOutData:function(){this.mergeOutData=[],this.factorOutDetailData=Object(l["a"])(this.factorOldOutDetailData),this.clearOutSelectionRow(),this.$refs.choseOutTable.clearSelection()},sortData:function(){this.mergeData.sort((function(e,t){return e.secdClassId===t.secdClassId?e.factorPoint-t.factorPoint:t.secdClassId-e.secdClassId})),this.mergeData.reverse()},sortOutData:function(){this.mergeOutData.sort((function(e,t){return e.secdClassId===t.secdClassId?e.factorPoint-t.factorPoint:t.secdClassId-e.secdClassId})),this.mergeOutData.reverse()},moveFactors:function(){var e=this;this.factorDetailData&&this.factorDetailData.length>0&&(this.factorDetailData.forEach((function(t){e.mergeData.push(Object(s["a"])(Object(s["a"])({},t),{},{collectLeaderId:""}))})),this.factorDetailData=[],this.clearSelectionRow())},moveOutFactors:function(){var e=this;this.factorOutDetailData&&this.factorOutDetailData.length>0&&(this.factorOutDetailData.forEach((function(t){e.mergeOutData.push(Object(s["a"])(Object(s["a"])({},t),{},{collectLeaderId:""}))})),this.factorOutDetailData=[],this.clearOutSelectionRow())},mergeFactors:function(){var e=this;if(this.multipleSelection&&this.multipleSelection.length>0){var t={};this.multipleSelection.forEach((function(a){t&&t.offerFactorId?(t.factorName+=","+a.factorName,t.offerFactorId+=","+a.offerFactorId):t=Object(s["a"])(Object(s["a"])({},a),{},{collectLeaderId:""});var r=e.factorDetailData.indexOf(a);e.factorDetailData.splice(r,1)})),this.mergeData.push(t),this.multipleSelection=[],this.clearSelectionRow(),this.$refs.choseTable.clearSelection()}else this.$message.error("至少选择一个因子合样")},mergeOutFactors:function(){var e=this;if(this.multipleOutSelection&&this.multipleOutSelection.length>0){var t={};this.multipleOutSelection.forEach((function(a){t&&t.offerFactorId?(t.factorName+=","+a.factorName,t.offerFactorId+=","+a.offerFactorId):t=Object(s["a"])(Object(s["a"])({},a),{},{collectLeaderId:""});var r=e.factorOutDetailData.indexOf(a);e.factorOutDetailData.splice(r,1)})),this.mergeOutData.push(t),this.multipleOutSelection=[],this.clearOutSelectionRow(),this.$refs.choseOutTable.clearSelection()}else this.$message.error("至少选择一个因子合样")},handlePrint:function(e){this.$router.push("/sampleDetail/".concat(e.sampTaskId))},handleChangeRow:function(e){var t=this;this.mergeData.forEach((function(a){a.collectLeaderId&&""!==a.collectLeaderId||e.factorPoint===a.factorPoint&&t.$set(a,"collectLeaderId",e.collectLeaderId)}))},handleOutChangeRow:function(e){var t=this;this.mergeOutData.forEach((function(a){a.collectLeaderId&&""!==a.collectLeaderId||e.factorPoint===a.factorPoint&&t.$set(a,"collectLeaderId",e.collectLeaderId)}))}}},h=m,f=(a("3e0d"),a("7e2e"),a("955f"),a("2877")),b=Object(f["a"])(h,r,o,!1,null,"599450ee",null);t["default"]=b.exports},"50cf":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"合同编号:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"合同编号"},model:{value:e.searchForm.contCode,callback:function(t){e.$set(e.searchForm,"contCode",t)},expression:"searchForm.contCode"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.contName,callback:function(t){e.$set(e.searchForm,"contName",t)},expression:"searchForm.contName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.contractData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无合同信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"contCode",label:"合同编号",width:"190px",align:"center"}}),a("el-table-column",{attrs:{prop:"offerId",label:"报价单号",width:"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"partA",label:"客户名称","min-width":"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"signDate",label:"签订时间",width:"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"validity",label:"有效期",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.validity)+" 年\n        ")]}}])}),a("el-table-column",{attrs:{prop:"contStatus",label:"制作方式",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"0"===r.makeType?"success":""}},[e._v(e._s("0"===r.makeType?"在线制作":"本地上传"))])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.contStatus>0?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]):e._e(),"1"===r.contStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"1"===r.contStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApproveRes(r)}}},[e._v(" 审核")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"合同审核",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmApproveDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("35ad"),l=a("333d"),n={0:"待完善",6:"待提交",1:"待审核",2:"审核失败",4:"完成",5:"已作废"},i={components:{Pagination:l["a"]},data:function(){return{CONTRACT_STATUS:n,contractData:[],searchForm:{contCode:"",contName:"",contStatus:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,currentItem:{},approveForm:{contId:"",auditFlag:"1",auditReason:""}}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["c"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.contractData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){var t=this;s["e"](e.id).then((function(e){if(200===e.code&&e.result&&e.result.length>0){var a=e.result;t.$router.push({name:"sysPdfView",params:{path:a,type:1}})}else t.$message.error("合同PDF还未生成")}))},handleApproveRes:function(e){this.approveForm.contId=e.id,this.approveForm.auditFlag="1",this.approveForm.auditReason="",this.approveVisible=!0},confirmApproveDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},c=i,d=(a("7179"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"7fcdccee",null);t["default"]=u.exports},5208:function(e,t,a){"use strict";a("1c6b")},5337:function(e,t,a){"use strict";a("bf5b")},53987:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.offerId,callback:function(t){e.$set(e.searchForm,"offerId",t)},expression:"searchForm.offerId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"分包状态:"}},[a("el-select",{attrs:{placeholder:"分包状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"未处理",value:"0"}}),a("el-option",{attrs:{label:"已处理",value:"1"}})],1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.orderData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无分包信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",fixed:"left","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"offerId",label:"报价单号",width:"180px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkType",label:"检测类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("0"===a.checkType?"委托检测":"样品送检")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"consignorName",label:"客户名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"finishDate",label:"完成时间",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"createUserId",label:"报价人",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.status)}},[e._v("\n            "+e._s(e.ACCOUNT_STATUS[r.status])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),"0"===t.row.status?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"0"===t.row.status?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApprove(t.row)}}},[e._v(" 分包判定")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentRow.projectName+"-详情",visible:e.detailVisible,top:"5vh",width:"85%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-form",{attrs:{"label-width":"110px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"委托单位:"}},[e._v(e._s(e.currentRow.consignorName))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"完成时间:"}},[e._v(e._s(e.currentRow.finishDate))])],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"报价人:"}},[e._v(e._s(e.currentRow.createUserId))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.currentRow.remark?e.currentRow.remark:"-"))])],1)],1)],1),e.showJudgeArray&&e.showJudgeArray.length>0?a("el-card",{attrs:{shadow:"never"}},e._l(e.showJudgeArray,(function(t,r){return a("el-card",{key:r,staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s("-1"===t.organName?"自处理":t.organName)),a("i",{staticClass:"el-input__icon"})])]),a("el-table",{attrs:{data:t.factorVos,"header-cell-style":{background:"#ECF3FC"},"max-height":"400px"}},[a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号","min-width":"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{prop:"totalCost",label:"检测费用",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(parseFloat(a.costPerTime*a.dayCount*a.dayCount).toFixed(2))+"\n            ")]}}],null,!0)})],1)],1)})),1):e._e()],1),a("el-dialog",{attrs:{title:e.currentRow.projectName+"-调度",visible:e.approveVisible,center:"",fullscreen:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"委托单位:"}},[e._v(e._s(e.currentRow.consignorName))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"完成时间:"}},[e._v(e._s(e.currentRow.finishDate))])],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"报价人:"}},[e._v(e._s(e.currentRow.createUserId))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.currentRow.remark?e.currentRow.remark:"-"))])],1)],1)],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",{attrs:{gutter:3}},[a("el-col",{attrs:{span:6}},[a("span",[e._v("检测因子"),a("i",{staticClass:"el-input__icon"})])]),a("el-col",{staticStyle:{"text-align":"right","padding-top":"13px"},attrs:{span:8}},[a("span",{staticStyle:{color:"red"}},[e._v("若直接点击确认，则默认不分包，全部由本机构自行检测")])]),a("el-col",{attrs:{span:7}},[a("el-select",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{placeholder:"机构选择"},model:{value:e.judgeId,callback:function(t){e.judgeId=t},expression:"judgeId"}},e._l(e.judgeArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.judgeOrganName,value:e.id}})})),1)],1),a("el-col",{attrs:{span:3}},[a("el-button",{staticStyle:{float:"left",margin:"4px 2px"},attrs:{type:"primary",plain:""},on:{click:e.addJudge}},[e._v("确定分包")])],1)],1)],1),a("el-row",{staticStyle:{height:"45px"}},[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请录入因子"},model:{value:e.ableFactor,callback:function(t){e.ableFactor=t},expression:"ableFactor"}})],1),a("el-col",{staticStyle:{"text-align":"center","font-size":"16px","padding-top":"10px",color:"#1890FF"},attrs:{span:16}},[e._v("有能力")]),a("el-col",{staticStyle:{"text-align":"center","font-size":"16px",color:"#1890FF"},attrs:{span:4}})],1),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-table",{attrs:{data:e.ableFactorDt,"header-cell-style":{background:"#ECF3FC"},"max-height":"400px",border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{prop:"totalCost",label:"检测费用",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(parseFloat(a.costPerTime*a.dayCount*a.dayCount).toFixed(2))+"\n            ")]}}])})],1)],1),a("el-divider"),a("el-row",{staticStyle:{height:"45px","padding-top":"8px"}},[a("el-col",{staticStyle:{"text-align":"center","font-size":"16px",color:"#1890FF"},attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请录入因子"},model:{value:e.unAbleFactor,callback:function(t){e.unAbleFactor=t},expression:"unAbleFactor"}})],1),a("el-col",{staticStyle:{"text-align":"center","font-size":"16px","padding-top":"10px",color:"#1890FF"},attrs:{span:16}},[e._v("无能力")]),a("el-col",{staticStyle:{"text-align":"center","font-size":"16px",color:"#1890FF"},attrs:{span:4}})],1),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-table",{attrs:{data:e.unAbleFactorDt,"header-cell-style":{background:"#ECF3FC"},"max-height":"400px",border:""},on:{"selection-change":e.handleSelectionEnableChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{prop:"totalCost",label:"检测费用",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(parseFloat(a.costPerTime*a.dayCount*a.dayCount).toFixed(2))+"\n            ")]}}])})],1)],1)],1),e.outFactorData&&e.outFactorData.length>0?a("el-card",{attrs:{shadow:"never"}},e._l(e.outFactorData,(function(t,r){return a("el-card",{key:r,staticStyle:{"margin-top":"3px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("分包机构:"+e._s(t.judgeName)),a("i",{staticClass:"el-input__icon"})]),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return e.delJudge(t,r)}}},[e._v("删除")])],1),a("el-table",{attrs:{data:t.facotrs,"header-cell-style":{background:"#ECF3FC"},"max-height":"400px"}},[a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{prop:"totalCost",label:"检测费用",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(parseFloat(a.costPerTime*a.dayCount*a.dayCount).toFixed(2))+"\n            ")]}}],null,!0)})],1)],1)})),1):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1)],1)},o=[],s=a("75fc"),l=(a("7514"),a("ac6a"),a("e601")),n=a("b429"),i=a("b705"),c=a("333d"),d={0:"待处理",1:"已处理"},u={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},p={components:{Pagination:c["a"]},filters:{statusQualityFilter:function(e){var t={0:"",1:"success"};return t[e]}},data:function(){return{ACCOUNT_STATUS:d,CHECK_STATUS:u,orderData:[],searchForm:{offerId:"",projectName:"",status:"0",pageNumber:1,pageSize:10},total:0,approveVisible:!1,approveForm:{result:"0",remark:""},orderDetailForm:{offerId:"",offerBaseVo:{consignorName:"",consignorLinker:"",consignorLinkerPhone:"",createUserName:"",finishDate:"",remark:"",checkCircle:"",checkTaskCount:""},factorTdos:[],costVo:{},oncePrice:"",selfCostVos:[]},detailVisible:!1,factorData:[],enableFactorData:[],ableFactorData:[],outFactorData:[],multipleSelection:[],multipleEnableSelection:[],judgeId:"",judgeArray:[],showJudgeArray:[],currentRow:{},ableFactor:"",unAbleFactor:""}},computed:{ableFactorDt:function(){var e=this.ableFactor.trim();return e?this.ableFactorData.filter((function(t){return t.factorName.indexOf(e)>-1})):this.ableFactorData},unAbleFactorDt:function(){var e=this.unAbleFactor.trim();return e?this.enableFactorData.filter((function(t){return t.factorName.indexOf(e)>-1})):this.enableFactorData}},created:function(){this.getOutSourceCom(),this.handleSearch()},methods:{handleSearch:function(){var e=this;n["c"](this.searchForm).then((function(t){200===t.code&&(e.orderData=t.result.records,e.total=t.result.total)}))},getOutSourceCom:function(){var e=this;Object(i["f"])().then((function(t){e.judgeArray=t.result}))},handleDetail:function(e){var t=this;this.currentRow=Object.assign({},e),l["e"](e.offerId).then((function(e){t.showJudgeArray=e.result,t.detailVisible=!0}))},handleApprove:function(e){var t=this;this.currentRow=Object.assign({},e),this.enableFactorData=[],this.ableFactorData=[],this.outFactorData=[],this.judgeId="",l["h"](e.offerId).then((function(e){200===e.code&&e.result&&(t.factorData=e.result||[],e.result.forEach((function(e){"1"===e.extAssistFlg?t.enableFactorData.push(e):t.ableFactorData.push(e)})),t.approveVisible=!0)}))},addJudge:function(){var e=this;if(this.ableFactorData.length-this.multipleSelection.length<=0)this.$message.error("有能力检测因子项不能全部分包");else if(this.judgeId&&(this.multipleSelection||this.multipleEnableSelection)){var t=this.outFactorData.find((function(t){return t.judgeId===e.judgeId})),a=this.judgeArray.find((function(t){return t.id===e.judgeId})),r=this.multipleSelection;r=r.concat(this.multipleEnableSelection),t?t.facotrs=t.facotrs.concat(r):this.outFactorData.push({judgeId:this.judgeId,judgeName:a.judgeOrganName,facotrs:r}),this.multipleSelection.forEach((function(t){var a=e.ableFactorData.indexOf(t);-1!==a&&e.ableFactorData.splice(a,1)})),this.multipleEnableSelection.forEach((function(t){var a=e.enableFactorData.indexOf(t);-1!==a&&e.enableFactorData.splice(a,1)})),this.multipleSelection=[],this.multipleEnableSelection=[]}else this.$message.warning("请先选择分包机构,且因子不能为空")},handleSelectionChange:function(e){this.multipleSelection=e},handleSelectionEnableChange:function(e){this.multipleEnableSelection=e},delJudge:function(e,t){var a=this;if(e.facotrs){var r=Object(s["a"])(e.facotrs);this.outFactorData.splice(t,1),r.forEach((function(e){"1"===e.extAssistFlg?a.enableFactorData.push(e):a.ableFactorData.push(e)}))}},confirmDialog:function(){var e=this;if(this.enableFactorData.length>0)this.$message.error("无能力检测因子需要全部分包");else{var t=this.ableFactorData.map((function(e){return{planFactorId:e.planFactorId,organId:""}}));this.outFactorData.forEach((function(e){e.facotrs&&e.facotrs.forEach((function(a){t.push({planFactorId:a.planFactorId,organId:e.judgeId})}))})),this.$confirm("确定提交分包信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={offerId:e.currentRow.offerId,itemTdoList:t};n["e"](a).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.approveVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}}},m=p,h=(a("fa10"),a("ae59"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"321e8dd9",null);t["default"]=f.exports},5511:function(e,t,a){"use strict";a("22d12")},5544:function(e,t,a){"use strict";a("b4f2")},5589:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create-container"},[a("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"原密码:",prop:"oldPassword"}},[a("el-input",{attrs:{type:"password",maxlength:"15"},model:{value:e.userForm.oldPassword,callback:function(t){e.$set(e.userForm,"oldPassword",t)},expression:"userForm.oldPassword"}})],1),a("el-form-item",{attrs:{label:"新密码:",prop:"newPassword"}},[a("el-input",{attrs:{type:"password",maxlength:"15"},model:{value:e.userForm.newPassword,callback:function(t){e.$set(e.userForm,"newPassword",t)},expression:"userForm.newPassword"}})],1),a("el-form-item",{attrs:{label:"新密码确认:",prop:"confirmPasswordVis"}},[a("el-input",{attrs:{type:"password",maxlength:"15"},model:{value:e.userForm.confirmPasswordVis,callback:function(t){e.$set(e.userForm,"confirmPasswordVis",t)},expression:"userForm.confirmPasswordVis"}})],1),a("el-form-item",{staticStyle:{"text-align":"center","margin-top":"50px"}},[a("el-button",{staticClass:"iconfont icon-right_circle",attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("更新")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:""},on:{click:e.goBack}},[e._v("返回")])],1)],1)],1)},o=[],s=a("db72"),l=a("78b1"),n={components:{},data:function(){var e=this,t=function(e,t,a){t?t.length<6?a(new Error("密码固定长度不能低于6位")):a():a(new Error("录入信息不能为空"))},a=function(t,a,r){a?e.userForm.newPassword!==a?r(new Error("两次密码不相同!")):r():r(new Error("录入信息不能为空"))};return{userForm:{userId:this.$store.getters.userInfo.userId,oldPassword:"",newPassword:"",confirmPasswordVis:""},userRule:{oldPassword:[{required:!0,validator:t,trigger:"blur"}],newPassword:[{required:!0,validator:t,trigger:"blur"}],confirmPasswordVis:[{required:!0,validator:a,trigger:"blur"}]}}},computed:{},created:function(){},methods:{onSubmit:function(){var e=this;this.$refs.userForm.validate((function(t){if(!t)return!1;var a=Object(s["a"])({},e.userForm);e.$delete(a,"confirmPasswordVis"),Object(l["a"])(a).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.$router.back()):e.$notify({title:"失败",message:t.message,type:"error"})})).catch((function(){}))}))},resetForm:function(e){this.$refs[e].resetFields()},goBack:function(){this.$router.back()}}},i=n,c=(a("bb26"),a("2877")),d=Object(c["a"])(i,r,o,!1,null,"13d15914",null);t["default"]=d.exports},5620:function(e,t,a){},5788:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"岗位名称",prop:"postName"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入岗位名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.postName,callback:function(t){e.$set(e.queryParams,"postName",t)},expression:"queryParams.postName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"small"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:post:add"],expression:"['system:post:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("right-toolbar",{attrs:{"show-search":e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.postList}},[a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{label:"岗位名称",align:"center",prop:"postName"}}),a("el-table-column",{attrs:{label:"备注",align:"center","show-overflow-tooltip":"",prop:"remark"}}),a("el-table-column",{attrs:{label:"创建日期",align:"center",prop:"createTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime,"{y}-{m}-{d}")))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:post:edit"],expression:"['system:post:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")]),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:post:remove"],expression:"['system:post:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("el-dialog",{attrs:{title:e.title,visible:e.open,width:"550px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"岗位名称",prop:"postName"}},[a("el-input",{attrs:{placeholder:"请输入岗位名称"},model:{value:e.form.postName,callback:function(t){e.$set(e.form,"postName",t)},expression:"form.postName"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容","show-word-limit":"",rows:6,maxlength:"120"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},o=[],s=a("74b1"),l={0:"正常",1:"停用"},n={name:"Post",data:function(){return{POST_STATUS:l,loading:!0,exportLoading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,postList:[],title:"",open:!1,queryParams:{postCode:"",postName:"",status:"0"},form:{},rules:{postName:[{required:!0,message:"岗位名称不能为空",trigger:"blur"}]}}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.loading=!0,Object(s["d"])(this.queryParams).then((function(t){e.postList=t.result||[],e.loading=!1})).catch((function(){e.loading=!1}))},statusFormat:function(e,t){return l[e.status]},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={postId:void 0,postCode:"emp",postName:void 0,postSort:0,status:"0",remark:void 0},this.resetForm("form")},handleQuery:function(){this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleAdd:function(){this.reset(),this.open=!0,this.title="添加岗位"},handleUpdate:function(e){this.reset(),this.form.postId=e.postId,this.form.postName=e.postName,this.form.postSort=e.postSort,this.form.status=e.status,this.form.remark=e.remark,this.open=!0,this.title="修改岗位"},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(void 0!==e.form.postId?Object(s["f"])(e.form).then((function(t){e.msgSuccess("修改成功"),e.open=!1,e.getList()})):Object(s["a"])(e.form).then((function(t){e.msgSuccess("新增成功"),e.open=!1,e.getList()})))}))},handleDelete:function(e){var t=this,a=e.postId;this.$confirm('是否确认删除岗位为"'+e.postName+'"的数据信息?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["b"])(a)})).then((function(){t.getList(),t.msgSuccess("删除成功")})).catch((function(){}))},handleExport:function(){var e=this,t=this.queryParams;this.$confirm("是否确认导出所有岗位数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return e.exportLoading=!0,Object(s["c"])(t)})).then((function(t){e.download(t.msg),e.exportLoading=!1})).catch((function(){}))}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},5837:function(e,t,a){},"59e0":function(e,t,a){"use strict";a("e1e1")},"5ae4":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.taskData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无任务信息\n            ")])])])]),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"180px","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",width:"140px","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorLinker",label:"委托人",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",width:"140px","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{label:"要求完成时间",width:"190px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+" ~ "+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"进度",align:"center",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",{on:{mousedown:function(t){return e.showInfos(r)}}},[a("el-progress",{attrs:{"text-inside":!0,"stroke-width":14,percentage:r.process}})],1)]}}])}),a("el-table-column",{attrs:{prop:"taskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.taskStatus?"success":"primary"}},[e._v(e._s("1"===r.taskStatus?"已完成":"未完成"))])]}}])}),a("el-table-column",{attrs:{prop:"createTime",width:"155px",label:"创建时间",align:"center"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("详情")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"任务进度表",visible:e.taskInfosVisible},on:{"update:visible":function(t){e.taskInfosVisible=t}}},[a("div",{staticClass:"block"},[a("el-timeline",e._l(e.activitieModel,(function(t,r){return a("el-timeline-item",{key:r,attrs:{type:t.type,color:t.color,size:t.size,timestamp:t.timestamp}},[e._v("\n          "+e._s(t.content)+"\n        ")])})),1)],1)]),a("el-dialog",{attrs:{title:"因子调度详情",visible:e.factorVisible,width:"80%"},on:{"update:visible":function(t){e.factorVisible=t}}},[a("el-table",{attrs:{data:e.factorData,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别","min-width":"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v("\n          "+e._s(r.factorName)),a("span",{staticStyle:{color:"red"}},[e._v(e._s(r.meanName&&r.meanName.length>0?"("+r.meanName+")":""))])]}}])}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(Number(a.dayCount*a.frequency))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"是否合样",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.hyFlag?"Y":"N")+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"是否分包",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.fbFlag?"Y":"N")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"factorRemark",label:"备注","min-width":"110",align:"center"}})],1)],1)],1)},o=[],s=(a("c5f6"),a("b199")),l=a("333d"),n={components:{Pagination:l["a"]},data:function(){return{taskData:[],searchForm:{jobId:"",projectName:"",pageNumber:1,pageSize:10},total:0,activitieModel:[],taskInfosVisible:!1,factorData:[],factorVisible:!1}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["j"](this.searchForm).then((function(t){200===t.code&&(e.taskData=t.result.records.map((function(t){return""!==t.reportStatus&&"6"===t.reportStatus?e.$set(t,"taskStatus","1"):e.$set(t,"taskStatus","0"),e.doProcessList(t),t}))||[],e.total=t.result.total)}))},doProcessList:function(e){var t=[{name:"任务单",content:"任务单",timestamp:"",size:"normal",type:"success"},{name:"采样",content:"采样",timestamp:"",size:"normal",type:"info"},{name:"检测",content:"检测",timestamp:"",size:"normal",type:"info"},{name:"报告生成",content:"报告生成",timestamp:"",size:"normal",type:"info"},{attr:"报告审核",content:"报告审核",timestamp:"",size:"normal",type:"info"},{attr:"报告签发",content:"报告签发",timestamp:"",size:"normal",type:"info"}],a=1;"1"===e.isSampled&&(t[1].type="success",a++),"1"===e.isChecked&&(t[2].type="success",a++),e.reportStatus>=1&&7!==e.reportStatus&&(t[3].type="success",a++),e.reportStatus>=4&&7!==e.reportStatus&&(t[4].type="success",a++),e.reportStatus>=5&&7!==e.reportStatus&&(t[5].type="success",a++),a>=1&&a<3&&(t[1].type="warning",t[2].type="warning"),a>=3&&(t[1].type="success",t[2].type="success",t[3].type="warning",4===a?(t[3].type="success",t[4].type="warning"):5===a?(t[3].type="success",t[4].type="success",t[5].type="warning"):6===a&&(t[3].type="success",t[4].type="success",t[5].type="success")),this.$set(e,"infoList",t),this.$set(e,"process",parseInt(Number(a/6*100).toFixed(0)))},showInfos:function(e){this.activitieModel=[],this.activitieModel=e.infoList,this.taskInfosVisible=!0},handleDetail:function(e){var t=this;s["h"](e.jobId).then((function(e){t.factorData=e.result.map((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}return e})),t.factorVisible=!0}))}}},i=n,c=(a("8180"),a("d758"),a("2877")),d=Object(c["a"])(i,r,o,!1,null,"9443b908",null);t["default"]=d.exports},"5b60":function(e,t,a){"use strict";a("e668")},"5b77":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{attrs:{label:"车辆编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"车辆编号"},model:{value:e.searchForm.carBaseNumber,callback:function(t){e.$set(e.searchForm,"carBaseNumber",t)},expression:"searchForm.carBaseNumber"}})],1),a("el-form-item",{attrs:{label:"车牌号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"车牌号"},model:{value:e.searchForm.carNumber,callback:function(t){e.$set(e.searchForm,"carNumber",t)},expression:"searchForm.carNumber"}})],1),a("el-form-item",{attrs:{label:"车辆状态:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"车辆状态"},model:{value:e.searchForm.carStatus,callback:function(t){e.$set(e.searchForm,"carStatus",t)},expression:"searchForm.carStatus"}},e._l(Object.keys(e.USE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.USE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:3}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.carData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无数据\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"carBaseNumber",label:"车辆编号",align:"center"}}),a("el-table-column",{attrs:{prop:"carNumber",label:"车牌号",align:"center"}}),a("el-table-column",{attrs:{prop:"carType",label:"品牌型号",align:"center"}}),a("el-table-column",{attrs:{prop:"location",label:"当前位置",align:"center"}}),a("el-table-column",{attrs:{prop:"repairTime",label:"维保时间",align:"center"}}),a("el-table-column",{attrs:{prop:"carStatus",label:"车辆状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(e.USE_STATUS[a.carStatus])+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"username",label:"使用人员",align:"center"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",width:"130px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v(" 删除")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDispatch(t.row.id)}}},[e._v(" 调度")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.carDialogStatus],visible:e.carDialogVisible,width:"600px",center:""},on:{"update:visible":function(t){e.carDialogVisible=t}}},[a("div",{staticStyle:{padding:"30px"}},[a("el-form",{ref:"carForm",attrs:{model:e.carForm,rules:e.carRules,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"carBaseNumber",label:"车辆编号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请录入车辆编号",maxlength:"25"},model:{value:e.carForm.carBaseNumber,callback:function(t){e.$set(e.carForm,"carBaseNumber",t)},expression:"carForm.carBaseNumber"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"carNumber",label:"车牌号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请录入车牌号",maxlength:"25"},model:{value:e.carForm.carNumber,callback:function(t){e.$set(e.carForm,"carNumber",t)},expression:"carForm.carNumber"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"carType",label:"品牌型号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请录入品牌型号",maxlength:"25"},model:{value:e.carForm.carType,callback:function(t){e.$set(e.carForm,"carType",t)},expression:"carForm.carType"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"location",label:"当前位置:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"当前位置",maxlength:"20"},model:{value:e.carForm.location,callback:function(t){e.$set(e.carForm,"location",t)},expression:"carForm.location"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"repairTime",label:"维保日期:"}},[a("el-date-picker",{staticStyle:{width:"80%"},attrs:{"value-format":"yyyy-MM-dd",placeholder:"维保日期"},model:{value:e.carForm.repairTime,callback:function(t){e.$set(e.carForm,"repairTime",t)},expression:"carForm.repairTime"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"remark",label:"备注:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",rows:3,placeholder:"备注",maxlength:"50"},model:{value:e.carForm.remark,callback:function(t){e.$set(e.carForm,"remark",t)},expression:"carForm.remark"}})],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.carDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"车辆调度",visible:e.carDisVisible,width:"600px",center:""},on:{"update:visible":function(t){e.carDisVisible=t}}},[a("el-form",{ref:"disForm",attrs:{model:e.disForm,rules:e.disRules,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"车辆状态:"}},[a("el-radio-group",{model:{value:e.disForm.carStatus,callback:function(t){e.$set(e.disForm,"carStatus",t)},expression:"disForm.carStatus"}},[a("el-radio",{attrs:{label:0}},[e._v("闲置中")]),a("el-radio",{attrs:{label:1}},[e._v("使用中")]),a("el-radio",{attrs:{label:2}},[e._v("维修中")])],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"location",label:"当前位置:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"当前位置",maxlength:"20"},model:{value:e.disForm.location,callback:function(t){e.$set(e.disForm,"location",t)},expression:"disForm.location"}})],1)],1),1==e.disForm.carStatus?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"username",label:"使用人员:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请录入使用人员",maxlength:"25"},model:{value:e.disForm.username,callback:function(t){e.$set(e.disForm,"username",t)},expression:"disForm.username"}})],1)],1):e._e(),1==e.disForm.carStatus?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"linkmethod",label:"联系电话:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请录联系电话",maxlength:"25"},model:{value:e.disForm.linkmethod,callback:function(t){e.$set(e.disForm,"linkmethod",t)},expression:"disForm.linkmethod"}})],1)],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.carDisVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDisDialog}},[e._v("确认")])],1)],1)],1)},o=[],s=a("333d"),l=a("b775");function n(e){return Object(l["a"])({url:"/car/findByCondition",method:"get",params:e})}function i(e){return Object(l["a"])({url:"/car/add",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/car/updateById",method:"post",data:e})}function d(e){return Object(l["a"])({url:"/car/carScheduling",method:"post",data:e})}var u=a("61f7"),p=a("b705"),m={0:"闲置中",1:"使用中",2:"维修中"},h={components:{Pagination:s["a"]},data:function(){var e=function(e,t,a){t&&t.length>0?Object(u["d"])(t)?a():a(new Error("输入正确的电话号码")):a()};return{USE_STATUS:m,searchForm:{carBaseNumber:"",carNumber:"",carStatus:"",pageNumber:1,pageSize:10},total:0,carData:[],carDialogStatus:"create",carDialogVisible:!1,titleMap:{edit:"修改车辆",create:"新增车辆"},carForm:{id:"",carBaseNumber:"",carNumber:"",carType:"",location:"",repairTime:"",remark:""},carDisVisible:!1,disForm:{carId:"",carStatus:0,username:0,linkmethod:"",location:""},carRules:{carBaseNumber:[{required:!0,message:"请录入车辆编号",trigger:"blur"}],carNumber:[{required:!0,message:"请录入车牌号",trigger:"blur"}],carType:[{required:!0,message:"请录入品牌型号",trigger:"blur"}],location:[{required:!0,message:"请录入当前位置",trigger:"blur"}]},disRules:{location:[{required:!0,message:"请录入当前位置",trigger:"blur"}],username:[{required:!0,message:"请录入使用人员",trigger:"blur"}],linkmethod:[{required:!0,message:"请录联系电话",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}]}}},created:function(){this.handleSearch()},methods:{getDicKey:function(e,t){var a=this;p["g"](t).then((function(t){200===t.code&&(a[e]=t.result)}))},handleSearch:function(){var e=this;n(this.searchForm).then((function(t){200===t.code&&(e.carData=t.result.records||[],e.total=t.result.total)}))},handleDispatch:function(e){this.disForm={carId:e,carStatus:0,username:"",linkmethod:"",location:""},this.carDisVisible=!0},handleAdd:function(){this.clearForm(),this.carDialogStatus="create",this.carDialogVisible=!0},handleUpdate:function(e){this.clearForm(),this.carForm.id=e.id,this.carForm.carBaseNumber=e.carBaseNumber,this.carForm.carNumber=e.carNumber,this.carForm.carType=e.carType,this.carForm.location=e.location,this.carForm.repairTime=e.repairTime,this.carForm.remark=e.remark,this.carDialogStatus="edit",this.carDialogVisible=!0},clearForm:function(){this.carForm={id:"",carBaseNumber:"",carNumber:"",carType:"",location:"",repairTime:"",remark:""}},confirmDisDialog:function(){var e=this;this.$refs.disForm.validate((function(t){if(!t)return!1;d(e.disForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.carDisVisible=!1,e.$refs.disForm.resetFields()})).catch((function(){}))}))},confirmDialog:function(){var e=this;"create"===this.carDialogStatus?i(this.carForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.carDialogVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})):c(this.carForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.carDialogVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))},handleDelete:function(e){var t=this;this.$confirm("是否确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(void 0)(e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))}}},f=h,b=(a("7b74"),a("2877")),g=Object(b["a"])(f,r,o,!1,null,"235a679e",null);t["default"]=g.exports},"5c4e":function(e,t,a){},"5cfa":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"部门名称",prop:"deptName"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入部门名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.deptName,callback:function(t){e.$set(e.queryParams,"deptName",t)},expression:"queryParams.deptName"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"部门状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},[a("el-option",{attrs:{label:"正常",value:"0"}}),a("el-option",{attrs:{label:"停用",value:"1"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"small"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:dept:add"],expression:"['system:dept:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("right-toolbar",{attrs:{"show-search":e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.deptList,"row-key":"deptId","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{prop:"deptName",label:"部门名称",width:"260"}}),a("el-table-column",{key:"status",attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"0"===t.row.status?"success":"danger"}},[e._v(e._s("0"===t.row.status?"正常":"停用"))])]}}])}),a("el-table-column",{attrs:{label:"创建日期",align:"center",prop:"createTime",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime,"{y}-{m}-{d}")))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[0!=t.row.parentId?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:dept:edit"],expression:"['system:dept:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e(),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:dept:add"],expression:"['system:dept:add']"}],attrs:{size:"mini",type:"text",icon:"el-icon-plus"},on:{click:function(a){return e.handleAdd(t.row)}}},[e._v("新增")]),0!=t.row.parentId?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:dept:remove"],expression:"['system:dept:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),a("el-dialog",{attrs:{title:e.title,visible:e.open,width:"620px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-row",{attrs:{gutter:20}},[0!==e.form.parentId&&"0"!==e.form.parentId?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"上级部门",prop:"parentId"}},[a("treeselect",{attrs:{options:e.deptOptions,normalizer:e.normalizer,placeholder:"选择上级部门"},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1)],1):e._e(),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"部门名称",prop:"deptName"}},[a("el-input",{attrs:{placeholder:"请输入部门名称"},model:{value:e.form.deptName,callback:function(t){e.$set(e.form,"deptName",t)},expression:"form.deptName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"负责人",prop:"leader"}},[a("el-input",{attrs:{placeholder:"请输入负责人",maxlength:"20"},model:{value:e.form.leader,callback:function(t){e.$set(e.form,"leader",t)},expression:"form.leader"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"部门状态"}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:"0"}},[e._v("正常")]),a("el-radio",{attrs:{label:"1"}},[e._v("停用")])],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},o=[],s=a("b775");function l(e){return Object(s["a"])({url:"/dept/selectDeptList",method:"get",params:e})}function n(e){return Object(s["a"])({url:"/dept/selectDeptById/"+e,method:"get"})}function i(e){return Object(s["a"])({url:"/dept/insertDept",method:"post",data:e})}function c(e){return Object(s["a"])({url:"/dept/updateDept",method:"post",data:e})}function d(e){return Object(s["a"])({url:"/dept/deleteDeptById/"+e,method:"get"})}var u=a("ca17"),p=a.n(u),m=(a("542c"),{name:"Dept",components:{Treeselect:p.a},data:function(){return{loading:!0,showSearch:!0,deptList:[],deptOptions:[],title:"",open:!1,statusOptions:[],queryParams:{deptName:"",status:""},form:{},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]}}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.loading=!0,l(this.queryParams).then((function(t){e.deptList=e.handleTree(t.result,"deptId"),e.loading=!1}))},normalizer:function(e){return e.children&&!e.children.length&&delete e.children,{id:e.deptId,label:e.deptName,children:e.children}},statusFormat:function(e,t){return"0"===e.status?"正常":"停用"},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={deptId:void 0,parentId:void 0,deptName:void 0,orderNum:0,leader:void 0,status:"0"},this.resetForm("form")},handleQuery:function(){this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleAdd:function(e){var t=this;this.reset(),void 0!==e&&(this.form.parentId=e.deptId),this.open=!0,this.title="添加部门",l({deptName:"",status:""}).then((function(e){t.deptOptions=t.handleTree(e.result,"deptId")}))},handleUpdate:function(e){var t=this;this.reset(),n(e.deptId).then((function(e){t.form=e.result,t.open=!0,t.title="修改部门"})),0!==e.parentId&&"0"!==e.parentId&&l({deptName:"",status:""}).then((function(e){t.deptOptions=t.handleTree(e.result,"deptId")}))},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(void 0!==e.form.deptId?c(e.form).then((function(t){e.msgSuccess("修改成功"),e.open=!1,e.getList()})):i(e.form).then((function(t){e.msgSuccess("新增成功"),e.open=!1,e.getList()})))}))},handleDelete:function(e){var t=this;this.$confirm('是否确认删除名称为"'+e.deptName+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return d(e.deptId)})).then((function(){t.getList(),t.msgSuccess("删除成功")})).catch((function(){}))}}}),h=m,f=a("2877"),b=Object(f["a"])(h,r,o,!1,null,null,null);t["default"]=b.exports},"5dc5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),a("el-form-item",{attrs:{label:"报价单状态:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"报价单状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(Object.keys(e.ACCOUNT_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.ACCOUNT_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:add"],expression:"['order:list:add']"}],attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.orderData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无报价单,\n            ")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"mini"},on:{click:e.handleCreate}},[e._v("新建报价单")])],1)])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"报价单号",sortable:"",width:"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkType",label:"检测类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("0"===a.checkType?"委托检测":"样品送检")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"certificationType",label:"认证类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.certificationType?"CMA":"CNAS")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"consignorName",label:"客户名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.status)}},[e._v("\n            "+e._s(e.ACCOUNT_STATUS[r.status])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"finishDate",label:"客户要求完成时间",width:"140",align:"center"}}),a("el-table-column",{attrs:{prop:"createUserId",label:"报价人",align:"center"}}),a("el-table-column",{attrs:{prop:"draftAmount",label:"费用总计(元)","min-width":"100",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]),a("div",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],staticClass:"erc-divider-vertical"}),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],attrs:{type:"text"},on:{click:function(t){return e.handleCopy(r)}}},[e._v(" 复制")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-dropdown",{attrs:{size:"medium"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n              更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["0"===r.status||"2"===r.status?a("el-link",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],attrs:{underline:!1},on:{click:function(t){return e.handleUpdate(r)}}},[a("el-dropdown-item",[e._v("编辑")])],1):e._e(),"0"===r.status||"2"===r.status?a("el-link",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],attrs:{underline:!1},on:{click:function(t){return e.handleApprovel(r.id)}}},[a("el-dropdown-item",[e._v("提交审核")])],1):e._e(),"0"===r.status||"2"===r.status||"4"===r.status?a("el-link",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:del"],expression:"['order:list:del']"}],attrs:{underline:!1},on:{click:function(t){return e.handleDelete(r.id)}}},[a("el-dropdown-item",[e._v("删除")])],1):e._e(),a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("WORD下载")])],1),a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleExcelDownload(r)}}},[a("el-dropdown-item",[e._v("EXCEL下载")])],1),r.status>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleApproveDetail(r)}}},[a("el-dropdown-item",[e._v("审核历史")])],1):e._e()],1)],1)]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.orderDialogStatus],visible:e.orderDialogVisible,"before-close":e.handleDialogClose,fullscreen:"",center:""},on:{"update:visible":function(t){e.orderDialogVisible=t}}},[a("el-form",{ref:"orderForm",attrs:{model:e.orderForm,rules:e.orderRules}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("项目基础信息"),a("i",{staticClass:"el-input__icon"})])]),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.projectName",label:"项目名称:","label-width":"100px"}},[a("el-input",{attrs:{placeholder:"项目名称",maxlength:"30","show-word-limit":""},model:{value:e.orderForm.offerInfoTdo.projectName,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"projectName",t)},expression:"orderForm.offerInfoTdo.projectName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.finishDate","label-width":"115px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                完成日期\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"客户要求的项目完成时间"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"完成日期"},model:{value:e.orderForm.offerInfoTdo.finishDate,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"finishDate",t)},expression:"orderForm.offerInfoTdo.finishDate"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.certificationType",label:"认证类型:","label-width":"100px"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"检测类型"},model:{value:e.orderForm.offerInfoTdo.certificationType,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"certificationType",t)},expression:"orderForm.offerInfoTdo.certificationType"}},[a("el-option",{attrs:{value:"1",label:"CMA"}}),a("el-option",{attrs:{value:"2",label:"CNAS"}})],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.consignorName",label:"委托单位:","label-width":"100px"}},[a("el-input",{attrs:{placeholder:"委托单位",maxlength:"25"},model:{value:e.orderForm.offerInfoTdo.consignorName,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"consignorName",t)},expression:"orderForm.offerInfoTdo.consignorName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.consignorLinker",label:"委托人:","label-width":"110px"}},[a("el-input",{attrs:{placeholder:"委托人",maxlength:"10"},model:{value:e.orderForm.offerInfoTdo.consignorLinker,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"consignorLinker",t)},expression:"orderForm.offerInfoTdo.consignorLinker"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.consignorLinkerPhone",label:"联系电话:","label-width":"100px"}},[a("el-input",{attrs:{placeholder:"联系电话",maxlength:"15"},model:{value:e.orderForm.offerInfoTdo.consignorLinkerPhone,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"consignorLinkerPhone",t)},expression:"orderForm.offerInfoTdo.consignorLinkerPhone"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                备注\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该备注信息可展示给业务负责人和调度负责人查看"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input",{attrs:{type:"textarea",rows:2,"show-word-limit":"",placeholder:"备注",maxlength:"100"},model:{value:e.orderForm.offerInfoTdo.remark,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"remark",t)},expression:"orderForm.offerInfoTdo.remark"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                说明\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该说明信息会自动填充到生成的报价单中，位于报价单下方的说明框"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input",{attrs:{type:"textarea",rows:2,"show-word-limit":"",placeholder:"说明",maxlength:"100"},model:{value:e.orderForm.offerInfoTdo.explains,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"explains",t)},expression:"orderForm.offerInfoTdo.explains"}})],1)],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px","padding-bottom":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("监测计划信息"),a("i",{staticClass:"el-input__icon"})]),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.addPlanInfo}},[e._v("新增计划")])],1),a("el-table",{attrs:{data:e.orderForm.offerPlanTdos,stripe:"",border:"","highlight-current-row":"","show-summary":"","summary-method":e.getSummaries,"header-cell-style":{background:"#ECF3FC"},"max-height":"400px"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),a("el-table-column",{attrs:{label:"计划名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{placeholder:""},model:{value:r.planName,callback:function(t){e.$set(r,"planName",t)},expression:"row.planName"}})]}}])}),a("el-table-column",{attrs:{prop:"checkFreq",label:"监测频次",align:"center"}}),a("el-table-column",{attrs:{prop:"execTimes",label:"计划执行次数",align:"center"}}),a("el-table-column",{attrs:{prop:"planTime",label:"计划时长",align:"center"}}),a("el-table-column",{attrs:{prop:"checkFactorCnt",label:"检测因子数",align:"center"}}),a("el-table-column",{attrs:{prop:"checkFee",label:"检测费用",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(parseFloat(a.checkFee*a.execTimes).toFixed(2))+"\n            ")]}}])}),a("el-table-column",{attrs:{prop:"index",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index,o=t.row;return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.planSearch(o)}}},[e._v("查看")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.planUpdate(o)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.planDelete(r)}}},[e._v("删除")])]}}])})],1)],1),a("el-card",{staticStyle:{"margin-top":"10px","padding-bottom":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("费用设置"),a("i",{staticClass:"el-input__icon"})])]),a("el-row",{staticStyle:{"margin-top":"15px"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{"label-width":"135px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                报告编制费(%)\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务报告编制费所占总检测费的比例"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input-number",{staticClass:"i-input",staticStyle:{width:"75%"},attrs:{size:"small","controls-position":"right",precision:0,min:0,max:100,placeholder:"报告编制费"},model:{value:e.orderForm.offerCostTdo.reportAmountRate,callback:function(t){e.$set(e.orderForm.offerCostTdo,"reportAmountRate",t)},expression:"orderForm.offerCostTdo.reportAmountRate"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                加急费(元)\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务加急费"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input-number",{staticStyle:{width:"75%"},attrs:{size:"small",min:0,"controls-position":"right",precision:2,max:99999.99,placeholder:"加急费"},model:{value:e.orderForm.offerCostTdo.expediteAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"expediteAmount",t)},expression:"orderForm.offerCostTdo.expediteAmount"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("采样费(元)\n                "),a("el-popover",{attrs:{slot:"suffix",placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务费用"},slot:"suffix"},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v(":")],1),a("el-input-number",{staticStyle:{width:"75%"},attrs:{size:"small",min:0,"controls-position":"right",precision:2,max:99999.99,placeholder:"采样费"},model:{value:e.orderForm.offerCostTdo.laborAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"laborAmount",t)},expression:"orderForm.offerCostTdo.laborAmount"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("差旅费(元)\n                "),a("el-popover",{attrs:{slot:"suffix",placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务费用"},slot:"suffix"},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v(":")],1),a("el-input-number",{staticStyle:{width:"75%"},attrs:{size:"small",min:0,"controls-position":"right",max:99999.99,precision:2,placeholder:"差旅费"},model:{value:e.orderForm.offerCostTdo.tripAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"tripAmount",t)},expression:"orderForm.offerCostTdo.tripAmount"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{"label-width":"135px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                税率(%)\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务费用"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input-number",{staticClass:"i-input",staticStyle:{width:"75%"},attrs:{size:"small",max:100,"controls-position":"right",precision:0,min:0,placeholder:"税率"},model:{value:e.orderForm.offerCostTdo.taxAmountRate,callback:function(t){e.$set(e.orderForm.offerCostTdo,"taxAmountRate",t)},expression:"orderForm.offerCostTdo.taxAmountRate"}})],1)],1),e._l(e.orderForm.selfCostTdos,(function(t,r){return a("el-col",{key:r,attrs:{span:6}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("div",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.selfName)+":")]),a("el-input-number",{staticStyle:{width:"75%","margin-right":"3px"},attrs:{min:0,size:"small","controls-position":"right",max:99999.99,placeholder:"金额信息"},model:{value:t.amount,callback:function(a){e.$set(t,"amount",a)},expression:"item.amount"}}),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeDomain(t)}}},[e._v("删除")])],1)],1)})),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:e.showAddPrice}},[e._v("新增费用")])],1)],1)],2)],1),a("el-card",{staticStyle:{"margin-top":"10px","padding-bottom":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("费用统计"),a("i",{staticClass:"el-input__icon"})])]),a("el-form",{attrs:{"label-width":"130px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"检测费合计:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.checkAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"报告编制费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.reportAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"报告加急费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.expediteAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"采样费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.laborAmount)))]),e._v(" 元\n              ")])],1)],1),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"差旅费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.tripAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"税额:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.taxAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"额外费用:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.otherPrice)))]),e._v(" 元\n              ")])],1)],1)],1),a("el-divider"),a("el-row",[a("el-col",{attrs:{span:6}},[e._v("\n             \n          ")]),a("el-col",{staticStyle:{"line-heigh":"2em"},attrs:{span:6}},[a("div",{staticStyle:{position:"relative",display:"inline-flex","line-height":"2em"}},[a("span",{staticStyle:{padding:"0 12px 0 0",width:"130px","text-align":"right"}},[e._v("费用总计:")]),a("div",{staticStyle:{position:"relative",width:"130px",padding:"0 15px"}},[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.sysAmount)))]),e._v("元\n            ")])]),a("el-col",{attrs:{span:6}},[a("div",{staticStyle:{position:"relative",display:"inline-flex","line-height":"2em"}},[a("span",{staticStyle:{padding:"0 12px 0 0",width:"130px","text-align":"right"}},[e._v("优惠价:")]),a("div",{staticStyle:{position:"relative",width:"130px"}},[a("el-input-number",{staticClass:"right-input",attrs:{"controls-position":"right",min:1,size:"small"},on:{change:e.validatoProInput},model:{value:e.orderForm.offerCostTdo.draftAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"draftAmount",t)},expression:"orderForm.offerCostTdo.draftAmount"}})],1),a("span",{staticStyle:{"margin-left":"15px"}},[e._v("元")])])]),a("el-col",{attrs:{span:6}},[a("div",{staticStyle:{position:"relative",display:"inline-flex","line-height":"2em"}},[a("span",{staticStyle:{padding:"0 12px 0 0",width:"130px","text-align":"right"}},[e._v("检测费折扣率(%):")]),e._v("\n              "+e._s(e.checkCostRate?e.checkCostRate:0)+"\n            ")])])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.orderDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1),a("el-dialog",{attrs:{title:"额外费用",visible:e.innerPriceVisible,"append-to-body":"",width:"60%",top:"5vh"},on:{"update:visible":function(t){e.innerPriceVisible=t}}},[a("div",{staticStyle:{width:"450px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.addPriceForm,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"费用名目:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"费用名目",maxlength:"6","show-word-limit":""},model:{value:e.addPriceForm.selfName,callback:function(t){e.$set(e.addPriceForm,"selfName",t)},expression:"addPriceForm.selfName"}})],1),a("el-form-item",{attrs:{label:"金额(元):"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"金额"},model:{value:e.addPriceForm.amount,callback:function(t){e.$set(e.addPriceForm,"amount",t)},expression:"addPriceForm.amount"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.innerPriceVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmPrice}},[e._v("确认")])],1)])],1),a("el-dialog",{attrs:{title:"报价单("+e.orderDetailForm.offerId+")",visible:e.detailVisible,top:"5vh",width:"70%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"135px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户名称:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorName||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系人:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinker||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinkerPhone||""))])],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户要求完成时间:"}},[e._v(e._s(e._f("Time2Format")(e.orderDetailForm.offerBaseVo.finishDate)))])],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.remark||""))])],1)],1)],1),e._l(e.orderDetailPlans,(function(t,r){return a("div",{key:r},[a("el-divider",[e._v(e._s(t.planName)+"-计划因子列表")]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0"}},[a("thead",[a("tr",[a("th",{attrs:{rowspan:"2"}},[e._v("序号")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测类别")]),a("th",{attrs:{colspan:"3"}},[e._v("检测项目")]),a("th",{attrs:{rowspan:"2"}},[e._v("频次(次/天)")]),a("th",{attrs:{rowspan:"2"}},[e._v("天数")]),a("th",{attrs:{rowspan:"2"}},[e._v("监测频次")]),a("th",{attrs:{rowspan:"2"}},[e._v("执行次数")]),a("th",{attrs:{rowspan:"2"}},[e._v("总数")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测单价(元)")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测费(元)")])]),a("tr",[a("th",[e._v("序号")]),a("th",[e._v("检测位置")]),a("th",[e._v("因子")])])]),a("tbody",[e._l(t.factorTdos,(function(r,o){return a("tr",{key:o},[0==r.frIndex?[a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.id))]),a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.secName))])]:e._e(),a("td",[e._v(e._s(r.sid))]),a("td",[e._v(e._s(r.factorPoint))]),a("td",[e._v(e._s(r.factorName)+e._s(r.meanName&&r.meanName.length>0?"("+r.meanName+")":""))]),a("td",[e._v(e._s(r.frequency))]),a("td",[e._v(e._s(r.dayCount))]),0==o?[a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.checkFreq))]),a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.execTimes))])]:e._e(),a("td",[e._v(e._s(Number(r.frequency*r.dayCount*t.execTimes).toFixed(0)))]),a("td",[e._v(e._s(r.costPerTime))]),a("td",[e._v(e._s(parseFloat(r.costPerTime*r.frequency*r.dayCount*t.execTimes).toFixed(2)))])],2)})),a("tr",[a("td",{attrs:{colspan:"11"}},[e._v("检测费合计")]),a("td",[e._v(e._s(parseFloat(t.checkFee*t.execTimes).toFixed(2)))])])],2)])])],1)})),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0  "}},[a("tbody",[a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("检测费合计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.checkAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告编制费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.reportAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告加急费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.expediteAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("采样费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.laborAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("差旅费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.tripAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("税额")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.taxAmount)))])]),e.orderDetailForm.selfCostVos?e._l(e.orderDetailForm.selfCostVos,(function(t,r){return a("tr",{key:r},[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(t.selfName))]),a("td",[e._v(e._s(e._f("MoneyFormat")(t.amount)))])])})):e._e(),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("总计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.sysAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("优惠价")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.draftAmount)))])]),a("tr",[a("td",{staticStyle:{width:"20%"}},[e._v("大写：")]),a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(e._f("Money2Chinese")(e.orderDetailForm.costVo.draftAmount)))])])],2)])])],2),a("el-dialog",{attrs:{title:"审核历史",visible:e.approveVisible,width:"75%"},on:{"update:visible":function(t){e.approveVisible=t}}},[a("el-table",{attrs:{data:e.approveDetails,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"0"===r.isPass?"success":"danger"}},[e._v(e._s("0"===r.isPass?"审核通过":"审核不通过"))])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"审核说明",align:"center"}}),a("el-table-column",{attrs:{prop:"approvalUserName",label:"审批用户",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"审批时间",align:"center"}})],1)],1),a("el-dialog",{attrs:{visible:e.planInfoVisible,title:"新增计划","append-to-body":"",fullscreen:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.planInfoVisible=t}}},[a("el-form",{attrs:{model:e.planForm,inline:""}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"计划名称:"}},[a("el-input",{attrs:{placeholder:"计划名称"},model:{value:e.planForm.planName,callback:function(t){e.$set(e.planForm,"planName",t)},expression:"planForm.planName"}})],1)],1),a("el-col",{attrs:{span:18}},[a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n              选择监测频次\n              "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"监测计划的频次"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n              :\n            ")],1),a("el-select",{attrs:{placeholder:"选择监测频次"},on:{change:e.reflushTime},model:{value:e.planForm.checkFreq,callback:function(t){e.$set(e.planForm,"checkFreq",t)},expression:"planForm.checkFreq"}},e._l(e.checkFreqArray,(function(e){return a("el-option",{key:e.desc,attrs:{label:e.desc,value:e.desc}})})),1)],1),a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n              计划执行次数\n              "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该监测计划一共需要执行的总次数"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n              :\n            ")],1),a("el-input-number",{attrs:{min:0,step:1,precision:0,disabled:"单次"===e.planForm.checkFreq,"controls-position":"right",placeholder:"计划执行次数"},on:{change:e.reflushTime},model:{value:e.planForm.execTimes,callback:function(t){e.$set(e.planForm,"execTimes",t)},expression:"planForm.execTimes"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.planForm.planTime.length>0,expression:"planForm.planTime.length > 0"}],attrs:{label:"计划时长:"}},[e._v("\n            "+e._s(e.planForm.planTime)+"\n          ")])],1)],1)],1),a("el-card",{staticStyle:{width:"100%","min-height":"500px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("检测因子信息"),a("i",{staticClass:"el-input__icon"})]),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.choseGroup}},[e._v("选择因子套餐")]),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.addFactor}},[e._v("添加因子")])],1),a("el-table",{attrs:{data:e.planForm.factorTdoList,stripe:"",border:"","highlight-current-row":"","show-summary":"","summary-method":e.getPlanSummaries,"header-cell-style":{background:"#ECF3FC"},"max-height":"700px"}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                暂无因子\n              ")])])])]),a("el-table-column",{attrs:{prop:"factorPoint",label:"位置","min-width":"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{placeholder:"请录入位置"},model:{value:r.factorPoint,callback:function(t){e.$set(r,"factorPoint",t)},expression:"row.factorPoint"}})]}}])}),a("el-table-column",{attrs:{prop:"className",label:"对象",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"类别",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.meanName&&r.meanName.length>0?[e._v("\n              "+e._s(r.secdClassName)),a("span",{staticStyle:{color:"red"}},[e._v(e._s("("+r.meanName+")"))])]:[e._v("\n              "+e._s(r.secdClassName)+"\n            ")]]}}])}),a("el-table-column",{attrs:{prop:"factorName",label:"因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号","min-width":"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"标准名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",disabled:"002001"===r.secdClassId||"002003"===r.secdClassId,min:1,step:1,precision:0,"controls-position":"right"},on:{change:function(t){return e.reflushMoney(r)}},model:{value:r.dayCount,callback:function(t){e.$set(r,"dayCount",t)},expression:"row.dayCount"}})]}}])},[a("template",{slot:"header"},[e._v("\n            天数 "),a("i",{staticClass:"el-input__icon "}),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该检测因子需要采集的天数"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1)],2),a("el-table-column",{attrs:{prop:"frequency",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",disabled:"002001"===r.secdClassId||"002003"===r.secdClassId,min:1,step:1,max:"004001"===r.secdClassId?2:10,precision:0,"controls-position":"right"},on:{change:function(t){return e.reflushMoney(r)}},model:{value:r.frequency,callback:function(t){e.$set(r,"frequency",t)},expression:"row.frequency"}})]}}])},[a("template",{slot:"header"},[e._v("\n            频次(次/天) "),a("i",{staticClass:"el-input__icon "}),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该检测因子每天需要采集的次数"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1)],2),a("el-table-column",{attrs:{prop:"totalNum",label:"次数",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(Number(a.frequency*a.dayCount))+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"costPerTime",label:"单次费用",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small","controls-position":"right",min:.01},on:{change:function(t){return e.reflushMoney(r)}},model:{value:r.costPerTime,callback:function(t){e.$set(r,"costPerTime",t)},expression:"row.costPerTime"}})]}}])}),a("el-table-column",{attrs:{prop:"totalCost",label:"总计",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(parseFloat(a.frequency*a.dayCount*a.costPerTime).toFixed(2))+"\n          ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index,o=t.row;return[a("el-popover",{attrs:{placement:"left",width:"280",trigger:"click"}},[a("el-input",{attrs:{placeholder:"录入备注信息"},model:{value:o.remark,callback:function(t){e.$set(o,"remark",t)},expression:"row.remark"}}),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("备注")])],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){return e.handleRowDel(r,o)}}},[e._v("删除")])]}}])})],2)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:""},on:{click:e.handleCancle}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confimPlanInfo}},[e._v("确认")])],1)],1),a("el-dialog",{attrs:{visible:e.factorVisible,"append-to-body":"",width:"85%","close-on-click-modal":!1,top:"5vh"},on:{"update:visible":function(t){e.factorVisible=t}}},[a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"card-left",attrs:{shadow:"never"}},[a("div",[a("el-tree",{ref:"tree",staticClass:"filter-tree",staticStyle:{height:"100%"},attrs:{data:e.factorTreeData,props:e.defaultProps,"highlight-current":"","default-expand-all":"","expand-on-click-node":!0},on:{"node-click":e.handleTreeFactorSearch}})],1)])],1),a("el-col",{attrs:{span:18}},[a("el-container",[a("el-header",{attrs:{height:"45px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入检测因子名称"},on:{change:e.handleFactorSearch},model:{value:e.factorForm.factorName,callback:function(t){e.$set(e.factorForm,"factorName",t)},expression:"factorForm.factorName"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.handleFactorSearch}},[e._v("查询")])],1),a("el-main",{staticClass:"main-body"},[a("el-table",{ref:"multipleTable",attrs:{data:e.showChoseData,stripe:"",border:"","max-height":"450px","header-cell-style":{background:"#ECF3FC"}},on:{select:e.handleSelectChange,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"MoneyFormat",label:"价格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                    "+e._s(e._f("MoneyFormat")(a.price))+" 元\n                  ")]}}])})],1)],1),a("el-footer",{attrs:{height:"45px"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.factTotal>0,expression:"factTotal>0"}],attrs:{total:e.factTotal,page:e.factorForm.pageNumber,limit:e.factorForm.pageSize},on:{"update:page":function(t){return e.$set(e.factorForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.factorForm,"pageSize",t)},pagination:e.handleFactorSearch}})],1)],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("已选因子")]),a("el-row",{staticStyle:{"min-height":"36px","line-height":"30px"}},[a("el-col",{attrs:{span:2}},[a("span",[e._v("已选中因子:")])]),a("el-col",{attrs:{span:22}},[e.choseFatcors&&e.choseFatcors.length>0?e._l(e.choseFatcors,(function(t){return a("el-tag",{key:t.id,staticStyle:{margin:"2px 3px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t)}}},[e._v("\n              "+e._s(t.factorName)+"\n            ")])})):[e._v("\n            无\n          ")]],2)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("因子配置")]),a("el-form",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},["002001"===e.currentNodeId?a("el-form-item",{attrs:{label:"均值类型:","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择均值类型"},on:{change:e.changeMeanType},model:{value:e.meanType,callback:function(t){e.meanType=t},expression:"meanType"}},[a("el-option",{attrs:{value:"0",label:"日均值"}}),a("el-option",{attrs:{value:"1",label:"时均值"}}),a("el-option",{attrs:{value:"2",label:"八小时均值"}})],1)],1):e._e()],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"天数:","label-width":"100px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.setDay,callback:function(t){e.setDay=t},expression:"setDay"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"频次(次/天):","label-width":"110px"}},[a("el-input-number",{attrs:{"controls-position":"right",max:e.maxTotal,min:1,step:1,precision:0},model:{value:e.frequency,callback:function(t){e.frequency=t},expression:"frequency"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.addressArray&&e.addressArray.length>0?"检测位置1:":"检测位置:","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:e.lookPosition,callback:function(t){e.lookPosition=t},expression:"lookPosition"}})],1)],1)],1),a("el-row",[e._l(e.addressArray,(function(t,r){return a("el-col",{key:t.key,attrs:{span:24}},[a("el-form-item",{attrs:{label:"检测位置"+(r+2)+":","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),"002001"!==e.currentNodeId&&"002003"!==e.currentNodeId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeAddDomain(t)}}},[e._v("删除")]):e._e()],1)],1)})),"002003"!==e.currentNodeId&&"002001"!==e.currentNodeId?a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addAddress}},[e._v("添加位置")])],1)],1):e._e()],2)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.factorVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChoseFactor}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"因子套餐",visible:e.factorGroupVisible,"append-to-body":"","before-close":e.handleClearTabs,"close-on-click-modal":!1,width:"85%"},on:{"update:visible":function(t){e.factorGroupVisible=t}}},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"自由因子套餐",name:"1"}},[a("free-meal",{attrs:{"clear-type":e.cleanAttr},on:{handleCancel:e.getTabStatus,handleConfim:e.getTabResultForFree}})],1),a("el-tab-pane",{attrs:{label:"同系因子套餐",name:"2"}},[a("same-meal",{attrs:{"clear-type":e.cleanAttr},on:{handleCancel:e.getTabStatus,handleConfim:e.getTabResultForSame}})],1)],1)],1),a("el-dialog",{attrs:{title:"计划详情",visible:e.planDetailVisible,"append-to-body":"",width:"80%"},on:{"update:visible":function(t){e.planDetailVisible=t}}},[a("el-row",{staticStyle:{height:"35px","font-size":"15px"}},[a("el-col",{attrs:{span:8}},[e._v("\n        计划名称: "+e._s(e.showPlanForm.planName)+"\n      ")]),a("el-col",{attrs:{span:8}},[e._v("\n        监测频次: "+e._s(e.showPlanForm.checkFreq)+"\n      ")]),a("el-col",{attrs:{span:8}},[e._v("\n        执行次数: "+e._s(e.showPlanForm.execTimes)+"\n      ")])],1),a("el-card",{staticStyle:{width:"100%","min-height":"500px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("检测因子信息"),a("i",{staticClass:"el-input__icon"})])]),a("el-table",{attrs:{data:e.showPlanForm.factorTdoList,stripe:"",border:"","highlight-current-row":"","show-summary":"","summary-method":e.getPlanSummaries,"header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                暂无因子\n              ")])])])]),a("el-table-column",{attrs:{prop:"factorPoint",label:"位置","min-width":"110",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"对象",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"类别",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.meanName&&r.meanName.length>0?[e._v("\n              "+e._s(r.secdClassName)),a("span",{staticStyle:{color:"red"}},[e._v(e._s("("+r.meanName+")"))])]:[e._v("\n              "+e._s(r.secdClassName)+"\n            ")]]}}])}),a("el-table-column",{attrs:{prop:"factorName",label:"因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号","min-width":"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"标准名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"totalNum",label:"次数",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(Number(a.dayCount*a.frequency).toFixed(0))+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"costPerTime",label:"单次费用",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"totalCost",label:"总计",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(Number(a.dayCount*a.frequency*a.costPerTime).toFixed(2))+"\n          ")]}}])})],2)],1)],1)],1)},o=[],s=(a("5df3"),a("f400"),a("75fc")),l=(a("c5f6"),a("20d6"),a("7f7f"),a("a481"),a("7514"),a("ac6a"),a("e601")),n=a("333d"),i=a("f858"),c=a("b429"),d=a("b705"),u=a("85cd"),p=a("10b9"),m=a("9612"),h={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过"},f={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},b={0:"日均值",1:"时均值",2:"八小时均值"},g={0:"单次",1:"1次/月",2:"1次/季",3:"1次/年",4:"1次/半年",5:"1次/周",6:"1次/日",7:"1次/12小时",8:"3次/半年",9:"1次/两年",10:"无固定频次"},v={name:"OrderList",components:{Pagination:n["a"],freeMeal:u["default"],sameMeal:p["default"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},data:function(){return{FRE_STATUS:g,MEAN_STATUS:b,ACCOUNT_STATUS:h,CHECK_STATUS:f,orderData:[],defaultProps:{children:"children",label:"name",id:"id"},searchForm:{id:"",projectName:"",status:"",pageNumber:1,pageSize:10},total:0,maxTotal:10,titleMap:{edit:"修改报价单",create:"新增报价单"},checkCostRate:"",orderForm:{offerId:"",offerInfoTdo:{projectName:"",checkType:"0",certificationType:"1",consignorName:"",consignorLinker:"",consignorLinkerPhone:"",finishDate:"",remark:"",explains:""},offerPlanTdos:[],offerCostTdo:{id:"",checkAmount:0,reportAmount:0,reportAmountRate:10,expediteAmount:0,laborAmount:0,tripAmount:0,taxAmount:"",taxAmountRate:6,sysAmount:0,draftAmount:0},selfCostTdos:[]},otherPrice:"",orderRules:{offerInfoTdo:{consignorLinkerPhone:[{required:!0,message:"请录入联系方式",trigger:"blur"}],projectName:[{required:!0,message:"请录入项目名称",trigger:"blur"}],finishDate:[{required:!0,message:"请录入完成日期",trigger:"blur"}],consignorName:[{required:!0,message:"请录入委托单位",trigger:"blur"}],consignorLinker:[{required:!0,message:"请录入委托人",trigger:"blur"}],checkType:[{required:!0,message:"请选择检测类型",trigger:"change"}],certificationType:[{required:!0,message:"请选择认证类型",trigger:"change"}]}},orderDialogStatus:"create",orderDialogVisible:!1,departmentArray:[],orderActiveName:"1",factorData:[],priceArray:[],innerPriceVisible:!1,addPriceForm:{selfName:"",amount:0},factorVisible:!1,showChoseData:[],factTotal:0,factorForm:{classId:"",factorName:"",pageNumber:1,pageSize:10},factorMultipleSelection:[],factorTreeData:[],choseFatcors:[],choseGroupFatcors:[],addressArray:[],groupAddressArray:[],setDay:1,frequency:1,meanType:"0",currentNodeId:"",currentGroupNodeId:"",lookPosition:"",currentNodeName:"",detailVisible:!1,orderDetailForm:{offerId:"",offerBaseVo:{consignorName:"",consignorLinker:"",consignorLinkerPhone:"",createUserName:"",finishDate:"",remark:"",checkCircle:"",checkTaskCount:""},offerPlanVos:[],costVo:{},selfCostVos:[],factorTdos:[]},orderDetailPlans:[],multipleSelection:[],multiplGroupeSelection:[],factorGroupData:[],choseMultipleTable:[],changeGroupId:"",startFactorGroup:"",factorGroupVisible:!1,rowShowVisible:!0,rowRemark:"",currentItem:{},windNum:3,approveVisible:!1,approveDetails:[],treeData:[],factListInfos:[],cacheFactors:[],factorList:[],facName:"",resultCache:{},resultForCache:{},currentUUid:"",planInfoVisible:!1,planForm:{planName:"",checkFreq:"",execTimes:0,planTime:"",scheduleTimes:"",checkFactorCnt:0,checkFee:"",factorTdoList:[]},activeName:"1",cleanAttr:"",checkFreqArray:[],planDetailVisible:!1,showPlanForm:{},operEditType:!1,currentRow:{},lastExplains:""}},computed:{},watch:{orderForm:{handler:function(e){var t=0,a=0,r=0,o=0,s=0,l=0,n=0,i=0;this.orderForm.offerPlanTdos.length>0&&(this.orderForm.offerPlanTdos.forEach((function(e){t+=parseFloat(e.checkFee*e.execTimes)})),t>0&&(a=parseFloat(t*this.orderForm.offerCostTdo.reportAmountRate/100)),s=parseFloat(this.orderForm.offerCostTdo.tripAmount),l=parseFloat(this.orderForm.offerCostTdo.laborAmount),r=parseFloat(this.orderForm.offerCostTdo.expediteAmount),this.orderForm.selfCostTdos&&this.orderForm.selfCostTdos.length>0&&this.orderForm.selfCostTdos.forEach((function(e){n+=parseFloat(e.amount)})),i=parseFloat(t+a+r+s+l+n),o=parseFloat(i*this.orderForm.offerCostTdo.taxAmountRate/100),this.orderForm.offerCostTdo.checkAmount=parseFloat(t).toFixed(2),this.orderForm.offerCostTdo.reportAmount=parseFloat(a).toFixed(2),this.orderForm.offerCostTdo.taxAmount=parseFloat(o).toFixed(2),this.otherPrice=parseFloat(n).toFixed(2),this.checkCostRate=parseFloat((t+this.orderForm.offerCostTdo.draftAmount-this.orderForm.offerCostTdo.sysAmount)/t*100).toFixed(2),this.orderForm.offerCostTdo.sysAmount=parseFloat(i+o).toFixed(2))},deep:!0}},created:function(){this.getFreqList(),this.getTreeClassList(),this.handleSearch()},methods:{getFreqList:function(){var e=this;d["b"]().then((function(t){200===t.code&&(e.checkFreqArray=t.result)}))},getDicKey:function(e,t){var a=this;d["g"](t).then((function(t){200===t.code&&(a[e]=t.result)}))},getTreeClassList:function(){var e=this;d["e"]().then((function(t){e.factorTreeData=t.result||[]}))},handleSearch:function(){var e=this;l["g"](this.searchForm).then((function(t){200===t.code&&(e.orderData=t.result.records||[],e.total=t.result.total),1===e.searchForm.pageNumber&&(e.lastExplains=t.result.records[0]?t.result.records[0].explains:"")})),1!==this.searchForm.pageNumber&&this.getLastExplains()},getLastExplains:function(){var e=this,t={id:"",factorName:"",pageNumber:1,pageSize:10};l["g"](t).then((function(t){200===t.code&&t.result.records&&(e.lastExplains=t.result.records[0].explains,""===e.lastExplains&&l["d"](e.searchForm).then((function(t){200===t.code&&(e.lastExplains=t.result.records[0].explains||"")})))}))},handleCreate:function(){this.clearForm(),this.orderForm.offerInfoTdo.explains=this.lastExplains,this.orderDialogStatus="create",this.orderDialogVisible=!0},handleCopy:function(e){var t=this;this.$confirm("确定复制?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["b"](e.id).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleUpdate:function(e){var t=this;this.orderForm.offerId=e.id,this.orderDialogStatus="edit",l["f"](e.id).then((function(e){200===e.code&&(t.orderForm.offerId=e.result.offerId||"",t.orderForm.offerInfoTdo=e.result.offerBaseVo||{},t.orderForm.offerCostTdo=e.result.costVo||{},t.orderForm.selfCostTdos=e.result.selfCostVos||[],t.orderForm.offerPlanTdos=e.result.offerPlanVos.map((function(e){return e.planFactorVoList&&e.planFactorVoList.length>0&&(e.planFactorVoList.forEach((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}var r=[];e.factorSubSetVos&&e.factorSubSetVos.length>0&&(r=e.factorSubSetVos.map((function(e){return e.checkStandardId}))),t.$set(e,"subCheckStandardIds",r)})),t.$set(e,"factorTdoList",e.planFactorVoList)),e}))||[],t.orderDialogVisible=!0)}))},handleApprovel:function(e){var t=this;this.$confirm("确定提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},confirmDialog:function(){if(this.checkCostRate<0)this.$message.warning("优惠价格不能低于服务总合计费用！");else if(this.orderForm.offerPlanTdos&&this.orderForm.offerPlanTdos.length>0){var e=this.orderForm.offerPlanTdos.find((function(e){return""===e.factorPoint}));if(e)return void this.$message.warning("因子位置信息不能为空");1===this.orderForm.offerInfoTdo.checkTaskCount&&(this.orderForm.offerInfoTdo.checkCircle="0"),this.orderForm.offerCostTdo.draftAmount&&this.orderForm.offerCostTdo.draftAmount>0?"create"===this.orderDialogStatus?this.confirmCreate():this.confirmUpdate():this.$message.warning("请录入正确的优惠价格!")}else this.$message.warning("因子信息不能为空")},confirmCreate:function(){var e=this;this.$refs.orderForm.validate((function(t){if(!t)return e.$message.warning("请完善必填信息"),!1;var a={offerInfoTdo:e.orderForm.offerInfoTdo,offerPlanTdos:e.orderForm.offerPlanTdos.map((function(e){var t=e.planName,a=e.checkFreq,r=e.execTimes,o=e.planTime,s=e.scheduleTimes,l=e.checkFactorCnt,n=e.checkFee,i=e.factorTdoList.map((function(e){var t=e.checkStandardId,a=e.isFactor,r=e.factorName,o=e.secdClassId,s=e.frequency,l=e.dayCount,n=e.costPerTime,i=e.factorPoint,c=e.remark,d=e.dynamicParam,u=e.factorGroupKey,p=e.subCheckStandardIds;return{checkStandardId:t,isFactor:a,factorName:r,secdClassId:o,frequency:s,dayCount:l,costPerTime:n,factorPoint:i.trim(),remark:c,dynamicParam:d,factorGroupKey:u,subCheckStandardIds:p}}));return{planName:t,checkFreq:a,execTimes:r,planTime:o,scheduleTimes:s,checkFactorCnt:l,checkFee:n,factorTdoList:i}})),offerCostTdo:e.orderForm.offerCostTdo,selfCostTdos:e.orderForm.selfCostTdos};l["i"](a).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.orderDialogVisible=!1,e.$refs.orderForm.resetFields()):e.$notify({title:"失败",message:t.message,type:"error"})})).catch((function(){}))}))},confirmUpdate:function(){var e=this;this.$refs.orderForm.validate((function(t){if(!t)return!1;var a={offerId:e.orderForm.offerId,offerInfoTdo:e.orderForm.offerInfoTdo,offerPlanTdos:e.orderForm.offerPlanTdos.map((function(e){var t=e.planName,a=e.checkFreq,r=e.execTimes,o=e.planTime,s=e.scheduleTimes,l=e.checkFactorCnt,n=e.checkFee,i=e.factorTdoList.map((function(e){var t=e.checkStandardId,a=e.isFactor,r=e.factorName,o=e.secdClassId,s=e.frequency,l=e.dayCount,n=e.costPerTime,i=e.factorPoint,c=e.remark,d=e.dynamicParam,u=e.factorGroupKey,p=e.subCheckStandardIds;return{checkStandardId:t,isFactor:a,factorName:r,secdClassId:o,frequency:s,dayCount:l,costPerTime:n,factorPoint:i.trim(),remark:c,dynamicParam:d,factorGroupKey:u,subCheckStandardIds:p}}));return{planName:t,checkFreq:a,execTimes:r,planTime:o,scheduleTimes:s,checkFactorCnt:l,checkFee:n,factorTdoList:i}})),offerCostTdo:e.orderForm.offerCostTdo,selfCostTdos:e.orderForm.selfCostTdos};l["j"](a).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.orderDialogVisible=!1,e.$refs.orderForm.resetFields()})).catch((function(){}))}))},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["c"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleApproveDetail:function(e){var t=this;c["a"](e.id).then((function(e){t.approveDetails=e.result||[]})),this.approveVisible=!0},clearForm:function(){this.orderForm={offerId:"",offerInfoTdo:{projectName:"",checkType:"0",certificationType:"1",consignorName:"",consignorLinker:"",consignorLinkerPhone:"",finishDate:"",remark:"",explains:""},offerPlanTdos:[],offerCostTdo:{id:"",checkAmount:0,reportAmount:0,reportAmountRate:10,expediteAmount:0,laborAmount:0,tripAmount:0,taxAmount:"",taxAmountRate:6,sysAmount:0,draftAmount:0},selfCostTdos:[]}},handleDialogClose:function(e){this.$confirm("确认离开？").then((function(t){e()})).catch((function(e){}))},showAddPrice:function(){this.addPriceForm={selfName:"",amount:0},this.innerPriceVisible=!0},factorNumCheck:function(e,t){t.length>=3?this.orderForm.offerCostTdo[e]=t.substr(0,2):this.orderForm.offerCostTdo[e]=t.replace(/[^\d]/g,"")},factorNumCheckNaN:function(e,t){t.length>=3?this.orderForm.offerCostTdo[e]=t.substr(0,2):this.orderForm.offerCostTdo[e]=t.replace(/[^\d]/g,"")},factorNumCheckPoint:function(e,t){this.orderForm.offerCostTdo[e]=t.replace(/[^\d.]/g,"")},confirmPrice:function(){this.addPriceForm.selfName&&this.addPriceForm.amount>=0?(this.orderForm.selfCostTdos.push({selfName:this.addPriceForm.selfName,amount:this.addPriceForm.amount}),this.innerPriceVisible=!1):this.$message.warning("请录入完整信息")},validatoProInput:function(e){e>0&&this.orderForm.offerCostTdo.sysAmount>0&&(this.checkCostRate=parseFloat(this.orderForm.offerCostTdo.draftAmount/this.orderForm.offerCostTdo.sysAmount*100))},addFactor:function(){var e=this;this.currentUUid=m["b"].v4().replaceAll("-",""),this.choseFatcors=[],this.multipleSelection=[],this.maxTotal=10,this.currentNodeId&&this.currentNodeId.length>0&&(this.handleFactorSearch(),"002003"===this.currentNodeId?this.$nextTick((function(){for(var t=0;t<4;t++)e.addressArray.push({value:"",windNum:3,key:Date.now()+t})})):"002001"===this.currentNodeId&&this.$nextTick((function(){for(var t=0;t<3;t++)e.addressArray.push({value:"",windNum:3,key:Date.now()+t})}))),this.setDay=1,this.frequency=1,this.addressArray=[],this.lookPosition="",this.meanType="",this.factorVisible=!0},choseGroup:function(){this.currentUUid=m["b"].v4().replaceAll("-",""),this.cleanAttr=this.currentUUid,this.startFactorGroup="",this.groupAddressArray=[],this.multiplGroupeSelection=[],this.choseGroupFatcors=[],this.factorGroupVisible=!0},addAddress:function(){var e=this;this.$nextTick((function(){e.addressArray.push({value:"",windNum:3,key:Date.now()})}))},addGroupAddress:function(){var e=this;this.$nextTick((function(){e.groupAddressArray.push({value:"",key:Date.now()})}))},removeDomain:function(e){var t=this.orderForm.selfCostTdos.indexOf(e);-1!==t&&this.orderForm.selfCostTdos.splice(t,1)},removeAddDomain:function(e){var t=this.addressArray.indexOf(e);-1!==t&&this.addressArray.splice(t,1)},removeGroupAddDomain:function(e){var t=this.groupAddressArray.indexOf(e);-1!==t&&this.groupAddressArray.splice(t,1)},handleClass:function(e){this.searchForm.classId=e,this.handleFactorSearch()},handleTreeFactorSearch:function(e,t){var a=this;e.children&&null!=e.children||(this.addressArray=[],this.currentNodeId=e.id,this.currentNodeName=e.name,this.factorForm.classId=t.parent.data.id,this.factorForm.secdClassId=e.id,this.factorForm.factorName="",this.factorForm.pageNumber=1,this.handleFactorSearch(),this.choseFatcors=[],this.multipleSelection=[],"002001"===e.id&&"0"===this.meanType?this.maxTotal=1:"004001"===e.id?this.maxTotal=2:this.maxTotal=10,"002003"===e.id?this.$nextTick((function(){for(var e=0;e<4;e++)a.addressArray.push({value:"",windNum:3,key:Date.now()+e})})):"002001"===e.id&&this.$nextTick((function(){for(var e=0;e<3;e++)a.addressArray.push({value:"",windNum:3,key:Date.now()+e})})))},handleFactorSearch:function(){var e=this;this.currentNodeId&&this.currentNodeId.length>0&&i["h"](this.factorForm).then((function(t){200===t.code&&(e.showChoseData=t.result.records||[],e.factTotal=t.result.total)}))},handleSelectionChange:function(e){var t=this;this.multipleSelection=e,e&&e.forEach((function(e){var a=t.choseFatcors.find((function(t){return t.id===e.id}));a||t.choseFatcors.push(e)}))},handleSelectChange:function(e,t){if(e&&-1===e.indexOf(t)){var a=this.choseFatcors.findIndex((function(e){return e.id===t.id}));this.choseFatcors.splice(a,1)}},handleClose:function(e){this.choseFatcors.splice(this.choseFatcors.indexOf(e),1),this.$refs.multipleTable.toggleRowSelection(e,!1)},handleGroupClose:function(e){this.choseGroupFatcors.splice(this.choseGroupFatcors.indexOf(e),1),this.$refs.groupMultipleTable.toggleRowSelection(e,!1)},confirmChoseFactor:function(){var e=this;if(!this.choseFatcors||this.choseFatcors.length<=0)this.$message.warning("因子不能为空");else if(!this.lookPosition||this.lookPosition.length<=0)this.$message.warning("初始检测位置不能为空");else{var t={};"002001"===this.currentNodeId&&(this.$set(t,"meanType",this.meanType),this.$set(t,"meanName",this.MEAN_STATUS[this.meanType]));var a="";"002001"!==this.currentNodeId&&"002003"!==this.currentNodeId||(a=this.currentNodeId);var r=this.choseFatcors.map((function(r){var o=r.standardNo,s=r.standardCode,l=r.className,n=r.standardName,i=r.factorName,c=r.price,d=parseFloat(c*e.frequency*e.setDay).toFixed(2),u=m["b"].v4().replaceAll("-","");return e.$set(r,"factorGroupKey",u),{checkStandardId:s,factorPoint:e.lookPosition.trim(),className:l,isFactor:"0",secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,factorName:i,standardNo:o,standardName:n,dayCount:e.setDay,frequency:e.frequency,totalNum:Number(e.frequency*e.setDay).toFixed(0),costPerTime:c,totalCost:d,meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+s:"",dynamicParam:JSON.stringify(t),factorGroupKey:u}}));this.addressArray&&this.addressArray.length>0&&this.addressArray.forEach((function(o){o.value&&o.value.length>0&&e.choseFatcors.forEach((function(s){var l=s.standardNo,n=s.standardCode,i=s.className,c=s.standardName,d=s.factorName,u=s.price,p=s.factorGroupKey,m=parseFloat(u*e.frequency*e.setDay).toFixed(2);r.push({checkStandardId:n,factorPoint:o.value.trim(),className:i,isFactor:"0",secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,factorName:d,standardNo:l,standardName:c,dayCount:e.setDay,frequency:e.frequency,totalNum:Number(e.frequency*e.setDay).toFixed(0),costPerTime:u,totalCost:m,remark:"",meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+n:"",dynamicParam:JSON.stringify(t),factorGroupKey:p})}))})),this.$nextTick((function(){e.planForm.factorTdoList&&e.planForm.factorTdoList.length>0?e.planForm.factorTdoList=e.planForm.factorTdoList.concat(r):e.planForm.factorTdoList=r})),this.factorVisible=!1}},getPlanSummaries:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var o=a.map((function(t){return"次数"===e.label?Number(t.dayCount*t.frequency):"总计"===e.label?parseFloat(t.dayCount*t.frequency*t.costPerTime):Number(t[e.property])}));o.every((function(e){return isNaN(e)}))?r[t]="":6===t?r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0):8===t?r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0):10===t&&(r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0).toFixed(2))}else r[t]="合计"})),r},getSummaries:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var o=a.map((function(t){return"检测费用"===e.label?Number(t.execTimes*t.checkFee):Number(t[e.property])}));o.every((function(e){return isNaN(e)}))?r[t]="":6===t&&(r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0).toFixed(2))}else r[t]="合计"})),r},handleRowDel:function(e,t){console.log(this.currentRow),this.planForm.factorTdoList.splice(e,1),console.log(this.currentRow)},handleDetail:function(e){var t=this;l["f"](e.id).then((function(e){if(200===e.code){var a=[];t.orderDetailForm.offerId=e.result.offerId||"",t.orderDetailForm.offerBaseVo=e.result.offerBaseVo||{},t.orderDetailForm.costVo=e.result.costVo||{},t.orderDetailForm.selfCostVos=e.result.selfCostVos||[],t.orderDetailForm.offerPlanVos=a=e.result.offerPlanVos.map((function(e){return e.planFactorVoList&&e.planFactorVoList.length>0&&(e.planFactorVoList.forEach((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}})),t.$set(e,"oldPlanFactors",e.planFactorVoList)),e}))||[],t.orderDetailPlans=t.doProcessOrder(a)||[],t.detailVisible=!0}}))},doProcessOrder:function(e){var t=this;if(e&&e.length>0){var a=Object(s["a"])(e);return a.forEach((function(e){var a=t.doProcessDate(e.planFactorVoList);t.$set(e,"factorTdos",a)})),a}},doProcessDate:function(e){var t=this;if(e&&e.length>0){var a=[],r=new Map,o=[],s=1;return e.forEach((function(e,t){var o=a.find((function(t){return t.secdClassName===e.secdClassName}));if(o||(a.push({id:s,secdClassName:e.secdClassName,totalPrice:0,detailLength:0}),s++),r.get(e.secdClassName)){var l=r.get(e.secdClassName);l.push(e)}else{var n=[];n.push(e),r.set(e.secdClassName,n)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName);a&&a.length>0&&a.forEach((function(r,s){var l=o.find((function(e){return e.secName===r.secdClassName}));l?t.$set(r,"frIndex",1):t.$set(r,"frIndex",0),t.$set(r,"id",e.id),t.$set(r,"sid",e.id+"."+(s+1)),t.$set(r,"secName",e.secdClassName),t.$set(r,"detailLength",a.length),t.$set(r,"dateType",0),o.push(r)}))})),o}return[]},countTotal:function(e,t){var a=0;return a=e.reduce((function(e,a,r,o){return a[t]?e+a[t]:e}),0),a},handleGroupSelectionChange:function(e){var t=this;this.multiplGroupeSelection=e,e&&e.forEach((function(e){var a=t.choseGroupFatcors.find((function(t){return t.standardCode===e.standardCode}));a||t.choseGroupFatcors.push(e)}))},groupSelect:function(e,t){if(e&&-1===e.indexOf(t)){var a=this.choseGroupFatcors.findIndex((function(e){return e.standardCode===t.standardCode}));this.choseGroupFatcors.splice(a,1)}},groupSelectAll:function(e){e.length>1?e.length=1:this.choseMultipleTable=[]},confirmAddGroup:function(){var e=this;!this.changeGroupId||this.changeGroupId.length<=0?this.$message.warning("套餐不能为空"):i["c"](this.changeGroupId).then((function(t){200===t.code&&t.result&&(e.doGroupProcess(t.result),e.factorGroupVisible=!1)}))},doGroupProcess:function(e){var t=this,a=e.map((function(e){var t=e.standardCode,a=e.secdClassId,r=e.secdClassName,o=e.className,s=e.standardName,l=e.factorName,n=e.price;return{checkStandardId:t,className:o,standardName:s,factorName:l,secdClassId:a,secdClassName:r,frequency:1,dayCount:1,price:n,totalCost:n,factorPoint:"",remark:""}}));this.$nextTick((function(){t.orderForm.factorTdos&&t.orderForm.factorTdos.length>0?t.orderForm.factorTdos=t.orderForm.factorTdos.concat(a):t.orderForm.factorTdos=a}))},handleDownload:function(e){var t="/api/word/downLoadOffer?offerId="+e.id;window.open(t)},handleExcelDownload:function(e){var t="/api/word/downLoadOfferExcel?offerId="+e.id;window.open(t)},handleRowShow:function(e){this.currentItem=e,this.rowRemark=e.remark,this.rowShowVisible=!0},rowShowConfirm:function(){this.currentItem.remark=this.rowRemark,this.rowShowVisible=!1},changeMeanType:function(e){var t=0;"0"===e?this.maxTotal=t=1:"1"===e?this.maxTotal=t=4:"2"===e&&(this.maxTotal=t=2),this.frequency>t&&(this.frequency=t)},changeTreeItem:function(e,t,a){var r=this;2===e.level&&(this.factorList=[],this.multiplGroupeSelection=[],this.factorList=this.cacheFactors.filter((function(t){return e.id===t.secdClassId})),this.addressArray=[],this.currentNodeId=e.id,this.currentNodeName=e.name,"002001"===e.id&&"0"===this.meanType?this.maxTotal=1:"004001"===e.id?this.maxTotal=2:this.maxTotal=10,"002001"!==e.id&&"002003"!==e.id||this.$nextTick((function(){for(var e=0;e<4;e++)r.addressArray.push({value:"",windNum:3,key:Date.now()+e})})))},choseItem:function(e){var t=this;if(this.treeData=[],this.cacheFactors=[],this.factorList=[],this.multiplGroupeSelection=[],this.choseGroupFatcors=[],this.setDay=1,this.frequency=1,this.addressArray=[],this.currentNodeId="",this.currentNodeName="",this.meanType="",this.resultCache[e.groupId])return this.treeData=this.resultCache[e.groupId],void(this.cacheFactors=this.resultForCache[e.groupId]);e.groupId&&i["c"](e.groupId).then((function(a){if(200===a.code&&a.result){t.cacheFactors=a.result;var r=[];a.result.forEach((function(e){var t=r.find((function(t){return t.id===e.classId}));if(t){var a=t.children,o=a.find((function(t){return t.id===e.secdClassId}));if(!o){var s=[{id:e.secdClassId,name:e.secdClassName,children:[],level:2}];t.children.push(s)}}else{var l=[{id:e.secdClassId,name:e.secdClassName,children:[],level:2}],n={id:e.classId,name:e.className,level:1,children:l};r.push(n)}})),t.$set(t.resultCache,e.groupId,r),t.$set(t.resultForCache,e.groupId,a.result),t.treeData=r}}))},addPlanInfo:function(){this.planForm={planName:"",checkFreq:"",execTimes:0,planTime:"",checkFactorCnt:0,checkFee:"",factorTdoList:[]},this.operEditType=!1,this.planInfoVisible=!0},reflushTime:function(){var e=this;if("单次"===this.planForm.checkFreq)this.planForm.planTime=1,this.planForm.scheduleTimes=1,this.planForm.execTimes=1;else if(this.planForm.execTimes>0){var t=this.checkFreqArray.find((function(t){return t.desc===e.planForm.checkFreq}));t&&(this.planForm.planTime=Number(t.calBaseVal*this.planForm.execTimes/t.calVal).toFixed(1)+"  "+("none"===t.unit?"":t.unit),this.planForm.scheduleTimes=Number(t.calVal*this.planForm.execTimes).toFixed(0))}},reflushMoney:function(e){e.totalNum=Number(e.dayCount*e.frequency),e.totalCost=Number(e.dayCount*e.frequency*e.costPerTime).toFixed(2)},confirmPlanDialog:function(){},planSearch:function(e){this.showPlanForm=Object.assign({},e),this.planDetailVisible=!0},planUpdate:function(e){this.currentRow=e,this.operEditType=!0,this.planForm={planName:"",checkFreq:"",execTimes:0,planTime:"",checkFactorCnt:0,checkFee:"",factorTdoList:[]},this.planForm=Object.assign({},e),this.planForm.factorTdoList=Object(s["a"])(e.factorTdoList),this.planInfoVisible=!0},handleCancle:function(){console.log(this.currentRow),this.planInfoVisible=!1},planDelete:function(e){-1!==e&&this.orderForm.offerPlanTdos.splice(e,1)},handleClearTabs:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},getTabStatus:function(e){e||(this.factorGroupVisible=!1)},getTabResultForFree:function(e){var t=this;this.$nextTick((function(){t.planForm.factorTdoList&&t.planForm.factorTdoList.length>0?t.planForm.factorTdoList=t.planForm.factorTdoList.concat(e):t.planForm.factorTdoList=e})),this.factorGroupVisible=!1,console.log("自由套餐："+e)},getTabResultForSame:function(e){var t=this;this.$nextTick((function(){t.planForm.factorTdoList&&t.planForm.factorTdoList.length>0?t.planForm.factorTdoList=t.planForm.factorTdoList.concat(e):t.planForm.factorTdoList=e})),this.factorGroupVisible=!1},confimPlanInfo:function(){var e=this;if(""!==this.planForm.planName&&void 0!==this.planForm.checkFreq&&""!==this.planForm.checkFreq)if(this.planForm.factorTdoList&&0!==this.planForm.factorTdoList.length)if(this.planForm.execTimes<=0)this.$message.error("计划执行次数不能小于1！");else{var t=0,a=0,r=[],o=[],s=this.planForm.factorTdoList.map((function(s){t=parseFloat(t)+parseFloat(s.frequency*s.dayCount*s.costPerTime),a=parseFloat(a)+parseFloat(s.frequency*s.dayCount);var l={checkStandardId:s.checkStandardId?s.checkStandardId:s.standardCode,isFactor:s.isFactor,factorName:s.factorName,secdClassId:s.secdClassId,frequency:s.frequency,dayCount:s.dayCount,factorGroupKey:s.factorGroupKey,costPerTime:s.costPerTime,factorPoint:s.factorPoint.trim(),standardNo:s.standardNo,dynamicParam:s.dynamicParam,remark:s.remark,secdClassName:s.secdClassName,meanName:s.meanName,totalCost:s.totalCost,standardName:s.standardName,totalNum:s.totalNum,className:s.className,subCheckStandardIds:s.subCheckStandardIds?s.subCheckStandardIds:[]};if(s.subCheckStandards){var n=s.subCheckStandards.map((function(e){return e.standardCode}));e.$set(l,"subCheckStandardIds",n)}var i=r.find((function(e){return e.factorPoint===s.factorPoint&&e.secdClassName===s.secdClassName&&e.factorName===s.factorName}));return i?o.push(s.factorName):r.push(s),l}));if(o.length>0)this.$message.error("同一个计划中同一个地点、类别下只能出现一个因子！");else{var l={planName:this.planForm.planName,checkFreq:this.planForm.checkFreq,execTimes:this.planForm.execTimes,planTime:this.planForm.planTime,scheduleTimes:this.planForm.scheduleTimes,checkFactorCnt:a,checkFee:t,factorTdoList:s};if(this.operEditType)return this.currentRow.planName=this.planForm.planName,this.currentRow.checkFreq=this.planForm.checkFreq,this.currentRow.execTimes=this.planForm.execTimes,this.currentRow.planTime=this.planForm.planTime,this.currentRow.scheduleTimes=this.planForm.scheduleTimes,this.currentRow.checkFactorCnt=a,this.currentRow.checkFee=t,this.currentRow.factorTdoList=s,void(this.planInfoVisible=!1);this.orderForm.offerPlanTdos.push(l),this.planInfoVisible=!1}}else this.$message.error("因子信息不能为空");else this.$message.error("请完善计划基础信息")}}},y=v,F=(a("364a"),a("0c06"),a("2877")),w=Object(F["a"])(y,r,o,!1,null,"4dcf72a8",null);t["default"]=w.exports},"5def":function(e,t,a){"use strict";a("c376")},"5f21":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form",{attrs:{model:e.searchForm,inline:""}},[a("el-form-item",{attrs:{label:"合同编号:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"合同编号"},model:{value:e.searchForm.contCode,callback:function(t){e.$set(e.searchForm,"contCode",t)},expression:"searchForm.contCode"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1),a("el-table",{attrs:{data:e.taskData,stripe:"",border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无任务信息\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"contCode",label:"合同编号",width:"185px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"latestScheduleDate",label:"上次调度日期",align:"center"}}),a("el-table-column",{attrs:{prop:"finishProgress",label:"计划调度完成进度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.scheduledPlanNum)+"/"+e._s(a.planNum)+"\n      ")]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看任务")]),a("div",{staticClass:"erc-divider-vertical"}),"0"===r.scheduleFlag?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleScheduler(r)}}},[e._v(" 调度新增")]):e._e(),"1"===r.scheduleFlag?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleUpdateScheduler(r)}}},[e._v(" 调度编辑")]):e._e()]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"任务分配",visible:e.taskSedVisible,width:"80%",center:"",top:"5vh"},on:{"update:visible":function(t){e.taskSedVisible=t}}},[a("el-form",{ref:"offerDisForm",attrs:{model:e.offerDisForm,rules:e.OfferDisRules,"label-width":"130px"}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            任务基础信息"),a("i",{staticClass:"el-input__icon "})])]),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同编号:"}},[a("el-input",{attrs:{disabled:""},model:{value:e.currentRow.contCode,callback:function(t){e.$set(e.currentRow,"contCode",t)},expression:"currentRow.contCode"}})],1)],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{attrs:{disabled:""},model:{value:e.currentRow.projectName,callback:function(t){e.$set(e.currentRow,"projectName",t)},expression:"currentRow.projectName"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"委托单位:"}},[a("el-input",{attrs:{disabled:""},model:{value:e.offerDisForm.consignorName,callback:function(t){e.$set(e.offerDisForm,"consignorName",t)},expression:"offerDisForm.consignorName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"consignorLinker",label:"委托联系人:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"委托联系人"},model:{value:e.offerDisForm.consignorLinker,callback:function(t){e.$set(e.offerDisForm,"consignorLinker",t)},expression:"offerDisForm.consignorLinker"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"consignorLinkerPhone",label:"委托联系人电话:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"委托联系人电话"},model:{value:e.offerDisForm.consignorLinkerPhone,callback:function(t){e.$set(e.offerDisForm,"consignorLinkerPhone",t)},expression:"offerDisForm.consignorLinkerPhone"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"inspectionName",label:"受检单位:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"受检单位"},model:{value:e.offerDisForm.inspectionName,callback:function(t){e.$set(e.offerDisForm,"inspectionName",t)},expression:"offerDisForm.inspectionName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"inspectionLinker",label:"受检联系人:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"受检联系人"},model:{value:e.offerDisForm.inspectionLinker,callback:function(t){e.$set(e.offerDisForm,"inspectionLinker",t)},expression:"offerDisForm.inspectionLinker"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"inspectionLinkerPhone",label:"受检联系人电话:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"受检联系人电话"},model:{value:e.offerDisForm.inspectionLinkerPhone,callback:function(t){e.$set(e.offerDisForm,"inspectionLinkerPhone",t)},expression:"offerDisForm.inspectionLinkerPhone"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{prop:"projectAddress",label:"项目地址:"}},[a("div",{staticStyle:{width:"100%"}},[a("el-select",{staticStyle:{width:"33%"},attrs:{placeholder:"请选择省"},on:{change:function(t){return e.getSubRegionByRegionCode("cityArray",t)}},model:{value:e.offerDisForm.province,callback:function(t){e.$set(e.offerDisForm,"province",t)},expression:"offerDisForm.province"}},e._l(e.provinceArray,(function(e){return a("el-option",{key:e.regionCode,attrs:{label:e.regionName,value:e.regionCode}})})),1),a("el-select",{staticStyle:{width:"33%"},attrs:{placeholder:"请选择市"},on:{change:function(t){return e.getSubRegionByRegionCode("areaArray",t)}},model:{value:e.offerDisForm.city,callback:function(t){e.$set(e.offerDisForm,"city",t)},expression:"offerDisForm.city"}},e._l(e.cityArray,(function(e){return a("el-option",{key:e.regionCode,attrs:{label:e.regionName,value:e.regionCode}})})),1),a("el-select",{staticStyle:{width:"33%"},attrs:{placeholder:"请选择区"},model:{value:e.offerDisForm.county,callback:function(t){e.$set(e.offerDisForm,"county",t)},expression:"offerDisForm.county"}},e._l(e.areaArray,(function(e){return a("el-option",{key:e.regionCode,attrs:{label:e.regionName,value:e.regionCode}})})),1)],1)])],1),a("el-col",{attrs:{span:10}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请录入详细地址"},model:{value:e.offerDisForm.projectAddress,callback:function(t){e.$set(e.offerDisForm,"projectAddress",t)},expression:"offerDisForm.projectAddress"}})],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"startDate"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                开始日期\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"以预估的采样开始日期计，系统不做强制日期限制，仅做任务进度提示"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"开始日期"},model:{value:e.offerDisForm.startDate,callback:function(t){e.$set(e.offerDisForm,"startDate",t)},expression:"offerDisForm.startDate"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"endDate"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                结束日期\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"以预估的检测报告签发日期计，系统不做强制日期限制，仅做任务进度提示"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"结束日期"},model:{value:e.offerDisForm.endDate,callback:function(t){e.$set(e.offerDisForm,"endDate",t)},expression:"offerDisForm.endDate"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"checkGoal"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                检测目的\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"检测目的的内容会在最终的检测报告中展示"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"检测目的"},model:{value:e.offerDisForm.checkGoal,callback:function(t){e.$set(e.offerDisForm,"checkGoal",t)},expression:"offerDisForm.checkGoal"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"备注"},model:{value:e.offerDisForm.jobRemark,callback:function(t){e.$set(e.offerDisForm,"jobRemark",t)},expression:"offerDisForm.jobRemark"}})],1)],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{title:"",shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            选择待调度计划"),a("i",{staticClass:"el-input__icon "})])]),a("el-table",{ref:"multipleTable",attrs:{data:e.planTaskData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.checkSelectable,align:"center"}}),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"planName",label:"计划名称",align:"center"}}),a("el-table-column",{attrs:{prop:"checkFreq",label:"监测频次",align:"center"}}),a("el-table-column",{attrs:{prop:"checkFactorCnt",label:"检测因子数",align:"center"}}),a("el-table-column",{attrs:{label:"调度进度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.scheduledTimes)+"/"+e._s(a.scheduleTimes)+"\n            ")]}}])}),a("el-table-column",{attrs:{prop:"lastScheduleDate",label:"上次调度日期",align:"center"}}),a("el-table-column",{attrs:{label:"计划调度完成进度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.finishTimes)+"/"+e._s(a.scheduleTimes)+"\n            ")]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.checkPlanDetail(r)}}},[e._v("查看")])]}}])})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{width:"90px"},on:{click:function(t){e.taskSedVisible=!1}}},[e._v("取消")]),a("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary",disabled:0===e.multipleSelection.length},on:{click:e.handlePreStep}},[e._v("下一步")])],1)],1),a("el-dialog",{attrs:{"append-to-body":"",title:"检测因子",visible:e.planFactorVisible,width:"70%"},on:{"update:visible":function(t){e.planFactorVisible=t}}},[a("el-table",{attrs:{data:e.planFactorDetails,border:"",stripe:"",height:"450"}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.factorName)+e._s(a.meanName&&a.meanName.length>0?"("+a.meanName+")":"")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(Number(a.dayCount*a.frequency))+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"是否分包",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.fbFlag?"Y":"N")+"\n        ")]}}])})],1)],1),a("el-dialog",{attrs:{visible:e.taskFacotyVisible,center:"","append-to-body":"",fullscreen:""},on:{"update:visible":function(t){e.taskFacotyVisible=t}}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("任务检测因子"),a("i",{staticClass:"el-input__icon"})]),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.addFactor}},[e._v("添加因子")])],1),a("el-table",{attrs:{data:e.offerDisForm.factorTdos,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(a.factorName)+e._s(a.meanName&&a.meanName.length>0?"("+a.meanName+")":"")+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"standardNo",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(Number(a.dayCount*a.frequency))+"\n          ")]}}])}),a("el-table-column",{attrs:{label:"是否分包",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s("1"===a.fbFlag?"Y":"N")+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"factorRemark",label:"因子备注","show-overflow-tooltip":!0,align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.delFactor(r)}}},[e._v("删除")])]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{width:"90px"},attrs:{type:"warning"},on:{click:e.handleNavStep}},[e._v("上一步")]),a("el-button",{staticStyle:{width:"90px"},attrs:{type:""},on:{click:function(t){e.taskFacotyVisible=!1}}},[e._v("取 消")]),a("el-button",{staticStyle:{width:"90px"},attrs:{type:"info"},on:{click:e.handlePlanSave}},[e._v("保 存")]),a("el-button",{staticStyle:{width:"90px"},attrs:{type:"primary"},on:{click:e.handlePlanConfirm}},[e._v("确 认")])],1)],1),a("el-dialog",{attrs:{visible:e.factorVisible,"append-to-body":"",width:"85%","close-on-click-modal":!1,top:"5vh"},on:{"update:visible":function(t){e.factorVisible=t}}},[a("factor-chose-list",{attrs:{"clear-type":e.cleanAttr},on:{handleCancel:e.getTabStatus,handleConfim:e.getResultForAdd}})],1)],1)},o=[],s=(a("6b54"),a("6762"),a("2fdb"),a("55dd"),a("7514"),a("ac6a"),a("5df3"),a("f400"),a("333d")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"card-left",staticStyle:{"min-height":"400px"},attrs:{shadow:"never"}},[a("div",[a("el-tree",{ref:"tree",staticClass:"filter-tree",staticStyle:{height:"100%"},attrs:{data:e.factorTreeData,props:e.defaultProps,"highlight-current":"","default-expand-all":"","expand-on-click-node":!0},on:{"node-click":e.handleTreeFactorSearch}})],1)])],1),a("el-col",{attrs:{span:18}},[a("el-container",[a("el-header",{attrs:{height:"45px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入检测因子名称"},on:{change:e.handleFactorSearch},model:{value:e.factorForm.factorName,callback:function(t){e.$set(e.factorForm,"factorName",t)},expression:"factorForm.factorName"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.handleFactorSearch}},[e._v("查询")])],1),a("el-main",{staticClass:"main-body"},[a("el-table",{ref:"multipleTable",attrs:{data:e.showChoseData,stripe:"",border:"","max-height":"450px","header-cell-style":{background:"#ECF3FC"}},on:{select:e.handleSelectChange,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"MoneyFormat",label:"价格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(e._f("MoneyFormat")(a.price))+" 元\n              ")]}}])})],1)],1),a("el-footer",{attrs:{height:"45px"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.factTotal>0,expression:"factTotal>0"}],attrs:{total:e.factTotal,page:e.factorForm.pageNumber,limit:e.factorForm.pageSize},on:{"update:page":function(t){return e.$set(e.factorForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.factorForm,"pageSize",t)},pagination:e.handleFactorSearch}})],1)],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("已选因子")]),a("el-row",{staticStyle:{"min-height":"36px","line-height":"30px"}},[a("el-col",{attrs:{span:2}},[a("span",[e._v("已选中因子:")])]),a("el-col",{attrs:{span:22}},[e.choseFatcors&&e.choseFatcors.length>0?e._l(e.choseFatcors,(function(t){return a("el-tag",{key:t.id,staticStyle:{margin:"2px 3px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t)}}},[e._v("\n          "+e._s(t.factorName)+"\n        ")])})):[e._v("\n        无\n      ")]],2)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("因子配置")]),a("el-form",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},["002001"===e.currentNodeId?a("el-form-item",{attrs:{label:"均值类型:","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择均值类型"},on:{change:e.changeMeanType},model:{value:e.meanType,callback:function(t){e.meanType=t},expression:"meanType"}},[a("el-option",{attrs:{value:"0",label:"日均值"}}),a("el-option",{attrs:{value:"1",label:"时均值"}}),a("el-option",{attrs:{value:"2",label:"八小时均值"}})],1)],1):e._e()],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"天数:","label-width":"100px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.setDay,callback:function(t){e.setDay=t},expression:"setDay"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"频次(次/天):","label-width":"110px"}},[a("el-input-number",{attrs:{"controls-position":"right",max:e.maxTotal,min:1,step:1,precision:0},model:{value:e.frequency,callback:function(t){e.frequency=t},expression:"frequency"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.addressArray&&e.addressArray.length>0?"检测位置1:":"检测位置:","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:e.lookPosition,callback:function(t){e.lookPosition=t},expression:"lookPosition"}})],1)],1)],1),a("el-row",[e._l(e.addressArray,(function(t,r){return a("el-col",{key:t.key,attrs:{span:24}},[a("el-form-item",{attrs:{label:"检测位置"+(r+2)+":","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),"002001"!==e.currentNodeId&&"002003"!==e.currentNodeId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeAddDomain(t)}}},[e._v("删除")]):e._e()],1)],1)})),"002003"!==e.currentNodeId&&"002001"!==e.currentNodeId?a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addAddress}},[e._v("添加位置")])],1)],1):e._e()],2)],1),a("el-divider"),a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-button",{attrs:{type:""},on:{click:e.cancelComfig}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChoseFactor}},[e._v("确 定")])],1)],1)],1)},n=[],i=(a("c5f6"),a("20d6"),a("7f7f"),a("f858")),c=a("9612"),d=a("b705"),u={0:"日均值",1:"时均值",2:"八小时均值"},p={name:"FactorChoseList",components:{Pagination:s["a"]},props:{clearType:{type:String,default:""}},data:function(){return{MEAN_STATUS:u,factorTreeData:[],addressArray:[],currentNodeId:"",currentNodeName:"",lookPosition:"",defaultProps:{children:"children",label:"name",id:"id"},factTotal:0,factorForm:{classId:"",factorName:"",pageNumber:1,pageSize:10},choseFatcors:[],showChoseData:[],multipleSelection:[],maxTotal:10,setDay:1,frequency:1,meanType:"0"}},watch:{clearType:function(){this.factorForm.factorName="",this.showChoseData=[],this.addressArray=[],this.choseFatcors=[],this.multipleSelection=[],this.setDay=1,this.frequency=1,this.lookPosition=""}},created:function(){this.getTreeClassList()},methods:{getTreeClassList:function(){var e=this;d["e"]().then((function(t){e.factorTreeData=t.result||[]}))},handleTreeFactorSearch:function(e,t){var a=this;e.children&&null!=e.children||(this.addressArray=[],this.currentNodeId=e.id,this.currentNodeName=e.name,this.factorForm.classId=t.parent.data.id,this.factorForm.factorName="",this.factorForm.pageNumber=1,this.handleFactorSearch(),this.choseFatcors=[],this.multipleSelection=[],"002001"===e.id&&"0"===this.meanType?this.maxTotal=1:"004001"===e.id?this.maxTotal=2:this.maxTotal=10,"002003"===e.id?this.$nextTick((function(){for(var e=0;e<4;e++)a.addressArray.push({value:"",windNum:3,key:Date.now()+e})})):"002001"===e.id&&this.$nextTick((function(){for(var e=0;e<3;e++)a.addressArray.push({value:"",windNum:3,key:Date.now()+e})})))},handleFactorSearch:function(){var e=this;this.currentNodeId&&this.currentNodeId.length>0&&i["h"](this.factorForm).then((function(t){200===t.code&&(e.showChoseData=t.result.records||[],e.factTotal=t.result.total)}))},handleSelectionChange:function(e){var t=this;this.multipleSelection=e,e&&e.forEach((function(e){var a=t.choseFatcors.find((function(t){return t.id===e.id}));a||t.choseFatcors.push(e)}))},handleSelectChange:function(e,t){if(e&&-1===e.indexOf(t)){var a=this.choseFatcors.findIndex((function(e){return e.id===t.id}));this.choseFatcors.splice(a,1)}},changeMeanType:function(e){var t=0;"0"===e?this.maxTotal=t=1:"1"===e?this.maxTotal=t=4:"2"===e&&(this.maxTotal=t=2),this.frequency>t&&(this.frequency=t)},addAddress:function(){var e=this;this.$nextTick((function(){e.addressArray.push({value:"",windNum:3,key:Date.now()})}))},handleClose:function(e){this.choseFatcors.splice(this.choseFatcors.indexOf(e),1),this.$refs.multipleTable.toggleRowSelection(e,!1)},confirmChoseFactor:function(){var e=this;if(!this.choseFatcors||this.choseFatcors.length<=0)this.$message.warning("因子不能为空");else if(!this.lookPosition||this.lookPosition.length<=0)this.$message.warning("初始检测位置不能为空");else{var t={};"002001"===this.currentNodeId&&(this.$set(t,"meanType",this.meanType),this.$set(t,"meanName",this.MEAN_STATUS[this.meanType]));var a="";"002001"!==this.currentNodeId&&"002003"!==this.currentNodeId||(a=this.currentNodeId);var r=this.choseFatcors.map((function(r){var o=r.standardCode,s=r.className,l=r.dataEntryStep,n=r.standardNo,i=r.standardName,d=r.factorName,u=r.price,p=parseFloat(u*e.frequency*e.setDay).toFixed(2),m=c["b"].v4().replaceAll("-","");return e.$set(r,"factorGroupKey",m),{checkStandardId:o,className:s,standardName:i,factorName:d,fbFlag:"0",isFactor:"0",factorFlag:"0",standardNo:n,dataEntryStep:l,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,frequency:e.frequency,dayCount:e.setDay,totalNum:Number(e.frequency*e.setDay).toFixed(0),costPerTime:u,totalCost:p,meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,factorPoint:e.lookPosition.trim(),groupClassId:""!==a?a+"/"+o:"",dynamicParam:JSON.stringify(t),factorGroupKey:m}}));this.addressArray&&this.addressArray.length>0&&this.addressArray.forEach((function(o){o.value&&o.value.length>0&&e.choseFatcors.forEach((function(s){var l=s.standardCode,n=s.className,i=s.standardNo,c=s.dataEntryStep,d=s.standardName,u=s.factorName,p=s.price,m=s.factorGroupKey,h=parseFloat(p*e.frequency*e.setDay).toFixed(2);r.push({checkStandardId:l,className:n,standardName:d,factorName:u,fbFlag:"0",isFactor:"0",factorFlag:"0",standardNo:i,dataEntryStep:c,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,frequency:e.frequency,dayCount:e.setDay,totalNum:Number(e.frequency*e.setDay).toFixed(0),costPerTime:p,totalCost:h,factorPoint:o.value,remark:"",meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+l:"",dynamicParam:JSON.stringify(t),factorGroupKey:m})}))})),this.formComfig(r)}},formComfig:function(e){this.$emit("handleConfim",e)},cancelComfig:function(){this.$emit("handleCancel",!1)}}},m=p,h=a("2877"),f=Object(h["a"])(m,l,n,!1,null,null,null),b=f.exports,g=a("b199"),v=a("61f7"),y={0:"待调度",1:"调度中",2:"调度完成"},F={components:{Pagination:s["a"],FactorChoseList:b},filters:{statusQualityFilter:function(e){var t={0:"",1:"warning",2:"success"};return t[e]}},data:function(){var e=function(e,t,a){t&&t.length>0?Object(v["d"])(t)?a():a(new Error("输入正确的电话号码")):a()};return{TASK_STATUS:y,searchForm:{scheduCircle:"",contCode:"",projectName:"",scheduStatus:"",pageNumber:1,pageSize:10},total:0,taskData:[],taskVisible:!1,taskForm:{projectName:"",offerId:"",contCode:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:""},factorData:[],factorTaskData:[],planTaskData:[],offerDisForm:{taskId:"",jobId:"",projectName:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:"",inspectionName:"",inspectionLinker:"",inspectionLinkerPhone:"",startDate:"",endDate:"",projectAddress:"",province:"",city:"",county:"",checkGoal:"",jobRemark:"",factorTdos:[]},OfferDisRules:{consignorLinker:[{required:!0,message:"请录入委托人",trigger:"blur"}],consignorLinkerPhone:[{required:!0,message:"请录入委托人联系方式",trigger:"blur"}],inspectionName:[{required:!0,message:"请录入受检单位",trigger:"blur"}],inspectionLinker:[{required:!0,message:"请录入受检人",trigger:"blur"}],inspectionLinkerPhone:[{required:!0,message:"请录入受检人联系方式",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}],startDate:[{required:!0,message:"请选择开始时间",trigger:"blur"}],endDate:[{required:!0,message:"请选择结束时间",trigger:"blur"}],projectAddress:[{required:!0,message:"地址信息不能为空",trigger:"blur"}]},provinceArray:[],cityArray:[],areaArray:[],currentRow:{},taskTitle:"",taskSedVisible:!1,multipleSelection:[],planFactorVisible:!1,planFactorDetails:[],taskFacotyVisible:!1,currentUUid:"",cleanAttr:"",choseFatcors:[],factorVisible:!1,currentJobId:"",clearData:!1}},created:function(){this.getProvince(),this.handleSearch()},methods:{getProvince:function(){var e=this;d["h"]().then((function(t){e.provinceArray=t.result}))},getSubRegionByRegionCode:function(e,t){"cityArray"===t?(this.offerDisForm.city="",this.offerDisForm.county=""):this.offerDisForm.county="",this.getRegionCode(e,t)},getRegionCode:function(e,t){var a=this;d["i"](t).then((function(t){a[e]=t.result}))},handleSearch:function(){var e=this;g["c"](this.searchForm).then((function(t){e.taskData=t.result.records||[],e.total=t.result.total}))},handleDetail:function(e){this.$router.push("/other/orderReportTaskList/".concat(e.taskId))},doProcessData:function(e){var t=this,a=[];if(e.length>0){var r=new Map;e.forEach((function(e){var t=a.find((function(t){return t.secdClassName===e.secdClassName&&t.fbFlag===e.fbFlag}));if(t||a.push({secdClassName:e.secdClassName,fbFlag:e.fbFlag,factList:[]}),r.get(e.secdClassName+"-"+e.fbFlag)){var o=r.get(e.secdClassName+"-"+e.fbFlag);o.push(e)}else{var s=[];s.push(e),r.set(e.secdClassName+"-"+e.fbFlag,s)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName+"-"+e.fbFlag),o=[];a&&(a.forEach((function(a){var r=o.find((function(e){return e.factorPoint===a.factorPoint&&e.frequency===a.frequency&&e.dayCount===a.dayCount?(""===e.showFactName?e.showFactName=a.factorName:e.showFactName=e.showFactName+","+a.factorName,e):null}));r||(t.$set(a,"showFactName",a.factorName),t.$set(a,"fbFlag",e.fbFlag),o.push(a))})),e.factList=o.sort((function(e,t){return e.checkStandardId>t.checkStandardId?-1:e.checkStandardId<t.checkStandardId?1:0})))}))}return a},handleScheduler:function(e){this.currentRow=e,this.clearForm(),this.offerDisForm.taskId=e.taskId,this.offerDisForm.consignorName=e.consignorName,this.offerDisForm.consignorLinker=e.consignorLinker,this.offerDisForm.consignorLinkerPhone=e.consignorLinkerPhone,this.offerDisForm.inspectionName=e.consignorName,this.offerDisForm.inspectionLinker=e.consignorLinker,this.offerDisForm.inspectionLinkerPhone=e.consignorLinkerPhone,this.offerDisForm.jobId=e.jobId,this.offerDisForm.projectName=e.projectName,this.findPlanInfos(e.taskId,1)},handleUpdateScheduler:function(e){var t=this;this.currentRow=e,this.clearForm(),g["g"](e.taskId).then((function(a){t.currentJobId=a.result.jobId||"",t.offerDisForm=a.result||{},t.offerDisForm.projectName=e.projectName,t.offerDisForm.taskId=e.taskId,t.offerDisForm.consignorName=e.consignorName,t.offerDisForm.province&&t.getRegionCode("cityArray",t.offerDisForm.province),t.offerDisForm.city&&t.getRegionCode("areaArray",t.offerDisForm.city),t.findPlanInfos(e.taskId,2)}))},findPlanInfos:function(e,t){var a=this;g["k"](e).then((function(e){200===e.code&&(a.planTaskData=e.result||[],a.offerDisForm.offerPlanIds&&a.offerDisForm.offerPlanIds.length>0&&(e.result.forEach((function(e){a.offerDisForm.offerPlanIds.includes(e.offerPlanId)&&a.multipleSelection.push(e)})),a.multipleSelection.forEach((function(e){a.$nextTick((function(){a.$refs.multipleTable.toggleRowSelection(e)}))}))),a.taskSedVisible=!0)}))},getTaskInfo:function(e){var t=this;g["l"](e).then((function(e){200===e.code&&e.result&&(t.offerDisForm=e.result,t.getSubRegionByRegionCode("cityArray",e.result.province),t.getSubRegionByRegionCode("areaArray",e.result.city),t.taskSedVisible=!0)})),g["m"](e).then((function(e){200===e.code&&(t.factorTaskData=e.result||[],t.taskSedVisible=!0)}))},confirmDialog:function(){var e=this;this.offerDisForm.province&&this.offerDisForm.city&&this.offerDisForm.county?this.$refs.offerDisForm.validate((function(t){t?g["b"](e.offerDisForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.taskSedVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})):e.$message.warning("请完善信息后在提交")})):this.$message.warning("省、市、区信息不能为空")},handleSelectionChange:function(e){this.clearData=!0,this.multipleSelection=e},handleNavStep:function(){this.clearData=!1,this.taskFacotyVisible=!1},handlePreStep:function(){var e=this;if(this.clearData)if(""!==this.currentJobId)g["h"](this.currentJobId).then((function(t){e.offerDisForm.factorTdos=t.result||[],e.taskFacotyVisible=!0}));else if(this.multipleSelection.length>=1){var t=this.multipleSelection.map((function(e){return e.offerPlanId}));g["d"]({offerPlanId:t.toString()}).then((function(t){e.offerDisForm.factorTdos=t.result.map((function(t){return e.$set(t,"factorRemark",t.remark),t}))||[],e.taskFacotyVisible=!0}))}else this.$message.warning("至少选择一个计划信息!");else this.taskFacotyVisible=!0},checkPlanDetail:function(e){var t=this;g["e"](e.offerPlanId).then((function(e){t.planFactorDetails=e.result||[]})),this.planFactorVisible=!0},delFactor:function(e){this.offerDisForm.factorTdos.splice(e,1)},handlePlanSave:function(){var e=this;g["n"](this.offerDisForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.taskSedVisible=!1,e.taskFacotyVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))},handlePlanConfirm:function(){var e=this;this.offerDisForm.province&&this.offerDisForm.city&&this.offerDisForm.county?this.$refs.offerDisForm.validate((function(t){t?g["a"](e.offerDisForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.taskSedVisible=!1,e.taskFacotyVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})):e.$message.warning("请完善信息后在提交")})):this.$message.warning("省、市、区信息不能为空")},addFactor:function(){this.cleanAttr=c["b"].v4().replaceAll("-",""),this.factorVisible=!0},getTabStatus:function(e){e||(this.factorVisible=!1)},getResultForAdd:function(e){this.offerDisForm.factorTdos=this.offerDisForm.factorTdos.concat(e),this.factorVisible=!1},confirmChoseFactor:function(){},clearForm:function(){this.currentJobId="",this.offerDisForm={taskId:"",jobId:"",projectName:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:"",inspectionName:"",inspectionLinker:"",inspectionLinkerPhone:"",startDate:"",endDate:"",projectAddress:"",province:"",city:"",county:"",checkGoal:"",jobRemark:"",factorTdos:[]}},checkSelectable:function(e){return!(e.scheduledTimes>=e.scheduleTimes)}}},w=F,k=(a("8b1c"),Object(h["a"])(w,r,o,!1,null,"78c12571",null));t["default"]=k.exports},6005:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{label:"文件名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"文件名称"},model:{value:e.searchForm.fileName,callback:function(t){e.$set(e.searchForm,"fileName",t)},expression:"searchForm.fileName"}})],1),a("el-form-item",{attrs:{label:"文件类型:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"文件类型"},model:{value:e.searchForm.fileType,callback:function(t){e.$set(e.searchForm,"fileType",t)},expression:"searchForm.fileType"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.downLoadAll}},[e._v(" 模板下载")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:6}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.fileData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无数据\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"fileType",label:"文件类型",align:"center"}}),a("el-table-column",{attrs:{prop:"fileName",label:"文件名称",align:"center"}}),a("el-table-column",{attrs:{prop:"fileNo",label:"文件控制编号",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDownload(t.row)}}},[e._v(" 模板下载")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"控制编号修改",visible:e.fileDialogVisible,width:"65%",center:""},on:{"update:visible":function(t){e.fileDialogVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{ref:"fileForm",attrs:{model:e.fileForm,rules:e.fileRules,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"文件类型:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"文件类型",disabled:""},model:{value:e.fileForm.fileType,callback:function(t){e.$set(e.fileForm,"fileType",t)},expression:"fileForm.fileType"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"文件名称:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"文件名称",disabled:""},model:{value:e.fileForm.fileName,callback:function(t){e.$set(e.fileForm,"fileName",t)},expression:"fileForm.fileName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"文件控制编号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"文件控制编号"},model:{value:e.fileForm.fileNo,callback:function(t){e.$set(e.fileForm,"fileNo",t)},expression:"fileForm.fileNo"}})],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.fileDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("333d"),l=a("b775");function n(e){return Object(l["a"])({url:"/fileResource/findByCondition",method:"get",params:e})}function i(e){return Object(l["a"])({url:"/fileResource/updateById",method:"post",data:e})}var c={0:"采样",1:"检测"},d={0:"闲置中",1:"使用中",2:"维修中"},u={0:"月",1:"季度",2:"半年",3:"年",4:"两年",5:"三年"},p={components:{Pagination:s["a"]},data:function(){return{CHECK_STATUS:u,DEV_STATUS:c,USE_STATUS:d,searchForm:{fileType:"",fileName:"",pageNumber:1,pageSize:10},total:0,fileData:[],fileDialogVisible:!1,fileForm:{id:"",fileType:"",fileName:"",fileNo:""},fileRules:{fileNo:[{required:!0,message:"请录入控制编号",trigger:"blur"}]}}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;n(this.searchForm).then((function(t){200===t.code&&(e.fileData=t.result.records||[],e.total=t.result.total)}))},handleUpdate:function(e){this.clearForm(),this.fileForm.id=e.id,this.fileForm.fileType=e.fileType,this.fileForm.fileName=e.fileName,this.fileForm.fileNo=e.fileNo,this.fileDialogVisible=!0},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/download/"+e.fileType+"-"+e.fileName+".doc";window.open(t)},clearForm:function(){this.fileForm={id:"",fileType:"",fileName:"",fileNo:""}},confirmDialog:function(){var e=this;this.$refs.fileForm.validate((function(t){if(t){var a={id:e.fileForm.id,fileNo:e.fileForm.fileNo};i(a).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.fileDialogVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))}})).catch((function(){}))},downLoadAll:function(){var e=this.$store.getters.sysBaseUrl+"/api/download/downloadControlFile";window.open(e)}}},m=p,h=(a("0772"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"83a34c1a",null);t["default"]=f.exports},"620f":function(e,t,a){},6292:function(e,t,a){},"634a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待处理报价单",name:"1"}},[a("processOrder")],1),a("el-tab-pane",{attrs:{label:"历史报价单",name:"2"}},[a("hisOrder")],1)],1)],1)},o=[],s=a("5dc5"),l=a("0ef1"),n={components:{processOrder:s["default"],hisOrder:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},6388:function(e,t,a){},6506:function(e,t,a){"use strict";a("d5fb")},"65a8":function(e,t,a){"use strict";a("d300")},"667f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create-container"},[a("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"登录账号:",prop:"username"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{disabled:!0},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),"-1"===!e.userForm.deptId?a("el-form-item",{attrs:{label:"所属部门:",prop:"username"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",disabled:!0},model:{value:e.userForm.deptId,callback:function(t){e.$set(e.userForm,"deptId",t)},expression:"userForm.deptId"}},e._l(e.deptArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.deptName,value:e.id}})})),1)],1):e._e(),"-1"===!e.userForm.deptId?a("el-form-item",{attrs:{prop:"platformPositionId",label:"岗位:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",disabled:!0},model:{value:e.userForm.platformPositionId,callback:function(t){e.$set(e.userForm,"platformPositionId",t)},expression:"userForm.platformPositionId"}},e._l(Object.keys(e.postionArray),(function(t){return a("el-option",{key:t,attrs:{label:e.postionArray[t],value:t}})})),1)],1):e._e(),a("el-form-item",{attrs:{label:"用户名称:",prop:"empName"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{maxlength:"15"},model:{value:e.userForm.empName,callback:function(t){e.$set(e.userForm,"empName",t)},expression:"userForm.empName"}})],1),a("el-form-item",{attrs:{label:"联系方式",prop:"phone"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{maxlength:"11"},model:{value:e.userForm.phone,callback:function(t){e.$set(e.userForm,"phone",t)},expression:"userForm.phone"}})],1),a("el-form-item",{staticStyle:{"margin-top":"50px"}},[a("el-button",{staticClass:"iconfont icon-right_circle",attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保 存")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:""},on:{click:e.goBack}},[e._v("返 回")])],1)],1)],1)},o=[],s=(a("7514"),a("db72")),l=a("2f62"),n=a("fe05"),i=a("c24f"),c=a("61f7"),d={components:{},data:function(){var e=function(e,t,a){t&&t.length>0?Object(c["d"])(t)?a():a(new Error("输入正确的电话号码")):a()};return{departmentArray:[],roleList:[],userForm:{userId:"",username:"",empCode:"",deptId:"",empName:"",phone:"",platformPositionId:""},userRules:{empName:[{required:!0,message:"请录入用户姓名",trigger:"blur"}],phone:[{required:!0,message:"请录入联系方式",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}]},postionArray:{},deptArray:[]}},computed:Object(s["a"])({},Object(l["b"])(["userInfo"])),created:function(){"-1"===this.userInfo.deptId?this.handleChange(-1):this.getDeptTreeList(),this.userForm.userId=this.userInfo.userId,this.userForm.username=this.userInfo.username,this.userForm.platformPositionId=this.userInfo.platformPositionId,this.userForm.deptId=this.userInfo.deptId,this.userForm.empCode=this.userInfo.empCode,this.userForm.empName=this.userInfo.empName,this.userForm.phone=this.userInfo.phone},methods:{getDeptTreeList:function(){var e=this;n["getDeptList"]().then((function(t){if(t.result){e.deptArray=t.result||[];var a=t.result.find((function(t){return t.id===e.userInfo.deptId}));e.handleChange(a.platformDeptId)}}))},handleChange:function(e){var t=this;n["dpfindPositionIdByDeptId"](e).then((function(e){t.$nextTick((function(){t.postionArray=e.result||{}}))}))},onSubmit:function(){var e=this;this.$refs.userForm.validate((function(t){if(!t)return!1;var a={userId:e.userForm.userId,empName:e.userForm.empName,phone:e.userForm.phone};i["c"](a).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.$router.back()):e.$notify({title:"失败",message:t.message,type:"error"})}))}))},goBack:function(){this.$router.back()}}},u=d,p=(a("8acb"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"a79c18ca",null);t["default"]=m.exports},"66ac1":function(e,t,a){},"66c1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"box-card-component",staticStyle:{height:"316px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("本月度-部门员工数")])]),a("div",{class:e.className,style:{height:e.height,width:e.width},attrs:{id:"personChart"}})])},o=[],s=a("313e"),l=a.n(s),n=a("1e21");a("817d");var i={mixins:[n["default"]],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"250px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,required:!0}},data:function(){return{chart:null}},watch:{chartData:{deep:!0,handler:function(e){this.setOptions(e)}}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=l.a.init(document.getElementById("personChart")),this.setOptions(this.chartData)},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.yNameData,a=e.factorData;this.chart.setOption({xAxis:{show:!1,type:"value"},grid:{left:"5%",right:"5%",bottom:"5%",top:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},yAxis:{type:"category",inverse:!0,axisTick:"none",axisLine:"none",show:!0,axisLabel:{textStyle:{color:"#000",fontSize:"12"}},data:t},series:[{name:"Direct",type:"bar",stack:"total",label:{color:"#fff",show:!0},itemStyle:{color:"#00CED1"},emphasis:{focus:"series"},data:a}]})}}},c=i,d=(a("fd90"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"3dc32d1d",null);t["default"]=u.exports},6723:function(e,t,a){},6724:function(e,t,a){"use strict";a("8d41");var r="@@wavesContext";function o(e,t){function a(a){var r=Object.assign({},t.value),o=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},r),s=o.ele;if(s){s.style.position="relative",s.style.overflow="hidden";var l=s.getBoundingClientRect(),n=s.querySelector(".waves-ripple");switch(n?n.className="waves-ripple":(n=document.createElement("span"),n.className="waves-ripple",n.style.height=n.style.width=Math.max(l.width,l.height)+"px",s.appendChild(n)),o.type){case"center":n.style.top=l.height/2-n.offsetHeight/2+"px",n.style.left=l.width/2-n.offsetWidth/2+"px";break;default:n.style.top=(a.pageY-l.top-n.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",n.style.left=(a.pageX-l.left-n.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return n.style.backgroundColor=o.color,n.className="waves-ripple z-active",!1}}return e[r]?e[r].removeHandle=a:e[r]={removeHandle:a},a}var s={bind:function(e,t){e.addEventListener("click",o(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[r].removeHandle,!1),e.addEventListener("click",o(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[r].removeHandle,!1),e[r]=null,delete e[r]}},l=function(e){e.directive("waves",s)};window.Vue&&(window.waves=s,Vue.use(l)),s.install=l;t["a"]=s},6805:function(e,t,a){"use strict";a("d1fd")},"683b":function(e,t,a){"use strict";a("0bb4")},6890:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报告状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"报告状态"},model:{value:e.searchForm.reportStatus,callback:function(t){e.$set(e.searchForm,"reportStatus",t)},expression:"searchForm.reportStatus"}},e._l(Object.keys(e.REPORT_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.REPORT_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleUphold}},[e._v("报告基础信息")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"reportStatus",label:"报告状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.reportStatus)}},[e._v("\n          "+e._s(e.REPORT_STATUS[r.reportStatus])+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"reportMakeTime",label:"生成时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.reportStatus>1?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]):e._e(),"1"===r.reportStatus?a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.downloadLoading,expression:"downloadLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"text"},on:{click:function(t){return e.handleAddReport(r)}}},[e._v("报告生成")]):e._e(),"2"===r.reportStatus||"3"===r.reportStatus||"7"===r.reportStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"2"===r.reportStatus||"3"===r.reportStatus||"7"===r.reportStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleUpload(r)}}},[e._v("上传报告")]):e._e(),"3"===r.reportStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"3"===r.reportStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSubApprove(r)}}},[e._v("提交审核")]):e._e(),r.reportStatus>1?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.reportStatus>1?a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1):e._e(),r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1):e._e()],1)],1):e._e()]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报告审核信息确认",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"报告审核信息确认",visible:e.issueVisible,center:""},on:{"update:visible":function(t){e.issueVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.issueVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmIssueDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"报告基础配置信息",visible:e.basicVisible,center:"",top:"5vh",width:"80%"},on:{"update:visible":function(t){e.basicVisible=t}}},[a("el-form",{ref:"basicForm",attrs:{model:e.basicForm,rules:e.basicRules,"label-width":"110px"}},[a("el-row",{attrs:{gutter:8}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"cmaNumber",label:"CMA证书号:"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"请录入CMA证书号"},model:{value:e.basicForm.cmaNumber,callback:function(t){e.$set(e.basicForm,"cmaNumber",t)},expression:"basicForm.cmaNumber"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"CNAS证书号:"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"请录入CNAS证书号"},model:{value:e.basicForm.cnasNumber,callback:function(t){e.$set(e.basicForm,"cnasNumber",t)},expression:"basicForm.cnasNumber"}})],1)],1)],1),a("el-row",{attrs:{gutter:8}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"tel",label:"电话:"}},[a("el-input",{attrs:{maxlength:"13",placeholder:"请录入电话"},model:{value:e.basicForm.tel,callback:function(t){e.$set(e.basicForm,"tel",t)},expression:"basicForm.tel"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"fax",label:"传真:"}},[a("el-input",{attrs:{maxlength:"13",placeholder:"请录入传真"},model:{value:e.basicForm.fax,callback:function(t){e.$set(e.basicForm,"fax",t)},expression:"basicForm.fax"}})],1)],1)],1),a("el-row",{attrs:{gutter:8}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"postCode",label:"邮政编码:"}},[a("el-input",{attrs:{maxlength:"6",placeholder:"请录入邮政编码"},model:{value:e.basicForm.postCode,callback:function(t){e.$set(e.basicForm,"postCode",t)},expression:"basicForm.postCode"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"website",label:"网址:"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"请录入网址"},model:{value:e.basicForm.website,callback:function(t){e.$set(e.basicForm,"website",t)},expression:"basicForm.website"}})],1)],1)],1),a("el-row",{attrs:{gutter:8}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"address",label:"详细地址:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"30",placeholder:"请录入详细地址"},model:{value:e.basicForm.address,callback:function(t){e.$set(e.basicForm,"address",t)},expression:"basicForm.address"}})],1)],1)],1),a("el-row",{attrs:{gutter:8}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"explains",label:"说明内容:"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",maxlength:"1000",rows:5,placeholder:"请录入报告说明信息"},model:{value:e.basicForm.explains,callback:function(t){e.$set(e.basicForm,"explains",t)},expression:"basicForm.explains"}})],1)],1)],1),a("el-row",{attrs:{gutter:8}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"logoImageId",label:"企业Logo:"}},[a("el-upload",{ref:"logoImage",class:{hide:e.hideLogoUploadEdit},attrs:{action:"/api/reportBase/uploadReportImg","list-type":"picture-card","on-change":e.onUploadChange,accept:".jpg,.jpeg,.png","file-list":e.logoFileList,"before-upload":e.beforeAvatarUpload,limit:1},scopedSlots:e._u([{key:"file",fn:function(t){var r=t.file;return a("div",{},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:r.url,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(r)}}},[a("i",{staticClass:"el-icon-delete"})])])])}}])},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("注：您最多只能上传1张图片，图片尺寸为500px*160px，并且图片大小不能超过1M")])])],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"watermarkImageId",label:"报告水印:"}},[a("el-upload",{ref:"waterImage",class:{hide:e.hideUploadEdit},attrs:{action:"/api/reportBase/uploadReportImg","list-type":"picture-card","on-change":e.onWaterUploadChange,accept:".jpg,.jpeg,.png,.gif","file-list":e.waterFileList,"before-upload":e.beforeAvatarUpload,limit:1},scopedSlots:e._u([{key:"file",fn:function(t){var r=t.file;return a("div",{},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:r.url,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleWaterRemove(r)}}},[a("i",{staticClass:"el-icon-delete"})])])])}}])},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("注：您最多只能上传1张图片，图片尺寸为600px*300px，并且图片大小不能超过1M")])])],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.basicVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmBasicDialog}},[e._v("确认")])],1),a("el-dialog",{attrs:{"append-to-body":"",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),a("el-dialog",{attrs:{title:"报告上传",visible:e.uploadVisible,top:"5vh"},on:{"update:visible":function(t){e.uploadVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{ref:"uploadForm",attrs:{model:e.uploadForm,rules:e.uploadRules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"报告编号:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{disabled:""},model:{value:e.uploadForm.reportCode,callback:function(t){e.$set(e.uploadForm,"reportCode",t)},expression:"uploadForm.reportCode"}})],1),a("el-form-item",{attrs:{prop:"reportFile",label:"报告文档:"}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{width:"300px"},attrs:{drag:"",data:{reportId:e.uploadForm.id},action:"/api/report/uploadReportFile","on-change":e.onReportUploadChange,"file-list":e.fileList,accept:".doc,.docx",limit:1}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("您只能上传.doc,.docx格式的文件")])])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.uploadVisible=!1}}},[e._v("关 闭")])],1)])],1)},o=[],s=(a("7f7f"),a("db72")),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u=a("4328"),p=a.n(u),m={1:"未生成",2:"制作中",3:"待提交审批",4:"待审核",5:"待签发",6:"完成",7:"已驳回"},h={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{REPORT_STATUS:m,searchForm:{jobId:"",reportCode:"",projectName:"",reportStatus:"",pageNumber:1,pageSize:10},total:0,reportData:[],approveVisible:!1,approveForm:{id:"",auditFlag:"1",remark:""},issueVisible:!1,issueForm:{id:"",auditFlag:"1",remark:""},basicForm:{cmaNumber:"",cnasNumber:"",tel:"",fax:"",address:"",website:"",postCode:"",logoImageId:"",explains:"",watermarkImageId:""},basicRules:{cmaNumber:[{required:!0,message:"请录入CMA证书号",trigger:"blur"}],cnasNumber:[{required:!0,message:"请录入CNAS证书号",trigger:"blur"}],tel:[{required:!0,message:"请录入电话",trigger:"blur"}],fax:[{required:!0,message:"请录入传真",trigger:"blur"}],postCode:[{required:!0,message:"请录入邮政编码",trigger:"blur"}],website:[{required:!0,message:"请录入网址",trigger:"blur"}],address:[{required:!0,message:"请录入详细地址",trigger:"blur"}],logoImageId:[{required:!0,message:"请上传企业Logo图片",trigger:"blur"}],watermarkImageId:[{required:!0,message:"请上传报告水印图片",trigger:"blur"}]},logoImageList:[],waterImageList:[],dialogImageUrl:"",basicVisible:!1,dialogVisible:!1,logoFileList:[],waterFileList:[],uploadVisible:!1,uploadForm:{id:"",reportCode:"",reportFile:""},uploadRules:{reportFile:[{required:!0,message:"请上传报告信息",trigger:"blur"}]},fileList:[],hideLogoUploadEdit:!1,hideUploadEdit:!1,downloadLoading:!1}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["c"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleAddReport:function(e){var t=this;this.downloadLoading=!0,n["e"](e.reportCode).then((function(e){200===e.code?t.$notify({title:"成功",message:e.message,type:"success"}):t.$notify({title:"失败",message:e.message,type:"error"}),t.handleSearch(),t.downloadLoading=!1})).catch((function(){t.handleSearch(),t.downloadLoading=!1})).finally((function(){t.handleSearch(),t.downloadLoading=!1}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)},handleUpload:function(e){this.uploadForm.id=e.id,this.uploadForm.reportCode=e.reportCode,this.uploadForm.reportFile="",this.fileList=[],this.uploadVisible=!0},handleSubApprove:function(e){var t=this;this.$confirm("确定提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["h"](p.a.stringify({id:e.id})).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleApprove:function(e){this.approveForm.id=e.id,this.approveForm.auditFlag="1",this.approveForm.remark="",this.approveVisible=!0},handleIssue:function(e){this.issueForm.id=e.id,this.issueForm.auditFlag="1",this.issueForm.remark="",this.issueVisible=!0},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["g"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.approveVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},handleUphold:function(){var e=this;this.logoFileList=[],this.waterFileList=[],this.$refs.logoImage&&this.$refs.logoImage.clearFiles(),this.$refs.waterImage&&this.$refs.waterImage.clearFiles(),this.basicForm={cmaNumber:"",cnasNumber:"",tel:"",fax:"",address:"",website:"",postCode:"",logoImageId:"",explains:"",watermarkImageId:""},n["f"]().then((function(t){if(200===t.code&&t.result){if(e.basicForm=t.result,e.basicForm.logoImageId){var a=e.$store.getters.sysBaseUrl+"/reportImg/"+e.basicForm.logoImageId;e.logoFileList.push({name:e.basicForm.logoImageId,url:a}),e.hideLogoUploadEdit=!0}if(e.basicForm.watermarkImageId){var r=e.$store.getters.sysBaseUrl+"/reportImg/"+e.basicForm.watermarkImageId;e.waterFileList.push({name:e.basicForm.watermarkImageId,url:r}),e.hideUploadEdit=!0}}e.basicVisible=!0}))},confirmIssueDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["i"](e.issueForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.issueVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},onUploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.basicForm.logoImageId=e.response.result,this.$message({type:"success",message:"上传成功!"}),this.hideLogoUploadEdit=!0):this.$message.error("上传失败!")}else this.$message.error("上传失败!")},onReportUploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.uploadForm.reportFile=e.response.result,this.$message({type:"success",message:e.response.message}),this.handleSearch(),this.uploadVisible=!1):this.$message.error("上传失败!")}else this.$message.error("上传失败!")},onWaterUploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.basicForm.watermarkImageId=e.response.result,this.$message({type:"success",message:"上传成功!"}),this.hideUploadEdit=!0):this.$message.error("上传失败!")}else this.$message.error("上传失败!")},handleRemove:function(e){this.$refs.logoImage.uploadFiles.splice(0,1),this.hideLogoUploadEdit=!1,this.basicForm.logoImage=""},handleWaterRemove:function(e){this.$refs.waterImage.uploadFiles.splice(0,1),this.basicForm.watermarkImageId="",this.hideUploadEdit=!1},handlePictureCardPreview:function(e){this.dialogImageUrl=this.$store.getters.sysBaseUrl+"/reportImg/"+e.name,this.dialogVisible=!0},beforeAvatarUpload:function(e){var t=e.size/1024/1024<1;return t||this.$message.error("上传图片大小不能超过 1MB!"),t},confirmBasicDialog:function(){var e=this;this.$refs.basicForm.validate((function(t){t&&n["j"](e.basicForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.basicVisible=!1,e.$refs.logoImage.clearFiles(),e.$refs.waterImage.clearFiles()):e.$notify({title:"失败",message:t.message,type:"error"})}))}))},confirmReportDialog:function(){var e=this;this.$refs.uploadForm.validate((function(t){t&&n["k"](e.uploadForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.uploadVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))}))}}},f=h,b=(a("683b"),a("2877")),g=Object(b["a"])(f,r,o,!1,null,"75082924",null);t["default"]=g.exports},"68de":function(e,t,a){"use strict";a("8d95")},"690f":function(e,t,a){"use strict";a("620f")},"693c":function(e,t,a){"use strict";a("2d16")},"69e5":function(e,t,a){},"6a47":function(e,t,a){"use strict";a("4d2d")},"6ae7":function(e,t,a){},"6ba2":function(e,t,a){},"6bb0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tab-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"任务状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.sampTaskStatus,callback:function(t){e.$set(e.searchForm,"sampTaskStatus",t)},expression:"searchForm.sampTaskStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.sampTaskStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.sampTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),t.row.sampTaskStatus>1?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handlePrint(t.row)}}},[e._v(" 标签打印")]):e._e(),t.row.sampTaskStatus<2?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleSchedTask(t.row)}}},[e._v(" 合样")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.taskTitle+" 任务详情",visible:e.taskVisible,center:"",width:"70%",top:"5vh"},on:{"update:visible":function(t){e.taskVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("合同编号: "+e._s(e.taskForm.contCode))])]),a("el-col",{attrs:{span:12}},[a("span",[e._v("报价单号: "+e._s(e.taskForm.offerId))])])],1),a("table",{staticClass:"info-table-new",attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("项目名称:")]),a("td",[e._v(e._s(e.taskForm.projectName))]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托单位:")]),a("td",[e._v(e._s(e.taskForm.consignorName))])]),a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人:")]),a("td",[e._v(e._s(e.taskForm.consignorLinker)+" ")]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人方式:")]),a("td",[e._v(e._s(e.taskForm.consignorLinkerPhone))])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},[e._v("\n          工作要求:\n        ")])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},e._l(e.factorData,(function(t,r){return a("el-row",{key:r},[a("el-col",{staticStyle:{"font-weight":"bolder"},attrs:{span:24}},[e._v(e._s(t.secdClassName)+":")]),e._l(t.factList,(function(t){return a("el-col",{key:t.id,attrs:{span:24}},[e._v("\n              "+e._s(t.factorPoint+"（"+t.dayCount+"*"+t.frequency+"）: ")+e._s(t.showFactName)+" "),"1"===t.fbFlag?a("span",{staticStyle:{color:"red"}},[e._v("(分包)")]):e._e()])}))],2)})),1)])])],1),a("el-dialog",{attrs:{title:"合样",visible:e.sampleTaskVisible,width:"80%","close-on-click-modal":!1,top:"1vh"},on:{"update:visible":function(t){e.sampleTaskVisible=t}}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"任务单号:"}},[e._v("\n            "+e._s(e.currentRow.jobId)+"\n          ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"受检单位:"}},[e._v("\n            "+e._s(e.currentRow.inspectionName)+"\n          ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v("\n            "+e._s(e.currentRow.inspectionLinkerPhone)+"\n          ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"要求完成时间:"}},[e._v("\n            "+e._s(e.currentRow.startDate)+"~"+e._s(e.currentRow.endDate)+"\n          ")])],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px","padding-bottom":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n          采样位置分配 "),a("i",{staticClass:"el-input__icon "}),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该采样任务分配信息仅作为给采样组长的提示信息，不与后续流程强关联，采样负责人也可以不分配。建议该位置分配给哪个组长就由该组长进行合样操作。"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1),e.roles.indexOf("Pm")>-1?a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{slot:"small",type:"primary",disabled:0==e.multipleLeaderSelection.length,plain:""},on:{click:e.choseLeader},slot:"small"},[e._v("确认")]):e._e(),e.roles.indexOf("Pm")>-1?a("el-select",{staticStyle:{float:"right",margin:"4px 2px",width:"250px"},attrs:{slot:"small",filterable:"",multiple:"",placeholder:"请选择采样组长"},slot:"small",model:{value:e.leaderfactorPoint,callback:function(t){e.leaderfactorPoint=t},expression:"leaderfactorPoint"}},e._l(e.perGroups,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.empName,value:e.userId}})})),1):e._e()],1),a("el-table",{ref:"pointAddressInfo",attrs:{data:e.pointAddress,border:"",stripe:"","max-height":"300"},on:{"selection-change":e.handleLeaderSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleUsers",label:"采样组长",align:"center"}})],1)],1),a("el-card",{staticStyle:{"margin-top":"10px","padding-bottom":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n          合样操作备忘录"),a("i",{staticClass:"el-input__icon "}),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"您可以录入任意备忘录信息以协同合样操作，采样负责人和采样组长都可以在文本框中增添信息并查看"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1)]),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入备注信息"},model:{value:e.combinedRemark,callback:function(t){e.combinedRemark=t},expression:"combinedRemark"}})],1)],1)],1),a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"自检因子"}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("span",[e._v("自检因子信息"),a("i",{staticClass:"el-input__icon "})])]),a("el-col",{staticStyle:{padding:"10px","text-align":"left"},attrs:{span:15}},[a("span",{staticStyle:{color:"red",width:"100%"}},[e._v("注意：选择需要合样的因子进行“合样”操作，其他不需要合样的因子可以在合样完成后，点击“全选”按钮，进行“自成样品”操作。")])]),a("el-col",{staticStyle:{padding:"5px","text-align":"right"},attrs:{span:5}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.moveFactors}},[e._v("自成样品")]),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.mergeFactors}},[e._v("合样")])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("\n               \n              "),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.toggleZjSelection(0)}}},[e._v("全选")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.toggleZjSelection(1)}}},[e._v("取消")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[a("el-input",{staticStyle:{width:"250px","padding-bottom":"5px"},attrs:{placeholder:"请录入因子名称"},model:{value:e.showFactorName,callback:function(t){e.showFactorName=t},expression:"showFactorName"}})],1)],1),a("el-table",{ref:"choseTable",staticStyle:{width:"100%"},attrs:{stripe:"",border:"",size:"small",data:e.filterData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"400px"},on:{"selection-change":e.handleSelectionChange,select:e.handleSelect}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:e.checkSelectable,align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",filters:e.zjClassNames,"filter-method":e.filterZJClass,"column-key":"secdClassName",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"200px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",filters:e.zjFactorNames,"filter-method":e.filterZjTable,"column-key":"factorPoint",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{label:"状态",align:"center"}},[[a("el-tag",{attrs:{type:""}},[e._v("自检")])]],2)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("合样列表"),a("i",{staticClass:"el-input__icon "})]),e.roles.indexOf("Pm")>-1?a("el-select",{staticStyle:{float:"right",margin:"4px 2px",width:"250px"},attrs:{slot:"small",filterable:"",clearable:"",placeholder:"请选择采样组长"},on:{change:function(t){return e.handleOnlineChangeRow()}},slot:"small",model:{value:e.mergeOnline,callback:function(t){e.mergeOnline=t},expression:"mergeOnline"}},e._l(e.perGroups,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.empName,value:e.userId}})})),1):e._e()],1),a("el-table",{ref:"mergerInfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.mergeData,size:"small","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"400px"},on:{"selection-change":e.handleMergeChange}},[e.roles.indexOf("Pm")>-1?a("el-table-column",{attrs:{align:"center",type:"selection",width:"50"}}):e._e(),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"200px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"样品数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{prop:"sampleUser",label:"采样组长",align:"center",width:"135"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,o=t.$index;return[e.roles.indexOf("Pm")>-1||e.userInfo.userId===r.sampleUserId?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.delGroupRow(r,o)}}},[e._v("删除")]):e._e()]}}])})],1)],1)],1),a("el-tab-pane",{attrs:{label:"分包因子"}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("span",[e._v("分包因子信息"),a("i",{staticClass:"el-input__icon "})])]),a("el-col",{staticStyle:{padding:"10px","text-align":"right"},attrs:{span:15}},[a("span",{staticStyle:{color:"red",width:"100%"}},[e._v("注意：选择需要合样的因子进行“合样”操作，其他不需要合样的因子可以在合样完成后，点击“全选”按钮，进行“自成样品”操作。")])]),a("el-col",{staticStyle:{padding:"5px","text-align":"right"},attrs:{span:5}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.moveOutFactors}},[e._v("自成样品")]),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.mergeOutFactors}},[e._v("合样")])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("\n               \n              "),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.toggleFbSelection(0)}}},[e._v("全选")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.toggleFbSelection(1)}}},[e._v("取消")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[a("el-input",{staticStyle:{width:"250px","padding-bottom":"5px"},attrs:{placeholder:"请录入因子名称"},model:{value:e.showOutFactorName,callback:function(t){e.showOutFactorName=t},expression:"showOutFactorName"}})],1)],1),a("el-table",{ref:"choseOutTable",staticStyle:{width:"100%","marggin-top":"10px"},attrs:{stripe:"",border:"",size:"small",data:e.outFilterData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"300px"},on:{"selection-change":e.handleOutSelectionChange,select:e.handleOutSelect}},[a("el-table-column",{attrs:{type:"selection",width:"45",selectable:e.checkOutSelectable,align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",filters:e.wbClassNames,"filter-method":e.filterFbClass,"column-key":"secdClassName",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"200px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",filters:e.wbFactorNames,"filter-method":e.filterFbTable,"column-key":"factorPoint",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{label:"状态",align:"center"}},[[a("el-tag",{attrs:{type:"danger"}},[e._v("分包")])]],2)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("分包合样列表"),a("i",{staticClass:"el-input__icon "})]),e.roles.indexOf("Pm")>-1?a("el-select",{staticStyle:{float:"right",margin:"4px 2px",width:"250px"},attrs:{slot:"small",filterable:"",placeholder:"请选择采样组长"},on:{change:function(t){return e.handleOutOnlineChangeRow()}},slot:"small",model:{value:e.mergeOutOnline,callback:function(t){e.mergeOutOnline=t},expression:"mergeOutOnline"}},e._l(e.perGroups,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.empName,value:e.userId}})})),1):e._e()],1),a("el-table",{ref:"mergeOutRef",staticStyle:{width:"100%"},attrs:{border:"",data:e.mergeOutData,size:"small","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"400px"},on:{"selection-change":e.handleMergeOutChange}},[e.roles.indexOf("Pm")>-1?a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}):e._e(),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"200px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",align:"center"}}),a("el-table-column",{attrs:{label:"样品数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                "+e._s(Number(a.frequency*a.dayCount).toFixed(0))+"\n              ")]}}])}),a("el-table-column",{attrs:{prop:"sampleUser",label:"采样组长",align:"center",width:"135"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,o=t.$index;return[e.roles.indexOf("Pm")>-1||e.userInfo.userId===r.sampleUserId?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.delOutGroupRow(r,o)}}},[e._v("删除")]):e._e()]}}])})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleTaskVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{disabled:e.saveDisable,type:"primary"},on:{click:e.saveDialog}},[e._v("保存")]),e.roles.indexOf("Pm")>-1?a("el-button",{attrs:{type:"primary",disabled:"1"!==e.currentRow.sampTaskStatus},on:{click:e.confirmDialog}},[e._v("确认")]):e._e()],1)],1)],1)},o=[],s=(a("6b54"),a("28a5"),a("75fc")),l=(a("55dd"),a("7514"),a("ac6a"),a("5df3"),a("f400"),a("3b2b"),a("db72")),n=a("47bc"),i=a("b705"),c=a("333d"),d=a("4328"),u=a.n(d),p=a("2f62"),m={0:"待合样",1:"已合样",2:"采样中"},h={components:{Pagination:c["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:m,sampleData:[],searchForm:{jobId:"",projectName:"",sampTaskStatus:"",pageNumber:1,pageSize:50},total:0,taskTitle:"",taskVisible:!1,factorData:[],factorDetailData:[],factorOldDetailData:[],factorOutDetailData:[],factorOldOutDetailData:[],taskForm:{projectName:"",offerId:"",contCode:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:""},sampleTaskVisible:!1,currentRow:{},multipleSelection:[],multipleLeaderSelection:[],multipleSampleSelection:[],multipleOutSelection:[],perGroups:[],mergeData:[],mergeOutData:[],currentSelectionRow:{secdClassId:"",factorPoint:"",frequency:"",dayCount:""},currentOutSelectionRow:{secdClassId:"",factorPoint:"",frequency:"",dayCount:""},showFactorName:"",showOutFactorName:"",pointAddress:[],leaderfactorPoint:"",combinedRemark:"",mergeOnline:"",mergeOutOnline:"",saveDisable:!1,zjFactorNames:[],wbFactorNames:[],zjClassNames:[],wbClassNames:[],checkZjVisible:!1,checkFbVisible:!1,checkZjClassVisible:!1,checkFbClassVisible:!1}},computed:Object(l["a"])(Object(l["a"])({},Object(p["b"])(["roles","userInfo"])),{},{filterData:function(){if(this.showFactorName&&this.showFactorName.length>0){var e=new RegExp(this.showFactorName.trim());return this.factorDetailData.filter((function(t){return e.test(t.factorName)}))}return this.factorDetailData},outFilterData:function(){if(this.showOutFactorName&&this.showOutFactorName.length>0){var e=new RegExp(this.showOutFactorName.trim());return this.factorOutDetailData.filter((function(t){return e.test(t.factorName)}))}return this.factorOutDetailData}}),created:function(){this.getFactorPeople(),this.handleSearch()},methods:{getFactorPeople:function(){var e=this;i["c"]().then((function(t){e.perGroups=t.result||[]}))},handleSearch:function(){var e=this;n["q"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.taskTitle=e.projectName,this.taskForm=Object.assign({},e),n["w"](e.jobId).then((function(e){200===e.code&&e.result&&(t.factorData=t.doProcessData(e.result),t.taskVisible=!0)}))},doProcessData:function(e){var t=this,a=[];if(e.length>0){var r=new Map;e.forEach((function(e){var t=a.find((function(t){return t.secdClassName===e.secdClassName&&t.fbFlag===e.fbFlag}));if(t||a.push({secdClassName:e.secdClassName,fbFlag:e.fbFlag,factList:[]}),r.get(e.secdClassName+"-"+e.fbFlag)){var o=r.get(e.secdClassName+"-"+e.fbFlag);o.push(e)}else{var s=[];s.push(e),r.set(e.secdClassName+"-"+e.fbFlag,s)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName+"-"+e.fbFlag),o=[];a&&(a.forEach((function(a){var r=o.find((function(e){return e.factorPoint===a.factorPoint&&e.frequency===a.frequency&&e.dayCount===a.dayCount?(e.showFactName=e.showFactName+","+a.factorName,e):null}));r||(t.$set(a,"showFactName",a.factorName),t.$set(a,"fbFlag",e.fbFlag),o.push(a))})),e.factList=o.sort((function(e,t){return e.checkStandardId>t.checkStandardId?-1:e.checkStandardId<t.checkStandardId?1:0})))}))}return a},getPointAddress:function(e){var t=this;n["A"](e).then((function(e){t.pointAddress=e.result||[]}))},filterZjTable:function(e,t){return this.checkZjVisible=!0,t.factorPoint===e},filterZJClass:function(e,t){return this.checkZjClassVisible=!0,t.secdClassName===e},filterFbTable:function(e,t){return t.factorPoint===e},filterFbClass:function(e,t){return t.secdClassName===e},handleSchedTask:function(e){var t=this;this.currentRow=Object.assign({},e),e.sampTaskStatus>0?this.saveDisable=!0:this.saveDisable=!1,this.getPointAddress(e.sampTaskId),this.combinedRemark=e.combinedRemark,this.zjFactorNames=[],this.wbFactorNames=[],this.zjClassNames=[],this.wbClassNames=[],this.multipleSampleSelection=[],this.multipleOutSampleSelection=[],this.mergeOnline="",this.mergeOutOnline="",this.factorDetailData=[],this.factorOldDetailData=[],this.mergeData=[],this.oldMergeData=[],this.factorOutDetailData=[],this.factorOldOutDetailData=[],this.mergeOutData=[],n["D"]({jobId:this.currentRow.jobId,fbFlag:"0"}).then((function(e){200===e.code&&e.result&&(t.factorDetailData=e.result||[],t.factorOldDetailData=Object(s["a"])(e.result)||[],e.result.forEach((function(e){var a=t.zjFactorNames.find((function(t){return t.text===e.factorPoint}));a||t.zjFactorNames.push({text:e.factorPoint,value:e.factorPoint});var r=t.zjClassNames.find((function(t){return t.text===e.secdClassName}));r||t.zjClassNames.push({text:e.secdClassName,value:e.secdClassName})}))),t.sampleTaskVisible=!0,t.clearSelectionRow()})),n["B"]({jobId:this.currentRow.jobId,fbFlag:"1"}).then((function(e){200===e.code&&e.result&&(t.factorOutDetailData=e.result||[],t.factorOldOutDetailData=Object(s["a"])(e.result)||[],e.result.forEach((function(e){var a=t.wbFactorNames.find((function(t){return t.text===e.factorPoint}));a||t.wbFactorNames.push({text:e.factorPoint,value:e.factorPoint});var r=t.wbClassNames.find((function(t){return t.text===e.secdClassName}));r||t.wbClassNames.push({text:e.secdClassName,value:e.secdClassName})}))),t.clearOutSelectionRow()})),this.getSampleListOn()},getSampleListOn:function(){var e=this;n["z"]({sampTaskId:this.currentRow.sampTaskId,fbFlag:"0"}).then((function(t){200===t.code&&t.result&&(e.mergeData=t.result.map((function(t){return e.$set(t,"isBack",1),t}))||[])})),n["z"]({sampTaskId:this.currentRow.sampTaskId,fbFlag:"1"}).then((function(t){200===t.code&&t.result&&(e.mergeOutData=t.result.map((function(t){return e.$set(t,"isBack",1),t}))||[])}))},choseLeader:function(){var e=this,t={sampleUserIds:"",sampleUsers:""};this.perGroups.forEach((function(a){e.leaderfactorPoint.indexOf(a.userId)>-1&&(t.sampleUserIds+=a.userId+",",t.sampleUsers+=a.empName+",")})),this.multipleLeaderSelection.forEach((function(a){e.pointAddress.forEach((function(r){r.factorPoint===a.factorPoint&&(e.$set(a,"sampleUserIds",e.leaderfactorPoint),e.$set(a,"sampleUsers",t.sampleUsers))}))})),this.$refs.pointAddressInfo.clearSelection()},choseSampleLeader:function(){var e=this,t=this.perGroups.find((function(t){return t.userId===e.mergeOnline}));t&&(this.multipleSampleSelection.forEach((function(a){e.mergeData.forEach((function(r){r.factorPoint===a.factorPoint&&(e.$set(a,"sampleUserIds",e.mergeOnline),e.$set(a,"sampleUser",t.empName))}))})),this.$refs.mergerInfo.clearSelection())},saveDialog:function(){var e=this;this.saveLeaders(),(this.mergeData.length>0||this.mergeOutData.length>0)&&this.$confirm("确定提交合样?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.mergeData.map((function(t){var a=t.secdClassId,r=t.secdClassName,o=t.jobPlanFactorId,s=t.factorName,l=t.dayCount,n=t.frequency,i=t.sampleUserId,c=t.sampleUser,d=t.factorPoint,u=t.factorGroupKey;return{sampleTaskId:e.currentRow.sampTaskId,jobId:e.currentRow.jobId,secdClassId:a,secdClassName:r,factorName:s,dayCount:l,frequency:n,sampleUserId:i,sampleUser:c,factorPoint:d,jobPlanFactorId:o,fbFlag:"0",factorGroupKey:u}})),a=[];e.mergeOutData&&e.mergeOutData.length>0&&(a=e.mergeOutData.map((function(t){var a=t.secdClassId,r=t.secdClassName,o=t.jobPlanFactorId,s=t.factorName,l=t.dayCount,n=t.frequency,i=t.sampleUserId,c=t.sampleUser,d=t.factorPoint,u=t.factorGroupKey;return{sampleTaskId:e.currentRow.sampTaskId,jobId:e.currentRow.jobId,secdClassId:a,secdClassName:r,factorName:s,dayCount:l,frequency:n,sampleUserId:i,sampleUser:c,factorPoint:d,jobPlanFactorId:o,fbFlag:"1",factorGroupKey:u}})));var r=t.concat(a);n["G"](JSON.stringify(r)).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.sampleTaskVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},confirmDialog:function(){var e=this;if(this.factorDetailData&&this.factorDetailData.length>0)this.$message.warning("样品必须全部合样后才能确认");else if(this.factorOutDetailData&&this.factorOutDetailData.length>0)this.$message.warning("剩余分包样品请进行自成样品操作！");else{var t=this.mergeData.find((function(e){return!e.sampleUserId||e.sampleUserId.length<=0||!e.isBack}));if(t)this.$message.error("人员分配完成后请先进行保存！");else{var a=this.mergeOutData.find((function(e){return!e.sampleUserId||e.sampleUserId.length<=0||!e.isBack}));a?this.$message.error("人员分配完成后请先进行保存！"):this.$confirm("确定提交合样?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["e"](u.a.stringify({sampTaskId:e.currentRow.sampTaskId})).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.sampleTaskVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},delGroupRow:function(e,t){var a=this;if(1===e.isBack)this.$confirm("该删除会刷新当前合样列表?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["f"](e.id).then((function(e){200===e.code?(a.$notify({title:"成功",message:e.message,type:"success"}),a.currentRow.sampTaskStatus=0,a.handleSearch(),a.handleSchedTask(a.currentRow)):a.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}));else{var r=e.jobPlanFactorId.split(",");r.forEach((function(e){var t=a.factorOldDetailData.find((function(t){return t.jobPlanFactorId===e}));t&&a.factorDetailData.push(t)})),this.mergeData.splice(t,1)}},delOutGroupRow:function(e,t){var a=this;if(1===e.isBack)this.$confirm("该删除会刷新当前合样列表?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["f"](e.id).then((function(e){200===e.code?(a.$notify({title:"成功",message:e.message,type:"success"}),a.currentRow.sampTaskStatus=0,a.handleSearch(),a.handleSchedTask(a.currentRow)):a.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}));else{var r=e.jobPlanFactorId.split(",");r.forEach((function(e){var t=a.factorOldOutDetailData.find((function(t){return t.jobPlanFactorId===e}));t&&a.factorOutDetailData.push(t)})),this.mergeOutData.splice(t,1)}},handleSelectionChange:function(e){this.multipleSelection=e},handleOutSelectionChange:function(e){this.multipleOutSelection=e},clearSelectionRow:function(){this.currentSelectionRow={secdClassId:"",factorPoint:"",frequency:"",dayCount:""}},clearOutSelectionRow:function(){this.currentOutSelectionRow={secdClassId:"",factorPoint:"",frequency:"",dayCount:""}},handleSelect:function(e,t){e.length>0?(this.currentSelectionRow.secdClassId=t.secdClassId,this.currentSelectionRow.factorPoint=t.factorPoint,this.currentSelectionRow.frequency=t.frequency,this.currentSelectionRow.dayCount=t.dayCount):this.clearSelectionRow()},handleOutSelect:function(e,t){e.length>0?(this.currentOutSelectionRow.secdClassId=t.secdClassId,this.currentOutSelectionRow.factorPoint=t.factorPoint,this.currentOutSelectionRow.frequency=t.frequency,this.currentOutSelectionRow.dayCount=t.dayCount):this.clearOutSelectionRow()},checkRow:function(e){return!!this.checkZjVisible||(!this.currentSelectionRow.secdClassId||""===this.currentSelectionRow.secdClassId||e.secdClassId===this.currentSelectionRow.secdClassId&&e.factorPoint.trim()===this.currentSelectionRow.factorPoint.trim()&&e.frequency===this.currentSelectionRow.frequency&&e.dayCount===this.currentSelectionRow.dayCount)},checkSelectable:function(e){return this.checkRow(e)},checkOutSelectable:function(e){return!!this.checkFbVisible||(!this.currentOutSelectionRow.secdClassId||""===this.currentOutSelectionRow.secdClassId||e.secdClassId===this.currentOutSelectionRow.secdClassId&&e.factorPoint===this.currentOutSelectionRow.factorPoint&&e.frequency===this.currentOutSelectionRow.frequency&&e.dayCount===this.currentOutSelectionRow.dayCount)},delMergeData:function(){this.mergeData=[],this.factorDetailData=Object(s["a"])(this.factorOldDetailData),this.clearSelectionRow(),this.$refs.choseTable.clearSelection()},delMergeOutData:function(){this.mergeOutData=[],this.factorOutDetailData=Object(s["a"])(this.factorOldOutDetailData),this.clearOutSelectionRow(),this.$refs.choseOutTable.clearSelection()},sortData:function(){this.mergeData.sort((function(e,t){return e.secdClassId===t.secdClassId?e.factorPoint-t.factorPoint:t.secdClassId-e.secdClassId})),this.mergeData.reverse()},sortOutData:function(){this.mergeOutData.sort((function(e,t){return e.secdClassId===t.secdClassId?e.factorPoint-t.factorPoint:t.secdClassId-e.secdClassId})),this.mergeOutData.reverse()},moveFactors:function(){var e=this;this.multipleSelection&&this.multipleSelection.length>0&&(this.multipleSelection.forEach((function(t){e.roles.indexOf("Po")>-1&&(e.$set(t,"sampleUserId",e.userInfo.userId),e.$set(t,"sampleUser",e.userInfo.empName));var a=e.factorDetailData.indexOf(t);e.factorDetailData.splice(a,1),e.mergeData.push(t)})),this.multipleSelection=[],this.clearSelectionRow())},moveOutFactors:function(){var e=this;this.multipleOutSelection&&this.multipleOutSelection.length>0&&(this.multipleOutSelection.forEach((function(t){e.roles.indexOf("Po")>-1&&(e.$set(t,"sampleUserId",e.userInfo.userId),e.$set(t,"sampleUser",e.userInfo.empName));var a=e.factorOutDetailData.indexOf(t);e.factorOutDetailData.splice(a,1),e.mergeOutData.push(Object(l["a"])(Object(l["a"])({},t),{},{collectLeaderId:""}))})),this.multipleOutSelection=[],this.clearOutSelectionRow())},mergeFactors:function(){var e=this;if(this.roles.indexOf("Po")>-1||this.roles.indexOf("Pm")>-1)if(this.multipleSelection&&this.multipleSelection.length>0){var t=[];if(this.multipleSelection.forEach((function(e){var a=t.find((function(t){return t.secdClassId===e.secdClassId&&t.factorPoint.trim()===e.factorPoint.trim()&&t.frequency===e.frequency&&t.dayCount===e.dayCount}));a||t.push(e)})),t.length>1)return void this.$message.error("当前选择不符合合样标准");var a={};this.multipleSelection.forEach((function(t){a&&a.jobPlanFactorId?(a.factorName+=","+t.factorName,a.jobPlanFactorId+=","+t.jobPlanFactorId):a=Object(l["a"])({},t),e.roles.indexOf("Po")>-1&&(e.$set(a,"sampleUserId",e.userInfo.userId),e.$set(a,"sampleUser",e.userInfo.empName));var r=e.factorDetailData.indexOf(t);e.factorDetailData.splice(r,1)})),this.mergeData.push(a),this.multipleSelection=[],this.clearSelectionRow(),this.$refs.choseTable.clearSelection()}else this.$message.error("至少选择一个因子合样");else this.$message.error("只有负责任/采样组长才能进行合样")},mergeOutFactors:function(){var e=this;if(this.roles.indexOf("Po")>-1||this.roles.indexOf("Pm")>-1)if(this.multipleOutSelection&&this.multipleOutSelection.length>0){var t=[];if(this.multipleOutSelection.forEach((function(e){var a=t.find((function(t){return t.secdClassId===e.secdClassId&&t.factorPoint===e.factorPoint&&t.frequency===e.frequency&&t.dayCount===e.dayCount}));a||t.push(e)})),t.length>1)return void this.$message.error("当前选择不符合合样标准");var a={};this.multipleOutSelection.forEach((function(t){a&&a.jobPlanFactorId?(a.factorName+=","+t.factorName,a.jobPlanFactorId+=","+t.jobPlanFactorId):a=Object(l["a"])({},t),e.roles.indexOf("Po")>-1&&(e.$set(a,"sampleUserId",e.userInfo.userId),e.$set(a,"sampleUser",e.userInfo.empName));var r=e.factorOutDetailData.indexOf(t);e.factorOutDetailData.splice(r,1)})),this.mergeOutData.push(a),this.multipleOutSelection=[],this.clearOutSelectionRow(),this.$refs.choseOutTable.clearSelection()}else this.$message.error("至少选择一个因子合样");else this.$message.error("只有负责任/采样组长才能进行合样")},handlePrint:function(e){this.$router.push("/sampleDetail/".concat(e.sampTaskId))},handleChangeRow:function(e){var t=this;this.mergeData.forEach((function(a){a.collectLeaderId&&""!==a.collectLeaderId||e.factorPoint===a.factorPoint&&t.$set(a,"collectLeaderId",e.collectLeaderId)}))},handleLeaderChangeRow:function(){var e=this;if(this.multipleLeaderSelection.length>0){var t={sampleUserId:"",sampleUsers:""};this.perGroups.forEach((function(a){e.leaderfactorPoint.indexOf(a.userId)>-1&&(t.sampleUserId+=a.userId+",",t.sampleUsers+=a.empName+",")})),this.multipleLeaderSelection.forEach((function(a){e.pointAddress.forEach((function(r){r.factorPoint===a.factorPoint&&(e.$set(a,"sampleUserId",e.leaderfactorPoint),e.$set(a,"sampleUsers",t.sampleUsers))}))}))}},handleMergeChange:function(e){this.multipleSampleSelection=e,this.mergeOnline=""},handleOnlineChangeRow:function(){var e=this,t=this.perGroups.find((function(t){return t.userId===e.mergeOnline}));t&&(this.multipleSampleSelection.forEach((function(a){e.mergeData.forEach((function(r){r.factorPoint===a.factorPoint&&(e.$set(a,"sampleUserId",e.mergeOnline),e.$set(a,"sampleUser",t.empName))}))})),this.$refs.mergerInfo.clearSelection())},handleMergeOutChange:function(e){this.multipleOutSampleSelection=e,this.mergeOutOnline=""},handleOutOnlineChangeRow:function(){var e=this,t=this.perGroups.find((function(t){return t.userId===e.mergeOutOnline}));t&&(this.multipleOutSampleSelection.forEach((function(a){e.mergeOutData.forEach((function(r){r.factorPoint===a.factorPoint&&(e.$set(a,"sampleUserId",e.mergeOutOnline),e.$set(a,"sampleUser",t.empName))}))})),this.$refs.mergeOutRef.clearSelection())},saveLeaders:function(){var e=this,t={sampTaskId:this.currentRow.sampTaskId,combinedRemark:this.combinedRemark};if(n["F"](u.a.stringify({param:JSON.stringify(t)})).then((function(t){e.$notify({title:"成功",message:"备注信息保存成功",type:"success"}),(-1===e.roles.indexOf("Pm")&&!e.mergeOutData||e.mergeOutData.length<=0)&&(e.sampleTaskVisible=!1,e.handleSearch())})),this.roles.indexOf("Pm")>-1){var a=[];if(this.pointAddress.forEach((function(e){e.sampleUserIds&&a.push({factorPoint:e.factorPoint,sampleUserId:e.sampleUserIds.toString()})})),a.length>0){var r={sampTaskId:this.currentRow.sampTaskId,params:a};n["a"](u.a.stringify({param:JSON.stringify(r)})).then((function(t){200===t.code?(!e.mergeOutData||e.mergeOutData.length<=0)&&(e.sampleTaskVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))}}},handleLeaderSelectionChange:function(e){this.multipleLeaderSelection=e},toggleZjSelection:function(e){0===e?(this.checkZjVisible=!0,this.$refs.choseTable.toggleAllSelection()):(this.clearSelectionRow(),this.$refs.choseTable.clearSelection(),this.checkZjVisible=!1)},toggleFbSelection:function(e){0===e?(this.checkFbVisible=!0,this.$refs.choseOutTable.toggleAllSelection()):(this.clearOutSelectionRow(),this.$refs.choseOutTable.clearSelection(),this.checkFbVisible=!1)}}},f=h,b=(a("6805"),a("341a"),a("693c"),a("2877")),g=Object(b["a"])(f,r,o,!1,null,"6e9de24d",null);t["default"]=g.exports},"6c40":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampleNo,callback:function(t){e.$set(e.searchForm,"sampleNo",t)},expression:"searchForm.sampleNo"}})],1),a("el-form-item",{attrs:{label:"样品状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.sampStatus,callback:function(t){e.$set(e.searchForm,"sampStatus",t)},expression:"searchForm.sampStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:"primary"},on:{click:e.goBack}},[e._v(" 返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleAddRecords}},[e._v("采样记录单导出")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无采样样品信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",fixed:"left",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",sortable:"",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"collectTime",label:"采样时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.collectTime&&a.collectTime.length>0?a.collectDate+" "+a.collectTime:a.collectDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.smapStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.smapStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样人",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",width:"80",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.smapStatus>1?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{border:"",data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"现场采样记录单下载",visible:e.downVisible,width:"400px",center:""},on:{"update:visible":function(t){e.downVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.recordForm,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"240px"},attrs:{clearable:"",filterable:"",placeholder:"检测对象"},on:{change:e.findSecClass},model:{value:e.recordForm.classId,callback:function(t){e.$set(e.recordForm,"classId",t)},expression:"recordForm.classId"}},e._l(e.classArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"240px"},attrs:{clearable:"",filterable:"",placeholder:"检测类别"},model:{value:e.recordForm.secClassId,callback:function(t){e.$set(e.recordForm,"secClassId",t)},expression:"recordForm.secClassId"}},e._l(e.secClassArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-row",[a("el-col",{staticStyle:{"text-align":"left"},attrs:{span:8}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.allDownload}},[e._v("全部下载")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:16}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.downVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmDownload}},[e._v("确认")])],1)],1)],1)])],1)},o=[],s=a("47bc"),l=a("d43b"),n=a("b705"),i=a("333d"),c={0:"待采样",1:"已采样",2:"组长待审核",3:"负责人待审核",4:"审核通过",5:"审核失败",6:"已入库",7:"部分出库",8:"已出库",9:"入库中",10:"待复核"},d={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"5"===e?"":"9"===e?"danger":e<4?"warning":e<9?"success":"danger"}},data:function(){return{SAMPLE_STATUS:c,sampleData:[],searchForm:{sampTaskId:"",sampleNo:"",sampStatus:"",pageNumber:1,pageSize:10},total:0,currentSample:"",sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},sampleImage:"",sampleVisible:!1,sampleImageList:[],downVisible:!1,recordForm:{taskId:"",classId:"",secClassId:"",sampleDate:""},classArray:[],secClassArray:[],sampleDetails:[],sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.getClassList(),this.$route.params.sampTaskId&&(this.searchForm.sampTaskId=this.$route.params.sampTaskId,this.handleSearch())},methods:{handleSearch:function(){var e=this;this.searchForm.sampTaskId&&s["t"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";l["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep&&-1===e.checkStandardId.indexOf("100004-")}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},getClassList:function(){var e=this;n["a"]().then((function(t){e.classArray=t.result||[]}))},findSecClass:function(e){var t=this;this.recordForm.secClassId="",n["d"](e).then((function(e){t.secClassArray=e.result||[]}))},handleAddRecords:function(){this.recordForm.taskId=this.$route.params.sampTaskId,this.recordForm.classId="",this.recordForm.secClassId="",this.recordForm.sampleDate="",this.downVisible=!0},allDownload:function(){var e="/api/word/downBlankSampleRecordByTaskId?taskId="+this.recordForm.taskId;window.open(e)},confirmDownload:function(){if(this.recordForm.taskId&&this.recordForm.secClassId){var e="/api/word/downSampleRecordByTaskIdAndSecdClassId?taskId="+this.recordForm.taskId+"&secdClassId="+this.recordForm.secClassId;window.open(e)}else this.$message.warning("检测类别不能为空")},goBack:function(){this.$router.go(-1)}}},u=d,p=(a("85be"),a("e744"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"1d88e46e",null);t["default"]=m.exports},"6da3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待确认样品",name:"1"}},[a("master-approve-list",{attrs:{"samp-task-id":e.sampTaskId}})],1),a("el-tab-pane",{attrs:{label:"已确认样品",name:"2"}},[a("master-his-approve-list",{attrs:{"samp-task-id":e.sampTaskId}})],1)],1)],1)},o=[],s=a("3403"),l=a("76d5"),n={components:{MasterApproveList:s["default"],MasterHisApproveList:l["default"]},data:function(){return{activeName:"1",sampTaskId:""}},created:function(){this.$route.params.sampTaskId&&(this.sampTaskId=this.$route.params.sampTaskId)},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},"6ecf":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待检测列表",name:"1"}},[a("outLaborList")],1),a("el-tab-pane",{attrs:{label:"历史检测列表",name:"2"}},[a("hisOutLaborList")],1)],1)],1)},o=[],s=a("47a90"),l=a("733e"),n={components:{outLaborList:s["default"],hisOutLaborList:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},"6f52":function(e,t,a){},7054:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入用户名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.userName,callback:function(t){e.$set(e.queryParams,"userName",t)},expression:"queryParams.userName"}})],1),a("el-form-item",{attrs:{label:"手机号码",prop:"phonenumber"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入手机号码",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.phonenumber,callback:function(t){e.$set(e.queryParams,"phonenumber",t)},expression:"queryParams.phonenumber"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:role:add"],expression:"['system:role:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.openSelectUser}},[e._v("添加用户")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:role:remove"],expression:"['system:role:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-circle-close",size:"mini",disabled:e.multiple},on:{click:e.cancelAuthUserAll}},[e._v("批量取消授权")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"warning",plain:"",icon:"el-icon-close",size:"mini"},on:{click:e.handleClose}},[e._v("关闭")])],1),a("right-toolbar",{attrs:{"show-search":e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.userList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"邮箱",prop:"email","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dict-tag",{attrs:{options:e.statusOptions,value:t.row.status}})]}}])}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:role:remove"],expression:"['system:role:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-circle-close"},on:{click:function(a){return e.cancelAuthUser(t.row)}}},[e._v("取消授权")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),a("select-user",{ref:"select",attrs:{"role-id":e.queryParams.roleId},on:{ok:e.handleQuery}})],1)},o=[],s=a("3528"),l=a("a17e"),n={name:"AuthUser",components:{selectUser:l["default"]},data:function(){return{loading:!0,userIds:[],multiple:!0,showSearch:!0,total:0,userList:[],statusOptions:[],queryParams:{pageNumber:1,pageSize:10,roleId:void 0,userName:void 0,phonenumber:void 0}}},created:function(){var e=this,t=this.$route.params&&this.$route.params.roleId;t&&(this.queryParams.roleId=t,this.getList(),this.getDicts("sys_normal_disable").then((function(t){e.statusOptions=t.data})))},methods:{getList:function(){var e=this;this.loading=!0,Object(s["b"])(this.queryParams).then((function(t){e.userList=t.rows,e.total=t.total,e.loading=!1}))},handleClose:function(){this.$store.dispatch("tagsView/delView",this.$route),this.$router.push({path:"/system/role"})},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e){this.userIds=e.map((function(e){return e.userId})),this.multiple=!e.length},openSelectUser:function(){this.$refs.select.show()},cancelAuthUser:function(e){var t=this,a=this.queryParams.roleId;this.$confirm('确认要取消该用户"'+e.userName+'"角色吗？',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["c"])({userId:e.userId,roleId:a})})).then((function(){t.getList(),t.msgSuccess("取消授权成功")})).catch((function(){}))},cancelAuthUserAll:function(e){var t=this,a=this.queryParams.roleId,r=this.userIds.join(",");this.$confirm("是否取消选中用户授权数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["d"])({roleId:a,userIds:r})})).then((function(){t.getList(),t.msgSuccess("取消授权成功")})).catch((function(){}))}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},"70e3":function(e,t,a){},"70eb":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{staticStyle:{width:"170px"},attrs:{placeholder:"请输入角色名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.roleName,callback:function(t){e.$set(e.queryParams,"roleName",t)},expression:"queryParams.roleName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"small"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.roleList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{label:"角色名称",prop:"roleName",sortable:"",align:"center"}}),a("el-table-column",{attrs:{label:"创建日期",align:"center",prop:"createTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime,"{y}-{m}-{d}")))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return 1!==t.row.roleId?[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:role:edit"],expression:"['system:role:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")])]:void 0}}],null,!0)})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNumber,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNumber",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),a("el-dialog",{attrs:{title:e.title,visible:e.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{placeholder:"请输入角色名称",disabled:""},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),a("el-form-item",{attrs:{label:"数据权限"}},[a("el-select",{staticStyle:{width:"200px"},model:{value:e.form.dataScope,callback:function(t){e.$set(e.form,"dataScope",t)},expression:"form.dataScope"}},e._l(Object.keys(e.AUTH_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.AUTH_STATUS[t],value:t}})})),1)],1),a("el-form-item",{attrs:{label:"菜单权限"}},[a("el-checkbox",{on:{change:function(t){return e.handleCheckedTreeNodeAll(t,"menu")}},model:{value:e.menuNodeAll,callback:function(t){e.menuNodeAll=t},expression:"menuNodeAll"}},[e._v("全选/全不选")]),a("el-checkbox",{on:{change:function(t){return e.handleCheckedTreeConnect(t,"menu")}},model:{value:e.menuCheckStrictly,callback:function(t){e.menuCheckStrictly=t},expression:"menuCheckStrictly"}},[e._v("父子联动")]),a("el-tree",{ref:"menu",staticClass:"tree-border",attrs:{data:e.menuOptions,"show-checkbox":"","node-key":"id","check-strictly":!e.menuCheckStrictly,"empty-text":"加载中，请稍后",props:e.defaultProps}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},o=[],s=(a("ac6a"),a("3528")),l=a("b775");function n(){return Object(l["a"])({url:"/menu/findMenusTreeByUser",method:"get"})}function i(e){return Object(l["a"])({url:"/menu/roleMenuTreeselect/"+e,method:"get"})}var c=a("333d"),d={0:"正常",1:"停用"},u={1:"所有数据权限",3:"本部门及以下数据权限",4:"仅本人数据权限"},p={name:"Role",components:{Pagination:c["a"]},data:function(){return{ROLE_STATUS:d,AUTH_STATUS:u,loading:!0,exportLoading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,roleList:[],title:"",open:!1,openDataScope:!1,menuNodeAll:!1,menuOptions:[],deptOptions:[],menuCheckStrictly:!0,queryParams:{pageNumber:1,pageSize:20,roleName:"",roleKey:"",status:""},form:{},defaultProps:{children:"children",label:"label"},rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],roleKey:[{required:!0,message:"权限字符不能为空",trigger:"blur"}],roleSort:[{required:!0,message:"角色顺序不能为空",trigger:"blur"}]}}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.loading=!0,Object(s["l"])(this.queryParams).then((function(t){e.roleList=t.result.records||[],e.total=t.result.total,e.loading=!1})).catch((function(){e.loading=!1}))},getMenuTreeselect:function(){var e=this;n().then((function(t){e.menuOptions=t.result}))},getDeptTreeselect:function(){},getMenuAllCheckedKeys:function(){var e=this.$refs.menu.getCheckedKeys(),t=this.$refs.menu.getHalfCheckedKeys();return e.unshift.apply(e,t),e},getDeptAllCheckedKeys:function(){var e=this.$refs.dept.getCheckedKeys(),t=this.$refs.dept.getHalfCheckedKeys();return e.unshift.apply(e,t),e},getRoleMenuTreeselect:function(e){var t=this;return i(e).then((function(e){return t.menuOptions=e.result.treeSelect,e.result}))},getRoleDeptTreeselect:function(e){},handleStatusChange:function(e){var t=this,a="0"===e.status?"启用":"停用";this.$confirm('确认要"'+a+'""'+e.roleName+'"角色吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["f"])(e.roleId,e.status)})).then((function(){t.msgSuccess(a+"成功")})).catch((function(){e.status="0"===e.status?"1":"0"}))},cancel:function(){this.open=!1,this.reset()},cancelDataScope:function(){this.openDataScope=!1,this.reset()},reset:function(){void 0!==this.$refs.menu&&this.$refs.menu.setCheckedKeys([]),this.menuNodeAll=!1,this.form={roleId:void 0,roleName:"",roleKey:"",roleSort:0,status:"0",menuIds:[],dataScope:"",remark:""},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNumber=1,this.getList()},resetQuery:function(){this.dateRange=[],this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.roleId})),this.single=1!==e.length,this.multiple=!e.length},handleCommand:function(e,t){switch(e){case"handleDataScope":this.handleDataScope(t);break;case"handleAuthUser":this.handleAuthUser(t);break;default:break}},handleCheckedTreeExpand:function(e,t){if("menu"===t)for(var a=this.menuOptions,r=0;r<a.length;r++)this.$refs.menu.store.nodesMap[a[r].id].expanded=e;else if("dept"===t)for(var o=this.deptOptions,s=0;s<o.length;s++)this.$refs.dept.store.nodesMap[o[s].id].expanded=e},handleCheckedTreeNodeAll:function(e,t){"menu"===t?this.$refs.menu.setCheckedNodes(e?this.menuOptions:[]):"dept"===t&&this.$refs.dept.setCheckedNodes(e?this.deptOptions:[])},handleCheckedTreeConnect:function(e,t){this.menuCheckStrictly=!!e},handleAdd:function(){this.reset(),this.getMenuTreeselect(),this.open=!0,this.title="添加角色"},handleUpdate:function(e){var t=this;this.reset();var a=e.roleId||this.ids,r=this.getRoleMenuTreeselect(a);Object(s["k"])(a).then((function(e){t.form=e.result,t.$delete(t.form,"createTime"),t.$delete(t.form,"updateTime"),t.$delete(t.form,"delFlag"),t.open=!0,t.$nextTick((function(){r.then((function(e){var a=e.checkedKeys;a.forEach((function(e){t.$nextTick((function(){t.$refs.menu.setChecked(e,!0,!1)}))}))}))})),t.title="修改角色"}))},dataScopeSelectChange:function(e){"2"!==e&&this.$refs.dept.setCheckedKeys([])},handleDataScope:function(e){var t=this;this.reset();var a=this.getRoleDeptTreeselect(e.roleId);Object(s["k"])(e.roleId).then((function(e){t.form=e.data,t.openDataScope=!0,t.$nextTick((function(){a.then((function(e){t.$refs.dept.setCheckedKeys(e.checkedKeys)}))})),t.title="分配数据权限"}))},handleAuthUser:function(e){var t=e.roleId;this.$router.push("/auth/user/"+t)},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(void 0!==e.form.roleId?(e.form.menuIds=e.getMenuAllCheckedKeys(),Object(s["n"])(e.form).then((function(t){e.msgSuccess("修改成功"),e.open=!1,e.getList()}))):(e.form.menuIds=e.getMenuAllCheckedKeys(),Object(s["a"])(e.form).then((function(t){e.msgSuccess("新增成功"),e.open=!1,e.getList()}))))}))},submitDataScope:function(){var e=this;void 0!==this.form.roleId&&(this.form.deptIds=this.getDeptAllCheckedKeys(),Object(s["g"])(this.form).then((function(t){e.msgSuccess("修改成功"),e.openDataScope=!1,e.getList()})))},handleDelete:function(e){var t=this,a=e.roleId||this.ids;this.$confirm('是否确认删除角色编号为"'+a+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["h"])(a)})).then((function(){t.getList(),t.msgSuccess("删除成功")})).catch((function(){}))},handleExport:function(){var e=this,t=this.queryParams;this.$confirm("是否确认导出所有角色数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return e.exportLoading=!0,Object(s["i"])(t)})).then((function(t){e.download(t.msg),e.exportLoading=!1})).catch((function(){}))}}},m=p,h=a("2877"),f=Object(h["a"])(m,r,o,!1,null,null,null);t["default"]=f.exports},"70eb4":function(e,t,a){},7162:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.offerId,callback:function(t){e.$set(e.searchForm,"offerId",t)},expression:"searchForm.offerId"}})],1),a("el-form-item",{attrs:{label:"评审状态:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"评审状态"},model:{value:e.searchForm.taskStatus,callback:function(t){e.$set(e.searchForm,"taskStatus",t)},expression:"searchForm.taskStatus"}},e._l(Object.keys(e.TASK_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.TASK_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.orderData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",fixed:"left","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"certificationType",label:"认证类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.certificationType?"CMA":"CNAS")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"consignorName",label:"客户名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{label:"评审状态",align:"center",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.judgeTaskStatus)}},[e._v("\n            "+e._s(e.TASK_STATUS[r.judgeTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"finishDate",label:"完成时间",width:"120",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]),r.judgeTaskStatus>=4?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.judgeTaskStatus>=4?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAppDetail(r)}}},[e._v(" 评审记录")]):e._e(),"0"===r.judgeTaskStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"0"===r.judgeTaskStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r)}}},[e._v(" 评审判定")]):e._e(),"4"===r.judgeTaskStatus||"5"===r.judgeTaskStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"4"===r.judgeTaskStatus||"5"===r.judgeTaskStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleLastApprove(r)}}},[e._v(" 评审审批")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报价单("+e.orderDetailForm.offerId+")",visible:e.detailVisible,top:"5vh",width:"70%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"135px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户名称:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorName||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系人:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinker||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinkerPhone||""))])],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户要求完成时间:"}},[e._v(e._s(e._f("Time2Format")(e.orderDetailForm.offerBaseVo.finishDate)))])],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.remark||""))])],1)],1)],1),e._l(e.orderDetailPlans,(function(t,r){return a("div",{key:r},[a("el-divider",[e._v("计划"+e._s(r+1)+"因子列表")]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0"}},[a("thead",[a("tr",[a("th",{attrs:{rowspan:"2"}},[e._v("序号")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测类别")]),a("th",{attrs:{colspan:"3"}},[e._v("检测项目")]),a("th",{attrs:{rowspan:"2"}},[e._v("频次(次/天)")]),a("th",{attrs:{rowspan:"2"}},[e._v("天数")]),a("th",{attrs:{rowspan:"2"}},[e._v("监测频次")]),a("th",{attrs:{rowspan:"2"}},[e._v("执行次数")]),a("th",{attrs:{rowspan:"2"}},[e._v("总数")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测单价(元)")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测费(元)")])]),a("tr",[a("th",[e._v("序号")]),a("th",[e._v("检测位置")]),a("th",[e._v("因子")])])]),a("tbody",[e._l(t.factorTdos,(function(r,o){return a("tr",{key:o},[0==r.frIndex?[a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.id))]),a("td",{attrs:{rowspan:r.detailLength}},[e._v(e._s(r.secName))])]:e._e(),a("td",[e._v(e._s(r.sid))]),a("td",[e._v(e._s(r.factorPoint))]),a("td",[e._v(e._s(r.factorName)+e._s(r.meanName&&r.meanName.length>0?"("+r.meanName+")":""))]),a("td",[e._v(e._s(r.frequency))]),a("td",[e._v(e._s(r.dayCount))]),0==o?[a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.checkFreq))]),a("td",{attrs:{rowspan:t.oldPlanFactors.length}},[e._v(e._s(t.execTimes))])]:e._e(),a("td",[e._v(e._s(Number(r.frequency*r.dayCount*t.execTimes).toFixed(0)))]),a("td",[e._v(e._s(r.costPerTime))]),a("td",[e._v(e._s(parseFloat(r.costPerTime*r.frequency*r.dayCount*t.execTimes).toFixed(2)))])],2)})),a("tr",[a("td",{attrs:{colspan:"11"}},[e._v("检测费合计")]),a("td",[e._v(e._s(parseFloat(t.checkFee*t.execTimes).toFixed(2)))])])],2)])])],1)})),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0  "}},[a("tbody",[a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("检测费合计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.checkAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告编制费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.reportAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("报告加急费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.expediteAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("采样费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.laborAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("差旅费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.tripAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("税额")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.taxAmount)))])]),e.orderDetailForm.selfCostVos?e._l(e.orderDetailForm.selfCostVos,(function(t,r){return a("tr",{key:r},[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(t.selfName))]),a("td",[e._v(e._s(e._f("MoneyFormat")(t.amount)))])])})):e._e(),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("总计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.sysAmount)))])]),a("tr",[a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v("优惠价")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.draftAmount)))])]),a("tr",[a("td",{staticStyle:{width:"20%"}},[e._v("大写：")]),a("td",{staticStyle:{width:"80%"},attrs:{colspan:"2"}},[e._v(e._s(e._f("Money2Chinese")(e.orderDetailForm.costVo.draftAmount)))])])],2)])])],2),a("el-dialog",{attrs:{title:"合同评审判定",visible:e.approveVisible,center:"",top:"5vh"},on:{"update:visible":function(t){e.approveVisible=t}}},[a("el-form",{attrs:{model:e.approveForm}},[a("el-form-item",{attrs:{label:"评审判定:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"2"}},[e._v("直接评审通过")]),a("el-radio",{attrs:{label:"1"}},[e._v("进入评审流程")]),a("el-radio",{attrs:{label:"3"}},[e._v("评审不通过")])],1)],1)],1),"1"===e.approveForm.auditFlag?a("div",[a("el-row",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleChosePerson}},[e._v("选择参与人员")])],1),a("el-table",{staticStyle:{"padding-top":"10px"},attrs:{data:e.judgeData,stripe:""}},[a("el-table-column",{attrs:{prop:"empName",label:"姓名",align:"center"}}),a("el-table-column",{attrs:{prop:"deptName",label:"部门",align:"center"}}),a("el-table-column",{attrs:{prop:"postNames",label:"岗位",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.delChoseRow(r)}}},[e._v("删除")])]}}],null,!1,1910967618)})],1)],1):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1),a("el-dialog",{attrs:{title:"人员选择",visible:e.innerChose,"append-to-body":""},on:{"update:visible":function(t){e.innerChose=t}}},[a("el-form",{attrs:{model:e.innerForm,inline:""}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.innerAdd}},[e._v("添加")])],1)],1),a("el-table",{attrs:{data:e.innerJudgeData,stripe:"","max-height":"450px"},on:{"selection-change":e.handleSelection}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"empName",label:"姓名",align:"center"}}),a("el-table-column",{attrs:{prop:"deptName",label:"部门",align:"center"}}),a("el-table-column",{attrs:{prop:"postNames",label:"岗位",align:"center"}})],1)],1)],1),a("el-dialog",{attrs:{title:"评审详情",visible:e.appDetailsVisible,center:"",top:"5vh"},on:{"update:visible":function(t){e.appDetailsVisible=t}}},[a("el-table",{attrs:{data:e.appDetails,border:"",stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"judgeUser",label:"技术评审人",align:"center"}}),a("el-table-column",{attrs:{prop:"judgeRecordStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("judgeStatusQualityFilter")(r.judgeRecordStatus)}},[e._v("\n            "+e._s(e.APPROVE_STATUS[r.judgeRecordStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.appDetailsVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"评审判定",visible:e.lastApproveVisible,center:"",top:"5vh"},on:{"update:visible":function(t){e.lastApproveVisible=t}}},[a("el-form",{attrs:{model:e.lastApproveForm}},[a("el-form-item",{attrs:{label:"评审判定:"}},[a("el-radio-group",{model:{value:e.lastApproveForm.auditFlag,callback:function(t){e.$set(e.lastApproveForm,"auditFlag",t)},expression:"lastApproveForm.auditFlag"}},[a("el-radio",{attrs:{label:"6"}},[e._v("通过")]),a("el-radio",{attrs:{label:"3"}},[e._v("不通过")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.lastApproveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmLastDialog}},[e._v("确认")])],1)],1)],1)},o=[],s=(a("6b54"),a("7514"),a("5df3"),a("f400"),a("75fc")),l=(a("ac6a"),a("e601")),n=a("e24a"),i=a("b705"),c=a("fe05"),d=a("74b1"),u=(a("542c"),{0:"待判定",1:"进入评审流程",2:"直接评审通过",3:"评审不通过",4:"部门经理审核",5:"技术负责人审核",6:"评审通过"}),p={0:"等待处理",1:"通过",2:"不通过"},m={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},h={name:"TechContList",filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"success",3:"danger",4:"",5:"",6:"success"};return t[e]},judgeStatusQualityFilter:function(e){var t={0:"info",1:"success",2:"danger"};return t[e]}},data:function(){return{TASK_STATUS:u,APPROVE_STATUS:p,CHECK_STATUS:m,orderData:[],searchForm:{offerId:"",projectName:"",taskStatus:"",pageNumber:1,pageSize:10},total:0,detailVisible:!1,orderDetailForm:{offerId:"",offerBaseVo:{consignorName:"",consignorLinker:"",consignorLinkerPhone:"",createUserName:"",finishDate:"",remark:"",checkCircle:"",checkTaskCount:""},factorTdos:[],costVo:{},oncePrice:"",selfCostVos:[]},approveVisible:!1,approveForm:{judgeTaskId:"",auditFlag:"1",remark:"",auditUsers:""},approveJudgeForm:{judgeTaskId:"",auditFlag:"1",remark:""},appDetailsVisible:!1,appDetails:[],lastApproveVisible:!1,lastApproveForm:{judgeTaskId:"",auditFlag:"6",remark:""},judgeData:[],innerChose:!1,postOptions:[],deptOptions:[],innerForm:{empName:"",deptId:void 0,postId:void 0},multipleSelection:[],innerJudgeData:[],orderDetailPlans:[]}},created:function(){this.innerSearch(),this.handleSearch(),this.getTreeselect(),this.getPostAndRoleList()},methods:{getDicKey:function(e,t){var a=this;i["g"](t).then((function(t){200===t.code&&(a[e]=t.result)}))},getTreeselect:function(){var e=this;this.deptOptions=[],c["l"]().then((function(t){e.deptOptions=t.result}))},getPostAndRoleList:function(){var e=this;Object(d["e"])().then((function(t){e.postOptions=t.result||[]}))},handleAppDetail:function(e){var t=this;n["h"](e.judgeTaskId).then((function(e){200===e.code&&e.result&&(t.appDetails=e.result||[],t.appDetailsVisible=!0)}))},handleDetail:function(e){var t=this;l["f"](e.offerId).then((function(e){if(200===e.code){var a=[];t.orderDetailForm.offerId=e.result.offerId||"",t.orderDetailForm.offerBaseVo=e.result.offerBaseVo||{},t.orderDetailForm.costVo=e.result.costVo||{},t.orderDetailForm.selfCostVos=e.result.selfCostVos||[],t.orderDetailForm.offerPlanVos=a=e.result.offerPlanVos.map((function(e){return e.planFactorVoList&&e.planFactorVoList.length>0&&(e.planFactorVoList.forEach((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}})),t.$set(e,"oldPlanFactors",e.planFactorVoList)),e}))||[],t.orderDetailPlans=t.doProcessOrder(a)||[],t.detailVisible=!0}}))},handleSearch:function(){var e=this;n["g"](this.searchForm).then((function(t){200===t.code&&(e.orderData=t.result.records||[],e.total=t.result.total)}))},doProcessOrder:function(e){var t=this;if(e&&e.length>0){var a=Object(s["a"])(e);return a.forEach((function(e){var a=t.doProcessDate(e.planFactorVoList);t.$set(e,"factorTdos",a)})),a}},doProcessDate:function(e){var t=this;if(e&&e.length>0){var a=[],r=new Map,o=[],s=1;return e.forEach((function(e,t){var o=a.find((function(t){return t.secdClassName===e.secdClassName}));if(o||(a.push({id:s,secdClassName:e.secdClassName,totalPrice:0,detailLength:0}),s++),r.get(e.secdClassName)){var l=r.get(e.secdClassName);l.push(e)}else{var n=[];n.push(e),r.set(e.secdClassName,n)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName);a&&a.length>0&&a.forEach((function(r,s){var l=o.find((function(e){return e.secName===r.secdClassName}));l?t.$set(r,"frIndex",1):t.$set(r,"frIndex",0),t.$set(r,"id",e.id),t.$set(r,"sid",e.id+"."+(s+1)),t.$set(r,"secName",e.secdClassName),t.$set(r,"detailLength",a.length),t.$set(r,"dateType",0),o.push(r)}))})),o}return[]},countTotal:function(e,t){var a=0;return a=e.reduce((function(e,a,r,o){return a[t]?e+a[t]:e}),0),a},handleApprove:function(e){this.approveForm.judgeTaskId=e.judgeTaskId,this.approveForm.auditFlag="2",this.approveVisible=!0,this.judgeData=[]},handleLastApprove:function(e){this.lastApproveForm.judgeTaskId=e.judgeTaskId,this.lastApproveForm.auditFlag="6",this.lastApproveForm.reamrk="",this.lastApproveVisible=!0},confirmLastDialog:function(){var e=this;this.$confirm("是否确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["d"](e.lastApproveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.lastApproveVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},confirmDialog:function(){var e=this;"1"===this.approveForm.auditFlag&&this.judgeData.length<=0?this.msgError("进入评审环节，评审人员不能为空"):this.$confirm("是否确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={judgeTaskId:e.approveForm.judgeTaskId,auditFlag:e.approveForm.auditFlag};if("1"===e.approveForm.auditFlag){var a=e.judgeData.map((function(e){return e.userId}));t.auditUsers=a.toString()}n["d"](t).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.approveVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},handleChosePerson:function(){this.innerChose=!0,this.innerSearch()},delChoseRow:function(e){this.judgeData.splice(e,1)},innerSearch:function(){var e=this;n["e"]().then((function(t){e.innerJudgeData=t.result}))},handleSelection:function(e){this.multipleSelection=e},innerAdd:function(){var e=this;this.multipleSelection.length>0?(this.multipleSelection.forEach((function(t){var a=e.judgeData.find((function(e){return e.userId===t.userId}));a||e.judgeData.push(t)})),this.innerChose=!1):this.msgInfo("至少选择一个评审用户")}}},f=h,b=(a("777d"),a("91a2"),a("2877")),g=Object(b["a"])(f,r,o,!1,null,"3b0b1c38",null);t["default"]=g.exports},7179:function(e,t,a){"use strict";a("fbd7")},"71e6":function(e,t,a){"use strict";a("93c4")},"72ed":function(e,t,a){"use strict";a("0f17")},"733e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-continer"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.smapItemId,callback:function(t){e.$set(e.searchForm,"smapItemId",t)},expression:"searchForm.smapItemId"}})],1),a("el-form-item",{attrs:{label:"因子名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"因子名称"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"220px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkRes",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkRes&&r.checkRes.length>0?[e._v("\n          "+e._s(r.masterRes)),r.exponRes>0?[e._v("×10"),a("sup",[e._v(e._s(r.exponRes))])]:e._e()]:void 0]}}])}),a("el-table-column",{attrs:{prop:"checkStatus",label:"状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.checkStatus)}},[e._v("\n          已完成\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"dataEntryStep",label:"数据操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.dataEntryStep?"danger":""}},[e._v("\n          "+e._s("1"===r.dataEntryStep?"采样录入":"检测录入")+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"assignUser",label:"分析员",align:"center"}}),a("el-table-column",{attrs:{prop:"collectTime",label:"采样时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"endDate",label:"任务截止时间",width:"120px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"140px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleLocalDetail(r)}}},[e._v("现场记录")])]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"样品详情",visible:e.detailVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticStyle:{width:"700px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.sampleForm.smapItemId))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.sampleForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.sampleForm.standardName))]),a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.sampleForm.remark))]),a("el-form-item",{attrs:{label:"检测结果:"}},[e.sampleForm.checkRes&&e.sampleForm.checkRes.length>0?[e._v("\n            "+e._s(e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v1?e.sampleForm.factorInfo.v1:0)+"\n            "),e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v2>0?[e._v("\n              ×10"),a("sup",[e._v(e._s(e.sampleForm.factorInfo.v2?Number(e.sampleForm.factorInfo.v2):0))])]:e._e()]:[e._v("暂无检测结果")]],2)],1),e.sampleForm.subFactors&&e.sampleForm.subFactors.length>0?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sampleForm.subFactors,border:"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"name",label:"检测因子",width:"130",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.v1?[e._v("\n                "+e._s(r.v1?r.v1:0)+"×10"),a("sup",[e._v(e._s(r.v2?Number(r.v2):0))]),e._v(e._s(e.sampleForm.unitName)+"\n              ")]:e._e()]}}],null,!1,1464253952)})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailVisible=!1}}},[e._v("关 闭")])],1)]),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},o=[],s=a("db72"),l=a("15d4"),n=a("d43b"),i=a("333d"),c={0:"待领样",1:"领样申请",2:"待检测",3:"已录入",4:"待审核",5:"审核通过",6:"审核失败"},d={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"2"===e?"info":"1"===e||"3"===e||"4"===e?"":"5"===e?"success":"danger"}},data:function(){return{CHECK_STATUS:c,checkData:[],searchForm:{smapItemId:"",factorName:"",checkStatus:"5",pageNumber:1,pageSize:10},total:0,detailVisible:!1,sampleForm:{factorInfo:{},subFactors:{}},sampleVisible:!1,sampleDetails:[],sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",sampleImageList:[],sampleImage:"",sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;l["k"](this.searchForm).then((function(t){200===t.code&&(e.checkData=t.result.records.map((function(t){if(t.checkRes&&""!==t.checkRes){var a=JSON.parse(t.checkRes);e.$set(t,"masterRes",a.v1),e.$set(t,"exponRes",a.v2)}else e.$set(t,"masterRes",0),e.$set(t,"exponRes",0);return t}))||[],e.total=t.result.total)}))},handleDetail:function(e){if(this.sampleForm=Object(s["a"])({},e),e.checkSubRes&&e.checkSubRes.length>0){var t=JSON.parse(e.checkSubRes);this.$set(this.sampleForm,"subFactors",t)}if(e.checkRes&&e.checkRes.length>0){var a=JSON.parse(e.checkRes);this.$set(this.sampleForm,"factorInfo",a)}this.detailVisible=!0},handleLocalDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";n["g"](e.smapItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))}}},u=d,p=(a("a2a9"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"0c0a3f60",null);t["default"]=m.exports},"738b":function(e,t,a){},"745c":function(e,t,a){},"74ad":function(e,t,a){"use strict";a("8a85")},"74b1":function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"f",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return c}));var r=a("b775");function o(e){return Object(r["a"])({url:"/post/selectPostList",method:"get",params:e})}function s(){return Object(r["a"])({url:"/post/selectPostAll",method:"get"})}function l(e){return Object(r["a"])({url:"/post/insertPost",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/post/updatePost",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/post/deletePostById/"+e,method:"get"})}function c(e){return Object(r["a"])({url:"/post/export",method:"get",params:e})}},7504:function(e,t,a){},7572:function(e,t,a){"use strict";a("c7e0")},"75ec":function(e,t,a){},7687:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{label:"设备编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"设备编号"},model:{value:e.searchForm.equipmentNumber,callback:function(t){e.$set(e.searchForm,"equipmentNumber",t)},expression:"searchForm.equipmentNumber"}})],1),a("el-form-item",{attrs:{label:"设备名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"设备名称"},model:{value:e.searchForm.equipmentName,callback:function(t){e.$set(e.searchForm,"equipmentName",t)},expression:"searchForm.equipmentName"}})],1),a("el-form-item",{attrs:{label:"设备类别:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"设备类别"},on:{change:e.getSearchSecdInfo},model:{value:e.searchForm.equipmentFirstType,callback:function(t){e.$set(e.searchForm,"equipmentFirstType",t)},expression:"searchForm.equipmentFirstType"}},e._l(e.devTypeArray,(function(e){return a("el-option",{key:e.dictKey,attrs:{label:e.dictVal,value:e.dictKey}})})),1)],1),"100404"!=e.searchForm.equipmentFirstType?a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"检测类别"},model:{value:e.searchForm.equipmentSecondType,callback:function(t){e.$set(e.searchForm,"equipmentSecondType",t)},expression:"searchForm.equipmentSecondType"}},e._l(e.secOtherArray,(function(e){return a("el-option",{key:e.dictKey,attrs:{label:e.dictVal,value:e.dictKey}})})),1)],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:6}},[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-upload2"},on:{click:e.handleUpload}},[e._v("批量导入")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("导出")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.devData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无数据\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"equipmentNumber",label:"设备编号",align:"center"}}),a("el-table-column",{attrs:{prop:"equipmentName",label:"设备名称",align:"center"}}),a("el-table-column",{attrs:{prop:"equipmentFirstTypeVal",label:"设备类别",align:"center"}}),a("el-table-column",{attrs:{prop:"equipmentSecondTypeVal",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"equipmentBrand",label:"设备品牌",align:"center"}}),a("el-table-column",{attrs:{prop:"equipmentModel",label:"设备型号",align:"center"}}),a("el-table-column",{attrs:{prop:"checkDate",label:"上次检定日期",align:"center"}}),a("el-table-column",{attrs:{prop:"checkCircle",label:"检定周期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(e.CHECK_STATUS[a.checkCircle])+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v(" 删除")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.devDialogStatus],visible:e.devDialogVisible,width:"65%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.devDialogVisible=t}}},[a("el-form",{ref:"devForm",attrs:{model:e.devForm,rules:e.devRules,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"equipmentNumber",label:"设备编号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"设备编号",maxlength:"25"},model:{value:e.devForm.equipmentNumber,callback:function(t){e.$set(e.devForm,"equipmentNumber",t)},expression:"devForm.equipmentNumber"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"equipmentName"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n              设备名称\n              "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"检测机构内部对该设备的命名：如气相色谱仪、液相色谱仪、便携式PH仪"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n              :\n            ")],1),a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"设备名称不能为空",maxlength:"25"},model:{value:e.devForm.equipmentName,callback:function(t){e.$set(e.devForm,"equipmentName",t)},expression:"devForm.equipmentName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"equipmentFirstType",label:"设备类别:"}},[a("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"设备类别不能为空"},on:{change:e.getSecdEquipment},model:{value:e.devForm.equipmentFirstType,callback:function(t){e.$set(e.devForm,"equipmentFirstType",t)},expression:"devForm.equipmentFirstType"}},e._l(e.devTypeArray,(function(e){return a("el-option",{key:e.dictKey,attrs:{label:e.dictVal,value:e.dictKey}})})),1)],1)],1),a("el-col",{attrs:{span:12}},["100404"!==e.devForm.equipmentFirstType?a("el-form-item",{attrs:{prop:"equipmentSecondType",label:"检测类别:"}},[a("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"检测类别不能为空"},model:{value:e.devForm.equipmentSecondType,callback:function(t){e.$set(e.devForm,"equipmentSecondType",t)},expression:"devForm.equipmentSecondType"}},e._l(e.secOtherArray,(function(e){return a("el-option",{key:e.dictKey,attrs:{label:e.dictVal,value:e.dictKey}})})),1)],1):e._e()],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"equipmentBrand",label:"设备品牌:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"设备品牌",maxlength:"20"},model:{value:e.devForm.equipmentBrand,callback:function(t){e.$set(e.devForm,"equipmentBrand",t)},expression:"devForm.equipmentBrand"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"equipmentModel",label:"设备型号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"设备型号",maxlength:"10"},model:{value:e.devForm.equipmentModel,callback:function(t){e.$set(e.devForm,"equipmentModel",t)},expression:"devForm.equipmentModel"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"checkDate",label:"上次检定日期:"}},[a("el-date-picker",{staticStyle:{width:"80%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"上次检定日期"},model:{value:e.devForm.checkDate,callback:function(t){e.$set(e.devForm,"checkDate",t)},expression:"devForm.checkDate"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"checkCircle",label:"检定周期:"}},[a("el-select",{staticStyle:{width:"80%"},attrs:{clearable:"",filterable:"",placeholder:"检定周期"},model:{value:e.devForm.checkCircle,callback:function(t){e.$set(e.devForm,"checkCircle",t)},expression:"devForm.checkCircle"}},e._l(Object.keys(e.CHECK_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.CHECK_STATUS[t],value:t}})})),1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"remark",label:"备注:"}},[a("el-input",{staticStyle:{width:"92%"},attrs:{type:"textarea",rows:3,placeholder:"备注",maxlength:"50"},model:{value:e.devForm.remark,callback:function(t){e.$set(e.devForm,"remark",t)},expression:"devForm.remark"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.devDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1),a("el-dialog",{attrs:{title:"批量导入设备",visible:e.uploadVisible,"append-to-body":"",width:"53%"},on:{"update:visible":function(t){e.uploadVisible=t}}},[a("div",{staticClass:"block"},[a("el-timeline",[a("el-timeline-item",{attrs:{size:"large"}},[a("span",{staticClass:"time-dot",attrs:{slot:"dot"},slot:"dot"},[e._v("\n            1\n          ")]),a("el-row",[a("el-col",{attrs:{span:24}},[e._v("\n              下载模板，批量填写设备信息\n            ")])],1),a("el-row",{staticStyle:{"padding-top":"10px"}},[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleDownloadTep()}}},[e._v("模板下载")])],1)],1)],1),a("el-timeline-item",{attrs:{size:"large"}},[a("span",{staticClass:"time-dot",attrs:{slot:"dot"},slot:"dot"},[e._v("\n            2\n          ")]),a("el-row",[a("el-col",{attrs:{span:24}},[e._v("\n              上传填写好的设备信息表格\n            ")])],1),a("el-row",{staticStyle:{"padding-top":"10px"}},[a("el-col",{attrs:{span:24}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{width:"300px"},attrs:{action:"/api/dataImport/uploadEquipent","on-change":e.customUploadChange,"file-list":e.excelFileList,accept:".xlsx,.xls",limit:1}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("您只能上传.xlsx,.xls格式的文件")])],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("span",{staticStyle:{color:"red","font-size":"13px"}},[e._v("备注：批量导入设备功能，只会将上传的设备信息列表内的设备新增到系统内，不对原有设备信息做任何替换或修改。\n\n          ")])])],1)],1)])],1)},o=[],s=a("333d"),l=a("f564"),n=a("b705"),i={0:"采样",1:"检测"},c={0:"闲置中",1:"使用中",2:"维修中"},d={0:"月",1:"季度",2:"半年",3:"年",4:"两年",5:"三年",6:"无需检定"},u={components:{Pagination:s["a"]},data:function(){return{CHECK_STATUS:d,DEV_STATUS:i,USE_STATUS:c,searchForm:{equipmentNumber:"",equipmentName:"",equipmentFirstType:"",equipmentSecondType:"",equipmentStatus:"",pageNumber:1,pageSize:10},total:0,devData:[],devDialogStatus:"create",devDialogVisible:!1,titleMap:{edit:"修改设备",create:"新增设备"},devForm:{id:"",equipmentNumber:"",equipmentName:"",equipmentFirstType:"",equipmentSecondType:"",equipmentBrand:"",equipmentModel:"",checkCircle:"",lastTime:"",remark:""},devRules:{equipmentNumber:[{required:!0,message:"请录入设备编号",trigger:"blur"}],equipmentName:[{required:!0,message:"请录入设备名称",trigger:"blur"}],equipmentFirstType:[{required:!0,message:"请选择检测对象",trigger:"change"}],equipmentSecondType:[{required:!0,message:"请选择检测类别",trigger:"change"}],equipmentBrand:[{required:!0,message:"请录入设备品牌",trigger:"blur"}],equipmentModel:[{required:!0,message:"请录入设备型号",trigger:"blur"}],checkCircle:[{required:!0,message:"请选择检定周期",trigger:"change"}]},classArray:[],secClassArray:[],secOtherArray:[],devTypeArray:[],classId:"",uploadVisible:!1,excelFileList:[],fileResult:""}},created:function(){this.getFirstEquipment(),this.getClassList(),this.handleSearch()},methods:{getDicKey:function(e,t){var a=this;n["g"](t).then((function(t){200===t.code&&(a[e]=t.result)}))},getFirstEquipment:function(){var e=this;l["c"]().then((function(t){e.devTypeArray=t.result||[],e.classArray=t.result||[]}))},getSecdEquipment:function(e){var t=this;this.secOtherArray=[],this.secClassArray=[],this.devForm.equipmentSecondType="",e&&"100404"!==e&&l["d"](e).then((function(e){t.secOtherArray=e.result||[],t.secClassArray=e.result||[]}))},getSearchSecdInfo:function(e){var t=this;this.secOtherArray=[],this.searchForm.equipmentSecondType="","100404"!==this.searchForm.equipmentFirstType&&e&&l["d"](e).then((function(e){t.secOtherArray=e.result||[]}))},getClassList:function(){var e=this;n["a"]().then((function(t){e.classArray=t.result||[]}))},findSecClass:function(e){var t=this;this.secdClassId="",n["d"](e).then((function(e){t.secClassArray=e.result||[]}))},handleSearch:function(){var e=this;l["b"](this.searchForm).then((function(t){200===t.code&&(e.devData=t.result.records||[],e.total=t.result.total)}))},handleAdd:function(){this.clearForm(),this.secOtherArray=[],this.devDialogStatus="create",this.devDialogVisible=!0},handleUpdate:function(e){var t=this;this.clearForm(),this.devForm.id=e.id,this.devForm.equipmentNumber=e.equipmentNumber,this.devForm.equipmentName=e.equipmentName,this.devForm.equipmentFirstType=e.equipmentFirstType,this.devForm.equipmentSecondType=e.equipmentSecondType,this.devForm.equipmentBrand=e.equipmentBrand,this.devForm.equipmentModel=e.equipmentModel,this.devForm.checkCircle=e.checkCircle,this.devForm.checkDate=e.checkDate,this.devForm.remark=e.remark,e.equipmentFirstType&&"100404"!==e.equipmentFirstType&&l["d"](e.equipmentFirstType).then((function(a){t.secOtherArray=a.result||[],t.secClassArray=a.result||[],t.$nextTick((function(){t.devForm.equipmentSecondType=e.equipmentSecondType}))})),this.devDialogStatus="edit",this.devDialogVisible=!0},clearForm:function(){this.devForm={id:"",equipmentNumber:"",equipmentName:"",equipmentFirstType:"",equipmentSecondType:"",equipmentBrand:"",equipmentModel:"",checkCircle:"",checkDate:"",remark:""}},confirmDialog:function(){var e=this;"create"===this.devDialogStatus?l["f"](this.devForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.devDialogVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})):l["g"](this.devForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.devDialogVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))},handleDelete:function(e){var t=this;this.$confirm("是否确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleDownloadTep:function(){var e=this.$store.getters.sysBaseUrl+"/api/dataImport/downloadEquipmentExcel";window.open(e)},handleDownload:function(){var e=this.$store.getters.sysBaseUrl+"/api/dataImport/exportEquipment?equipmentNumber=&equipmentName=&equipmentFirstType=&equipmentSecondType=";window.open(e)},customUploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.fileResult=e.response.result,this.$message({type:"success",message:e.response.message}),this.handleSearch(),this.uploadVisible=!1):(this.$message.error("上传失败!"),this.excelFileList=[])}else this.$message.error("上传失败!"),this.excelFileList=[]},handleUpload:function(){this.uploadVisible=!0,this.excelFileList=[],this.fileResult=""}}},p=u,m=(a("04a5"),a("2877")),h=Object(m["a"])(p,r,o,!1,null,"8ae0ea3e",null);t["default"]=h.exports},"76b3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampItemId,callback:function(t){e.$set(e.searchForm,"sampItemId",t)},expression:"searchForm.sampItemId"}})],1),a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleBatchInStock}},[e._v(" 批量入库")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.stockData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样员","min-width":"90px",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",width:"100px",align:"center"}}),a("el-table-column",{attrs:{label:"样品状态",align:"center"}},[[a("el-tag",{attrs:{type:""}},[e._v("待入库")])]],2),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleInStock(t.row)}}},[e._v(" 入库")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"80%",center:""},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleForm,"label-width":"90px"}},[a("el-divider",[e._v("样品基础信息")]),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"检测因子:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.factorName,callback:function(t){e.$set(e.sampleForm,"factorName",t)},expression:"sampleForm.factorName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"样品性状:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.sampleProperties,callback:function(t){e.$set(e.sampleForm,"sampleProperties",t)},expression:"sampleForm.sampleProperties"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"样品固定剂:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.sampleFixative,callback:function(t){e.$set(e.sampleForm,"sampleFixative",t)},expression:"sampleForm.sampleFixative"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"录样位置:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.collectLocation,callback:function(t){e.$set(e.sampleForm,"collectLocation",t)},expression:"sampleForm.collectLocation"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"采样时间:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.collectTime,callback:function(t){e.$set(e.sampleForm,"collectTime",t)},expression:"sampleForm.collectTime"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"送样员:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.sendUser,callback:function(t){e.$set(e.sampleForm,"sendUser",t)},expression:"sampleForm.sendUser"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"采样备注:"}},[a("el-input",{staticStyle:{width:"98%"},attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",disabled:""},model:{value:e.sampleForm.collectRemark,callback:function(t){e.$set(e.sampleForm,"collectRemark",t)},expression:"sampleForm.collectRemark"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"样品入库",visible:e.factorVisible,center:""},on:{"update:visible":function(t){e.factorVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{ref:"inStockForm",attrs:{model:e.inStockForm,rules:e.inStockRule,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"sendUser",label:"送样人:"}},[a("el-input",{attrs:{placeholder:"请录入送样人"},model:{value:e.inStockForm.sendUser,callback:function(t){e.$set(e.inStockForm,"sendUser",t)},expression:"inStockForm.sendUser"}})],1),a("el-form-item",{attrs:{prop:"storeLocation",label:"入库位置:"}},[a("el-input",{attrs:{placeholder:"入库位置"},model:{value:e.inStockForm.storeLocation,callback:function(t){e.$set(e.inStockForm,"storeLocation",t)},expression:"inStockForm.storeLocation"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.factorVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"样品批量入库",visible:e.batchFactorVisible,center:""},on:{"update:visible":function(t){e.batchFactorVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{ref:"batchInStockForm",attrs:{model:e.batchInStockForm,rules:e.batchInStockRule,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"sendUser",label:"送样人:"}},[a("el-input",{attrs:{placeholder:"请录入送样人"},model:{value:e.batchInStockForm.sendUser,callback:function(t){e.$set(e.batchInStockForm,"sendUser",t)},expression:"batchInStockForm.sendUser"}})],1),a("el-form-item",{attrs:{prop:"storeLocation",label:"入库位置:"}},[a("el-input",{attrs:{placeholder:"入库位置"},model:{value:e.batchInStockForm.storeLocation,callback:function(t){e.$set(e.batchInStockForm,"storeLocation",t)},expression:"batchInStockForm.storeLocation"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.batchFactorVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.batchConfirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=(a("6b54"),a("d43b")),l=a("333d"),n={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过",4:"审核通过",5:"审核通过",6:"审核通过"},i={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},c={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},data:function(){return{ACCOUNT_STATUS:n,CHECK_STATUS:i,stockData:[],searchForm:{jobId:"",sampItemId:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleForm:{collectUser:"",sampleProperties:"",sampleFixative:"",collectRemark:"",collectLocation:"",collectIamge1:"",collectIamge2:"",collectIamge3:"",collectIamge4:"",factorName:""},inStockRule:{sendUser:[{required:!0,message:"请录入送样人",trigger:"blur"}],storeLocation:[{required:!0,message:"请录入位置信息",trigger:"blur"}]},currentSample:"",approveForm:{sampItemId:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],inStockForm:{storeApplyId:"",storeLocation:"",sendUser:""},factorVisible:!1,batchFactorVisible:!1,batchInStockForm:{storeApplyId:"",storeLocation:"",sendUser:""},multipleSelection:[],batchInStockRule:{sendUser:[{required:!0,message:"请录入送样人",trigger:"blur"}],storeLocation:[{required:!0,message:"请录入位置信息",trigger:"blur"}]}}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["f"](this.searchForm).then((function(t){200===t.code&&(e.stockData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,s["h"](e.sampItemId).then((function(e){200===e.code&&(t.sampleForm=e.result||{}),t.sampleVisible=!0}))},handleInStock:function(e){this.inStockForm.storeApplyId=e.storeApplyId,this.factorVisible=!0},confirmDialog:function(){var e=this;this.$refs.inStockForm.validate((function(t){t?s["c"](e.inStockForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.factorVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})):e.$message.warning("必填信息不能为空")}))},handleBatchInStock:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var e=this.multipleSelection.map((function(e){return e.storeApplyId}));this.batchInStockForm.storeApplyId=e.toString(),this.batchInStockForm.storeLocation="",this.batchInStockForm.sendUser="",this.batchFactorVisible=!0}else this.$message.warning("至少选择一条记录")},batchConfirmDialog:function(){var e=this;this.$refs.batchInStockForm.validate((function(t){t?s["a"](e.batchInStockForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.batchFactorVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})):e.$message.warning("必填信息不能为空")}))},handleSelectionChange:function(e){this.multipleSelection=e}}},d=c,u=(a("1852"),a("5208"),a("2335"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"2390efde",null);t["default"]=p.exports},"76d5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampleNo,callback:function(t){e.$set(e.searchForm,"sampleNo",t)},expression:"searchForm.sampleNo"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{attrs:{type:""},on:{click:e.goBack}},[e._v("返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center","min-width":"140px"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样人",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"finishTime",label:"样品登记时间",width:"190px",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},o=[],s=a("47bc"),l=a("d43b"),n=a("333d"),i={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过"},c={name:"MasterHisApprove",components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},props:{sampTaskId:{type:String,default:""}},data:function(){return{ACCOUNT_STATUS:i,sampleData:[],searchForm:{sampleNo:"",jobId:"",sampTaskId:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",sampleImage:"",sampleImageList:[],sampleDetails:[],sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.searchForm.sampTaskId=this.sampTaskId,this.handleSearch()},methods:{handleSearch:function(){var e=this;""!==this.sampTaskId&&s["l"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";l["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},goBack:function(){this.$router.back()}}},d=c,u=(a("2bb1"),a("5511"),a("a0b9"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"399836dd",null);t["default"]=p.exports},"76fb":function(e,t,a){},"777d":function(e,t,a){"use strict";a("70eb4")},"78b1":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("b775");function o(e){return Object(r["a"])({url:"/organ/modifyPassword",method:"post",data:e})}},7902:function(e,t,a){},"7ac6":function(e,t,a){},"7aff":function(e,t,a){},"7b74":function(e,t,a){"use strict";a("c2bd")},"7bc4":function(e,t,a){"use strict";a("1095")},"7c1a":function(e,t,a){"use strict";a("7902")},"7d05":function(e,t,a){"use strict";a("bf8d")},"7e2e":function(e,t,a){"use strict";a("4245")},"7eed":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",[a("el-input",{staticStyle:{width:"145px"},attrs:{placeholder:"请录入样品编号"},model:{value:e.searchForm.sampleNo,callback:function(t){e.$set(e.searchForm,"sampleNo",t)},expression:"searchForm.sampleNo"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"145px"},attrs:{placeholder:"请选择库存状态"},model:{value:e.searchForm.sampStatus,callback:function(t){e.$set(e.searchForm,"sampStatus",t)},expression:"searchForm.sampStatus"}},[a("el-option",{attrs:{label:"已入库",value:6}}),a("el-option",{attrs:{label:"部分出库",value:7}}),a("el-option",{attrs:{label:"已出库",value:8}})],1)],1),a("el-form-item",{attrs:{prop:"signDate"}},[a("el-date-picker",{staticStyle:{width:"145px"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择入库日期"},model:{value:e.searchForm.date,callback:function(t){e.$set(e.searchForm,"date",t)},expression:"searchForm.date"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary",size:"small"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:"primary",size:"small"},on:{click:e.goBack}},[e._v(" 返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:e.handleDownlond}},[e._v("交接单下载")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{ref:"stockTable",staticClass:"table-item",staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.stockData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange,select:e.handleSelect}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"55",selectable:e.checkSelectable,align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",fixed:"left",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样人",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"storeLocation",label:"存放位置","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{label:"库存状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.sampStatus)}},[e._v("\n            "+e._s(e.STOCK_STATUS[r.sampStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"交接单下载",visible:e.downVisible,center:""},on:{"update:visible":function(t){e.downVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.recordForm,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请录入任务单号"},model:{value:e.recordForm.taskId,callback:function(t){e.$set(e.recordForm,"taskId",t)},expression:"recordForm.taskId"}})],1),a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测对象"},on:{change:e.findSecClass},model:{value:e.recordForm.classId,callback:function(t){e.$set(e.recordForm,"classId",t)},expression:"recordForm.classId"}},e._l(e.classArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测类别"},model:{value:e.recordForm.secClassId,callback:function(t){e.$set(e.recordForm,"secClassId",t)},expression:"recordForm.secClassId"}},e._l(e.secClassArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"采样信息记录时间:"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"采样信息记录时间","value-format":"yyyy-MM-dd"},model:{value:e.recordForm.sampleDate,callback:function(t){e.$set(e.recordForm,"sampleDate",t)},expression:"recordForm.sampleDate"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.downVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDownload}},[e._v("确认")])],1)])],1)},o=[],s=(a("6b54"),a("d43b")),l=a("b705"),n=a("ed08"),i=a("333d"),c={0:"待采样",1:"已采样",2:"待组长审核",3:"待负责人审核",4:"审核通过",5:"审核失败",6:"已入库",7:"部分出库",8:"已出库",9:"入库中",10:"待复核"},d={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){var t={6:"",7:"success",8:"success"};return t[e]}},data:function(){return{STOCK_STATUS:c,stockData:[],searchForm:{sampTaskId:"",sampleNo:"",sampStatus:"",date:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",approveForm:{sampleNo:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],multipleSelection:[],downVisible:!1,recordForm:{taskId:"",classId:"",secClassId:"",sampleDate:""},classArray:[],secClassArray:[],sampleDetails:[],sampleDataInfo:[],sampleSecInfo:[],currentSelectionRow:{jobId:"",secdClassName:"",storeData:""}}},created:function(){this.$route.params.sampTaskId&&(this.searchForm.sampTaskId=this.$route.params.sampTaskId,this.getClassList(),this.handleSearch())},methods:{handleSearch:function(){var e=this;""!==this.searchForm.jobId&&(this.clearSelectionRow(),s["i"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.stockData=t.result.records.map((function(t){var a=Object(n["c"])(t.storeTime,"{y}-{m}-{d}");return e.$set(t,"storeData",a),t}))||[],e.total=t.result.total)})))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";s["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleSelectionChange:function(e){this.multipleSelection=e},handleDownlond:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var e=this.multipleSelection.map((function(e){return e.sampleNo})),t="/api/word/downLoadHandover?secdClassId="+this.multipleSelection[0].secdClassId+"&sampleNos="+e.toString();window.open(t)}else this.$message.warning("至少选择一条记录")},getClassList:function(){var e=this;l["a"]().then((function(t){e.classArray=t.result||[]}))},findSecClass:function(e){var t=this;this.recordForm.secClassId="",l["d"](e).then((function(e){t.secClassArray=e.result||[]}))},confirmDownload:function(){if(this.recordForm.taskId&&this.recordForm.secClassId&&this.recordForm.sampleDate){var e="/api/word/downLoadHandover?taskId="+this.recordForm.taskId+"&secdClassId="+this.recordForm.secClassId+"&sampleDate="+this.recordForm.sampleDate;window.open(e),this.downVisible=!1}else this.$message.warning("任务单号和检测类别不能为空")},handleSelect:function(e,t){e.length>0?(this.currentSelectionRow.jobId=t.jobId,this.currentSelectionRow.secdClassName=t.secdClassName,this.currentSelectionRow.storeData=t.storeData):this.clearSelectionRow()},clearSelectionRow:function(){this.currentSelectionRow={jobId:"",secdClassName:"",storeData:""}},checkRow:function(e){return!this.currentSelectionRow.jobId||""===this.currentSelectionRow.jobId||e.jobId===this.currentSelectionRow.jobId&&e.secdClassName===this.currentSelectionRow.secdClassName&&e.storeData===this.currentSelectionRow.storeData},checkSelectable:function(e){return this.checkRow(e)},goBack:function(){this.$router.back()}}},u=d,p=(a("24249"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"dd708c08",null);t["default"]=m.exports},"7ef2":function(e,t,a){},"7ff9":function(e,t,a){},"7ffa":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待处理合同",name:"1"}},[a("contractList")],1),a("el-tab-pane",{attrs:{label:"历史合同",name:"2"}},[a("hisContractList")],1)],1)],1)},o=[],s=a("abf0"),l=a("a4f2"),n={components:{contractList:s["default"],hisContractList:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},8037:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待分配任务",name:"1"}},[a("sampleTask")],1),a("el-tab-pane",{attrs:{label:"历史任务",name:"2"}},[a("hisSampleTask")],1)],1)],1)},o=[],s=a("6bb0"),l=a("ed89"),n={components:{sampleTask:s["default"],hisSampleTask:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},8180:function(e,t,a){"use strict";a("a339")},8261:function(e,t,a){"use strict";a("738b")},8435:function(e,t,a){},"847b":function(e,t,a){"use strict";a("a2dc")},8497:function(e,t,a){"use strict";a("b637")},"84c2":function(e,t,a){},"85be":function(e,t,a){"use strict";a("48cd")},"85cd":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-card",{staticStyle:{height:"400px","overflow-y":"auto"},attrs:{shadow:"never"}},e._l(e.factorGroupData,(function(t,r){return a("div",{key:r,staticClass:"text dialog-item",on:{click:function(a){return e.choseItem(t)}}},[e._v("\n          "+e._s(t.groupName)+"\n        ")])})),0)],1),a("el-col",{attrs:{span:4}},[a("el-card",{staticStyle:{height:"400px"},attrs:{shadow:"never"}},[a("el-tree",{ref:"tree",attrs:{data:e.treeData,"default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps},on:{"node-click":e.changeTreeItem}})],1)],1),a("el-col",{attrs:{span:16}},[a("el-table",{ref:"groupMultipleTable",attrs:{data:e.factorList,border:"",height:"400px","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleGroupSelectionChange,select:e.groupSelect}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测对象",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"价格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(e._f("MoneyFormat")(a.price))+" 元\n          ")]}}])})],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("已选因子")]),a("el-row",{staticStyle:{"min-height":"36px","line-height":"30px"}},[a("el-col",{attrs:{span:2}},[a("span",[e._v("已选中因子:")])]),a("el-col",{attrs:{span:22}},[e.choseGroupFatcors&&e.choseGroupFatcors.length>0?e._l(e.choseGroupFatcors,(function(t){return a("el-tag",{key:t.id,staticStyle:{margin:"2px 3px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleGroupClose(t)}}},[e._v("\n          "+e._s(t.factorName)+"\n        ")])})):[e._v("\n        无\n      ")]],2)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("因子配置")]),a("el-form",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},["002001"===e.currentNodeId?a("el-form-item",{attrs:{label:"均值类型:","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择均值类型"},on:{change:e.changeMeanType},model:{value:e.meanType,callback:function(t){e.meanType=t},expression:"meanType"}},[a("el-option",{attrs:{value:"0",label:"日均值"}}),a("el-option",{attrs:{value:"1",label:"时均值"}}),a("el-option",{attrs:{value:"2",label:"八小时均值"}})],1)],1):e._e()],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"天数:","label-width":"100px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.setDay,callback:function(t){e.setDay=t},expression:"setDay"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"频次(次/天):","label-width":"110px"}},[a("el-input-number",{attrs:{"controls-position":"right",max:e.maxTotal,min:1,step:1,precision:0},model:{value:e.frequency,callback:function(t){e.frequency=t},expression:"frequency"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.addressArray&&e.addressArray.length>0?"检测位置1:":"检测位置:","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:e.lookPosition,callback:function(t){e.lookPosition=t},expression:"lookPosition"}})],1)],1)],1),a("el-row",[e._l(e.addressArray,(function(t,r){return a("el-col",{key:t.key,attrs:{span:24}},[a("el-form-item",{attrs:{label:"检测位置"+(r+2)+":","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),"002001"!==e.currentNodeId&&"002003"!==e.currentNodeId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeAddDomain(t)}}},[e._v("删除")]):e._e()],1)],1)})),"002003"!==e.currentNodeId&&"002001"!==e.currentNodeId?a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addAddress}},[e._v("添加位置")])],1)],1):e._e()],2)],1),a("el-divider"),a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-button",{attrs:{type:""},on:{click:e.cancelComfig}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmGroupChoseFactor}},[e._v("确 定")])],1)],1)],1)},o=[],s=(a("c5f6"),a("20d6"),a("7f7f"),a("7514"),a("ac6a"),a("f858")),l=a("9612"),n={0:"日均值",1:"时均值",2:"八小时均值"},i={name:"FreeMeal",props:{clearType:{type:String,default:""}},data:function(){return{MEAN_STATUS:n,treeData:[],factorList:[],addressArray:[],defaultProps:{children:"children",label:"name",id:"id"},factorGroupData:[],choseGroupFatcors:[],groupAddressArray:[],multiplGroupeSelection:[],resultCache:{},resultForCache:{},currentNodeId:"",meanType:"",maxTotal:10,setDay:1,frequency:1,lookPosition:""}},watch:{clearType:function(){this.factorList=[],this.addressArray=[],this.choseGroupFatcors=[],this.multiplGroupeSelection=[],this.setDay=1,this.frequency=1,this.lookPosition=""}},created:function(){this.getFactorGroup()},methods:{getFactorGroup:function(){var e=this;s["d"]().then((function(t){200===t.code&&(e.factorGroupData=t.result||[])}))},handleGroupClose:function(e){this.choseGroupFatcors.splice(this.choseGroupFatcors.indexOf(e),1),this.$refs.groupMultipleTable.toggleRowSelection(e,!1)},choseItem:function(e){var t=this;if(this.treeData=[],this.cacheFactors=[],this.factorList=[],this.multiplGroupeSelection=[],this.choseGroupFatcors=[],this.setDay=1,this.frequency=1,this.addressArray=[],this.currentNodeId="",this.currentNodeName="",this.meanType="",this.resultCache[e.groupId])return this.treeData=this.resultCache[e.groupId],void(this.cacheFactors=this.resultForCache[e.groupId]);e.groupId&&s["c"](e.groupId).then((function(a){if(200===a.code&&a.result){t.cacheFactors=a.result;var r=[];a.result.forEach((function(e){var t=r.find((function(t){return t.id===e.classId}));if(t){var a=t.children,o=a.find((function(a){return t.id===e.classId&&a.id===e.secdClassId}));if(!o){var s={id:e.secdClassId,name:e.secdClassName,children:[],level:2};t.children.push(s)}}else{var l=[{id:e.secdClassId,name:e.secdClassName,children:[],level:2}],n={id:e.classId,name:e.className,level:1,children:l||[]};r.push(n)}})),t.$set(t.resultCache,e.groupId,r),t.$set(t.resultForCache,e.groupId,a.result),t.treeData=r}}))},changeTreeItem:function(e,t,a){var r=this;2===e.level&&(this.factorList=[],this.choseGroupFatcors=[],this.multiplGroupeSelection=[],this.factorList=this.cacheFactors.filter((function(t){return e.id===t.secdClassId})),this.addressArray=[],this.currentNodeId=e.id,this.currentNodeName=e.name,"002001"===e.id&&"0"===this.meanType?this.maxTotal=1:"004001"===e.id?this.maxTotal=2:this.maxTotal=10,"002001"!==e.id&&"002003"!==e.id||this.$nextTick((function(){for(var e=0;e<4;e++)r.addressArray.push({value:"",windNum:3,key:Date.now()+e})})))},handleGroupSelectionChange:function(e){var t=this;this.multiplGroupeSelection=e,e&&e.forEach((function(e){var a=t.choseGroupFatcors.find((function(t){return t.standardCode===e.standardCode}));a||t.choseGroupFatcors.push(e)}))},groupSelect:function(e,t){if(e&&-1===e.indexOf(t)){var a=this.choseGroupFatcors.findIndex((function(e){return e.standardCode===t.standardCode}));this.choseGroupFatcors.splice(a,1)}},changeMeanType:function(e){var t=0;"0"===e?this.maxTotal=t=1:"1"===e?this.maxTotal=t=4:"2"===e&&(this.maxTotal=t=2),this.frequency>t&&(this.frequency=t)},removeAddDomain:function(e){var t=this.addressArray.indexOf(e);-1!==t&&this.addressArray.splice(t,1)},addAddress:function(){var e=this;this.$nextTick((function(){e.addressArray.push({value:"",windNum:3,key:Date.now()})}))},confirmGroupChoseFactor:function(){var e=this;if(!this.choseGroupFatcors||this.choseGroupFatcors.length<=0)this.$message.warning("因子不能为空");else if(!this.lookPosition||this.lookPosition.length<=0)this.$message.warning("初始检测位置不能为空");else{var t={};"002001"===this.currentNodeId&&(this.$set(t,"meanType",this.meanType),this.$set(t,"meanName",this.MEAN_STATUS[this.meanType]));var a="";"002001"!==this.currentNodeId&&"002003"!==this.currentNodeId||(a=this.currentNodeId);var r=this.choseGroupFatcors.map((function(r){var o=r.standardCode,s=r.className,n=r.standardName,i=r.standardNo,c=r.factorName,d=r.price,u=parseFloat(d*e.frequency*e.setDay).toFixed(2),p=l["b"].v4().replaceAll("-","");return e.$set(r,"factorGroupKey",p),{factorPoint:e.lookPosition,className:s,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,isFactor:"0",factorName:c,standardCode:o,standardNo:i,standardName:n,dayCount:e.setDay,frequency:e.frequency,totalNum:Number(e.frequency*e.setDay).toFixed(0),costPerTime:d,totalCost:u,meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+o:"",dynamicParam:JSON.stringify(t),factorGroupKey:p}}));this.addressArray&&this.addressArray.length>0&&this.addressArray.forEach((function(o){o.value&&o.value.length>0&&e.choseGroupFatcors.forEach((function(s){var l=s.standardCode,n=s.className,i=s.standardName,c=s.standardNo,d=s.factorName,u=s.price,p=s.factorGroupKey,m=parseFloat(u*e.frequency*e.setDay).toFixed(2);r.push({factorPoint:o.value,className:n,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,isFactor:"0",factorName:d,standardNo:c,standardCode:l,standardName:i,dayCount:e.setDay,frequency:e.frequency,totalNum:Number(e.frequency*e.setDay).toFixed(0),costPerTime:u,totalCost:m,remark:"",meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+l:"",dynamicParam:JSON.stringify(t),factorGroupKey:p})}))})),this.formComfig(r)}},formComfig:function(e){this.$emit("handleConfim",e)},cancelComfig:function(){this.$emit("handleCancel",!1)}}},c=i,d=(a("88c4"),a("3437"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"41dd61c4",null);t["default"]=u.exports},"88c4":function(e,t,a){"use strict";a("7ff9")},"88c9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"user-info-head",on:{click:function(t){return e.editCropper()}}},[e.options.img?[r("img",{staticClass:"img-circle img-lg",attrs:{src:e.options.img,title:"点击上传头像"}})]:[r("img",{staticClass:"img-circle img-lg",attrs:{src:a("cf49")}})]],2),r("el-dialog",{attrs:{title:e.title,visible:e.open,width:"800px","append-to-body":""},on:{"update:visible":function(t){e.open=t},opened:e.modalOpened,close:function(t){return e.closeDialog()}}},[r("el-row",[r("el-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[e.visible?r("vue-cropper",{ref:"cropper",attrs:{img:e.options.img,info:!0,"auto-crop":e.options.autoCrop,"auto-crop-width":e.options.autoCropWidth,"auto-crop-height":e.options.autoCropHeight,"fixed-box":e.options.fixedBox},on:{realTime:e.realTime}}):e._e()],1),r("el-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[r("div",{staticClass:"avatar-upload-preview"},[r("img",{style:e.previews.img,attrs:{src:e.previews.url}})])])],1),r("br"),r("el-row",[r("el-col",{attrs:{lg:2,md:2}},[r("el-upload",{attrs:{action:"#","http-request":e.requestUpload,"show-file-list":!1,"before-upload":e.beforeUpload}},[r("el-button",{attrs:{size:"small"}},[e._v("\n            选择\n            "),r("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],1),r("el-col",{attrs:{lg:{span:1,offset:2},md:2}},[r("el-button",{attrs:{icon:"el-icon-plus",size:"small"},on:{click:function(t){return e.changeScale(1)}}})],1),r("el-col",{attrs:{lg:{span:1,offset:1},md:2}},[r("el-button",{attrs:{icon:"el-icon-minus",size:"small"},on:{click:function(t){return e.changeScale(-1)}}})],1),r("el-col",{attrs:{lg:{span:1,offset:1},md:2}},[r("el-button",{attrs:{icon:"el-icon-refresh-left",size:"small"},on:{click:function(t){return e.rotateLeft()}}})],1),r("el-col",{attrs:{lg:{span:1,offset:1},md:2}},[r("el-button",{attrs:{icon:"el-icon-refresh-right",size:"small"},on:{click:function(t){return e.rotateRight()}}})],1),r("el-col",{attrs:{lg:{span:2,offset:6},md:2}},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.uploadImg()}}},[e._v("提 交")])],1)],1)],1)],1)},o=[],s=a("4360"),l=a("7e79"),n=a("c0c7"),i={components:{VueCropper:l["VueCropper"]},props:{user:{type:Object}},data:function(){return{open:!1,visible:!1,title:"修改头像",options:{img:s["a"].getters.avatar,autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},previews:{}}},methods:{editCropper:function(){this.open=!0},modalOpened:function(){this.visible=!0},requestUpload:function(){},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},changeScale:function(e){e=e||1,this.$refs.cropper.changeScale(e)},beforeUpload:function(e){var t=this;if(-1===e.type.indexOf("image/"))this.msgError("文件格式错误，请上传图片类型,如：JPG，PNG后缀的文件。");else{var a=new FileReader;a.readAsDataURL(e),a.onload=function(){t.options.img=a.result}}},uploadImg:function(){var e=this;this.$refs.cropper.getCropBlob((function(t){var a=new FormData;a.append("file",t,"file.png"),Object(n["j"])(a).then((function(t){e.open=!1,e.$store.dispatch("user/resetAttrPath",t.result),e.msgSuccess("修改成功"),e.visible=!1}))}))},realTime:function(e){this.previews=e},closeDialog:function(){this.options.img=s["a"].getters.avatar,this.visible=!1}}},c=i,d=(a("0cc4"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"0100ad25",null);t["default"]=u.exports},"891d":function(e,t,a){"use strict";a("2029")},"89df":function(e,t,a){"use strict";a("efe3")},"8a85":function(e,t,a){},"8acb":function(e,t,a){"use strict";a("6388")},"8b1c":function(e,t,a){"use strict";a("02b0")},"8d41":function(e,t,a){},"8d8e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待处理样品",name:"1"}},[a("sample")],1),a("el-tab-pane",{attrs:{label:"历史样品列表",name:"2"}},[a("hisSample")],1)],1)],1)},o=[],s=a("d23a"),l=a("bc1d"),n={components:{sample:s["default"],hisSample:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},"8d95":function(e,t,a){},"8e68":function(e,t,a){},"8e8b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"box-card-component",staticStyle:{height:"316px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("本月度-发放报告数")])]),a("div",{class:e.className,style:{height:e.height,width:e.width},attrs:{id:"pieChart"}})])},o=[],s=(a("7f7f"),a("313e")),l=a.n(s),n=a("1e21");a("817d");var i={mixins:[n["default"]],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"230px"},pieDatas:{type:Array,required:!0}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){var e=this;this.chart=l.a.init(document.getElementById("pieChart"));var t=!0,a=!0;this.chart.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{show:!0,orient:"vertical",top:"center",left:5,textStyle:{align:"left",verticalAlign:"middle",rich:{name:{color:"rgba(255,255,255,0.5)",fontSize:10},value:{color:"rgba(255,255,255,0.5)",fontSize:10},rate:{color:"rgba(255,255,255,0.9)",fontSize:10}}},formatter:function(r){var o=e.pieDatas,s=0;o.map((function(e){s+=e.value-0}));var l=o.map((function(e){return e.name})).indexOf(r);return r+"  "+(t?o[l].value+" ":"")+(a?"("+(o[l].value/s*100).toFixed(2)+"%)":"")}},series:[{type:"pie",center:["76%","50%"],radius:["30%","52%"],label:{normal:{show:!1,position:"center",formatter:"{value|{c}}\n{label|{b}}",rich:{value:{padding:5,align:"center",verticalAlign:"middle",fontSize:28},label:{align:"center",verticalAlign:"middle",fontSize:16}}},emphasis:{show:!0,textStyle:{fontSize:"12"}}},data:this.pieDatas}]})}}},c=i,d=(a("891d"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"72227bbe",null);t["default"]=u.exports},"911f":function(e,t,a){"use strict";a("c730")},"91a2":function(e,t,a){"use strict";a("66ac1")},"93c4":function(e,t,a){},"945f":function(e,t,a){},"955f":function(e,t,a){"use strict";a("ef67")},"959f":function(e,t,a){},9603:function(e,t,a){"use strict";a("9ead")},"96e9":function(e,t,a){},"988e":function(e,t,a){"use strict";a("eb76")},"9b98":function(e,t,a){},"9ccb":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"175px"},attrs:{clearable:"",filterable:"",placeholder:"检测对象"},model:{value:e.searchForm.classId,callback:function(t){e.$set(e.searchForm,"classId",t)},expression:"searchForm.classId"}},e._l(e.classArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测因子:"}},[a("el-input",{staticStyle:{width:"175px"},attrs:{placeholder:"检测因子"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:6}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")]),a("el-button",{attrs:{type:"text",icon:"el-icon-upload"},on:{click:e.handleUpload}},[e._v("上传")]),a("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("导出")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.factorData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},border:""}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无因子\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardNo",label:"标准号",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"220px",align:"center"}}),a("el-table-column",{attrs:{prop:"analysisMethod",label:"分析方法","min-width":"80px",align:"center"}}),a("el-table-column",{attrs:{label:"标准状态","min-width":"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("0"===a.methodStatus?"现行":"废弃")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"factorUnit",label:"因子单位",width:"80px",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"检测费用",align:"center"}}),a("el-table-column",{attrs:{prop:"cmaFlg",label:"CMA",width:"60px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cmaFlg?"success":"danger"}},[e._v(e._s("1"===r.cmaFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"cnasFlg",label:"CNAS",width:"60px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cnasFlg?"success":"danger"}},[e._v(e._s("1"===r.cnasFlg?"Y":"N"))])]}}])}),a("el-table-column",{attrs:{prop:"extAssistFlg",label:"检测能力",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.cmaFlg||"1"===r.cnasFlg?"success":"danger"}},[e._v(e._s("1"===r.cmaFlg||"1"===r.cnasFlg?"有":"无"))])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 编辑")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"因子编辑",visible:e.factorDialogVisible,width:"50%"},on:{"update:visible":function(t){e.factorDialogVisible=t}}},[a("div",{staticStyle:{width:"550px",margin:"0 auto"}},[a("el-form",{ref:"factorForm",attrs:{model:e.factorForm,rules:e.factorRules,"label-width":"130px"}},[a("el-form-item",{attrs:{prop:"price",label:"检测费用:"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"检测费用",maxlength:"10"},model:{value:e.factorForm.price,callback:function(t){e.$set(e.factorForm,"price",t)},expression:"factorForm.price"}})],1),a("el-form-item",{attrs:{label:"检测能力:"}},[a("el-select",{attrs:{"default-first-option":"",placeholder:"检测能力"},on:{change:e.handleChange},model:{value:e.extAssistFlg,callback:function(t){e.extAssistFlg=t},expression:"extAssistFlg"}},[a("el-option",{attrs:{value:"0",label:"有能力"}}),a("el-option",{attrs:{value:"1",label:"无能力"}})],1)],1),"0"===e.extAssistFlg?a("el-form-item",{attrs:{prop:"cmaFlg",label:"CMA:"}},[a("el-radio-group",{model:{value:e.factorForm.cmaFlg,callback:function(t){e.$set(e.factorForm,"cmaFlg",t)},expression:"factorForm.cmaFlg"}},[a("el-radio",{attrs:{label:"0"}},[e._v("无")]),a("el-radio",{attrs:{label:"1"}},[e._v("有")])],1)],1):e._e(),"0"===e.extAssistFlg?a("el-form-item",{attrs:{prop:"cnasFlg",label:"CNAS:"}},[a("el-radio-group",{model:{value:e.factorForm.cnasFlg,callback:function(t){e.$set(e.factorForm,"cnasFlg",t)},expression:"factorForm.cnasFlg"}},[a("el-radio",{attrs:{label:"0"}},[e._v("无")]),a("el-radio",{attrs:{label:"1"}},[e._v("有")])],1)],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.factorDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"能力表上传",visible:e.uploadVisible},on:{"update:visible":function(t){e.uploadVisible=t}}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/api/factor/importExcel","on-change":e.onUploadChange,"on-exceed":e.onExceed,limit:1,"file-list":e.fileList,"http-request":e.uploadSectionFile}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)],1)],1)])},o=[],s=a("333d"),l=a("f858"),n=a("b705"),i=a("bc3a"),c=a.n(i),d={components:{Pagination:s["a"]},data:function(){return{searchForm:{classId:"",factorName:"",pageNumber:1,pageSize:10},total:0,factorData:[],factorDialogVisible:!1,categoryArray:[],factorForm:{id:"",price:"",cmaFlg:"",cnasFlg:""},extAssistFlg:"1",factorRules:{price:[{required:!0,message:"单价信息不能不空",trigger:"blur"}]},uploadVisible:!1,fileList:[],classArray:[]}},created:function(){this.getClassList(),this.handleSearch()},methods:{getClassList:function(){var e=this;n["a"]().then((function(t){e.classArray=t.result||[]}))},handleSearch:function(){var e=this;l["h"](this.searchForm).then((function(t){200===t.code&&(e.factorData=t.result.records||[],e.total=t.result.total)}))},handleUpdate:function(e){this.factorForm.id=e.id,this.factorForm.price=e.price,this.factorForm.cmaFlg=e.cmaFlg,this.factorForm.cnasFlg=e.cnasFlg,"1"===this.factorForm.cmaFlg||"1"===this.factorForm.cnasFlg?this.extAssistFlg="0":this.extAssistFlg="1",this.factorDialogVisible=!0},handleUpload:function(){this.fileList=[],this.uploadVisible=!0},handleDownload:function(){var e="/api/factor/export?sheetName=";window.open(e)},confirmDialog:function(){var e=this;this.$refs.factorForm.validate((function(t){if(!t)return!1;l["k"](e.factorForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.factorDialogVisible=!1,e.$refs.factorForm.resetFields()}))}))},handleChangeCMA:function(e){this.factorForm.cnasFlg="0"===e?"1":"0"},handleChangeCNAS:function(e){this.factorForm.cmaFlg="0"===e?"1":"0"},handleChange:function(e){"1"===e&&(this.factorForm.cmaFlg="0",this.factorForm.cnasFlg="0")},onUploadChange:function(e){"ready"!==e.status&&("success"===e.status?(this.$message({type:"success",message:"上传成功!"}),this.uploadVisible=!1):this.$message.error("上传失败!"))},onExceed:function(){this.$message.error("最多上传一个文件")},uploadSectionFile:function(e){var t=this,a=new FormData;a.append("file",e.file),c.a.post("/api/factor/importExcel",a,{responseType:"arraybuffer"}).then((function(e){if(t.$message({type:"success",message:"上传成功!"}),t.handleSearch(),e.data.byteLength>0){var a=document.createElement("a"),r=new Blob([e.data]),o=URL.createObjectURL(r);a.setAttribute("href",o),a.setAttribute("download","异常处理返回.xls"),a.click(),URL.revokeObjectURL(o)}t.uploadVisible=!1})).catch((function(e){console.log(e)}))}}},u=d,p=(a("e30a"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"3199c168",null);t["default"]=m.exports},"9d50":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"checkTime",label:"审核时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),a("div",{staticClass:"erc-divider-vertical"}),e.checkPermission(["admin","sqqzi"])?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleIssue(r)}}},[e._v("签发")]):e._e(),a("div",{staticClass:"erc-divider-vertical"}),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1):e._e(),r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1):e._e()],1)],1)]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报告签发确认",visible:e.issueVisible,center:""},on:{"update:visible":function(t){e.issueVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.issueForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.issueForm.auditFlag,callback:function(t){e.$set(e.issueForm,"auditFlag",t)},expression:"issueForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.issueForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.issueForm.auditReason,callback:function(t){e.$set(e.issueForm,"auditReason",t)},expression:"issueForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.issueVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmIssueDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("db72"),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{searchForm:{jobId:"",projectName:"",pageNumber:1,pageSize:10},total:0,reportData:[],issueVisible:!1,issueForm:{id:"",auditFlag:"1",remark:""}}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["d"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)},handleIssue:function(e){this.issueForm.id=e.id,this.issueForm.auditFlag="1",this.issueForm.remark="",this.issueVisible=!0},confirmIssueDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["i"](e.issueForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.issueVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},p=u,m=(a("41f4"),a("2877")),h=Object(m["a"])(p,r,o,!1,null,"31c2d56b",null);t["default"]=h.exports},"9dfc":function(e,t,a){},"9ead":function(e,t,a){},"9ed6":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login-container ng-scope"},[r("div",{staticClass:"login-wrap"},[e._m(0),r("el-card",{staticClass:"card-container"},[r("el-tabs",{staticStyle:{height:"350px"},attrs:{type:"card","tab-position":e.tabPosition}},[r("el-tab-pane",[r("span",{staticStyle:{width:"248px"},attrs:{slot:"label"},slot:"label"},[r("i",{staticClass:"el-icon-user"}),e._v(" 账号登录")]),r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,autocomplete:"on","label-position":"left"}},[r("div",{staticClass:"title-container"},[r("h1",{staticClass:"title"},[e._v("登录")])]),r("el-form-item",{attrs:{prop:"username"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"user"}})],1),r("el-input",{ref:"username",attrs:{placeholder:"请输入账号",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),r("el-tooltip",{attrs:{content:"密码明文查看",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),r("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"请填写密码",name:"password",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:function(t){return e.checkCapslock(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),r("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1)],1),r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登 录")]),r("span",{staticStyle:{"font-size":"13px",cursor:"pointer",color:"#9b9ea0","text-decoration":"none",position:"absolute",right:"20px","padding-top":"20px"},on:{click:e.forgetPwd}},[e._v("忘记密码")]),r("el-row",[r("el-col",{staticStyle:{"text-align":"center","padding-top":"25px"},attrs:{span:24}},[r("span",{staticStyle:{"font-size":"12px",cursor:"pointer",color:"#9b9ea0","text-decoration":"none"}},[e._v("\n                  登录并使用“环测链”即为同意"),r("a",{staticStyle:{color:"#1890FF"},attrs:{href:"https://www.jshengzheng.com/aggrement",target:"_blank"}},[e._v("《用户协议》")]),e._v("和\n                  "),r("a",{staticStyle:{color:"#1890FF"},attrs:{href:"https://www.jshengzheng.com/privacyPolicy",target:"_blank"}},[e._v("《隐私政策》")])])])],1)],1)],1),r("el-tab-pane",[r("span",{staticStyle:{width:"249px"},attrs:{slot:"label"},slot:"label"},[r("i",{staticClass:"el-icon-phone"}),e._v(" 手机号登录")]),r("el-form",{ref:"loginPhoneForm",staticClass:"login-form",attrs:{model:e.loginPhoneForm,rules:e.loginPhoneRules,autocomplete:"on","label-position":"left"}},[r("div",{staticClass:"title-container"},[r("h1",{staticClass:"title"},[e._v("登录")])]),r("el-form-item",{attrs:{prop:"username"}},[r("span",{staticClass:"svg-container"},[r("img",{staticClass:"svgImg",attrs:{src:a("0a37")}})]),r("el-input",{ref:"phone",attrs:{placeholder:"请输入手机号码",name:"phone",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginPhoneForm.phone,callback:function(t){e.$set(e.loginPhoneForm,"phone",t)},expression:"loginPhoneForm.phone"}})],1),r("el-tooltip",{attrs:{content:"密码明文查看",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),r("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"请填写密码",name:"password",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:function(t){return e.checkCapslock(t)}},model:{value:e.loginPhoneForm.password,callback:function(t){e.$set(e.loginPhoneForm,"password",t)},expression:"loginPhoneForm.password"}}),r("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1)],1),r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.phoneLogin(t)}}},[e._v("登 录")]),r("span",{staticStyle:{"font-size":"13px",cursor:"pointer",color:"#9b9ea0","text-decoration":"none",position:"absolute",right:"20px","padding-top":"20px"},on:{click:e.forgetPwd}},[e._v("忘记密码")]),r("el-row",[r("el-col",{staticStyle:{"text-align":"center","padding-top":"25px"},attrs:{span:24}},[r("span",{staticStyle:{"font-size":"12px",cursor:"pointer",color:"#9b9ea0","text-decoration":"none"}},[e._v("\n                  登录并使用“环测链”即为同意"),r("a",{staticStyle:{color:"#1890FF"},attrs:{href:"https://www.jshengzheng.com/aggrement",target:"_blank"}},[e._v("《用户协议》")]),e._v("和\n                  "),r("a",{staticStyle:{color:"#1890FF"},attrs:{href:"https://www.jshengzheng.com/privacyPolicy",target:"_blank"}},[e._v("《隐私政策》")])])])],1)],1)],1)],1)],1)],1),r("el-dialog",{attrs:{title:"忘记密码",visible:e.dialogVisible,width:"30%","append-to-body":"",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("p",[e._v(" 机构员工遗失密码，请联系本机构管理员进行密码重置；")]),r("p",[e._v("机构管理员遗失密码，请联系平台客服，QQ：2546125360，并提供相关身份证明材料。")]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bg-opacity"},[a("div",{staticClass:"logo"}),a("div",{staticClass:"title"})])}],s=(a("ac6a"),a("456d"),{name:"Login",data:function(){return{loginForm:{username:"",password:""},loginPhoneForm:{phone:"",password:""},tabPosition:"",loginRules:{username:[{required:!0,trigger:"blur",message:"请输入用户名称"}],password:[{required:!0,trigger:"blur",message:"请录入密码"}]},loginPhoneRules:{phone:[{required:!0,trigger:"blur",message:"请输入手机号码"}],password:[{required:!0,trigger:"blur",message:"请录入密码"}]},passwordType:"password",capsTooltip:!1,loading:!1,redirect:void 0,otherQuery:{},dialogVisible:!1}},watch:{$route:{handler:function(e){var t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}},created:function(){},mounted:function(){""===this.loginForm.username?this.$refs.username.focus():""===this.loginForm.password&&this.$refs.password.focus()},methods:{checkCapslock:function(e){var t=e.key;this.capsTooltip=t&&1===t.length&&t>="A"&&t<="Z"},showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(){e.$router.push({path:"/",query:e.otherQuery}),e.loading=!1})).catch((function(){e.loading=!1}))}))},phoneLogin:function(){var e=this;this.$refs.loginPhoneForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,e.$store.dispatch("user/phoneLogin",e.loginPhoneForm).then((function(){e.$router.push({path:"/",query:e.otherQuery}),e.loading=!1})).catch((function(){e.loading=!1}))}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(t,a){return"redirect"!==a&&(t[a]=e[a]),t}),{})},forgetPwd:function(){this.dialogVisible=!0}}}),l=s,n=(a("2017"),a("2b1d"),a("2877")),i=Object(n["a"])(l,r,o,!1,null,"57fac890",null);t["default"]=i.exports},"9f07":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.offerId,callback:function(t){e.$set(e.searchForm,"offerId",t)},expression:"searchForm.offerId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报告状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"报告状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(Object.keys(e.REPORT_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.REPORT_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{data:e.reportData,border:"",stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",align:"center"}}),a("el-table-column",{attrs:{prop:"offerId",label:"任务单号",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"生成时间",align:"center"}}),a("el-table-column",{attrs:{prop:"reportStatus",label:"报告状态",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleTask(r)}}},[e._v("任务分配")])]}}])})],1)],1)},o=[],s={0:"待审核"},l={data:function(){return{REPORT_STATUS:s,searchForm:{},total:0,reportData:[],path:"offer_template.docx"}},created:function(){},methods:{handleSearch:function(){},handleToFile:function(){},handleDetail:function(e){}}},n=l,i=(a("9fca"),a("2877")),c=Object(i["a"])(n,r,o,!1,null,"18f6d1e0",null);t["default"]=c.exports},"9f079":function(e,t,a){"use strict";a("7ac6")},"9f32":function(e,t,a){"use strict";a("145f")},"9f71":function(e,t,a){"use strict";a("7ef2")},"9fb4":function(e,t,a){},"9fca":function(e,t,a){"use strict";a("0dea")},"9fcc":function(e,t,a){},"9fde":function(e,t,a){},a0b9:function(e,t,a){"use strict";a("c679")},a17e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"选择用户",visible:e.visible,width:"800px",top:"5vh","append-to-body":""},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[a("el-input",{attrs:{placeholder:"请输入用户名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.userName,callback:function(t){e.$set(e.queryParams,"userName",t)},expression:"queryParams.userName"}})],1),a("el-form-item",{attrs:{label:"手机号码",prop:"phonenumber"}},[a("el-input",{attrs:{placeholder:"请输入手机号码",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.phonenumber,callback:function(t){e.$set(e.queryParams,"phonenumber",t)},expression:"queryParams.phonenumber"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-row",[a("el-table",{ref:"table",attrs:{data:e.userList,height:"260px"},on:{"row-click":e.clickRow,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"邮箱",prop:"email","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dict-tag",{attrs:{options:e.statusOptions,value:t.row.status}})]}}])}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectUser}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")])],1)],1)},o=[],s=(a("c5f6"),a("3528")),l={props:{roleId:{type:Number}},data:function(){return{visible:!1,userIds:[],total:0,userList:[],statusOptions:[],queryParams:{pageNumber:1,pageSize:10,roleId:void 0,userName:void 0,phonenumber:void 0}}},created:function(){var e=this;this.getDicts("sys_normal_disable").then((function(t){e.statusOptions=t.data}))},methods:{show:function(){this.queryParams.roleId=this.roleId,this.getList(),this.visible=!0},clickRow:function(e){this.$refs.table.toggleRowSelection(e)},handleSelectionChange:function(e){this.userIds=e.map((function(e){return e.userId}))},getList:function(){var e=this;Object(s["m"])(this.queryParams).then((function(t){e.userList=t.rows,e.total=t.total}))},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectUser:function(){var e=this,t=this.queryParams.roleId,a=this.userIds.join(",");Object(s["e"])({roleId:t,userIds:a}).then((function(t){e.msgSuccess(t.msg),200===t.code&&(e.visible=!1,e.$emit("ok"))}))}}},n=l,i=a("2877"),c=Object(i["a"])(n,r,o,!1,null,null,null);t["default"]=c.exports},a1b9:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待审核样品",name:"1"}},[a("approve-list",{attrs:{"samp-task-id":e.sampTaskId}})],1),a("el-tab-pane",{attrs:{label:"已审核样品",name:"2"}},[a("approve-his-list",{attrs:{"samp-task-id":e.sampTaskId}})],1)],1)],1)},o=[],s=a("cb3b"),l=a("df9b"),n={components:{ApproveList:s["default"],ApproveHisList:l["default"]},data:function(){return{activeName:"1",sampTaskId:""}},created:function(){this.$route.params.sampTaskId&&(this.sampTaskId=this.$route.params.sampTaskId)},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},a28f:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"})},o=[],s=a("2877"),l={},n=Object(s["a"])(l,r,o,!1,null,null,null);t["default"]=n.exports},a29f:function(e,t,a){},a2a9:function(e,t,a){"use strict";a("0867")},a2dc:function(e,t,a){},a339:function(e,t,a){},a34c:function(e,t,a){},a353:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:e.taskData,stripe:"",border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无任务信息\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"contCode",label:"合同编号",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"scheduProgress",label:"调度进度",align:"center"}}),a("el-table-column",{attrs:{prop:"latestScheduDate",label:"上次调度",align:"center"}}),a("el-table-column",{attrs:{prop:"finishProgress",label:"计划调度完成进度",align:"center"}}),a("el-table-column",{attrs:{prop:"scheduStatus",label:"状态",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleScheduler(r)}}},[e._v(" 分配")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("2877"),l={},n=Object(s["a"])(l,r,o,!1,null,null,null);t["default"]=n.exports},a36b:function(e,t,a){e.exports=a.p+"static/img/404.a57b6f31.png"},a37b7:function(e,t,a){},a4f2:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"合同编号:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"合同编号"},model:{value:e.searchForm.contCode,callback:function(t){e.$set(e.searchForm,"contCode",t)},expression:"searchForm.contCode"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.contName,callback:function(t){e.$set(e.searchForm,"contName",t)},expression:"searchForm.contName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.contractData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无合同信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"contCode",label:"合同编号",width:"185px",align:"center"}}),a("el-table-column",{attrs:{prop:"offerId",label:"报价单号",width:"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"partA",label:"甲方",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"signDate",label:"签订日期",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"validity",label:"有效期(年)",align:"center"}}),a("el-table-column",{attrs:{prop:"contStatus",label:"合同状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.contStatus)}},[e._v("\n            "+e._s(e.CONTRACT_STATUS[r.contStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[5!=r.contStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]):e._e(),5!=r.contStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),5!=r.contStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDwonload(r)}}},[e._v(" 下载")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("35ad"),l=a("333d"),n={4:"完成",5:"已作废"},i={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"2"===e?"":"3"===e||"1"===e||"4"===e?"success":"danger"}},data:function(){return{CONTRACT_STATUS:n,contractData:[],searchForm:{contCode:"",contName:"",contStatus:"",pageNumber:1,pageSize:10},total:0,contractVisible:!1,contractForm:{contId:"",contractInfoTdo:{signDate:"",signLocation:"",payMethod:"",payMethodDesc:"",validity:""},cusContBaseInfoTdo:{organId:"",companyName:"",address:"",postCode:"",jurPerson:"",agentPerson:"",telFax:"",bankName:"",bankNo:"",taxNumber:""}},collapNames:["1"],restaurants:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["h"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.contractData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;s["e"](e.id).then((function(e){200===e.code&&e.result&&e.result.length>0?t.$router.push({name:"sysPdfView",params:{path:e.result,type:1}}):t.$message.error("合同PDF还未生成")}))},handleDwonload:function(e){var t="/api/word/downLoadContract?contCode="+e.contCode;window.open(t)}}},c=i,d=(a("0340"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"30e1d954",null);t["default"]=u.exports},a555:function(e,t,a){},a6f4:function(e,t,a){"use strict";a("f8c3")},a73e:function(e,t,a){"use strict";a("5620")},a8ca:function(e,t,a){},a933:function(e,t,a){},abf0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"合同编号:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"合同编号"},model:{value:e.searchForm.contCode,callback:function(t){e.$set(e.searchForm,"contCode",t)},expression:"searchForm.contCode"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.contName,callback:function(t){e.$set(e.searchForm,"contName",t)},expression:"searchForm.contName"}})],1),a("el-form-item",{attrs:{label:"合同状态:"}},[a("el-select",{staticStyle:{width:"170px"},attrs:{clearable:"",filterable:"",placeholder:"合同状态"},model:{value:e.searchForm.contStatus,callback:function(t){e.$set(e.searchForm,"contStatus",t)},expression:"searchForm.contStatus"}},e._l(Object.keys(e.CONTRACT_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.CONTRACT_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.contractData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无合同信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"contCode",label:"合同编号",width:"185px",align:"center"}}),a("el-table-column",{attrs:{prop:"offerId",label:"报价单号",width:"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"partA",label:"客户名称",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"signDate",label:"签订日期",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"validity",label:"有效期(年)",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"contStatus",label:"合同状态",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.contStatus)}},[e._v("\n            "+e._s(e.CONTRACT_STATUS[r.contStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"210px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.contStatus>0?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]):e._e(),"6"===r.contStatus||"2"===r.contStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"0"===r.contStatus?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["contract:list:add"],expression:"['contract:list:add']"}],attrs:{type:"text"},on:{click:function(t){return e.handleEdit(r)}}},[e._v(" 完善")]):e._e(),"6"===r.contStatus||"2"===r.contStatus?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["contract:list:update"],expression:"['contract:list:update']"}],attrs:{type:"text"},on:{click:function(t){return e.handleEdit(r)}}},[e._v(" 编辑")]):e._e(),r.signDate&&r.contStatus>=1?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.signDate&&r.contStatus>=1?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDwonload(r)}}},[e._v(" 下载")]):e._e(),r.signDate&&"6"===r.contStatus?a("div",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["contract:list:update"],expression:"['contract:list:update']"}],staticClass:"erc-divider-vertical"}):e._e(),r.signDate&&"6"===r.contStatus?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["contract:list:update"],expression:"['contract:list:update']"}],attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r)}}},[e._v(" 提交审核")]):e._e(),"0"===r.contStatus||"2"===r.contStatus?a("div",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["contract:list:del"],expression:"['contract:list:del']"}],staticClass:"erc-divider-vertical"}):e._e(),"0"===r.contStatus||"2"===r.contStatus?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["contract:list:del"],expression:"['contract:list:del']"}],attrs:{type:"text"},on:{click:function(t){return e.handleDelete(r)}}},[e._v(" 作废")]):e._e(),"2"===r.contStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"2"===r.contStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApproveDetail(r)}}},[e._v(" 审核历史")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"合同信息完善",visible:e.contractVisible,width:"85%",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.contractVisible=t}}},[a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"maker",label:"在线制作"}},[a("el-form",{ref:"contractForm",attrs:{model:e.contractForm,rules:e.contractRules,"label-width":"120px","label-position":"right"}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("合同信息")]),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"contractInfoTdo.validity",label:"有效期(年):"}},[a("el-input-number",{staticStyle:{width:"90%"},attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.contractForm.contractInfoTdo.validity,callback:function(t){e.$set(e.contractForm.contractInfoTdo,"validity",t)},expression:"contractForm.contractInfoTdo.validity"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"contractInfoTdo.signDate",label:"签订日期:"}},[a("el-date-picker",{staticStyle:{width:"90%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"签订日期"},model:{value:e.contractForm.contractInfoTdo.signDate,callback:function(t){e.$set(e.contractForm.contractInfoTdo,"signDate",t)},expression:"contractForm.contractInfoTdo.signDate"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"contractInfoTdo.signLocation",label:"签订地址:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"签订地址"},model:{value:e.contractForm.contractInfoTdo.signLocation,callback:function(t){e.$set(e.contractForm.contractInfoTdo,"signLocation",t)},expression:"contractForm.contractInfoTdo.signLocation"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"contractInfoTdo.payMethod",label:"支付方式:"}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"支付方式"},model:{value:e.contractForm.contractInfoTdo.payMethod,callback:function(t){e.$set(e.contractForm.contractInfoTdo,"payMethod",t)},expression:"contractForm.contractInfoTdo.payMethod"}},[a("el-option",{attrs:{value:"1",label:"一次付清"}},[e._v("一次付清")]),a("el-option",{attrs:{value:"2",label:"分期支付"}},[e._v("分期支付")]),a("el-option",{attrs:{value:"3",label:"其他方式"}},[e._v("其他方式")])],1)],1)],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{prop:"contractInfoTdo.payMethodDesc",label:"支付说明:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"支付说明"},model:{value:e.contractForm.contractInfoTdo.payMethodDesc,callback:function(t){e.$set(e.contractForm.contractInfoTdo,"payMethodDesc",t)},expression:"contractForm.contractInfoTdo.payMethodDesc"}})],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("客户信息")]),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同属性:"}},[a("el-switch",{attrs:{"active-text":"子合同","inactive-text":"主合同"},model:{value:e.masterSwitch,callback:function(t){e.masterSwitch=t},expression:"masterSwitch"}})],1)],1),e.masterSwitch?a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"关联主合同:"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"合同编号"},model:{value:e.contractForm.addTdo.supContCode,callback:function(t){e.$set(e.contractForm.addTdo,"supContCode",t)},expression:"contractForm.addTdo.supContCode"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.checkContractInfo}},[e._v("验证")]),e.checkFlag?a("span",{staticStyle:{color:"green","margin-left":"10px"}},[e._v("\n                  "+e._s(e.checkText)+"\n                ")]):e._e(),e.checkFlag?e._e():a("span",{staticStyle:{color:"red","margin-left":"10px"}},[e._v("\n                  "+e._s(e.checkText)+"\n                ")])],1)],1):e._e()],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.companyName",label:"单位名称:"}},[a("el-select",{staticStyle:{width:"90%"},attrs:{filterable:"",remote:"",placeholder:"请输入客户","remote-method":e.querySearchAsync},on:{change:e.handleSelectCom},model:{value:e.contractForm.addTdo.companyName,callback:function(t){e.$set(e.contractForm.addTdo,"companyName",t)},expression:"contractForm.addTdo.companyName"}},e._l(Object.keys(e.companyMap),(function(t){return a("el-option",{key:t,attrs:{label:e.companyMap[t],value:t}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.address",label:"通讯地址:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:"35",placeholder:"通讯地址"},model:{value:e.contractForm.addTdo.address,callback:function(t){e.$set(e.contractForm.addTdo,"address",t)},expression:"contractForm.addTdo.address"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.postCode",label:"邮政编码:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:6,placeholder:"邮政编码"},model:{value:e.contractForm.addTdo.postCode,callback:function(t){e.$set(e.contractForm.addTdo,"postCode",t)},expression:"contractForm.addTdo.postCode"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.jurPerson",label:"法定代表人:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:"40",placeholder:"法定代表人"},model:{value:e.contractForm.addTdo.jurPerson,callback:function(t){e.$set(e.contractForm.addTdo,"jurPerson",t)},expression:"contractForm.addTdo.jurPerson"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.agentPerson",label:"委托代理人:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:"40",placeholder:"委托代理人"},model:{value:e.contractForm.addTdo.agentPerson,callback:function(t){e.$set(e.contractForm.addTdo,"agentPerson",t)},expression:"contractForm.addTdo.agentPerson"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.telFax",label:"电话/传真:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:"15",placeholder:"电话/传真"},model:{value:e.contractForm.addTdo.telFax,callback:function(t){e.$set(e.contractForm.addTdo,"telFax",t)},expression:"contractForm.addTdo.telFax"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.bankName",label:"开户银行:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:"15",placeholder:"开户银行"},model:{value:e.contractForm.addTdo.bankName,callback:function(t){e.$set(e.contractForm.addTdo,"bankName",t)},expression:"contractForm.addTdo.bankName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.bankNo",label:"银行账号:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:"20",placeholder:"银行账号"},on:{input:e.bankNumCheck},model:{value:e.contractForm.addTdo.bankNo,callback:function(t){e.$set(e.contractForm.addTdo,"bankNo",t)},expression:"contractForm.addTdo.bankNo"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"addTdo.taxNumber",label:"税号:"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{maxlength:"20",placeholder:"税号"},model:{value:e.contractForm.addTdo.taxNumber,callback:function(t){e.$set(e.contractForm.addTdo,"taxNumber",t)},expression:"contractForm.addTdo.taxNumber"}})],1)],1)],1)],1)],1),a("el-tab-pane",{attrs:{name:"upload",label:"合同上传"}},[a("el-form",{attrs:{model:e.contarctUploadForm,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"signDate",label:"签订时间:"}},[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"签订日期"},model:{value:e.contarctUploadForm.signDate,callback:function(t){e.$set(e.contarctUploadForm,"signDate",t)},expression:"contarctUploadForm.signDate"}})],1),a("el-form-item",{attrs:{label:"合同属性:"}},[a("el-switch",{attrs:{"active-text":"子合同","inactive-text":"主合同"},model:{value:e.masterUpSwitch,callback:function(t){e.masterUpSwitch=t},expression:"masterUpSwitch"}})],1),e.masterUpSwitch?a("el-form-item",{attrs:{label:"关联主合同:"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"合同编号"},model:{value:e.contarctUploadForm.supContCode,callback:function(t){e.$set(e.contarctUploadForm,"supContCode",t)},expression:"contarctUploadForm.supContCode"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.checkUpContractInfo}},[e._v("验证")]),e.checkUpFlag?a("span",{staticStyle:{color:"green","margin-left":"10px"}},[e._v("\n              "+e._s(e.checkUpText)+"\n            ")]):e._e(),e.checkUpFlag?e._e():a("span",{staticStyle:{color:"red","margin-left":"10px"}},[e._v("\n              "+e._s(e.checkUpText)+"\n            ")])],1):e._e(),a("el-form-item",{attrs:{label:"有效期(年):"}},[a("el-input-number",{staticStyle:{width:"260px"},attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.contarctUploadForm.validity,callback:function(t){e.$set(e.contarctUploadForm,"validity",t)},expression:"contarctUploadForm.validity"}})],1),a("el-form-item",{attrs:{label:"合同附件上传:"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"/api/cont/uploadContFile","on-change":e.onUploadChange,"on-exceed":e.onExceed,"on-remove":e.onUploadRemove,limit:1,"file-list":e.fileList,accept:".doc,.docx,.pdf"}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("\n                将文件拖到此处，或\n                "),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"}),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("注:您只能上传.doc,.docx,.pdf格式的文件")])])],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.contractVisible=!1}}},[e._v("取消")]),a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.processLoading,expression:"processLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1),a("el-dialog",{attrs:{title:"合同审核",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmApproveDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"审核历史",visible:e.appHisVisible,width:"75%"},on:{"update:visible":function(t){e.appHisVisible=t}}},[a("el-table",{attrs:{data:e.approveDetails,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.auditFlag?"success":"danger"}},[e._v(e._s("1"===r.auditFlag?"通过":"不通过"))])]}}])}),a("el-table-column",{attrs:{prop:"auditReason",label:"审核说明",align:"center"}}),a("el-table-column",{attrs:{prop:"auditUserName",label:"审批用户",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"审批时间",align:"center"}})],1)],1)],1)},o=[],s=a("db72"),l=(a("a481"),a("35ad")),n=a("f6b0"),i=a("333d"),c={0:"待完善",6:"待提交",1:"待审核",2:"审核驳回"},d={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"2"===e?"":"3"===e||"1"===e?"info":"4"===e?"success":"danger"}},data:function(){return{CONTRACT_STATUS:c,contractData:[],searchForm:{contCode:"",contName:"",contStatus:"",pageNumber:1,pageSize:10},masterSwitch:!1,masterUpSwitch:!1,checkFlag:!1,checkText:"",total:0,contractVisible:!1,contractForm:{contId:"",contractInfoTdo:{signDate:"",signLocation:"",payMethod:"0",payMethodDesc:"",validity:""},cusContBaseInfoId:"",addTdo:{supContCode:"",companyName:"",address:"",postCode:"",jurPerson:"",agentPerson:"",telFax:"",bankName:"",bankNo:"",taxNumber:""}},contractStatus:"create",contractRules:{contractInfoTdo:{validity:[{required:!0,message:"请录入有效期",trigger:"blur"}],signDate:[{required:!0,message:"请录入签订日期",trigger:"blur"}],signLocation:[{required:!0,message:"请录入地址",trigger:"blur"}],payMethod:[{required:!0,message:"请选择支付方式",trigger:"blur"}],payMethodDesc:[{required:!0,message:"请录支付说明",trigger:"blur"}]},addTdo:{companyName:[{required:!0,message:"请录入单位名称",trigger:"blur"}],address:[{required:!0,message:"请录入通讯地址",trigger:"blur"}],postCode:[{required:!0,message:"请录入邮政编码",trigger:"blur"}],jurPerson:[{required:!0,message:"请录入法定代表人",trigger:"blur"}],agentPerson:[{required:!0,message:"请录入委托代理人",trigger:"blur"}],telFax:[{required:!0,message:"请录入电话/传真",trigger:"blur"}],bankName:[{required:!0,message:"请录入开户银行",trigger:"blur"}],bankNo:[{required:!0,message:"请录入银行账号",trigger:"blur"}],taxNumber:[{required:!0,message:"请录入税号",trigger:"blur"}]}},uploadContractForm:{contId:"",signDate:"",contFileId:"",validity:""},restaurants:[],contarctUploadForm:{contId:"",contFileId:"",supContCode:"",signDate:"",validity:""},fileList:[],activeName:"maker",companyMap:{},approveVisible:!1,currentItem:{},approveForm:{contId:"",auditFlag:"1",auditReason:""},appHisVisible:!1,approveDetails:[],processLoading:!1,checkUpFlag:!1,checkUpText:"",customerList:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;l["f"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.contractData=t.result.records||[],e.total=t.result.total)}))},querySearchAsync:function(e){var t=this;e&&e.trim().length>0&&n["d"](e).then((function(e){e.result&&(t.companyMap=e.result||{})})).catch((function(){}))},confirmDialog:function(){var e=this;if(this.processLoading=!0,"maker"===this.activeName){if(this.masterSwitch&&(this.contractForm.addTdo.supContCode.length<=0||!this.checkFlag))return this.$message.error("请录入关联主合同信息且通过验证！"),void(this.processLoading=!1);this.$refs.contractForm.validate((function(t){t?(e.contractForm.addTdo&&""!==e.contractForm.addTdo.id&&(e.contractForm.cusContBaseInfoId=e.contractForm.addTdo.id||""),l["k"](e.contractForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.contractVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"}),e.processLoading=!1})).catch((function(){e.contractVisible=!1,e.processLoading=!1,e.handleSearch()})).finally((function(){e.contractVisible=!1,e.processLoading=!1,e.handleSearch()}))):e.processLoading=!1}))}else{if(this.masterUpSwitch&&(this.contarctUploadForm.supContCode.length<=0||!this.checkUpFlag))return this.$message.error("请录入关联主合同信息且通过验证！"),void(this.processLoading=!1);this.contarctUploadForm.signDate&&this.contarctUploadForm.validity?l["l"](this.contarctUploadForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.contractVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"}),e.contractVisible=!1,e.processLoading=!1,e.handleSearch()})).finally((function(){e.processLoading=!1})):(this.$message.error("签订时间和周期不能为空"),this.processLoading=!1)}},handleDetail:function(e){var t=this;l["e"](e.id).then((function(e){if(200===e.code&&e.result&&e.result.length>0){var a=e.result;t.$router.push({name:"sysPdfView",params:{path:a,type:1}})}else t.$message.error("合同PDF还未生成")}))},handleEdit:function(e){var t=this;this.clearForm(),this.checkFlag=!1,this.checkUpFlag=!1,this.checkText="",this.checkUpText="",this.contarctUploadForm.contId=e.id,"0"===e.makeType?(this.contractForm.contId=e.id,l["g"](e.id).then((function(a){200===a.code&&a.result&&(t.contractForm.contractInfoTdo.signDate=a.result.signDate,t.contractForm.contractInfoTdo.signLocation=a.result.signLocation,t.contractForm.contractInfoTdo.payMethod=a.result.payMethod,t.contractForm.contractInfoTdo.payMethodDesc=a.result.payMethodDesc,t.contractForm.contractInfoTdo.validity=a.result.validity,a.result.cusContBaseInfoVo&&a.result.cusContBaseInfoVo.id?t.contractForm.cusContBaseInfoId=a.result.cusContBaseInfoVo.id:t.contractForm.cusContBaseInfoId="",t.contractForm.addTdo=a.result.cusContBaseInfoVo||{},"6"===e.contStatus&&(t.currentItem=a.result.cusContBaseInfoVo||{}),t.contractVisible=!0)}))):(this.contarctUploadForm.contFileId=e.contFileId,this.contarctUploadForm.signDate=e.signDate,this.contarctUploadForm.validity=e.validity,this.contarctUploadForm.supContCode=e.supContCode,this.contractVisible=!0)},clearForm:function(){this.contractForm={contId:"",contractInfoTdo:{signDate:"",signLocation:"",payMethod:"0",payMethodDesc:"",validity:"1"},cusContBaseInfoId:"",addTdo:{id:"",organId:"",companyName:"",address:"",postCode:"",jurPerson:"",agentPerson:"",telFax:"",bankName:"",bankNo:"",taxNumber:"",supContCode:""}},this.contarctUploadForm={contId:"",contFileId:"",supContCode:"",signDate:"",validity:"1"},this.masterSwitch=!1,this.masterUpSwitch=!1},bankNumCheck:function(e){this.contractForm.addTdo.bankNo=e.replace(/[^\d]/g,"")},handleSelectCom:function(e){var t=this;n["c"](e).then((function(e){200===e.code&&e.result&&(t.currentItem=Object(s["a"])({},e.result),t.contractForm.cusContBaseInfoId=e.result.id,t.contractForm.addTdo=e.result)}))},onUploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.contarctUploadForm.contFileId=e.response.result,this.$message({type:"success",message:"上传成功!"})):this.$message.error("上传失败!")}else this.$message.error("上传失败!")},onExceed:function(){this.$message.error("最多上传一个文件")},onUploadRemove:function(){this.contarctUploadForm.contFileId=""},handleApprove:function(e){var t=this;this.$confirm("确定提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["m"](e.id).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleDwonload:function(e){if(e.contFileId&&e.contFileId.length>0){var t=this.$store.getters.sysBaseUrl+"/file/ht/upload/"+e.contFileId;window.open(t)}else this.$message.warning("合同生成异常，请联系管理员")},handleApproveDetail:function(e){var t=this;l["d"](e.id).then((function(e){t.approveDetails=e.result||[]})),this.appHisVisible=!0},handleDelete:function(e){var t=this;this.$confirm("确定作废?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["j"](e.id).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleApproveRes:function(e){this.approveForm.contId=e.id,this.approveForm.auditFlag="1",this.approveForm.auditReason="",this.approveVisible=!0},confirmApproveDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},checkContractInfo:function(){var e=this;this.contractForm.addTdo.supContCode&&this.contractForm.addTdo.supContCode.length>0&&l["b"]({supContCode:this.contractForm.addTdo.supContCode}).then((function(t){200===t.code?(e.checkFlag=!0,e.checkText="校验通过"):(e.checkFlag=!1,e.checkText="校验不通过")})).catch((function(){e.checkFlag=!1,e.checkText="校验不通过"}))},checkUpContractInfo:function(){var e=this;this.contarctUploadForm.supContCode&&this.contarctUploadForm.supContCode.length>0&&l["b"]({supContCode:this.contarctUploadForm.supContCode}).then((function(t){200===t.code?(e.checkUpFlag=!0,e.checkUpText="校验通过"):(e.checkUpFlag=!1,e.checkUpText="校验不通过")})).catch((function(){e.checkUpFlag=!1,e.checkUpText="校验不通过"}))}}},u=d,p=(a("f608"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"598a906c",null);t["default"]=m.exports},ad06:function(e,t,a){"use strict";a("a29f")},ae59:function(e,t,a){"use strict";a("8435")},ae64:function(e,t,a){},af96:function(e,t,a){},b196:function(e,t,a){},b199:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"h",(function(){return l})),a.d(t,"k",(function(){return n})),a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"g",(function(){return d})),a.d(t,"n",(function(){return u})),a.d(t,"a",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"j",(function(){return h})),a.d(t,"m",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"l",(function(){return g}));var r=a("b775");function o(e){return Object(r["a"])({url:"/scheduleTask/findByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/scheduleTask/findHistoryByCondition",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/scheduleTask/".concat(e,"/jobFactors"),method:"get"})}function n(e){return Object(r["a"])({url:"/scheduleTask/".concat(e,"/findOfferPlan"),method:"get"})}function i(e){return Object(r["a"])({url:"/scheduleTask/".concat(e,"/findFactors"),method:"get"})}function c(e){return Object(r["a"])({url:"/scheduleTask/findFactorsByOfferPlanIds",method:"get",params:e})}function d(e){return Object(r["a"])({url:"/scheduleTask/findJobByTaskId/".concat(e),method:"get"})}function u(e){return Object(r["a"])({url:"/scheduleTask/saveScheduleJob",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/scheduleTask/confirmScheduleJob",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/scheduleTask/findJobForTask",method:"get",params:e})}function h(e){return Object(r["a"])({url:"/scheduleTask/findJobsByCondition",method:"get",params:e})}function f(e){return Object(r["a"])({url:"/offerDispatch/getOfferFactorByTaskId/".concat(e),method:"get"})}function b(e){return Object(r["a"])({url:"/offerDispatch/doScheduTask",method:"post",data:e})}function g(e){return Object(r["a"])({url:"/offerDispatch/getLastScheduInfoByTaskId/".concat(e),method:"get"})}},b218:function(e,t,a){"use strict";a("9dfc")},b300:function(e,t,a){"use strict";a("4738")},b32e:function(e,t,a){},b429:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return n})),a.d(t,"e",(function(){return i}));var r=a("b775");function o(e){return Object(r["a"])({url:"/approval/offer/findOfferByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/approval/offer/check",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/approval/offer/findOfferApprovalRecordByOfferId/".concat(e),method:"get"})}function n(e){return Object(r["a"])({url:"/approval/offer/findOfferJudgeByCondition",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/approval/offer/judge",method:"post",data:e})}},b440:function(e,t,a){},b4f2:function(e,t,a){},b5d4:function(e,t,a){"use strict";a("5c4e")},b637:function(e,t,a){},b66d:function(e,t,a){},b705:function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return d})),a.d(t,"h",(function(){return u})),a.d(t,"i",(function(){return p}));var r=a("b775");function o(e){return Object(r["a"])({url:"/common/findDictMap/".concat(e),method:"get"})}function s(){return Object(r["a"])({url:"/common/findSampLeaders",method:"get"})}function l(){return Object(r["a"])({url:"/common/findMonitorFreq",method:"get"})}function n(){return Object(r["a"])({url:"/judge/organ/findValidList",method:"get"})}function i(){return Object(r["a"])({url:"/platform/factor/findFstClasses",method:"get"})}function c(e){return Object(r["a"])({url:"/platform/factor/findSecdClassByClassId/".concat(e),method:"get"})}function d(){return Object(r["a"])({url:"/platform/factor/findClassTrees",method:"get"})}function u(){return Object(r["a"])({url:"/sysRegion/getFirstLevel",method:"get"})}function p(e){return Object(r["a"])({url:"/sysRegion/getSubRegionByRegionCode/".concat(e),method:"get"})}},b829:function(e,t,a){"use strict";a.r(t);a("386d");var r,o,s={name:"AuthRedirect",created:function(){var e=window.location.search.slice(1);window.localStorage&&(window.localStorage.setItem("x-admin-oauth-code",e),window.close())},render:function(e){return e()}},l=s,n=a("2877"),i=Object(n["a"])(l,r,o,!1,null,null,null);t["default"]=i.exports},b82c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待调度列表",name:"1"}},[a("processTask")],1),a("el-tab-pane",{attrs:{label:"历史调度列表",name:"2"}},[a("hisTask")],1)],1)],1)},o=[],s=a("5f21"),l=a("0139"),n={components:{processTask:s["default"],hisTask:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},b894:function(e,t,a){},ba013:function(e,t,a){"use strict";a("69e5")},bb0a:function(e,t,a){"use strict";a("d053")},bb10:function(e,t,a){"use strict";a("062b")},bb26:function(e,t,a){"use strict";a("1e09")},bc1d:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampItemId,callback:function(t){e.$set(e.searchForm,"sampItemId",t)},expression:"searchForm.sampItemId"}})],1),a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"入库时间:"}},[a("el-date-picker",{staticStyle:{width:"165px"},attrs:{"value-format":"yyyy-MM-dd",placeholder:"入库时间"},model:{value:e.searchForm.storeDate,callback:function(t){e.$set(e.searchForm,"storeDate",t)},expression:"searchForm.storeDate"}})],1),a("el-form-item",{attrs:{label:"样品状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.sampStatus,callback:function(t){e.$set(e.searchForm,"sampStatus",t)},expression:"searchForm.sampStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleAddRecords}},[e._v("采样记录单导出")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无采样样品信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",fixed:"left",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"采样时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sampleType",label:"样品归类",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.sampleType?"danger":""}},[e._v("\n            "+e._s("1"===r.sampleType?"样品分包":"样品自检")+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.sampleStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.sampleStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"现场采样记录单下载",visible:e.downVisible,center:""},on:{"update:visible":function(t){e.downVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.recordForm,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请录入任务单号"},model:{value:e.recordForm.taskId,callback:function(t){e.$set(e.recordForm,"taskId",t)},expression:"recordForm.taskId"}})],1),a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测对象"},on:{change:e.findSecClass},model:{value:e.recordForm.classId,callback:function(t){e.$set(e.recordForm,"classId",t)},expression:"recordForm.classId"}},e._l(e.classArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测类别"},model:{value:e.recordForm.secClassId,callback:function(t){e.$set(e.recordForm,"secClassId",t)},expression:"recordForm.secClassId"}},e._l(e.secClassArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"采样现场记录时间:"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"采样现场记录时间","value-format":"yyyy-MM-dd"},model:{value:e.recordForm.sampleDate,callback:function(t){e.$set(e.recordForm,"sampleDate",t)},expression:"recordForm.sampleDate"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.downVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDownload}},[e._v("确认")])],1)])],1)},o=[],s=a("47bc"),l=a("d43b"),n=a("b705"),i=a("333d"),c={6:"已入库",7:"部分出库",8:"已出库"},d={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){var t={6:"",7:"",8:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:c,sampleData:[],searchForm:{sampItemId:"",jobId:"",sampStatus:"",storeDate:"",pageNumber:1,pageSize:10},total:0,currentSample:"",sampleForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},sampleImage:"",sampleVisible:!1,sampleImageList:[],downVisible:!1,recordForm:{taskId:"",classId:"",secClassId:"",sampleDate:""},classArray:[],secClassArray:[],sampleDetails:[],sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.getClassList(),this.handleSearch()},methods:{handleSearch:function(){var e=this;s["n"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},getClassList:function(){var e=this;n["a"]().then((function(t){e.classArray=t.result||[]}))},findSecClass:function(e){var t=this;this.recordForm.secClassId="",n["d"](e).then((function(e){t.secClassArray=e.result||[]}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";l["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleAddRecords:function(){this.recordForm.taskId="",this.recordForm.classId="",this.recordForm.secClassId="",this.recordForm.sampleDate="",this.downVisible=!0},confirmDownload:function(){if(this.recordForm.taskId&&this.recordForm.secClassId&&this.recordForm.sampleDate){var e="/api/word/downSampleRecordByTaskId?taskId="+this.recordForm.taskId+"&secdClassId="+this.recordForm.secClassId+"&sampleDate="+this.recordForm.sampleDate;window.open(e),this.downVisible=!1}else this.$message.warning("任务单号和检测类别不能为空")}}},u=d,p=(a("bb10"),a("0bf7"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"6f24b420",null);t["default"]=m.exports},bc7b:function(e,t,a){},be5e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"合同编号:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"合同编号"},model:{value:e.searchForm.contCode,callback:function(t){e.$set(e.searchForm,"contCode",t)},expression:"searchForm.contCode"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.contName,callback:function(t){e.$set(e.searchForm,"contName",t)},expression:"searchForm.contName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.contractData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无合同信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"contCode",label:"合同编号",width:"190px",align:"center"}}),a("el-table-column",{attrs:{prop:"offerId",label:"报价单号",width:"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"judgeOrganName",label:"分包机构名称","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"signDate",label:"签订时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.signDate&&r.signDate.length?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDwonload(r)}}},[e._v(" 下载")]):e._e(),r.signDate&&r.signDate.length>0?a("div",{staticClass:"erc-divider-vertical"}):e._e(),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleUpload(r)}}},[e._v("合同上传")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"合同信息上传",visible:e.contractVisible,top:"5vh"},on:{"update:visible":function(t){e.contractVisible=t}}},[a("el-form",{attrs:{model:e.contarctUploadForm,"label-width":"110px"}},[a("el-form-item",{attrs:{prop:"signDate",label:"签订时间:"}},[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"签订日期"},model:{value:e.contarctUploadForm.signDate,callback:function(t){e.$set(e.contarctUploadForm,"signDate",t)},expression:"contarctUploadForm.signDate"}})],1),a("el-form-item",{attrs:{label:"有效期(年):"}},[a("el-input-number",{staticStyle:{width:"260px"},attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.contarctUploadForm.validity,callback:function(t){e.$set(e.contarctUploadForm,"validity",t)},expression:"contarctUploadForm.validity"}})],1),a("el-form-item",{attrs:{label:"合同附件上传:"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",data:{id:e.contarctUploadForm.contId,signDate:e.contarctUploadForm.signDate,validity:e.contarctUploadForm.validity},action:"/api/cont/uploadSubContFile","on-change":e.onUploadChange,"on-exceed":e.onExceed,"on-remove":e.onUploadRemove,accept:".doc,.docx,.pdf","auto-upload":!1,limit:1,"file-list":e.fileList}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("\n            将文件拖到此处，或\n            "),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"}),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("注:您只能上传.doc,.docx,.pdf格式的文件")])])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.contractVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1)],1)},o=[],s=(a("ac6a"),a("456d"),a("35ad")),l=a("f6b0"),n=a("333d"),i={0:"待完善",1:"待审核",2:"审核失败",3:"待制作",4:"已制作",5:"已作废"},c={components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"2"===e?"":"3"===e||"1"===e?"info":"4"===e?"success":"danger"}},data:function(){return{CONTRACT_STATUS:i,contractData:[],searchForm:{contCode:"",contName:"",contStatus:"",pageNumber:1,pageSize:10},total:0,contractVisible:!1,contractForm:{contId:"",contractInfoTdo:{signDate:"",signLocation:"",payMethod:"0",payMethodDesc:"",validity:""},cusContBaseInfoId:"",addTdo:{companyName:"",address:"",postCode:"",jurPerson:"",agentPerson:"",telFax:"",bankName:"",bankNo:"",taxNumber:""}},contractStatus:"create",contractRules:{contractInfoTdo:{validity:[{required:!0,message:"请录入有效期",trigger:"blur"}],signDate:[{required:!0,message:"请录入签订日期",trigger:"blur"}],signLocation:[{required:!0,message:"请录入地址",trigger:"blur"}],payMethod:[{required:!0,message:"请选择支付方式",trigger:"blur"}],payMethodDesc:[{required:!0,message:"请录支付说明",trigger:"blur"}]},addTdo:{companyName:[{required:!0,message:"请录入客户名称",trigger:"blur"}],address:[{required:!0,message:"请录入单位地址",trigger:"blur"}],postCode:[{required:!0,message:"请录入电话/传真",trigger:"blur"}],jurPerson:[{required:!0,message:"请录入邮政编码",trigger:"blur"}],agentPerson:[{required:!0,message:"请录入法定代表人",trigger:"blur"}],telFax:[{required:!0,message:"请录入委托代理人",trigger:"blur"}],bankName:[{required:!0,message:"请录入开户银行",trigger:"blur"}],bankNo:[{required:!0,message:"请录入银行账号",trigger:"blur"}],taxNumber:[{required:!0,message:"请录入税号",trigger:"blur"}]}},restaurants:[],contarctUploadForm:{contId:"",contFileId:"",signDate:"",validity:1},fileList:[],activeName:"maker",companyMap:{},approveVisible:!1,currentItem:{},approveForm:{contId:"",auditFlag:"1",auditReason:""}}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["i"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.contractData=t.result.records||[],e.total=t.result.total)}))},querySearchAsync:function(e,t){var a=this,r=this.restaurants;e?l["d"](e).then((function(e){e.result?(a.companyMap=e.result||{},t(Object.keys(e.result))):t([])})).catch((function(){t([])})):t(r)},confirmDialog:function(){this.contarctUploadForm.signDate?(this.$refs.upload.submit(),setTimeout((function(){this.handleSearch()}),1500)):this.$message.warning("完成日期不能为空")},handleDetail:function(e){""!==e.contFileId||"--"!==e.contFileId?this.$router.push({name:"sysPdfView",params:{path:e.contFileId,type:1}}):this.$message.error("合同文件还未上传")},onUploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.contarctUploadForm.contFileId=e.response.result,this.$message({type:"success",message:"上传成功!"}),this.contractVisible=!1):this.$message.error("上传失败!")}else this.$message.error("上传失败!")},onExceed:function(){this.$message.error("最多上传一个文件")},onUploadRemove:function(){this.contarctUploadForm.contFileId=""},handleDwonload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/ht/upload/"+e.contFileId;window.open(t)},handleUpload:function(e){this.contarctUploadForm.contId=e.id,this.contractVisible=!0},confirmApproveDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},d=c,u=(a("1328"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"69d30fec",null);t["default"]=p.exports},bea9:function(e,t,a){},bf5b:function(e,t,a){},bf8d:function(e,t,a){},bfb3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"任务状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.sampTaskStatus,callback:function(t){e.$set(e.searchForm,"sampTaskStatus",t)},expression:"searchForm.sampTaskStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"taskSn",label:"项目进度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.taskSn)+"/"+e._s(a.taskCount)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"采样组长",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.sampLeader&&a.sampLeader?a.sampLeader.toString():"")+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.sampTaskStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.sampTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{label:"采样进度",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.completeSampCount)+"/"+e._s(a.sampCount)+"\n        ")]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleSampleInfo(t.row)}}},[e._v(" 查看样品")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handlePrint(t.row)}}},[e._v(" 标签打印")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.taskTitle+" 任务详情",visible:e.taskVisible,center:"",width:"70%",top:"5vh"},on:{"update:visible":function(t){e.taskVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("合同编号: "+e._s(e.taskForm.contCode))])]),a("el-col",{attrs:{span:12}},[a("span",[e._v("报价单号: "+e._s(e.taskForm.offerId))])])],1),a("table",{staticClass:"info-table-new",attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("项目名称:")]),a("td",[e._v(e._s(e.taskForm.projectName))]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托单位:")]),a("td",[e._v(e._s(e.taskForm.consignorName))])]),a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人:")]),a("td",[e._v(e._s(e.taskForm.consignorLinker)+" ")]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人方式:")]),a("td",[e._v(e._s(e.taskForm.consignorLinkerPhone))])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},[e._v("\n          工作要求:\n        ")])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},e._l(e.factorData,(function(t,r){return a("el-row",{key:r},[a("el-col",{attrs:{span:24}},[e._v(e._s(t.secdClassName))]),e._l(t.factList,(function(t){return a("el-col",{key:t.id,attrs:{span:24}},[e._v("\n              "+e._s(t.factorPoint+"（"+t.dayCount+"*"+t.frequency+"）: ")+e._s(t.showFactName)+" "),"1"===t.fbFlag?a("span",{staticStyle:{color:"red"}},[e._v("(分包)")]):e._e()])}))],2)})),1)])])],1)],1)},o=[],s=(a("7514"),a("ac6a"),a("5df3"),a("f400"),a("3b2b"),a("47bc")),l=a("b705"),n=a("333d"),i={2:"采样中",3:"已完成"},c={components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){var t={1:"",2:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:i,sampleData:[],searchForm:{jobId:"",projectName:"",sampTaskStatus:"",pageNumber:1,pageSize:10},total:0,taskTitle:"",taskVisible:!1,factorData:[],factorDetailData:[],factorOldDetailData:[],factorOutDetailData:[],factorOldOutDetailData:[],taskForm:{projectName:"",offerId:"",contCode:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:""},sampleTaskVisible:!1,currentRow:{},multipleSelection:[],multipleOutSelection:[],perGroups:[],mergeData:[],mergeOutData:[],currentSelectionRow:{secdClassId:"",factorPoint:"",frequency:"",dayCount:""},currentOutSelectionRow:{secdClassId:"",factorPoint:"",frequency:"",dayCount:""},showFactorName:"",showOutFactorName:""}},computed:{filterData:function(){if(this.showFactorName&&this.showFactorName.length>0){var e=new RegExp(this.showFactorName.trim());return this.factorDetailData.filter((function(t){return e.test(t.factorName)}))}return this.factorDetailData},outFilterData:function(){if(this.showOutFactorName&&this.showOutFactorName.length>0){var e=new RegExp(this.showOutFactorName.trim());return this.factorOutDetailData.filter((function(t){return e.test(t.factorName)}))}return this.factorOutDetailData}},created:function(){this.getFactorPeople(),this.handleSearch()},methods:{getFactorPeople:function(){var e=this;l["c"]().then((function(t){e.perGroups=t.result||[]}))},handleSearch:function(){var e=this;s["s"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.taskTitle=e.projectName,this.taskForm=Object.assign({},e),s["w"](e.jobId).then((function(e){200===e.code&&e.result&&(t.factorData=t.doProcessData(e.result),t.taskVisible=!0)}))},handleSampleInfo:function(e){this.$router.push("/sampleAllList/".concat(e.sampTaskId))},doProcessData:function(e){var t=this,a=[];if(e.length>0){var r=new Map;e.forEach((function(e){var t=a.find((function(t){return t.secdClassName===e.secdClassName&&t.fbFlag===e.fbFlag}));if(t||a.push({secdClassName:e.secdClassName,fbFlag:e.fbFlag,factList:[]}),r.get(e.secdClassName+"-"+e.fbFlag)){var o=r.get(e.secdClassName+"-"+e.fbFlag);o.push(e)}else{var s=[];s.push(e),r.set(e.secdClassName+"-"+e.fbFlag,s)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName+"-"+e.fbFlag),o=[];a&&(a.forEach((function(a){var r=o.find((function(e){return e.factorPoint===a.factorPoint&&e.frequency===a.frequency&&e.dayCount===a.dayCount?(e.showFactName=e.showFactName+","+a.factorName,e):null}));r||(t.$set(a,"showFactName",a.factorName),t.$set(a,"fbFlag",e.fbFlag),o.push(a))})),e.factList=o)}))}return a},clearSelectionRow:function(){this.currentSelectionRow={secdClassId:"",factorPoint:"",frequency:"",dayCount:""}},clearOutSelectionRow:function(){this.currentOutSelectionRow={secdClassId:"",factorPoint:"",frequency:"",dayCount:""}},handlePrint:function(e){this.$router.push("/sampleDetail/".concat(e.sampTaskId))}}},d=c,u=(a("0def"),a("1335"),a("df1a"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"580b8cde",null);t["default"]=p.exports},c0c7:function(e,t,a){"use strict";a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return n})),a.d(t,"i",(function(){return i})),a.d(t,"h",(function(){return c})),a.d(t,"j",(function(){return d})),a.d(t,"e",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"c",(function(){return m}));var r=a("b775"),o=a("c38a");function s(e){return Object(r["a"])({url:"/sys/user/getByCondition",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/sys/user/findUserByUserId/"+Object(o["e"])(e),method:"get"})}function n(e){return Object(r["a"])({url:"/sys/user/save",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/sys/user/modifyUserById",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/sys/user/resetOriganPassword/"+e,method:"get"})}function d(e){return Object(r["a"])({headers:{"Content-Type":"application/x-www-form-urlencoded"},url:"/sys/user/uploadAvatarPath",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/sys/user/invalidUserByUserId/"+e,method:"get"})}function p(e){return Object(r["a"])({url:"/sys/user/enableUserByUserId/"+e,method:"get"})}function m(e){return Object(r["a"])({url:"/sys/user/editUserById",method:"post",data:e})}},c2bd:function(e,t,a){},c2c3:function(e,t,a){},c2f9:function(e,t,a){"use strict";a("959f")},c376:function(e,t,a){},c4ba:function(e,t,a){"use strict";a("7aff")},c527:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"角色名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"角色名称"},model:{value:e.searchForm.roleName,callback:function(t){e.$set(e.searchForm,"roleName",t)},expression:"searchForm.roleName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.roleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无角色,\n            ")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"small"},on:{click:e.handleCreate}},[e._v("新建用户角色")])],1)])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"roleName",label:"角色名称",align:"center"}}),a("el-table-column",{attrs:{prop:"platformPositionName",label:"平台岗位",align:"center"}}),a("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleRelation(t.row)}}},[e._v("关联菜单")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.roleId)}}},[e._v("删除")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.roleDialogStatus],visible:e.roleDialogVisible,width:"50%"},on:{"update:visible":function(t){e.roleDialogVisible=t}}},[a("div",{staticStyle:{width:"550px",margin:"0 auto"}},[a("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.roleRules,"label-width":"130px"}},[a("el-form-item",{attrs:{prop:"roleName",label:"岗位:"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"岗位",maxlength:"8","show-word-limit":""},model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1),a("el-form-item",{attrs:{prop:"platformPositionId",label:"角色:"}},[a("el-select",{staticStyle:{width:"70%"},attrs:{placeholder:"角色"},model:{value:e.roleForm.platformPositionId,callback:function(t){e.$set(e.roleForm,"platformPositionId",t)},expression:"roleForm.platformPositionId"}},e._l(Object.keys(e.positionArray),(function(t){return a("el-option",{key:t,attrs:{label:e.positionArray[t],value:t}})})),1)],1),a("el-form-item",{attrs:{prop:"roleDesc",label:"岗位描述:"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{type:"textarea",rows:2,maxlength:"50","show-word-limit":"",placeholder:"岗位描述"},model:{value:e.roleForm.roleDesc,callback:function(t){e.$set(e.roleForm,"roleDesc",t)},expression:"roleForm.roleDesc"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.roleDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"分配菜单权限",visible:e.permissionsVisible},on:{"update:visible":function(t){e.permissionsVisible=t}}},[a("el-tree",{ref:"tree",attrs:{"check-strictly":e.checkStrictly,data:e.routesData,props:e.defaultProps,"show-checkbox":"","node-key":"path"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.permissionsVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmPermissions}},[e._v("保存")])],1)],1)],1)},o=[],s=(a("6762"),a("2fdb"),a("75fc")),l=(a("ac6a"),a("db72")),n=a("2d63"),i=a("cc5e"),c=a("333d"),d=a("b705"),u=a("a18c"),p=a("df7c"),m=a.n(p),h={name:"UserList",components:{Pagination:c["a"]},data:function(){return{roleData:[],searchForm:{roleName:"",pageNumber:1,pageSize:10},total:0,titleMap:{edit:"修改角色",create:"新增角色"},roleForm:{roleId:"",roleName:"",platformPositionId:"",roleDesc:""},roleRules:{roleName:[{required:!0,message:"请录入角色名称",trigger:"blur"}],platformPositionId:[{required:!0,message:"请关联岗位",trigger:"change"}]},roleDialogStatus:"create",roleDialogVisible:!1,permissionsVisible:!1,checkStrictly:!1,routes:[],defaultProps:{children:"children",label:"title"},currentItem:{},positionArray:[]}},computed:{routesData:function(){return this.routes}},created:function(){this.getDicKey("positionArray",1003),this.handleSearch(),this.getRoutes()},methods:{getDicKey:function(e,t){var a=this;Object(d["g"])(t).then((function(t){200===t.code&&(a[e]=t.result)}))},getRoutes:function(){var e=u["a"];this.routes=this.generateRoutes(e)},handleSearch:function(){var e=this;i["e"](this.searchForm).then((function(t){200===t.code&&(e.roleData=t.result.records||[],e.total=t.result.total)}))},handleCreate:function(){this.clearForm(),this.roleDialogStatus="create",void 0!==this.$refs.roleForm&&this.$refs.roleForm.resetFields(),this.roleDialogVisible=!0},handleUpdate:function(e){void 0!==this.$refs.roleForm&&this.$refs.roleForm.resetFields(),this.roleForm.roleId=e.roleId,this.roleForm.roleName=e.roleName||"",this.roleForm.platformPositionId=e.platformPositionId||"",this.roleForm.roleDesc=e.roleDesc||"",this.roleDialogStatus="edit",this.roleDialogVisible=!0},confirmDialog:function(){"create"===this.roleDialogStatus?this.confirmCreate():this.confirmUpdate()},confirmCreate:function(){var e=this;this.$refs.roleForm.validate((function(t){if(!t)return!1;i["a"](e.roleForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.roleDialogVisible=!1,e.$refs.roleForm.resetFields()})).catch((function(){}))}))},confirmUpdate:function(){var e=this;this.$refs.roleForm.validate((function(t){if(!t)return!1;i["g"](e.roleForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.roleDialogVisible=!1,e.$refs.roleForm.resetFields()})).catch((function(){}))}))},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["b"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},clearForm:function(){this.roleForm={roleId:"",roleName:"",platformPositionId:"",roleDesc:""}},handleRelation:function(e){var t=this,a=e.roleId,r=e.roleName,o=e.rolesDesc;this.currentItem={roleId:a,roleName:r,rolesDesc:o},i["c"](a).then((function(e){if(200===e.code){var a=e.result||[];t.$nextTick((function(){t.$refs.tree.setCheckedKeys(a)}))}})),this.permissionsVisible=!0},resetChecked:function(){this.$refs.tree.setCheckedKeys([])},generateRoutes:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=[],o=Object(n["a"])(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(!s.hidden){var l=this.onlyOneShowingChild(s.children,s);s.children&&l&&!s.alwaysShow&&(s=l);var i={path:m.a.resolve(a,s.path),title:s.meta&&s.meta.title};s.children&&(i.children=this.generateRoutes(s.children,i.path)),r.push(i)}}}catch(c){o.e(c)}finally{o.f()}return r},onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=null,r=e.filter((function(e){return!e.hidden}));return 1===r.length?(a=r[0],a.path=m.a.resolve(t.path,a.path),a):0===r.length&&(a=Object(l["a"])(Object(l["a"])({},t),{},{path:"",noShowingChildren:!0}),a)},confirmPermissions:function(){var e=this,t=this.$refs.tree.getCheckedKeys(),a={roleId:this.currentItem.roleId,permUrls:t};i["f"](a).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.resetChecked(),e.permissionsVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})).catch((function(){}))},generateArr:function(e){var t=this,a=[];return e.forEach((function(e){if(a.push(e),e.children){var r=t.generateArr(e.children);r.length>0&&(a=[].concat(Object(s["a"])(a),Object(s["a"])(r)))}})),a},generateTree:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=arguments.length>2?arguments[2]:void 0,o=[],s=Object(n["a"])(e);try{for(s.s();!(t=s.n()).done;){var l=t.value,i=m.a.resolve(a,l.path);l.children&&(l.children=this.generateTree(l.children,i,r)),(r.includes(i)||l.children&&l.children.length>=1)&&o.push(l)}}catch(c){s.e(c)}finally{s.f()}return o}}},f=h,b=(a("911f"),a("2877")),g=Object(b["a"])(f,r,o,!1,null,"7c7d9a35",null);t["default"]=g.exports},c679:function(e,t,a){},c730:function(e,t,a){},c736:function(e,t,a){"use strict";a("76fb")},c7e0:function(e,t,a){},c7f0:function(e,t,a){"use strict";a("9fb4")},c82d:function(e,t,a){},ca83:function(e,t,a){"use strict";a("d08b")},ca94:function(e,t,a){},cad1:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{label:"单位名称:"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"单位名称"},model:{value:e.searchForm.companyName,callback:function(t){e.$set(e.searchForm,"companyName",t)},expression:"searchForm.companyName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:6}},[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-upload2"},on:{click:e.handleUpload}},[e._v("批量导入")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("导出")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.customerData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无客户,\n            ")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"small"},on:{click:e.handleCreate}},[e._v("新建客户")])],1)])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"companyName",label:"单位名称",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"jurPerson",label:"法定代表人",align:"center"}}),a("el-table-column",{attrs:{prop:"address",label:"通讯地址",align:"center"}}),a("el-table-column",{attrs:{prop:"agentPerson",label:"委托代理人",align:"center"}}),a("el-table-column",{attrs:{prop:"telFax",label:"电话/传真",align:"center"}}),a("el-table-column",{attrs:{prop:"bankName",label:"开户行",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"bankNo",label:"银行卡号",align:"center"}}),a("el-table-column",{attrs:{prop:"taxNumber",label:"识别号/信用代码","min-width":"100",align:"center"}}),a("el-table-column",{attrs:{prop:"createUserId",label:"创建人",width:"110px",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 修改")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v(" 删除")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.customerDialogStatus],visible:e.customerDialogVisible,width:"65%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.customerDialogVisible=t}}},[a("el-form",{ref:"customForm",attrs:{model:e.customForm,rules:e.customRules,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"companyName",label:"单位名称:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"单位名称",maxlength:"25"},model:{value:e.customForm.companyName,callback:function(t){e.$set(e.customForm,"companyName",t)},expression:"customForm.companyName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"address",label:"单位地址:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"单位地址",maxlength:"35"},model:{value:e.customForm.address,callback:function(t){e.$set(e.customForm,"address",t)},expression:"customForm.address"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"telFax",label:"电话/传真:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"电话/传真",maxlength:"15"},model:{value:e.customForm.telFax,callback:function(t){e.$set(e.customForm,"telFax",t)},expression:"customForm.telFax"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"postCode",label:"邮政编码:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"邮政编码",maxlength:"6"},model:{value:e.customForm.postCode,callback:function(t){e.$set(e.customForm,"postCode",t)},expression:"customForm.postCode"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"jurPerson",label:"法定代表人:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"法定代表人",maxlength:"40"},model:{value:e.customForm.jurPerson,callback:function(t){e.$set(e.customForm,"jurPerson",t)},expression:"customForm.jurPerson"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"agentPerson",label:"委托代理人:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"委托代理人",maxlength:"40"},model:{value:e.customForm.agentPerson,callback:function(t){e.$set(e.customForm,"agentPerson",t)},expression:"customForm.agentPerson"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"开户银行:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"开户银行",maxlength:"30"},model:{value:e.customForm.bankName,callback:function(t){e.$set(e.customForm,"bankName",t)},expression:"customForm.bankName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"银行账号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"银行账号",maxlength:"30"},model:{value:e.customForm.bankNo,callback:function(t){e.$set(e.customForm,"bankNo",t)},expression:"customForm.bankNo"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{label:"纳税人识别号/统一社会信用代码:","label-width":"230px"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"企业税号",maxlength:"20"},model:{value:e.customForm.taxNumber,callback:function(t){e.$set(e.customForm,"taxNumber",t)},expression:"customForm.taxNumber"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.customerDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)],1),a("el-dialog",{attrs:{title:"批量导入客户",visible:e.uploadVisible,"append-to-body":""},on:{"update:visible":function(t){e.uploadVisible=t}}},[a("div",{staticClass:"block"},[a("el-timeline",[a("el-timeline-item",{attrs:{size:"large"}},[a("span",{staticClass:"time-dot",attrs:{slot:"dot"},slot:"dot"},[e._v("\n            1\n          ")]),a("el-row",[a("el-col",{attrs:{span:24}},[e._v("\n              下载模板，批量填写客户信息\n            ")])],1),a("el-row",{staticStyle:{"padding-top":"10px"}},[a("el-col",{attrs:{span:24}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleDownloadTep()}}},[e._v("模板下载")])],1)],1)],1),a("el-timeline-item",{attrs:{size:"large"}},[a("span",{staticClass:"time-dot",attrs:{slot:"dot"},slot:"dot"},[e._v("\n            2\n          ")]),a("el-row",[a("el-col",{attrs:{span:24}},[e._v("\n              上传填写好的客户信息表格\n            ")])],1),a("el-row",{staticStyle:{"padding-top":"10px"}},[a("el-col",{attrs:{span:24}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{width:"300px"},attrs:{action:"/api/dataImport/uploadCustomer","on-change":e.customUploadChange,"file-list":e.excelFileList,accept:".xlsx,.xls",limit:1}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("您只能上传.xlsx,.xls格式的文件")])],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("span",{staticStyle:{color:"red","font-size":"13px"}},[e._v("备注：批量导入客户功能，只会将上传的客户信息列表内的客户新增到系统内，不对原有客户信息做任何替换或修改。")])])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.uploadVisible=!1}}},[e._v("关闭")])],1)])],1)},o=[],s=a("f6b0"),l=a("333d"),n=a("b705"),i={0:"有效",1:"无效"},c={name:"CustomerList",components:{Pagination:l["a"]},data:function(){return{ACCOUNT_STATUS:i,customerData:[],searchForm:{companyName:"",pageNumber:1,pageSize:10},total:0,titleMap:{edit:"修改客户",create:"新增客户"},customForm:{cusContBaseInfoId:"",companyName:"",address:"",postCode:"",jurPerson:"",agentPerson:"",telFax:"",bankName:"",bankNo:"",taxNumber:""},customRules:{companyName:[{required:!0,message:"请录入单位名称",trigger:"blur"}],address:[{required:!0,message:"请录入单位地址",trigger:"blur"}],postCode:[{required:!0,message:"请录入邮政编码",trigger:"blur"}],jurPerson:[{required:!0,message:"请录入法定代表人",trigger:"blur"}],agentPerson:[{required:!0,message:"请录入委托代理人",trigger:"blur"}],telFax:[{required:!0,message:"请录入电话/传真",trigger:"blur"}],bankName:[{required:!0,message:"请录入开户银行",trigger:"blur"}],bankNo:[{required:!0,message:"请录入银行账号",trigger:"blur"}],taxNumber:[{required:!0,message:"请录入企业税号",trigger:"blur"}]},customerDialogStatus:"create",customerDialogVisible:!1,departmentArray:[],customerActiveName:"1",factorData:[],factorForm:{checkCount:1,CountType:"",reportAmountRate:10,expediteAmountRate:0,laborAmount:"",tripAmount:"",taxAmountRate:6},factorRules:{},priceArray:[],innerPriceVisible:!1,addPriceForm:{selfName:"",amount:0},uploadVisible:!1,excelFileList:[],fileResult:""}},created:function(){this.handleSearch()},methods:{getDicKey:function(e,t){var a=this;Object(n["g"])(t).then((function(t){200===t.code&&(a[e]=t.result)}))},handleSearch:function(){var e=this;s["e"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.customerData=t.result.records||[],e.total=t.result.total)}))},handleCreate:function(){this.clearForm(),this.customerDialogStatus="create",this.customerDialogVisible=!0},handleUpdate:function(e){this.clearForm(),this.customForm=Object.assign({},e),this.customForm.cusContBaseInfoId=e.id,this.customerDialogStatus="edit",this.customerDialogVisible=!0},confirmDialog:function(){"create"===this.customerDialogStatus?this.confirmCreate():this.confirmUpdate()},confirmCreate:function(){var e=this;this.$refs.customForm.validate((function(t){if(!t)return!1;s["a"](e.customForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.customerDialogVisible=!1,e.$refs.customForm.resetFields()})).catch((function(){}))}))},confirmUpdate:function(){var e=this;this.$refs.customForm.validate((function(t){if(!t)return!1;s["f"](e.customForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.customerDialogVisible=!1,e.$refs.customForm.resetFields()})).catch((function(){}))}))},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["b"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},clearForm:function(){this.customForm={cusContBaseInfoId:"",companyName:"",address:"",postCode:"",jurPerson:"",agentPerson:"",telFax:"",bankName:"",bankNo:"",taxNumber:""}},handleDownloadTep:function(){var e=this.$store.getters.sysBaseUrl+"/api/dataImport/downloadCustomerExcel";window.open(e)},handleDownload:function(){var e=this.$store.getters.sysBaseUrl+"/api/dataImport/exportCustomer";window.open(e)},customUploadChange:function(e){if("ready"!==e.status)if("success"===e.status){var t=e.response||{};t&&200===t.code?(this.fileResult=e.response.result,this.$message({type:"success",message:e.response.message}),this.handleSearch(),this.uploadVisible=!1):(this.$message.error("上传失败!"),this.excelFileList=[])}else this.$message.error("上传失败!"),this.excelFileList=[]},handleUpload:function(){this.uploadVisible=!0,this.excelFileList=[],this.fileResult=""}}},d=c,u=(a("b300"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"71d77bc6",null);t["default"]=p.exports},cb01:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"commitCheckTime",label:"提交审核时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1):e._e(),r.reportStatus>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1):e._e()],1)],1)]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报告审核",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("db72"),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u=(a("4328"),{1:"未生成",2:"制作中",3:"待提交审批",4:"待审核",5:"待签发",6:"完成",7:"已驳回"}),p={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{REPORT_STATUS:u,searchForm:{jobId:"",projectName:"",reportStatus:"",pageNumber:1,pageSize:10},total:0,reportData:[],approveVisible:!1,approveForm:{id:"",auditFlag:"1",remark:""},issueVisible:!1,issueForm:{id:"",auditFlag:"1",remark:""},basicForm:{cmaNumber:"",cnasNumber:"",tel:"",fax:"",address:"",website:"",postCode:"",logoImageId:"",watermarkImageId:""},basicRules:{cmaNumber:[{required:!0,message:"请录入CMA证书号",trigger:"blur"}],cnasNumber:[{required:!0,message:"请录入CNAS证书号",trigger:"blur"}],tel:[{required:!0,message:"请录入电话",trigger:"blur"}],fax:[{required:!0,message:"请录入传真",trigger:"blur"}],postCode:[{required:!0,message:"请录入邮政编码",trigger:"blur"}],website:[{required:!0,message:"请录入网址",trigger:"blur"}],address:[{required:!0,message:"请录入详细地址",trigger:"blur"}],logoImageId:[{required:!0,message:"请上传企业Logo图片",trigger:"blur"}],watermarkImageId:[{required:!0,message:"请上传报告水印图片",trigger:"blur"}]},logoImageList:[],waterImageList:[],dialogImageUrl:"",basicVisible:!1,dialogVisible:!1,logoFileList:[],waterFileList:[],uploadVisible:!1,uploadForm:{id:"",reportCode:"",reportFile:""},uploadRules:{reportFile:[{required:!0,message:"请上传报告信息",trigger:"blur"}]},fileList:[],hideLogoUploadEdit:!1,hideUploadEdit:!1,downloadLoading:!1}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["b"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)},handleApprove:function(e){this.approveForm.id=e.id,this.approveForm.auditFlag="1",this.approveForm.remark="",this.approveVisible=!0},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["g"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.approveVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},m=p,h=(a("0375"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"5e06fad8",null);t["default"]=f.exports},cb3b:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampItemId,callback:function(t){e.$set(e.searchForm,"sampItemId",t)},expression:"searchForm.sampItemId"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleBatchApprove}},[e._v("批量审核")]),a("el-button",{attrs:{type:""},on:{click:e.goBack}},[e._v("返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center","min-width":"140px"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样人",width:"190px",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",width:"190px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"finishTime",label:"采样登记时间",width:"190px",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleApprove(t.row)}}},[e._v("审核")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:e.showTitle,visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:e.showTitle,visible:e.batchApproveVisible,center:""},on:{"update:visible":function(t){e.batchApproveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.batchApprove,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.batchApprove.auditFlag,callback:function(t){e.$set(e.batchApprove,"auditFlag",t)},expression:"batchApprove.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.batchApprove.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.batchApprove.auditReason,callback:function(t){e.$set(e.batchApprove,"auditReason",t)},expression:"batchApprove.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.batchApproveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.batchConfirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=(a("6b54"),a("47bc")),l=a("d43b"),n=a("333d"),i={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过"},c={name:"SampleApprove",components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},props:{sampTaskId:{type:String,default:""}},data:function(){return{ACCOUNT_STATUS:i,sampleData:[],searchForm:{jobId:"",sampItemId:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",approveForm:{sampItemId:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],showTitle:"",sampleDetails:[],multipleSelection:[],batchApproveVisible:!1,batchApprove:{sampItemId:"",auditFlag:"1",auditReason:""},sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.searchForm.sampTaskId=this.sampTaskId,this.handleSearch()},methods:{handleSearch:function(){var e=this;s["j"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";l["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleApprove:function(e){this.approveForm.sampItemId=e.sampItemId,this.approveForm.auditFlag="1",this.approveForm.auditReason="",this.showTitle="样品审核",this.approveVisible=!0},handleBatchApprove:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var e=this.multipleSelection.map((function(e){return e.sampItemId}));this.batchApprove.sampItemId=e.toString(),this.batchApprove.auditFlag="1",this.batchApprove.auditReason="",this.showTitle="样品审核",this.batchApproveVisible=!0}else this.$message.warning("至少选择一个任务进行审核")},handleSelectionChange:function(e){this.multipleSelection=e},batchConfirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["c"](e.batchApprove).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.batchApproveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["h"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},goBack:function(){this.$router.back()}}},d=c,u=(a("a73e"),a("4a53"),a("068f"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"3b4ae6cf",null);t["default"]=p.exports},cb8d:function(e,t,a){"use strict";a("945f")},cbc6:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticStyle:{"min-height":"600px"},attrs:{header:"机构信息维护",shadow:"never"}},[a("div",{staticStyle:{width:"98%",margin:"0 auto"}},[a("el-form",{ref:"contractForm",attrs:{model:e.contractForm,rules:e.contractRules,"label-width":"110px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"organName",label:"机构名称:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{disabled:e.isEdit,maxlength:"20",placeholder:"请录入机构名称"},model:{value:e.contractForm.organName,callback:function(t){e.$set(e.contractForm,"organName",t)},expression:"contractForm.organName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"jurPerson",label:"法定代表人:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"10",placeholder:"请录入法人"},model:{value:e.contractForm.jurPerson,callback:function(t){e.$set(e.contractForm,"jurPerson",t)},expression:"contractForm.jurPerson"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"address",label:"通讯地址:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"35",placeholder:"请录入通讯地址"},model:{value:e.contractForm.address,callback:function(t){e.$set(e.contractForm,"address",t)},expression:"contractForm.address"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"postCode",label:"邮政编码:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"6",placeholder:"请录入邮编"},model:{value:e.contractForm.postCode,callback:function(t){e.$set(e.contractForm,"postCode",t)},expression:"contractForm.postCode"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"agentPerson",label:"委托代理人:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"12",placeholder:"请录入委托代理人"},model:{value:e.contractForm.agentPerson,callback:function(t){e.$set(e.contractForm,"agentPerson",t)},expression:"contractForm.agentPerson"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"telFax",label:"电话/传真:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"15",placeholder:"请录入电话/传真"},model:{value:e.contractForm.telFax,callback:function(t){e.$set(e.contractForm,"telFax",t)},expression:"contractForm.telFax"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"bankName",label:"开户行:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"30",placeholder:"请录入开户行"},model:{value:e.contractForm.bankName,callback:function(t){e.$set(e.contractForm,"bankName",t)},expression:"contractForm.bankName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"bankNo",label:"银行账号:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"30",placeholder:"请录入银行卡号"},model:{value:e.contractForm.bankNo,callback:function(t){e.$set(e.contractForm,"bankNo",t)},expression:"contractForm.bankNo"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"taxNumber",label:"企业税号:"}},[a("el-input",{staticStyle:{width:"350pxpx"},attrs:{maxlength:"20",placeholder:"请录入税号"},model:{value:e.contractForm.taxNumber,callback:function(t){e.$set(e.contractForm,"taxNumber",t)},expression:"contractForm.taxNumber"}})],1)],1)],1),a("el-row",[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(" 保 存 ")])],1)],1)],1)],1)])],1)},o=[],s=a("b775");function l(e){return Object(s["a"])({url:"/owner/contract/addOwnerContBase",method:"post",data:e})}function n(e){return Object(s["a"])({url:"/owner/contract/modifyOwnerContBaseById",method:"post",data:e})}function i(e){return Object(s["a"])({url:"/owner/contract/findByOrganId/".concat(e),method:"get"})}var c={data:function(){return{contractForm:{id:"",organName:"",contControlId:"HT001",address:"",postCode:"",jurPerson:"",agentPerson:"",telFax:"",bankName:"",bankNo:"",taxNumber:""},isEdit:!1,contractRules:{organName:[{required:!0,message:"请录入机构名称",trigger:"blur"}],address:[{required:!0,message:"请录入机构地址",trigger:"blur"}],postCode:[{required:!0,message:"请录入邮政编号",trigger:"blur"}],jurPerson:[{required:!0,message:"请录入法人",trigger:"blur"}],agentPerson:[{required:!0,message:"请录入委托代理人",trigger:"blur"}],telFax:[{required:!0,message:"请录入电话/传真",trigger:"blur"}],bankName:[{required:!0,message:"请录入开户行",trigger:"blur"}],bankNo:[{required:!0,message:"请录入银行卡号",trigger:"blur"}],taxNumber:[{required:!0,message:"请录入企业税号",trigger:"blur"}]}}},created:function(){this.getOwnInfo()},methods:{getOwnInfo:function(){var e=this;this.$store.getters.organId&&i(this.$store.getters.organId).then((function(t){200===t.code&&t.result&&(e.contractForm=t.result,e.isEdit=!0)}))},confirm:function(){var e=this;this.$refs.contractForm.validate((function(t){t?(e.contractForm.contControlId="HT001",e.isEdit?n(e.contractForm).then((function(t){200===t.code?e.$notify({title:"成功",message:t.message,type:"success"}):e.$notify({title:"失败",message:t.message,type:"error"})})):l(e.contractForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.getOwnInfo()):e.$notify({title:"失败",message:t.message,type:"error"})}))):e.$message.error("请录入完整信息")}))}}},d=c,u=(a("49e6"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"2793f3ef",null);t["default"]=p.exports},cc5e:function(e,t,a){"use strict";a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return d}));var r=a("b775");function o(e){return Object(r["a"])({url:"/sys/role/getPageByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/sys/role/saveRole",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/sys/role/modifyRoleById",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/sys/role/saveRolePerms",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/sys/role/delByRoleId/".concat(e),method:"get"})}function c(e){return Object(r["a"])({url:"/sys/role/findPermsByRoleId/".concat(e),method:"get"})}function d(){return Object(r["a"])({url:"/sys/role/findRoleList",method:"get"})}},cc6c:function(e,t,a){e.exports=a.p+"static/img/401.089007e7.gif"},cc83:function(e,t,a){},cc8d:function(e,t,a){},d049:function(e,t,a){},d053:function(e,t,a){},d08b:function(e,t,a){},d1cb:function(e,t,a){},d1fd:function(e,t,a){},d23a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampItemId,callback:function(t){e.$set(e.searchForm,"sampItemId",t)},expression:"searchForm.sampItemId"}})],1),a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"样品状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.sampStatus,callback:function(t){e.$set(e.searchForm,"sampStatus",t)},expression:"searchForm.sampStatus"}},e._l(Object.keys(e.SAMPLE_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.SAMPLE_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无采样样品信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",fixed:"left",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"采样时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sampleType",label:"样品归类",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.sampleType?"danger":""}},[e._v("\n            "+e._s("1"===r.sampleType?"样品分包":"样品自检")+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"sampTaskStatus",label:"状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.sampleStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.sampleStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"现场采样记录单下载",visible:e.downVisible,center:""},on:{"update:visible":function(t){e.downVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.recordForm,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请录入任务单号"},model:{value:e.recordForm.taskId,callback:function(t){e.$set(e.recordForm,"taskId",t)},expression:"recordForm.taskId"}})],1),a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测对象"},on:{change:e.findSecClass},model:{value:e.recordForm.classId,callback:function(t){e.$set(e.recordForm,"classId",t)},expression:"recordForm.classId"}},e._l(e.classArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测类别"},model:{value:e.recordForm.secClassId,callback:function(t){e.$set(e.recordForm,"secClassId",t)},expression:"recordForm.secClassId"}},e._l(e.secClassArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"采样日期:"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"采样日期","value-format":"yyyy-MM-dd"},model:{value:e.recordForm.sampleDate,callback:function(t){e.$set(e.recordForm,"sampleDate",t)},expression:"recordForm.sampleDate"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.downVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDownload}},[e._v("确认")])],1)])],1)},o=[],s=a("47bc"),l=a("d43b"),n=a("b705"),i=a("333d"),c={0:"待采样",1:"已采样",2:"组长待审核",3:"负责人待审核",4:"审核通过",5:"审核失败",9:"入库处理中",10:"待复核"},d={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"5"===e?"":"9"===e?"danger":e<4?"warning":e<7?"success":"danger"}},data:function(){return{SAMPLE_STATUS:c,sampleData:[],searchForm:{sampItemId:"",jobId:"",sampStatus:"",pageNumber:1,pageSize:10},total:0,currentSample:"",sampleForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},sampleImage:"",sampleVisible:!1,sampleImageList:[],downVisible:!1,recordForm:{taskId:"",classId:"",secClassId:"",sampleDate:""},classArray:[],secClassArray:[],sampleDetails:[],sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.getClassList(),this.handleSearch()},methods:{handleSearch:function(){var e=this;s["r"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";l["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},getClassList:function(){var e=this;n["a"]().then((function(t){e.classArray=t.result||[]}))},findSecClass:function(e){var t=this;this.recordForm.secClassId="",n["d"](e).then((function(e){t.secClassArray=e.result||[]}))},handleAddRecords:function(){this.recordForm.taskId="",this.recordForm.classId="",this.recordForm.secClassId="",this.recordForm.sampleDate="",this.downVisible=!0},confirmDownload:function(){if(this.recordForm.taskId&&this.recordForm.secClassId&&this.recordForm.sampleDate){var e="/api/word/downSampleRecordByTaskId?taskId="+this.recordForm.taskId+"&secdClassId="+this.recordForm.secClassId+"&sampleDate="+this.recordForm.sampleDate;window.open(e)}else this.$message.warning("任务单号和检测类别不能为空")}}},u=d,p=(a("24be"),a("71e6"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"33ad65c6",null);t["default"]=m.exports},d300:function(e,t,a){},d425:function(e,t,a){"use strict";a("75ec")},d430:function(e,t,a){},d43b:function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"i",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"h",(function(){return n})),a.d(t,"f",(function(){return i})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return p}));var r=a("b775");function o(e){return Object(r["a"])({url:"/sample/findByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/sample/getSamplesBySampTaskId",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/sample/getSampleDataBySampItemId/".concat(e),method:"get"})}function n(e){return Object(r["a"])({url:"/sample/getSampleDetailBySampItemId/".concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"/sample/getSampStoreApplyList",method:"get",params:e})}function c(e){return Object(r["a"])({url:"/sample/getSampDrawApplyList",method:"get",params:e})}function d(e){return Object(r["a"])({url:"/sample/doStoreSample",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/sample/doDrawSample",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/sample/batchDoStoreSample",method:"post",data:e})}},d471:function(e,t,a){"use strict";a("c2c3")},d4a9:function(e,t,a){},d5fb:function(e,t,a){},d637:function(e,t,a){},d6aa:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待审核报告",name:"1"}},[a("approvelTask")],1),a("el-tab-pane",{attrs:{label:"已审核报告",name:"2"}},[a("hisApprovelTask")],1)],1)],1)},o=[],s=a("0ffe"),l=a("cb01"),n={components:{approvelTask:s["default"],hisApprovelTask:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},d758:function(e,t,a){"use strict";a("1381")},d8d0:function(e,t,a){},da72:function(e,t,a){"use strict";a("6ae7")},dc80:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"checkTime",label:"审核时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),e.checkPermission(["admin","sqqzi"])?a("div",{staticClass:"erc-divider-vertical"}):e._e(),e.checkPermission(["admin","sqqzi"])?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleIssue(r)}}},[e._v("签发")]):e._e(),a("div",{staticClass:"erc-divider-vertical"}),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1),a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1)],1)],1)]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报告签发确认",visible:e.issueVisible,center:""},on:{"update:visible":function(t){e.issueVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.issueForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.issueForm.auditFlag,callback:function(t){e.$set(e.issueForm,"auditFlag",t)},expression:"issueForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.issueForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.issueForm.auditReason,callback:function(t){e.$set(e.issueForm,"auditReason",t)},expression:"issueForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.issueVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmIssueDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("db72"),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{searchForm:{jobId:"",projectName:"",pageNumber:1,pageSize:10},total:0,reportData:[],issueVisible:!1,issueForm:{reportId:"",auditFlag:"1",remark:""}}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["d"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)},handleIssue:function(e){this.issueForm.reportId=e.reportId,this.issueForm.auditFlag="1",this.issueForm.remark="",this.issueVisible=!0},confirmIssueDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["i"](e.issueForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.issueVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},p=u,m=(a("f9c0"),a("2877")),h=Object(m["a"])(p,r,o,!1,null,"4f21ea72",null);t["default"]=h.exports},dd87:function(e,t,a){},dda9:function(e,t,a){"use strict";a("bea9")},df1a:function(e,t,a){"use strict";a("e8a9")},df9b:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampItemId,callback:function(t){e.$set(e.searchForm,"sampItemId",t)},expression:"searchForm.sampItemId"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{attrs:{type:""},on:{click:e.goBack}},[e._v("返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center","min-width":"140px"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样人",width:"190px",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",width:"190px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"finishTime",label:"采样登记时间",width:"190px",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},o=[],s=(a("6b54"),a("47bc")),l=a("d43b"),n=a("333d"),i={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过"},c={name:"SampleHisApprove",components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},props:{sampTaskId:{type:String,default:""}},data:function(){return{ACCOUNT_STATUS:i,sampleData:[],searchForm:{jobId:"",sampItemId:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",approveForm:{sampItemId:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],showTitle:"",sampleDetails:[],multipleSelection:[],batchApproveVisible:!1,batchApprove:{sampItemId:"",auditFlag:"1",auditReason:""},sampleDataInfo:[],sampleSecInfo:[]}},created:function(){this.searchForm.sampTaskId=this.sampTaskId,this.handleSearch()},methods:{handleSearch:function(){var e=this;s["m"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";l["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleBatchApprove:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var e=this.multipleSelection.map((function(e){return e.sampItemId}));this.batchApprove.sampItemId=e.toString(),this.batchApprove.auditFlag="1",this.batchApprove.auditReason="",this.showTitle="样品审核",this.batchApproveVisible=!0}else this.$message.warning("至少选择一个任务进行审核")},handleSelectionChange:function(e){this.multipleSelection=e},batchConfirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["c"](e.batchApprove).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.batchApproveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["h"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},goBack:function(){this.$router.back()}}},d=c,u=(a("44fb"),a("ba013"),a("68de"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"531a0d34",null);t["default"]=p.exports},e18b:function(e,t,a){"use strict";a("cc8d")},e1db:function(e,t,a){},e1e1:function(e,t,a){},e24a:function(e,t,a){"use strict";a.d(t,"i",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"j",(function(){return l})),a.d(t,"b",(function(){return n})),a.d(t,"g",(function(){return i})),a.d(t,"e",(function(){return c})),a.d(t,"d",(function(){return d})),a.d(t,"h",(function(){return u})),a.d(t,"f",(function(){return p})),a.d(t,"c",(function(){return m}));var r=a("b775");function o(e){return Object(r["a"])({url:"/judge/organ/findPageByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/judge/organ/addJudgeOrgan",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/judge/organ/modifyJudgeOrganById",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/judge/organ/delById/".concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"/judgeTask/findJudgeTaskForTecManagerByCondition",method:"get",params:e})}function c(){return Object(r["a"])({url:"/judgeTask/findAuditUser",method:"get"})}function d(e){return Object(r["a"])({url:"/judgeTask/doAuditTask",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/judgeTask/getJudgeRecordByJudgeTaskId/".concat(e),method:"get"})}function p(e){return Object(r["a"])({url:"/judgeTask/findJudgeTaskForDeptManagerByCondition",method:"get",params:e})}function m(e){return Object(r["a"])({url:"/judgeTask/doAuditRecord",method:"post",data:e})}},e25d:function(e,t,a){},e28f:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"分包机构名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"分包机构名称"},model:{value:e.searchForm.judgeOrganName,callback:function(t){e.$set(e.searchForm,"judgeOrganName",t)},expression:"searchForm.judgeOrganName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.mechanData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无分包机构信息\n            ")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"small"},on:{click:e.handleCreate}},[e._v("新建分包机构")])],1)])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"judgeOrganName",label:"机构名称","min-width":"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"legalPerson",label:"企业法人",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"judgeOrganLinker",label:"联系人",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"judgeOrganLinkerPhone",label:"联系人电话",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱",align:"center"}}),a("el-table-column",{attrs:{prop:"bankName",label:"开户行",align:"center"}}),a("el-table-column",{attrs:{prop:"bankNumber",label:"银行账号","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注","show-overflow-tooltip":"true",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v(" 删除")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.judgeDialogStatus],visible:e.judgeVisible,center:"",width:"65%",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.judgeVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{ref:"judgeForm",attrs:{model:e.judgeForm,rules:e.judgeRules,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"judgeOrganName",label:"机构名称:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"分包机构名称",maxlength:"30"},model:{value:e.judgeForm.judgeOrganName,callback:function(t){e.$set(e.judgeForm,"judgeOrganName",t)},expression:"judgeForm.judgeOrganName"}})],1),a("el-form-item",{attrs:{prop:"legalPerson",label:"企业法人:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"企业法人",maxlength:"15"},model:{value:e.judgeForm.legalPerson,callback:function(t){e.$set(e.judgeForm,"legalPerson",t)},expression:"judgeForm.legalPerson"}})],1),a("el-form-item",{attrs:{prop:"judgeOrganLinker",label:"联系人:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"联系人",maxlength:"15"},model:{value:e.judgeForm.judgeOrganLinker,callback:function(t){e.$set(e.judgeForm,"judgeOrganLinker",t)},expression:"judgeForm.judgeOrganLinker"}})],1),a("el-form-item",{attrs:{prop:"judgeOrganLinkerPhone",label:"联系人电话:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"联系人电话",maxlength:"15"},model:{value:e.judgeForm.judgeOrganLinkerPhone,callback:function(t){e.$set(e.judgeForm,"judgeOrganLinkerPhone",t)},expression:"judgeForm.judgeOrganLinkerPhone"}})],1),a("el-form-item",{attrs:{prop:"email",label:"邮箱:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{pattern:"[^@]*@[^@]*",type:"email",maxlength:"25",placeholder:"邮箱"},model:{value:e.judgeForm.email,callback:function(t){e.$set(e.judgeForm,"email",t)},expression:"judgeForm.email"}})],1),a("el-form-item",{attrs:{prop:"bankName",label:"开户行:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"开户行",maxlength:"30"},model:{value:e.judgeForm.bankName,callback:function(t){e.$set(e.judgeForm,"bankName",t)},expression:"judgeForm.bankName"}})],1),a("el-form-item",{attrs:{prop:"bankNumber",label:"银行账号:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"银行账号",maxlength:"30"},model:{value:e.judgeForm.bankNumber,callback:function(t){e.$set(e.judgeForm,"bankNumber",t)},expression:"judgeForm.bankNumber"}})],1),a("el-form-item",{attrs:{label:"备注:"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"备注"},model:{value:e.judgeForm.remark,callback:function(t){e.$set(e.judgeForm,"remark",t)},expression:"judgeForm.remark"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.judgeVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("e24a"),l=a("333d"),n={components:{Pagination:l["a"]},data:function(){return{mechanData:[],searchForm:{judgeOrganName:"",pageNumber:1,pageSize:10},titleMap:{edit:"修改分包机构信息",create:"新增分包机构信息"},total:0,judgeVisible:!1,judgeDialogStatus:"create",judgeForm:{organId:"",judgeOrganName:"",judgeOrganLinker:"",judgeOrganLinkerPhone:"",email:"",legalPerson:"",bankName:"",bankNumber:"",remark:""},judgeRules:{judgeOrganName:[{required:!0,message:"请录入机构名称",trigger:"blur"}],judgeOrganLinker:[{required:!0,message:"请录入机构联系人",trigger:"blur"}],judgeOrganLinkerPhone:[{required:!0,message:"请录入联系方式",trigger:"blur"}],email:[{required:!0,message:"请录入邮箱地址",trigger:"blur"}],legalPerson:[{required:!0,message:"请录入法人",trigger:"blur"}],bankName:[{required:!0,message:"请录入开户行",trigger:"blur"}],bankNumber:[{required:!0,message:"请录入银行账号",trigger:"blur"}]}}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["i"](this.searchForm).then((function(t){200===t.code&&(e.mechanData=t.result.records,e.total=t.result.total)}))},handleCreate:function(){this.clearForm(),this.judgeDialogStatus="create",this.judgeVisible=!0},handleUpdate:function(e){this.clearForm(),this.judgeDialogStatus="edit",this.judgeForm=Object.assign({},e),this.judgeVisible=!0},confirmDialog:function(){var e=this;this.$refs.judgeForm.validate((function(t){if(!t)return!1;"create"===e.judgeDialogStatus?s["a"](e.judgeForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.judgeVisible=!1,e.handleSearch(),e.$refs.judgeForm.resetFields()})).catch((function(){})):s["j"](e.judgeForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.judgeVisible=!1,e.handleSearch(),e.$refs.judgeForm.resetFields()})).catch((function(){}))}))},handleDelete:function(e){var t=this;this.$confirm("是否确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["b"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},clearForm:function(){this.judgeForm={organId:"",judgeOrganName:"",judgeOrganLinker:"",judgeOrganLinkerPhone:"",email:"",legalPerson:"",bankName:"",bankNumber:"",remark:""}}}},i=n,c=(a("5b60"),a("2877")),d=Object(c["a"])(i,r,o,!1,null,"462772e6",null);t["default"]=d.exports},e2e6:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:7}},[a("el-card",{staticClass:"card-left",attrs:{shadow:"never"}},[a("el-input",{attrs:{placeholder:"输入名称"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.positionTreeData,props:e.defaultProps,"highlight-current":"","default-expand-all":"","filter-node-method":e.filterNode,"expand-on-click-node":!1},on:{"node-click":e.onSelectDepart}})],1)],1),a("el-col",{attrs:{span:17}},[a("el-card",{staticClass:"card-right",attrs:{shadow:"never"}},[a("el-form",{attrs:{inline:!0}},[a("el-row",[a("el-col",{staticClass:"search-right",attrs:{span:24}},[e.currentPosId&&"-1001"!==e.currentPosId?a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]):e._e(),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.positionData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                    暂无岗位\n                  ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"positionName",label:"岗位名称",align:"center"}}),a("el-table-column",{attrs:{prop:"roleName",label:"关联角色",align:"center"}}),a("el-table-column",{attrs:{prop:"positionDesc",label:"岗位描述",align:"center"}}),a("el-table-column",{attrs:{prop:"parentName",label:"上级岗位",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",width:"170px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleRelation(t.row)}}},[e._v("关联角色")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("编辑")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],2)],1)],1)],1)],1),a("el-dialog",{attrs:{title:e.titleMap[e.positionDialogStatus],visible:e.positionVisible,center:""},on:{"update:visible":function(t){e.positionVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{ref:"positionForm",attrs:{model:e.positionForm,rules:e.positionRules,"label-width":"90px"}},[a("el-form-item",{attrs:{prop:"positionName",label:"部门名称:"}},[a("el-input",{attrs:{placeholder:"请录入部门名称"},model:{value:e.positionForm.positionName,callback:function(t){e.$set(e.positionForm,"positionName",t)},expression:"positionForm.positionName"}})],1),a("el-form-item",{attrs:{label:"部门描述:"}},[a("el-input",{attrs:{type:"textarea",rows:2,maxlength:"50","show-word-limit":"",placeholder:"请录入部门描述"},model:{value:e.positionForm.positionDesc,callback:function(t){e.$set(e.positionForm,"positionDesc",t)},expression:"positionForm.positionDesc"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.positionVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDepart}},[e._v("保存")])],1)]),a("el-dialog",{attrs:{title:"关联角色",visible:e.roleVisible,center:""},on:{"update:visible":function(t){e.roleVisible=t}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.posRelationForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色关联:"}},[a("el-select",{staticStyle:{width:"280px"},attrs:{clearable:"",multiple:"",placeholder:"请选择角色"},model:{value:e.posRelationForm.roleIds,callback:function(t){e.$set(e.posRelationForm,"roleIds",t)},expression:"posRelationForm.roleIds"}},e._l(e.roleRelations,(function(e,t){return a("el-option",{key:t,attrs:{value:e.roleId,label:e.roleName}})})),1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.roleVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmRelation}},[e._v("保存")])],1)])],1)},o=[],s=a("db72"),l=a("fe05"),n=a("cc5e"),i={name:"PositionList",data:function(){return{positionTreeData:[],defaultProps:{children:"children",label:"positionName",id:"id"},titleMap:{edit:"修改岗位",create:"新增岗位"},positionDialogStatus:"create",currentPosId:"",currentPosName:"",positionData:[],filterText:"",positionVisible:!1,positionForm:{parentPositionId:"",positionId:"",positionName:"",positionDesc:""},positionRules:{positionName:[{required:!0,message:"岗位名称",trigger:"blur"}]},currentTreeItem:{},positionName:"",currentNode:{},currentResolve:{},roleVisible:!1,posRelationForm:{positionId:"",roleIds:[]},roleRelations:[]}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},created:function(){this.findPositionTreeList(),this.getRoleList()},methods:{findPositionTreeList:function(){var e=this;this.positionTreeData=[],l["findPositionTreeList"]().then((function(t){var a=t.result||{};e.positionTreeData.push(a)}))},filterNode:function(e,t){return!e||-1!==t.positionName.indexOf(e)},getRoleList:function(){var e=this;n["d"]().then((function(t){e.roleRelations=t.result||[]}))},loadNode:function(e,t){var a=this;this.currentNode=e,this.currentResolve=t;var r=e.data;if(this.currentPosId=r.id,this.currentPosName=r.positionName,0===e.level)return t([{id:-1001,positionName:this.$store.getters.userInfo.organName||"当前机构",children:[]}]);this.currentPosId?(this.positionData=[],l["findSubPositionListByParentId"](this.currentPosId).then((function(e){200===e.code&&e.result?(a.positionData=e.result.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{parentName:a.currentPosName})}))||[],t(e.result)):t([])})).catch((function(){t([])}))):t([])},addNode:function(){this.currentNode.children=[],this.loadNode(this.currentNode,this.currentResolve)},onSelectDepart:function(e){var t=this;e.id!==this.currentPosId&&(this.currentPosId=e.id,this.currentPosName=e.positionName,this.$nextTick((function(){t.handleSearch()})))},confirmDepart:function(){var e=this;this.$refs.positionForm.validate((function(t){if(t)if("create"===e.positionDialogStatus){var a={parentPositionId:e.positionForm.parentPositionId,positionName:e.positionForm.positionName,positionDesc:e.positionForm.positionDesc};l["saveDeptPositions"](a).then((function(t){200===t.code&&(e.handleSearch(),e.findPositionTreeList(),e.positionVisible=!1)}))}else{var r={positionId:e.positionForm.positionId,positionName:e.positionForm.positionName,positionDesc:e.positionForm.positionDesc};l["updateDeptPositions"](r).then((function(t){200===t.code&&(e.handleSearch(),e.findPositionTreeList(),e.positionVisible=!1)}))}}))},handleSearch:function(){var e=this;this.positionData=[],l["findSubPositionListByParentId"](this.currentPosId).then((function(t){200===t.code&&t.result&&(e.positionData=t.result.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{parentName:e.currentPosName})}))||[])})).catch((function(){}))},handleCreate:function(){this.clearForm(),this.positionForm.parentPositionId=this.currentPosId,this.positionDialogStatus="create",this.positionVisible=!0},handleUpdate:function(e){this.clearForm(),this.positionForm.positionId=e.id,this.positionForm.positionName=e.positionName||"",this.positionForm.positionDesc=e.positionDesc||"",this.positionDialogStatus="edit",this.positionVisible=!0},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["delPositionById"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch(),t.findPositionTreeList()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleRelation:function(e){this.posRelationForm.positionId=e.id,this.posRelationForm.roleIds=e.roleIds,this.roleVisible=!0},confirmRelation:function(){var e=this;this.posRelationForm.roleIds&&this.posRelationForm.roleIds.length>0?l["savePositionRoles"](this.posRelationForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.roleVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})})):this.$message.error("角色选择不能为空")},clearForm:function(){this.positionForm={parentPositionId:"",positionId:"",positionName:"",positionDesc:""}}}},c=i,d=(a("2745"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"3700f7c0",null);t["default"]=u.exports},e2f7:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",{attrs:{label:"报价单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),a("el-form-item",{attrs:{label:"报价单状态:"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",filterable:"",placeholder:"报价单状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(Object.keys(e.ACCOUNT_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.ACCOUNT_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:add"],expression:"['order:list:add']"}],attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.orderData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无报价单,\n            ")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"mini"},on:{click:e.handleCreate}},[e._v("新建报价单")])],1)])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"报价单号",sortable:"",width:"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkType",label:"检测类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("0"===a.checkType?"委托检测":"样品送检")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"certificationType",label:"认证类型",width:"90px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s("1"===a.certificationType?"CMA":"CNAS")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"consignorName",label:"客户名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.status)}},[e._v("\n            "+e._s(e.ACCOUNT_STATUS[r.status])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"finishDate",label:"客户要求完成时间",width:"140",align:"center"}}),a("el-table-column",{attrs:{prop:"createUserId",label:"报价人",align:"center"}}),a("el-table-column",{attrs:{prop:"checkTaskCount",label:"任务数",align:"center"}}),a("el-table-column",{attrs:{prop:"checkCircle",label:"周期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(e.CHECK_STATUS[a.checkCircle])+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"draftAmount",label:"费用总计(元)",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v(" 查看")]),a("div",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],staticClass:"erc-divider-vertical"}),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],attrs:{type:"text"},on:{click:function(t){return e.handleCopy(r)}}},[e._v(" 复制")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-dropdown",{attrs:{size:"medium"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n              更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["0"===r.status||"2"===r.status?a("el-link",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],attrs:{underline:!1},on:{click:function(t){return e.handleUpdate(r)}}},[a("el-dropdown-item",[e._v("编辑")])],1):e._e(),"0"===r.status||"2"===r.status?a("el-link",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:update"],expression:"['order:list:update']"}],attrs:{underline:!1},on:{click:function(t){return e.handleApprovel(r.id)}}},[a("el-dropdown-item",[e._v("提交审核")])],1):e._e(),"0"===r.status||"2"===r.status||"4"===r.status?a("el-link",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["order:list:del"],expression:"['order:list:del']"}],attrs:{underline:!1},on:{click:function(t){return e.handleDelete(r.id)}}},[a("el-dropdown-item",[e._v("删除")])],1):e._e(),a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("下载")])],1),r.status>1?a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleApproveDetail(r)}}},[a("el-dropdown-item",[e._v("审核历史")])],1):e._e()],1)],1)]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.orderDialogStatus],visible:e.orderDialogVisible,"before-close":e.handleDialogClose,fullscreen:"",center:""},on:{"update:visible":function(t){e.orderDialogVisible=t}}},[a("el-form",{ref:"orderForm",attrs:{model:e.orderForm,rules:e.orderRules}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("项目基础信息"),a("i",{staticClass:"el-input__icon"})])]),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.projectName",label:"项目名称:","label-width":"100px"}},[a("el-input",{attrs:{placeholder:"项目名称",maxlength:"30","show-word-limit":""},model:{value:e.orderForm.offerInfoTdo.projectName,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"projectName",t)},expression:"orderForm.offerInfoTdo.projectName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.finishDate","label-width":"115px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                完成日期\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"客户要求的项目完成时间"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"完成日期"},model:{value:e.orderForm.offerInfoTdo.finishDate,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"finishDate",t)},expression:"orderForm.offerInfoTdo.finishDate"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.certificationType",label:"认证类型:","label-width":"100px"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"检测类型"},model:{value:e.orderForm.offerInfoTdo.certificationType,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"certificationType",t)},expression:"orderForm.offerInfoTdo.certificationType"}},[a("el-option",{attrs:{value:"1",label:"CMA"}}),a("el-option",{attrs:{value:"2",label:"CNAS"}})],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.consignorName",label:"委托单位:","label-width":"100px"}},[a("el-input",{attrs:{placeholder:"委托单位",maxlength:"25"},model:{value:e.orderForm.offerInfoTdo.consignorName,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"consignorName",t)},expression:"orderForm.offerInfoTdo.consignorName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.consignorLinker",label:"委托人:","label-width":"110px"}},[a("el-input",{attrs:{placeholder:"委托人",maxlength:"10"},model:{value:e.orderForm.offerInfoTdo.consignorLinker,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"consignorLinker",t)},expression:"orderForm.offerInfoTdo.consignorLinker"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"offerInfoTdo.consignorLinkerPhone",label:"联系电话:","label-width":"100px"}},[a("el-input",{attrs:{placeholder:"联系电话",maxlength:"15"},model:{value:e.orderForm.offerInfoTdo.consignorLinkerPhone,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"consignorLinkerPhone",t)},expression:"orderForm.offerInfoTdo.consignorLinkerPhone"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注:","label-width":"80px"}},[a("el-input",{attrs:{type:"textarea",rows:2,"show-word-limit":"",placeholder:"备注",maxlength:"50"},model:{value:e.orderForm.offerInfoTdo.remark,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"remark",t)},expression:"orderForm.offerInfoTdo.remark"}})],1)],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px","padding-bottom":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("检测因子信息"),a("i",{staticClass:"el-input__icon"})]),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.choseGroup}},[e._v("因子套餐")]),a("el-button",{staticStyle:{float:"right",margin:"4px 2px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.addFactor}},[e._v("添加因子")])],1),a("el-table",{attrs:{data:e.orderForm.factorTdos,stripe:"","highlight-current-row":"","show-summary":"","summary-method":e.getSummaries,"header-cell-style":{background:"#ECF3FC"},"max-height":"400px"}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n                  暂无因子\n                ")])])])]),a("el-table-column",{attrs:{prop:"factorPoint",label:"位置","min-width":"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{placeholder:"请录入位置"},model:{value:r.factorPoint,callback:function(t){e.$set(r,"factorPoint",t)},expression:"row.factorPoint"}})]}}])}),a("el-table-column",{attrs:{prop:"className",label:"对象",sortable:"",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"类别","min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.meanName&&r.meanName.length>0?[e._v("\n                "+e._s(r.secdClassName)),a("span",{staticStyle:{color:"red"}},[e._v(e._s("("+r.meanName+")"))])]:[e._v("\n                "+e._s(r.secdClassName)+"\n              ")]]}}])}),a("el-table-column",{attrs:{prop:"factorName",label:"因子",align:"center"}}),a("el-table-column",{attrs:{prop:"dayCount",label:"天数",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",disabled:"002001"===r.secdClassId||"002003"===r.secdClassId,min:1,step:1,precision:0,"controls-position":"right"},model:{value:r.dayCount,callback:function(t){e.$set(r,"dayCount",t)},expression:"row.dayCount"}})]}}])}),a("el-table-column",{attrs:{prop:"frequency",label:"频次(次/天)",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",disabled:"002001"===r.secdClassId||"002003"===r.secdClassId,min:1,step:1,max:"004001"===r.secdClassId?2:10,precision:0,"controls-position":"right"},model:{value:r.frequency,callback:function(t){e.$set(r,"frequency",t)},expression:"row.frequency"}})]}}])}),a("el-table-column",{attrs:{prop:"totalNum",label:"次数",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"单次费用",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"totalCost",label:"总计",width:"120px",align:"center"}}),a("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index,o=t.row;return[a("el-popover",{attrs:{placement:"left",width:"280",trigger:"click"}},[a("el-input",{attrs:{placeholder:"录入备注信息"},model:{value:o.remark,callback:function(t){e.$set(o,"remark",t)},expression:"row.remark"}}),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("备注")])],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){return e.handleRowDel(r,o)}}},[e._v("删除")])]}}])})],2),a("el-row",{staticStyle:{"margin-top":"15px"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"taskNum","label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                任务总数\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"400",trigger:"hover",content:"任务总数默认为“1”，表示该项目为单次任务；若是周期性项目，\n                  则需填写该项目的任务总数（例如，任务总数填写“12”，任务周期选择“年”，表示该任务要求一年内完成12次检测任务数，\n                  具体任务时间根据实际情况分配）注意：一份报价单中不可同时包含\n                  单次任务和周期任务，也不可包含不同周期的任务。"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input-number",{staticStyle:{width:"75%"},attrs:{"controls-position":"right",step:1,precision:0,min:1},model:{value:e.orderForm.offerInfoTdo.checkTaskCount,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"checkTaskCount",t)},expression:"orderForm.offerInfoTdo.checkTaskCount"}})],1)],1),e.orderForm.offerInfoTdo.checkTaskCount>1?a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("div",{attrs:{slot:"label"},slot:"label"},[e._v("任务周期:")]),a("el-select",{staticStyle:{width:"75%"},attrs:{placeholder:"周期选择"},model:{value:e.orderForm.offerInfoTdo.checkCircle,callback:function(t){e.$set(e.orderForm.offerInfoTdo,"checkCircle",t)},expression:"orderForm.offerInfoTdo.checkCircle"}},[a("el-option",{attrs:{value:"1",label:"周"}}),a("el-option",{attrs:{value:"2",label:"月"}}),a("el-option",{attrs:{value:"3",label:"季"}}),a("el-option",{attrs:{value:"4",label:"半年"}}),a("el-option",{attrs:{value:"5",label:"年"}})],1)],1)],1):e._e(),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"135px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                报告编制费(%)\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务报告编制费所占总检测费的比例"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input-number",{staticClass:"i-input",staticStyle:{width:"75%"},attrs:{"controls-position":"right",precision:0,min:0,max:100,placeholder:"报告编制费"},model:{value:e.orderForm.offerCostTdo.reportAmountRate,callback:function(t){e.$set(e.orderForm.offerCostTdo,"reportAmountRate",t)},expression:"orderForm.offerCostTdo.reportAmountRate"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                加急费(元)\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务加急费"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input-number",{staticStyle:{width:"75%"},attrs:{min:0,"controls-position":"right",precision:2,placeholder:"加急费"},model:{value:e.orderForm.offerCostTdo.expediteAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"expediteAmount",t)},expression:"orderForm.offerCostTdo.expediteAmount"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("采样费(元)\n                "),a("el-popover",{attrs:{slot:"suffix",placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务费用"},slot:"suffix"},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v(":")],1),a("el-input-number",{staticStyle:{width:"75%"},attrs:{min:0,"controls-position":"right",precision:2,placeholder:"采样费"},model:{value:e.orderForm.offerCostTdo.laborAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"laborAmount",t)},expression:"orderForm.offerCostTdo.laborAmount"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"135px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("差旅费(元)\n                "),a("el-popover",{attrs:{slot:"suffix",placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务费用"},slot:"suffix"},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v(":")],1),a("el-input-number",{staticStyle:{width:"75%"},attrs:{min:0,"controls-position":"right",precision:2,placeholder:"差旅费"},model:{value:e.orderForm.offerCostTdo.tripAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"tripAmount",t)},expression:"orderForm.offerCostTdo.tripAmount"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                税率(%)\n                "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"单次任务费用"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n                :\n              ")],1),a("el-input-number",{staticClass:"i-input",staticStyle:{width:"75%"},attrs:{"controls-position":"right",precision:0,min:0,max:100,placeholder:"税率"},model:{value:e.orderForm.offerCostTdo.taxAmountRate,callback:function(t){e.$set(e.orderForm.offerCostTdo,"taxAmountRate",t)},expression:"orderForm.offerCostTdo.taxAmountRate"}})],1)],1),e._l(e.orderForm.selfCostTdos,(function(t,r){return a("el-col",{key:r,attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("div",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.selfName)+":")]),a("el-input",{staticStyle:{width:"65%","margin-right":"3px"},attrs:{type:"number",min:"0",placeholder:"金额信息"},model:{value:t.amount,callback:function(a){e.$set(t,"amount",a)},expression:"item.amount"}}),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeDomain(t)}}},[e._v("删除")])],1)],1)})),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"110px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.showAddPrice}},[e._v("新增费用")])],1)],1)],2)],1),a("el-card",{staticStyle:{"margin-top":"10px","padding-bottom":"10px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("费用统计")])]),a("el-form",{attrs:{"label-width":"130px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"检测费合计:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.checkAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"报告编制费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.reportAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"报告加急费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.expediteAmount*e.orderForm.offerInfoTdo.checkTaskCount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"采样费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.laborAmount*e.orderForm.offerInfoTdo.checkTaskCount)))]),e._v(" 元\n              ")])],1)],1),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"差旅费:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.tripAmount*e.orderForm.offerInfoTdo.checkTaskCount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"税额:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.taxAmount)))]),e._v(" 元\n              ")])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"额外费用:"}},[a("span",[e._v(e._s(e._f("MoneyFormat")(e.otherPrice)))]),e._v(" 元\n              ")])],1)],1)],1),a("el-row",[a("el-col",{staticStyle:{"text-align":"right","line-heigh":"2em"},attrs:{span:24}},[a("div",{staticStyle:{position:"relative",display:"inline-flex","line-height":"2em"}},[a("span",{staticStyle:{"margin-right":"10px"}},[e._v("费用总计:")]),a("div",{staticStyle:{position:"relative",width:"100px",padding:"0 15px"}},[e._v(e._s(e._f("MoneyFormat")(e.orderForm.offerCostTdo.sysAmount)))]),e._v(" 元\n            ")])])],1),a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("span",{staticStyle:{"margin-right":"5px"}},[a("span",{staticStyle:{color:"red","padding-right":"4px","vertical-align":"sub"}},[e._v("*")]),e._v("优惠价:")]),a("el-input",{staticClass:"right-input",staticStyle:{width:"100px"},on:{input:e.validatoProInput},model:{value:e.orderForm.offerCostTdo.draftAmount,callback:function(t){e.$set(e.orderForm.offerCostTdo,"draftAmount",t)},expression:"orderForm.offerCostTdo.draftAmount"}}),e._v(" 元\n          ")],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.orderDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1),a("el-dialog",{attrs:{title:"额外费用",visible:e.innerPriceVisible,"append-to-body":"",width:"60%",top:"5vh"},on:{"update:visible":function(t){e.innerPriceVisible=t}}},[a("div",{staticStyle:{width:"450px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.addPriceForm,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"费用名目:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"费用名目"},model:{value:e.addPriceForm.selfName,callback:function(t){e.$set(e.addPriceForm,"selfName",t)},expression:"addPriceForm.selfName"}})],1),a("el-form-item",{attrs:{label:"金额(元):"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"金额"},model:{value:e.addPriceForm.amount,callback:function(t){e.$set(e.addPriceForm,"amount",t)},expression:"addPriceForm.amount"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.innerPriceVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmPrice}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"因子选择",visible:e.factorVisible,"append-to-body":"",width:"85%","close-on-click-modal":!1,top:"5vh"},on:{"update:visible":function(t){e.factorVisible=t}}},[a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"card-left",attrs:{shadow:"never"}},[a("div",[a("el-tree",{ref:"tree",staticClass:"filter-tree",staticStyle:{height:"100%"},attrs:{data:e.factorTreeData,props:e.defaultProps,"highlight-current":"","default-expand-all":"","expand-on-click-node":!0},on:{"node-click":e.handleTreeFactorSearch}})],1)])],1),a("el-col",{attrs:{span:18}},[a("el-container",[a("el-header",{attrs:{height:"45px"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入检测因子名称"},on:{change:e.handleFactorSearch},model:{value:e.factorForm.factorName,callback:function(t){e.$set(e.factorForm,"factorName",t)},expression:"factorForm.factorName"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.handleFactorSearch}},[e._v("查询")])],1),a("el-main",{staticClass:"main-body"},[a("el-table",{ref:"multipleTable",attrs:{data:e.showChoseData,stripe:"",border:"","max-height":"310px","header-cell-style":{background:"#ECF3FC"}},on:{select:e.handleSelectChange,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"className",label:"检测对象",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"MoneyFormat",label:"价格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                      "+e._s(e._f("MoneyFormat")(a.price))+" 元\n                    ")]}}])})],1)],1),a("el-footer",{attrs:{height:"45px"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.factTotal>0,expression:"factTotal>0"}],attrs:{total:e.factTotal,page:e.factorForm.pageNumber,limit:e.factorForm.pageSize},on:{"update:page":function(t){return e.$set(e.factorForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.factorForm,"pageSize",t)},pagination:e.handleFactorSearch}})],1)],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("已选因子")]),a("el-row",{staticStyle:{"min-height":"36px","line-height":"30px"}},[a("el-col",{attrs:{span:2}},[a("span",[e._v("已选中因子:")])]),a("el-col",{attrs:{span:22}},[e.choseFatcors&&e.choseFatcors.length>0?e._l(e.choseFatcors,(function(t){return a("el-tag",{key:t.id,staticStyle:{margin:"2px 3px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t)}}},[e._v("\n                "+e._s(t.factorName)+"\n              ")])})):[e._v("\n              无\n            ")]],2)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("因子配置")]),a("el-form",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},["002001"===e.currentNodeId?a("el-form-item",{attrs:{label:"均值类型:","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择均值类型"},on:{change:e.changeMeanType},model:{value:e.meanType,callback:function(t){e.meanType=t},expression:"meanType"}},[a("el-option",{attrs:{value:"0",label:"日均值"}}),a("el-option",{attrs:{value:"1",label:"时均值"}}),a("el-option",{attrs:{value:"2",label:"八小时均值"}})],1)],1):e._e()],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"天数:","label-width":"100px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.setDay,callback:function(t){e.setDay=t},expression:"setDay"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"频次(次/天):","label-width":"110px"}},[a("el-input-number",{attrs:{"controls-position":"right",max:e.maxTotal,min:1,step:1,precision:0},model:{value:e.frequency,callback:function(t){e.frequency=t},expression:"frequency"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.addressArray&&e.addressArray.length>0?"检测位置1:":"检测位置:","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:e.lookPosition,callback:function(t){e.lookPosition=t},expression:"lookPosition"}})],1)],1)],1),a("el-row",[e._l(e.addressArray,(function(t,r){return a("el-col",{key:t.key,attrs:{span:24}},[a("el-form-item",{attrs:{label:"检测位置"+(r+2)+":","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),"002001"!==e.currentNodeId&&"002003"!==e.currentNodeId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeAddDomain(t)}}},[e._v("删除")]):e._e()],1)],1)})),"002003"!==e.currentNodeId&&"002001"!==e.currentNodeId?a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addAddress}},[e._v("添加位置")])],1)],1):e._e()],2)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.factorVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChoseFactor}},[e._v("确认")])],1)])],1),a("el-dialog",{attrs:{title:"报价单("+e.orderDetailForm.offerId+")",visible:e.detailVisible,top:"5vh",width:"70%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"135px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户名称:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorName||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系人:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinker||""))])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系电话:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.consignorLinkerPhone||""))])],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户要求完成时间:"}},[e._v(e._s(e._f("Time2Format")(e.orderDetailForm.offerBaseVo.finishDate)))])],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.remark||""))])],1)],1)],1),a("el-divider",[e._v("因子列表")]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table-hover",attrs:{cellspacing:"1",cellpadding:"0  "}},[a("thead",[a("tr",[a("th",{attrs:{rowspan:"2"}},[e._v("序号")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测类别")]),a("th",{attrs:{colspan:"3"}},[e._v("检测项目")]),a("th",{attrs:{rowspan:"2"}},[e._v("频次(次/天)")]),a("th",{attrs:{rowspan:"2"}},[e._v("天数")]),a("th",{attrs:{rowspan:"2"}},[e._v("次数")]),a("th",{attrs:{rowspan:"2"}},[e._v("检测费(元)")]),a("th",{attrs:{rowspan:"2"}},[e._v("总计(元)")])]),a("tr",[a("th",[e._v("序号")]),a("th",[e._v("检测位置")]),a("th",[e._v("因子")])])]),a("tbody",e._l(e.orderDetailForm.factorTdos,(function(t,r){return a("tr",{key:r},[0==t.dateType?[0==t.frIndex?[a("td",{attrs:{rowspan:t.detailLength}},[e._v(e._s(t.id))]),a("td",{attrs:{rowspan:t.detailLength}},[e._v(e._s(t.secName))])]:e._e(),a("td",[e._v(e._s(t.sid))]),a("td",[e._v(e._s(t.factorPoint))]),a("td",[e._v(e._s(t.factorName)+e._s(t.meanName&&t.meanName.length>0?"("+t.meanName+")":""))]),a("td",[e._v(e._s(t.frequency))]),a("td",[e._v(e._s(t.dayCount))]),a("td",[e._v(e._s(Number(t.frequency*t.dayCount).toFixed(0)))]),a("td",[e._v(e._s(t.price))]),a("td",[e._v(e._s(e._f("MoneyFormat")(t.totalCost)))])]:[a("td",{attrs:{colspan:"7"}},[e._v("小计")]),a("td",[e._v(e._s(t.totalPrice))])]],2)})),0),a("tfoot",[a("tr",[a("td",{attrs:{colspan:"9"}},[e._v(e._s(e.orderDetailForm.offerBaseVo.checkTaskCount>1?"单次检测费合计":"检测费合计"))]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.oncePrice)))])]),e.orderDetailForm.offerBaseVo.checkTaskCount>1?a("tr",[a("td",{attrs:{colspan:"3"}},[e._v("检测任务总数")]),a("td",[e._v(e._s(e.orderDetailForm.offerBaseVo.checkTaskCount))]),a("td",{attrs:{colspan:"3"}},[e._v("任务周期")]),a("td",{attrs:{colspan:"3"}},[e._v(e._s(e.CHECK_STATUS[e.orderDetailForm.offerBaseVo.checkCircle]))])]):e._e(),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("检测费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.checkAmount)))])]),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("报告编制费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.reportAmount)))])]),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("报告加急费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.expediteAmount)))])]),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("采样费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.laborAmount)))])]),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("差旅费")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.tripAmount)))])]),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("税额")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.taxAmount)))])]),e.orderDetailForm.selfCostVos?e._l(e.orderDetailForm.selfCostVos,(function(t,r){return a("tr",{key:r},[a("td",{attrs:{colspan:"9"}},[e._v(e._s(t.selfName))]),a("td",[e._v(e._s(e._f("MoneyFormat")(t.amount)))])])})):e._e(),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("总计")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.sysAmount)))])]),a("tr",[a("td",{attrs:{colspan:"9"}},[e._v("优惠价")]),a("td",[e._v(e._s(e._f("MoneyFormat")(e.orderDetailForm.costVo.draftAmount)))])]),a("tr",[a("td",{attrs:{colspan:"2"}},[e._v("大写：")]),a("td",{attrs:{colspan:"8"}},[e._v(e._s(e._f("Money2Chinese")(e.orderDetailForm.costVo.draftAmount)))])])],2)])])],1),a("el-dialog",{attrs:{title:"审核历史",visible:e.approveVisible,width:"75%"},on:{"update:visible":function(t){e.approveVisible=t}}},[a("el-table",{attrs:{data:e.approveDetails,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"0"===r.isPass?"success":"danger"}},[e._v(e._s("0"===r.isPass?"审核通过":"审核不通过"))])]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"审核说明",align:"center"}}),a("el-table-column",{attrs:{prop:"approvalUserName",label:"审批用户",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"审批时间",align:"center"}})],1)],1),a("el-dialog",{attrs:{title:"因子套餐",visible:e.factorGroupVisible,"append-to-body":"","close-on-click-modal":!1,width:"85%"},on:{"update:visible":function(t){e.factorGroupVisible=t}}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-card",{staticStyle:{height:"400px","overflow-y":"auto"},attrs:{shadow:"never"}},e._l(e.factorGroupData,(function(t,r){return a("div",{key:r,staticClass:"text dialog-item",on:{click:function(a){return e.choseItem(t)}}},[e._v("\n            "+e._s(t.groupName)+"\n          ")])})),0)],1),a("el-col",{attrs:{span:4}},[a("el-card",{staticStyle:{height:"400px"},attrs:{shadow:"never"}},[a("el-tree",{ref:"tree",attrs:{data:e.treeData,"default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps},on:{"node-click":e.changeTreeItem}})],1)],1),a("el-col",{attrs:{span:16}},[a("el-table",{ref:"groupMultipleTable",attrs:{data:e.factorList,border:"",height:"400px","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleGroupSelectionChange,select:e.groupSelect}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测对象",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"价格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(e._f("MoneyFormat")(a.price))+" 元\n            ")]}}])})],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("已选因子")]),a("el-row",{staticStyle:{"min-height":"36px","line-height":"30px"}},[a("el-col",{attrs:{span:2}},[a("span",[e._v("已选中因子:")])]),a("el-col",{attrs:{span:22}},[e.choseGroupFatcors&&e.choseGroupFatcors.length>0?e._l(e.choseGroupFatcors,(function(t){return a("el-tag",{key:t.id,staticStyle:{margin:"2px 3px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleGroupClose(t)}}},[e._v("\n            "+e._s(t.factorName)+"\n          ")])})):[e._v("\n          无\n        ")]],2)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v("因子配置")]),a("el-form",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},["002001"===e.currentNodeId?a("el-form-item",{attrs:{label:"均值类型:","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择均值类型"},on:{change:e.changeMeanType},model:{value:e.meanType,callback:function(t){e.meanType=t},expression:"meanType"}},[a("el-option",{attrs:{value:"0",label:"日均值"}}),a("el-option",{attrs:{value:"1",label:"时均值"}}),a("el-option",{attrs:{value:"2",label:"八小时均值"}})],1)],1):e._e()],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"天数:","label-width":"100px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,step:1,precision:0},model:{value:e.setDay,callback:function(t){e.setDay=t},expression:"setDay"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"频次(次/天):","label-width":"110px"}},[a("el-input-number",{attrs:{"controls-position":"right",max:e.maxTotal,min:1,step:1,precision:0},model:{value:e.frequency,callback:function(t){e.frequency=t},expression:"frequency"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.addressArray&&e.addressArray.length>0?"检测位置1:":"检测位置:","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:e.lookPosition,callback:function(t){e.lookPosition=t},expression:"lookPosition"}})],1)],1)],1),a("el-row",[e._l(e.addressArray,(function(t,r){return a("el-col",{key:t.key,attrs:{span:24}},[a("el-form-item",{attrs:{label:"检测位置"+(r+2)+":","label-width":"100px"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"3px"},attrs:{placeholder:"检测位置"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),"002001"!==e.currentNodeId&&"002003"!==e.currentNodeId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return a.preventDefault(),e.removeAddDomain(t)}}},[e._v("删除")]):e._e()],1)],1)})),"002003"!==e.currentNodeId&&"002001"!==e.currentNodeId?a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addAddress}},[e._v("添加位置")])],1)],1):e._e()],2)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.factorGroupVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmGroupChoseFactor}},[e._v("确认")])],1)],1)],1)},o=[],s=(a("5df3"),a("f400"),a("20d6"),a("7f7f"),a("28a5"),a("a481"),a("7514"),a("c5f6"),a("ac6a"),a("e601")),l=a("333d"),n=a("f858"),i=a("b429"),c=a("b705"),d=a("9612"),u={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过"},p={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},m={0:"日均值",1:"时均值",2:"八小时均值"},h={name:"OrderList",components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},data:function(){return{MEAN_STATUS:m,ACCOUNT_STATUS:u,CHECK_STATUS:p,orderData:[],defaultProps:{children:"children",label:"name",id:"id"},searchForm:{id:"",projectName:"",status:"",pageNumber:1,pageSize:10},total:0,maxTotal:10,titleMap:{edit:"修改报价单",create:"新增报价单"},orderForm:{offerId:"",offerInfoTdo:{projectName:"",checkType:"0",certificationType:"1",status:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:"",offerer:"",finishDate:"",checkCircle:"1",checkTaskCount:"",remark:""},factorTdos:[],offerCostTdo:{id:"",reportAmount:0,reportAmountRate:10,expediteAmount:0,laborAmount:0,tripAmount:0,taxAmount:"",taxAmountRate:6,checkAmount:0,sysAmount:0,draftAmount:0},selfCostTdos:[]},otherPrice:"",orderRules:{offerInfoTdo:{consignorLinkerPhone:[{required:!0,message:"请录入联系方式",trigger:"blur"}],projectName:[{required:!0,message:"请录入项目名称",trigger:"blur"}],finishDate:[{required:!0,message:"请录入完成日期",trigger:"blur"}],consignorName:[{required:!0,message:"请录入委托单位",trigger:"blur"}],consignorLinker:[{required:!0,message:"请录入委托人",trigger:"blur"}],checkType:[{required:!0,message:"请选择检测类型",trigger:"change"}],certificationType:[{required:!0,message:"请选择认证类型",trigger:"change"}]}},orderDialogStatus:"create",orderDialogVisible:!1,departmentArray:[],orderActiveName:"1",factorData:[],priceArray:[],innerPriceVisible:!1,addPriceForm:{selfName:"",amount:0},factorVisible:!1,showPriceForm:{},showChoseData:[],factTotal:0,factorForm:{classId:"",factorName:"",pageNumber:1,pageSize:10},factorMultipleSelection:[],factorTreeData:[],choseFatcors:[],choseGroupFatcors:[],addressArray:[],groupAddressArray:[],setDay:1,frequency:1,meanType:"0",currentNodeId:"",currentGroupNodeId:"",lookPosition:"",currentNodeName:"",detailVisible:!1,orderDetailForm:{offerId:"",offerBaseVo:{consignorName:"",consignorLinker:"",consignorLinkerPhone:"",createUserName:"",finishDate:"",remark:"",checkCircle:"",checkTaskCount:""},factorTdos:[],costVo:{},oncePrice:"",selfCostVos:[]},multipleSelection:[],multiplGroupeSelection:[],factorGroupData:[],choseMultipleTable:[],changeGroupId:"",startFactorGroup:"",factorGroupVisible:!1,rowShowVisible:!0,rowRemark:"",currentItem:{},windNum:3,approveVisible:!1,approveDetails:[],treeData:[],factListInfos:[],cacheFactors:[],factorList:[],facName:"",resultCache:{},resultForCache:{},currentUUid:""}},computed:{},watch:{orderForm:{handler:function(e){var t=0,a=0,r=0,o=0,s=0,l=0,n=0;if(this.orderForm.factorTdos.length>0){var i=0;this.orderForm.factorTdos.forEach((function(e){if(e.dayCount&&e.frequency){var t=Number(e.dayCount*e.frequency),a=parseFloat(e.dayCount*e.frequency*e.price).toFixed(2);e.totalNum=t,e.totalCost=a,i+=parseFloat(a)}})),i>0&&(t=parseFloat(i*this.orderForm.offerInfoTdo.checkTaskCount),a=parseFloat(t*this.orderForm.offerCostTdo.reportAmountRate/100),o=parseFloat(t*this.orderForm.offerCostTdo.taxAmountRate/100)),this.orderForm.offerCostTdo.checkAmount=t,this.orderForm.offerCostTdo.reportAmount=a,this.orderForm.offerCostTdo.taxAmount=o,s=parseFloat(this.orderForm.offerCostTdo.tripAmount*this.orderForm.offerInfoTdo.checkTaskCount),l=parseFloat(this.orderForm.offerCostTdo.laborAmount*this.orderForm.offerInfoTdo.checkTaskCount),r=parseFloat(this.orderForm.offerCostTdo.expediteAmount*this.orderForm.offerInfoTdo.checkTaskCount),this.orderForm.selfCostTdos&&this.orderForm.selfCostTdos.length>0&&this.orderForm.selfCostTdos.forEach((function(e){n+=parseFloat(e.amount)})),this.otherPrice=parseFloat(n*this.orderForm.offerInfoTdo.checkTaskCount),this.orderForm.offerCostTdo.sysAmount=parseFloat(t+a+r+o+s+l+n*this.orderForm.offerInfoTdo.checkTaskCount).toFixed(2)}},deep:!0}},created:function(){this.getTreeClassList(),this.getFactorGroup(),this.handleSearch()},methods:{getDicKey:function(e,t){var a=this;c["g"](t).then((function(t){200===t.code&&(a[e]=t.result)}))},getTreeClassList:function(){var e=this;c["e"]().then((function(t){e.factorTreeData=t.result||[]}))},handleSearch:function(){var e=this;s["g"](this.searchForm).then((function(t){200===t.code&&(e.orderData=t.result.records||[],e.total=t.result.total)}))},handleCreate:function(){this.clearForm(),this.orderDialogStatus="create",this.orderDialogVisible=!0},handleCopy:function(e){var t=this;this.$confirm("确定复制?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["b"](e.id).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleUpdate:function(e){var t=this;this.orderForm.offerId=e.id,this.orderDialogStatus="edit",s["f"](e.id).then((function(e){200===e.code&&(t.orderForm.offerId=e.result.offerId||"",t.orderForm.offerInfoTdo=e.result.offerBaseVo||{},t.orderForm.offerCostTdo=e.result.costVo||{},t.orderForm.selfCostTdos=e.result.selfCostVos||[],t.orderForm.factorTdos=e.result.factorVos.map((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}return e}))||[],t.orderDialogVisible=!0)}))},handleApprovel:function(e){var t=this;this.$confirm("确定提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},confirmDialog:function(){if(this.orderForm.factorTdos&&this.orderForm.factorTdos.length>0){var e=this.orderForm.factorTdos.find((function(e){return""===e.factorPoint}));if(e)return void this.$message.warning("因子位置信息不能为空");1===this.orderForm.offerInfoTdo.checkTaskCount&&(this.orderForm.offerInfoTdo.checkCircle="0"),this.orderForm.offerCostTdo.draftAmount&&this.orderForm.offerCostTdo.draftAmount>0?"create"===this.orderDialogStatus?this.confirmCreate():this.confirmUpdate():this.$message.warning("请录入正确的优惠价格!")}else this.$message.warning("因子信息不能为空")},confirmCreate:function(){var e=this;this.$refs.orderForm.validate((function(t){if(!t)return e.$message.warning("请完善必填信息"),!1;var a={offerInfoTdo:e.orderForm.offerInfoTdo,factorTdos:e.orderForm.factorTdos.map((function(e){var t=e.checkStandardId,a=e.secdClassId,r=e.frequency,o=e.dayCount,s=e.totalCost,l=e.factorPoint,n=e.remark,i=e.dynamicParam,c=e.factorGroupKey;return{checkStandardId:t,secdClassId:a,frequency:r,dayCount:o,totalCost:s,factorPoint:l,remark:n,dynamicParam:i,factorGroupKey:c}})),offerCostTdo:e.orderForm.offerCostTdo,selfCostTdos:e.orderForm.selfCostTdos};s["i"](a).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.orderDialogVisible=!1,e.$refs.orderForm.resetFields()):e.$notify({title:"失败",message:t.message,type:"error"})})).catch((function(){}))}))},confirmUpdate:function(){var e=this;this.$refs.orderForm.validate((function(t){if(!t)return!1;var a={offerId:e.orderForm.offerId,offerInfoTdo:e.orderForm.offerInfoTdo,factorTdos:e.orderForm.factorTdos.map((function(e){var t=e.checkStandardId,a=e.secdClassId,r=e.frequency,o=e.dayCount,s=e.totalCost,l=e.factorPoint,n=e.remark,i=e.dynamicParam,c=e.factorGroupKey;return{checkStandardId:t,secdClassId:a,frequency:r,dayCount:o,totalCost:s,factorPoint:l,remark:n,dynamicParam:i,factorGroupKey:c}})),offerCostTdo:e.orderForm.offerCostTdo,selfCostTdos:e.orderForm.selfCostTdos};s["j"](a).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.orderDialogVisible=!1,e.$refs.orderForm.resetFields()})).catch((function(){}))}))},handleDelete:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["c"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleApproveDetail:function(e){var t=this;i["a"](e.id).then((function(e){t.approveDetails=e.result||[]})),this.approveVisible=!0},clearForm:function(){this.orderForm={offerInfoTdo:{projectName:"",checkType:"0",certificationType:"1",status:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:"",offerer:"",finishDate:"",checkCircle:"1",checkTaskCount:"",remark:""},factorTdos:[],offerCostTdo:{id:"",reportAmount:0,reportAmountRate:10,expediteAmount:0,laborAmount:0,tripAmount:0,taxAmount:"",taxAmountRate:6,checkAmount:0,sysAmount:0,draftAmount:0},selfCostTdos:[],currentTreeNode:""}},handleDialogClose:function(e){this.$confirm("确认离开？").then((function(t){e()})).catch((function(e){}))},showAddPrice:function(){this.addPriceForm={selfName:"",amount:0},this.innerPriceVisible=!0},factorNumCheck:function(e,t){t.length>=3?this.orderForm.offerCostTdo[e]=t.substr(0,2):this.orderForm.offerCostTdo[e]=t.replace(/[^\d]/g,"")},factorNumCheckNaN:function(e,t){t.length>=3?this.orderForm.offerCostTdo[e]=t.substr(0,2):this.orderForm.offerCostTdo[e]=t.replace(/[^\d]/g,"")},factorNumCheckPoint:function(e,t){this.orderForm.offerCostTdo[e]=t.replace(/[^\d.]/g,"")},confirmPrice:function(){this.addPriceForm.selfName&&this.addPriceForm.amount>=0?(this.orderForm.selfCostTdos.push({selfName:this.addPriceForm.selfName,amount:this.addPriceForm.amount}),this.innerPriceVisible=!1):this.$message.warning("请录入完整信息")},validatoProInput:function(e){e.split(".").length>2?this.showPriceForm.totalPrice=0:this.showPriceForm.totalPrice=e.replace(/[^\d.]/g,"")},addFactor:function(){var e=this;this.currentUUid=d["b"].v4().replaceAll("-",""),this.choseFatcors=[],this.multipleSelection=[],this.maxTotal=10,this.currentNodeId&&this.currentNodeId.length>0&&(this.handleFactorSearch(),"002003"===this.currentNodeId?this.$nextTick((function(){for(var t=0;t<4;t++)e.addressArray.push({value:"",windNum:3,key:Date.now()+t})})):"002001"===this.currentNodeId&&this.$nextTick((function(){for(var t=0;t<3;t++)e.addressArray.push({value:"",windNum:3,key:Date.now()+t})}))),this.setDay=1,this.frequency=1,this.addressArray=[],this.lookPosition="",this.meanType="",this.factorVisible=!0},choseGroup:function(){this.currentUUid=d["b"].v4().replaceAll("-",""),this.startFactorGroup="",this.groupAddressArray=[],this.multiplGroupeSelection=[],this.choseGroupFatcors=[],this.factorGroupVisible=!0},getFactorGroup:function(){var e=this;n["e"]().then((function(t){200===t.code&&(e.factorGroupData=t.result||[])}))},addAddress:function(){var e=this;this.$nextTick((function(){e.addressArray.push({value:"",windNum:3,key:Date.now()})}))},addGroupAddress:function(){var e=this;this.$nextTick((function(){e.groupAddressArray.push({value:"",key:Date.now()})}))},removeDomain:function(e){var t=this.orderForm.selfCostTdos.indexOf(e);-1!==t&&this.orderForm.selfCostTdos.splice(t,1)},removeAddDomain:function(e){var t=this.addressArray.indexOf(e);-1!==t&&this.addressArray.splice(t,1)},removeGroupAddDomain:function(e){var t=this.groupAddressArray.indexOf(e);-1!==t&&this.groupAddressArray.splice(t,1)},handleClass:function(e){this.searchForm.classId=e,this.handleFactorSearch()},handleTreeFactorSearch:function(e,t){var a=this;e.children&&null!=e.children||(this.addressArray=[],this.currentNodeId=e.id,this.currentNodeName=e.name,this.factorForm.classId=t.parent.data.id,this.factorForm.factorName="",this.factorForm.pageNumber=1,this.handleFactorSearch(),this.choseFatcors=[],this.multipleSelection=[],"002001"===e.id&&"0"===this.meanType?this.maxTotal=1:"004001"===e.id?this.maxTotal=2:this.maxTotal=10,"002003"===e.id?this.$nextTick((function(){for(var e=0;e<4;e++)a.addressArray.push({value:"",windNum:3,key:Date.now()+e})})):"002001"===e.id&&this.$nextTick((function(){for(var e=0;e<3;e++)a.addressArray.push({value:"",windNum:3,key:Date.now()+e})})))},handleFactorSearch:function(){var e=this;this.currentNodeId&&this.currentNodeId.length>0&&n["h"](this.factorForm).then((function(t){200===t.code&&(e.showChoseData=t.result.records||[],e.factTotal=t.result.total)}))},handleSelectionChange:function(e){var t=this;this.multipleSelection=e,e&&e.forEach((function(e){var a=t.choseFatcors.find((function(t){return t.id===e.id}));a||t.choseFatcors.push(e)}))},handleSelectChange:function(e,t){if(e&&-1===e.indexOf(t)){var a=this.choseFatcors.findIndex((function(e){return e.id===t.id}));this.choseFatcors.splice(a,1)}},handleClose:function(e){this.choseFatcors.splice(this.choseFatcors.indexOf(e),1),this.$refs.multipleTable.toggleRowSelection(e,!1)},handleGroupClose:function(e){this.choseGroupFatcors.splice(this.choseGroupFatcors.indexOf(e),1),this.$refs.groupMultipleTable.toggleRowSelection(e,!1)},confirmChoseFactor:function(){var e=this;if(!this.choseFatcors||this.choseFatcors.length<=0)this.$message.warning("因子不能为空");else if(!this.lookPosition||this.lookPosition.length<=0)this.$message.warning("初始检测位置不能为空");else{var t={};"002001"===this.currentNodeId&&(this.$set(t,"meanType",this.meanType),this.$set(t,"meanName",this.MEAN_STATUS[this.meanType]));var a="";"002001"!==this.currentNodeId&&"002003"!==this.currentNodeId||(a=this.currentNodeId);var r=this.choseFatcors.map((function(r){var o=r.standardCode,s=r.className,l=r.standardName,n=r.factorName,i=r.price,c=parseFloat(i*e.frequency*e.setDay).toFixed(2),u=d["b"].v4().replaceAll("-","");return e.$set(r,"factorGroupKey",u),{checkStandardId:o,className:s,standardName:l,factorName:n,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,frequency:e.frequency,dayCount:e.setDay,price:i,totalCost:c,meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,factorPoint:e.lookPosition,groupClassId:""!==a?a+"/"+o:"",dynamicParam:JSON.stringify(t),factorGroupKey:u}}));this.addressArray&&this.addressArray.length>0&&this.addressArray.forEach((function(o){o.value&&o.value.length>0&&e.choseFatcors.forEach((function(s){var l=s.standardCode,n=s.className,i=s.standardName,c=s.factorName,d=s.price,u=s.factorGroupKey,p=parseFloat(d*e.frequency*e.setDay).toFixed(2);r.push({checkStandardId:l,className:n,standardName:i,factorName:c,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,frequency:e.frequency,dayCount:e.setDay,price:d,totalCost:p,factorPoint:o.value,remark:"",meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+l:"",dynamicParam:JSON.stringify(t),factorGroupKey:u})}))})),this.$nextTick((function(){e.orderForm.factorTdos&&e.orderForm.factorTdos.length>0?e.orderForm.factorTdos=e.orderForm.factorTdos.concat(r):e.orderForm.factorTdos=r})),this.factorVisible=!1}},confirmGroupChoseFactor:function(){var e=this;if(!this.choseGroupFatcors||this.choseGroupFatcors.length<=0)this.$message.warning("因子不能为空");else if(!this.lookPosition||this.lookPosition.length<=0)this.$message.warning("初始检测位置不能为空");else{var t={};"002001"===this.currentNodeId&&(this.$set(t,"meanType",this.meanType),this.$set(t,"meanName",this.MEAN_STATUS[this.meanType]));var a="";"002001"!==this.currentNodeId&&"002003"!==this.currentNodeId||(a=this.currentNodeId);var r=this.choseGroupFatcors.map((function(r){var o=r.standardCode,s=r.className,l=r.standardName,n=r.factorName,i=r.price,c=parseFloat(i*e.frequency*e.setDay).toFixed(2),u=d["b"].v4().replaceAll("-","");return e.$set(r,"factorGroupKey",u),{checkStandardId:o,className:s,standardName:l,factorName:n,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,frequency:e.frequency,dayCount:e.setDay,price:i,totalCost:c,meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,factorPoint:e.lookPosition,groupClassId:""!==a?a+"/"+o:"",dynamicParam:JSON.stringify(t),factorGroupKey:u}}));this.addressArray&&this.addressArray.length>0&&this.addressArray.forEach((function(o){o.value&&o.value.length>0&&e.choseGroupFatcors.forEach((function(s){var l=s.standardCode,n=s.className,i=s.standardName,c=s.factorName,d=s.price,u=s.factorGroupKey,p=parseFloat(d*e.frequency*e.setDay).toFixed(2);r.push({checkStandardId:l,className:n,standardName:i,factorName:c,secdClassId:e.currentNodeId,secdClassName:e.currentNodeName,frequency:e.frequency,dayCount:e.setDay,price:d,totalCost:p,factorPoint:o.value,remark:"",meanName:"002001"===e.currentNodeId?e.MEAN_STATUS[e.meanType]:void 0,groupClassId:""!==a?a+"/"+l:"",dynamicParam:JSON.stringify(t),factorGroupKey:u})}))})),this.$nextTick((function(){e.orderForm.factorTdos&&e.orderForm.factorTdos.length>0?e.orderForm.factorTdos=e.orderForm.factorTdos.concat(r):e.orderForm.factorTdos=r})),this.factorGroupVisible=!1}},getSummaries:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var o=a.map((function(t){return"次数"===e.label?Number(t.dayCount*t.frequency):"总计"===e.label?parseFloat(t.dayCount*t.frequency*t.price):Number(t[e.property])}));o.every((function(e){return isNaN(e)}))?r[t]="":6===t?r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0):8===t&&(r[t]=o.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0).toFixed(2))}else r[t]="合计"})),r},handleRowDel:function(e,t){var a=this;if(t.groupClassId&&""!==t.groupClassId){var r=this.orderForm.factorTdos.filter((function(e){return e.groupClassId===t.groupClassId}));r&&r.forEach((function(e){a.orderForm.factorTdos.some((function(e,r){t.groupClassId!==e.groupClassId||a.orderForm.factorTdos.splice(r,1)}))}))}else this.orderForm.factorTdos.splice(e,1)},handleDetail:function(e){var t=this;s["f"](e.id).then((function(e){200===e.code&&(t.orderDetailForm.offerId=e.result.offerId||"",t.orderDetailForm.offerBaseVo=e.result.offerBaseVo||{},t.orderDetailForm.costVo=e.result.costVo||{},t.orderDetailForm.selfCostVos=e.result.selfCostVos||[],t.orderForm.factorTdos=e.result.factorVos.map((function(e){if("{}"!==e.dynamicParam&&e.dynamicParam.indexOf("meanName")>-1){var a=JSON.parse(e.dynamicParam);t.$set(e,"meanName",a.meanName)}return e}))||[],t.orderDetailForm.factorTdos=t.doProcessDate(e.result.factorVos)||[],t.detailVisible=!0)}))},doProcessDate:function(e){var t=this;if(e&&e.length>0){var a=[],r=new Map,o=[],s=1;return e.forEach((function(e,t){var o=a.find((function(t){return t.secdClassName===e.secdClassName}));if(o||(a.push({id:s,secdClassName:e.secdClassName,totalPrice:0,detailLength:0}),s++),r.get(e.secdClassName)){var l=r.get(e.secdClassName);l.push(e)}else{var n=[];n.push(e),r.set(e.secdClassName,n)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName);if(a&&a.length>0){var s=t.countTotal(a,"totalCost");a.forEach((function(r,s){var l=o.find((function(e){return e.secName===r.secdClassName}));l?t.$set(r,"frIndex",1):t.$set(r,"frIndex",0),t.$set(r,"id",e.id),t.$set(r,"sid",e.id+"."+(s+1)),t.$set(r,"secName",e.secdClassName),t.$set(r,"detailLength",a.length+1),t.$set(r,"dateType",0),o.push(r)})),o.push({secName:e.secdClassName,frIndex:1,totalPrice:parseFloat(s).toFixed(2),dateType:1})}})),this.orderDetailForm.oncePrice=this.countTotal(o,"totalCost"),o}return[]},countTotal:function(e,t){var a=0;return a=e.reduce((function(e,a,r,o){return a[t]?e+a[t]:e}),0),a},handleGroupSelectionChange:function(e){var t=this;this.multiplGroupeSelection=e,e&&e.forEach((function(e){var a=t.choseGroupFatcors.find((function(t){return t.standardCode===e.standardCode}));a||t.choseGroupFatcors.push(e)}))},groupSelect:function(e,t){if(e&&-1===e.indexOf(t)){var a=this.choseGroupFatcors.findIndex((function(e){return e.standardCode===t.standardCode}));this.choseGroupFatcors.splice(a,1)}},groupSelectAll:function(e){e.length>1?e.length=1:this.choseMultipleTable=[]},confirmAddGroup:function(){var e=this;!this.changeGroupId||this.changeGroupId.length<=0?this.$message.warning("套餐不能为空"):n["c"](this.changeGroupId).then((function(t){200===t.code&&t.result&&(e.doGroupProcess(t.result),e.factorGroupVisible=!1)}))},doGroupProcess:function(e){var t=this,a=e.map((function(e){var t=e.standardCode,a=e.secdClassId,r=e.secdClassName,o=e.className,s=e.standardName,l=e.factorName,n=e.price;return{checkStandardId:t,className:o,standardName:s,factorName:l,secdClassId:a,secdClassName:r,frequency:1,dayCount:1,price:n,totalCost:n,factorPoint:"",remark:""}}));this.$nextTick((function(){t.orderForm.factorTdos&&t.orderForm.factorTdos.length>0?t.orderForm.factorTdos=t.orderForm.factorTdos.concat(a):t.orderForm.factorTdos=a}))},handleDownload:function(e){var t="/api/word/downLoadOffer?offerId="+e.id;window.open(t)},handleRowShow:function(e){this.currentItem=e,this.rowRemark=e.remark,this.rowShowVisible=!0},rowShowConfirm:function(){this.currentItem.remark=this.rowRemark,this.rowShowVisible=!1},changeMeanType:function(e){var t=0;"0"===e?this.maxTotal=t=1:"1"===e?this.maxTotal=t=4:"2"===e&&(this.maxTotal=t=2),this.frequency>t&&(this.frequency=t)},changeTreeItem:function(e,t,a){var r=this;2===e.level&&(this.factorList=[],this.multiplGroupeSelection=[],this.factorList=this.cacheFactors.filter((function(t){return e.id===t.secdClassId})),this.addressArray=[],this.currentNodeId=e.id,this.currentNodeName=e.name,"002001"===e.id&&"0"===this.meanType?this.maxTotal=1:"004001"===e.id?this.maxTotal=2:this.maxTotal=10,"002001"!==e.id&&"002003"!==e.id||this.$nextTick((function(){for(var e=0;e<4;e++)r.addressArray.push({value:"",windNum:3,key:Date.now()+e})})))},choseItem:function(e){var t=this;if(this.treeData=[],this.cacheFactors=[],this.factorList=[],this.multiplGroupeSelection=[],this.choseGroupFatcors=[],this.setDay=1,this.frequency=1,this.addressArray=[],this.currentNodeId="",this.currentNodeName="",this.meanType="",this.resultCache[e.groupId])return this.treeData=this.resultCache[e.groupId],void(this.cacheFactors=this.resultForCache[e.groupId]);e.groupId&&n["c"](e.groupId).then((function(a){if(200===a.code&&a.result){t.cacheFactors=a.result;var r=[];a.result.forEach((function(e){var t=r.find((function(t){return t.id===e.classId}));if(t){var a=t.children,o=a.find((function(t){return t.id===e.secdClassId}));if(!o){var s=[{id:e.secdClassId,name:e.secdClassName,children:[],level:2}];t.children.push(s)}}else{var l=[{id:e.secdClassId,name:e.secdClassName,children:[],level:2}],n={id:e.classId,name:e.className,level:1,children:l};r.push(n)}})),t.$set(t.resultCache,e.groupId,r),t.$set(t.resultForCache,e.groupId,a.result),t.treeData=r}}))}}},f=h,b=(a("d425"),a("8261"),a("2877")),g=Object(b["a"])(f,r,o,!1,null,"3e8da822",null);t["default"]=g.exports},e30a:function(e,t,a){"use strict";a("d049")},e350:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("6762"),a("2fdb");var r=a("4360");function o(e){if(e&&e instanceof Array&&e.length>0){var t=r["a"].getters&&r["a"].getters.roles,a=e,o=t.some((function(e){return a.includes(e)}));return o}return console.error("必须传入权限标识!"),!1}},e496:function(e,t,a){},e5a6:function(e,t,a){},e601:function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"i",(function(){return l})),a.d(t,"j",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d})),a.d(t,"f",(function(){return u})),a.d(t,"h",(function(){return p})),a.d(t,"e",(function(){return m}));var r=a("b775");function o(e){return Object(r["a"])({url:"/offer/findOfferInfosByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/offer/findHistoryOfferInfosByCondition",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/offer/saveOffer",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/offer/modifyOfferByOfferId",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/offer/delByOfferId/".concat(e),method:"get"})}function c(e){return Object(r["a"])({url:"/offer/copyOfferByOfferId/".concat(e),method:"get"})}function d(e){return Object(r["a"])({url:"/offer/commitByOfferId/".concat(e),method:"get"})}function u(e){return Object(r["a"])({url:"/offer/findOfferDetailsByOfferId/".concat(e),method:"get"})}function p(e){return Object(r["a"])({url:"/offer/findJudgeOfferFactorVosByOfferId/".concat(e),method:"get"})}function m(e){return Object(r["a"])({url:"/offer/findJudgeOfferFactorQryVoByOfferId/".concat(e),method:"get"})}},e668:function(e,t,a){},e708:function(e,t,a){},e744:function(e,t,a){"use strict";a("d1cb")},e7bb:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail-continer"},[a("el-card",{staticClass:"card-continer",staticStyle:{height:"550px"},attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("span",[e._v("样品列表"),a("i",{staticClass:"el-input__icon"})])]),a("el-col",{attrs:{span:8}},[e.showTitle?[a("el-row",{staticStyle:{"text-align":"center","font-size":"14px"}},[a("el-col",{attrs:{span:24}},[e._v("Web打印服务CLodop未安装启动，"),a("a",{staticStyle:{color:"red"},attrs:{href:"#"},on:{click:e.fileDownLoad}},[e._v("点击这里下载执行安装")])])],1),a("el-row",{staticStyle:{"text-align":"center","font-size":"14px","padding-top":"3px"}},[a("el-col",{attrs:{span:24}},[e._v("(若此前已安装过，"),a("a",{staticStyle:{color:"red"},attrs:{href:"#"},on:{click:e.tabPrint}},[e._v("可点这里直接再次启动")]),e._v("），成功后请刷新本页面。")])],1)]:[a("div",{staticStyle:{visibility:"hidden"}},[e._v("信息提示")])]],2),a("el-col",{staticStyle:{padding:"5px","text-align":"right"},attrs:{span:8}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.pageBack}},[e._v(" 返回")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.tabPrint}},[e._v(" 标签打印")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"},"max-height":"420px"},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无样品\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"45",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"150",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"170px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"检测位置",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(天/次)",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"smapStatus",label:"样品状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.smapStatus)}},[e._v("\n            "+e._s(e.SAMPLE_STATUS[r.smapStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"sampleType",label:"是否分包",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:"1"===r.sampleType?"danger":"success"}},[e._v("\n            "+e._s("1"===r.sampleType?"分包":"自检")+"\n          ")])]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],staticStyle:{"padding-top":"10px"},attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1),a("div",{staticClass:"footer"},[a("el-row",{staticStyle:{color:"red"}},[a("el-col",{attrs:{span:24}},[e._v("\n        提示：\n      ")])],1),a("el-row",{staticStyle:{color:"red"}},[a("el-col",{attrs:{span:24}},[e._v("\n        1. 打印样品标签需要用到【热敏打印机】以及【三防热敏标签纸】；\n      ")])],1),a("el-row",{staticStyle:{color:"red"}},[a("el-col",{attrs:{span:24}},[e._v("\n        2. 由于一般电脑不带蓝牙，打印机建议使用USB版，而不是蓝牙版，推荐使用得力DL-888D型号；\n      ")])],1),a("el-row",{staticStyle:{color:"red"}},[a("el-col",{attrs:{span:24}},[e._v("\n        3. 三防热敏标签纸的尺寸为60*40mm，推荐得力品牌。\n      ")])],1)],1),a("div",{staticStyle:{overflow:"auto",opacity:"0"}},[a("div",{ref:"labelPrint",staticStyle:{margin:"0",padding:"5px"},attrs:{id:"labelPrint"}},e._l(e.printList,(function(t){return a("div",{key:t.sampItemId,staticStyle:{width:"60mm",height:"40mm",margin:"0",padding:"0px","font-size":"12px"}},[a("div",{staticStyle:{"padding-left":"10px","padding-top":"6px",display:"flex"}},[a("div",{staticStyle:{padding:"0px","line-height":"4mm"}},[e._v("受检单位:")]),a("div",{staticStyle:{"padding-left":"10px","line-height":"4mm"}},[e._v(e._s(e._f("ellipsis")(t.inspectionName)))])]),a("div",{staticStyle:{"padding-left":"10px",display:"flex"}},[a("div",{staticStyle:{padding:"0px","line-height":"4mm"}},[e._v("样品类别:")]),a("div",{staticStyle:{"padding-left":"10px","line-height":"4mm"}},[e._v(e._s(t.secdClassName))])]),a("div",{staticStyle:{"padding-left":"10px",display:"flex"}},[a("div",{staticStyle:{padding:"0px","line-height":"4mm"}},[e._v("检测因子:")]),a("div",{staticStyle:{"padding-left":"10px","line-height":"4mm"}},[e._v(e._s(e._f("ellipsis")(t.factorName)))])]),a("div",{staticStyle:{"text-align":"center","font-size":"12px"}},[a("barcode",{attrs:{value:t.sampleNo,options:e.barcode_option,tag:"svg"}})],1),a("div",{staticStyle:{"padding-left":"10px",display:"flex"}},[a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"8mm"}},[e._v("点位:")]),a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"29mm","text-align":"center"}},[e._v(e._s(t.factorPoint))]),a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"11mm"}},[e._v("次/天:")]),a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"8mm","text-align":"center"}},[e._v(e._s(t.frequency?t.frequency:"")+"/"+e._s(t.day?t.day:""))])]),e._m(0,!0),e._m(1,!0)])})),0)])],1)},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-left":"10px",display:"flex"}},[a("div",{staticStyle:{padding:"0px","line-height":"3mm"}},[e._v("状态:")]),a("div",{staticStyle:{"padding-left":"10px","line-height":"4mm"}},[e._v("□未检 □在检 □已检")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-left":"10px",display:"flex"}},[a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"14mm"}},[e._v("日期:")]),a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"14mm"}},[e._v(" ")]),a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"14mm"}},[e._v("采样人:")]),a("div",{staticStyle:{padding:"0px","line-height":"3mm",width:"14mm"}},[e._v(" ")])])}],s=a("47bc"),l=(a("4917"),null);function n(){try{var e=navigator.userAgent;if(null!=e.match(/Windows\sPhone/i))return!0;if(null!=e.match(/iPhone|iPod/i))return!0;if(null!=e.match(/Android/i))return!0;if(null!=e.match(/Edge\D?\d+/i))return!0;var t=e.match(/Trident\D?\d+/i),a=e.match(/MSIE\D?\d+/i),r=e.match(/OPR\D?\d+/i),o=e.match(/Firefox\D?\d+/i),s=e.match(/x64/i);if(null==t&&null==a&&null!==s)return!0;if(null!==o){if(o=o[0].match(/\d+/),o[0]>=41||null!==s)return!0}else if(null!==r){if(r=r[0].match(/\d+/),r[0]>=32)return!0}else if(null==t&&null==a){var l=e.match(/Chrome\D?\d+/i);if(null!==l&&(l=l[0].match(/\d+/),l[0]>=41))return!0}return!1}catch(n){return!0}}if(n()){var i=document.head||document.getElementsByTagName("head")[0]||document.documentElement,c=document.createElement("script");c.src="http://localhost:8000/CLodopfuncs.js?priority=1",i.insertBefore(c,i.firstChild),c=document.createElement("script"),c.src="http://localhost:18000/CLodopfuncs.js?priority=0",i.insertBefore(c,i.firstChild)}function d(e,t){var a,r="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop32.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",o="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop32.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",s="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop64.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",i="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop64.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",c="<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>",d="<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>",u="<br><font color='#FF00FF'>CLodop云打印服务(localhost本地)未安装启动!点击这里<a href='http://www.lodop.net/download/CLodop_Setup_for_Win32NT_https_3.046Extend.zip' download target='_self'>执行安装</a>,安装后请刷新页面。</font>",p="<br><font color='#FF00FF'>CLodop云打印服务需升级!点击这里<a href='http://www.lodop.net/download/CLodop_Setup_for_Win32NT_https_3.046Extend.zip' download target='_self'>执行升级</a>,升级后请刷新页面。</font>";try{var m=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0;if(n()){try{a=getCLodop()}catch(f){}if(!a&&"complete"!==document.readyState)return void alert("C-Lodop没准备好，请稍后再试！");if(void 0===a)return;if(!a){try{m?document.write(u):document.body.innerHTML=u+document.body.innerHTML}catch(f){}return}CLODOP.CVERSION<"3.0.4.3"&&(m?document.write(p):document.body.innerHTML=p+document.body.innerHTML),t&&t.parentNode&&t.parentNode.removeChild(t),e&&e.parentNode&&e.parentNode.removeChild(e)}else{var h=m&&navigator.userAgent.indexOf("x64")>=0;if(void 0!=e||void 0!=t?a=m?e:t:null==l?(a=document.createElement("object"),a.setAttribute("width",0),a.setAttribute("height",0),a.setAttribute("style","position:absolute;left:0px;top:-100px;width:0px;height:0px;"),m?a.setAttribute("classid","clsid:2105C259-1E0C-4534-8141-A753534CB4CA"):a.setAttribute("type","application/x-print-lodop"),document.documentElement.appendChild(a),l=a):a=l,null==a||"undefined"===typeof a.VERSION)return navigator.userAgent.indexOf("Chrome")>=0&&(document.body.innerHTML=d+document.body.innerHTML),navigator.userAgent.indexOf("Firefox")>=0&&(document.body.innerHTML=c+document.body.innerHTML),h?document.write(s):m?document.write(r):document.body.innerHTML=r+document.body.innerHTML,a}return a.VERSION<"6.2.2.3"?(n()||(h?document.write(i):m?document.write(o):document.body.innerHTML=o+document.body.innerHTML),a):a}catch(f){alert("getLodop出错:"+f)}}var u=a("333d"),p={0:"待采样",1:"已采样",2:"待组长审核",3:"待负责人审核",4:"审核通过",5:"审核失败",6:"已入库",7:"部分出库",8:"已出库",9:"入库中",10:"待复核"},m={components:{Pagination:u["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"1"===e?"":"2"===e||"3"===e?"info":"4"===e||e>5?"success":"danger"}},data:function(){return{SAMPLE_STATUS:p,sampleData:[],searchForm:{sampTaskId:"",pageNumber:1,pageSize:50},total:0,multipleSelection:[],barcode_option:{format:"CODE128",displayValue:!0,background:"rgba(255,255,255,.0)",width:"1.3px",fontOptions:"bold",height:"30mm",fontSize:"12px",textMargin:0,font:'12px/1.5 arial,"黑体"',textAlign:"center",margin:5},printList:[],showTitle:!1}},created:function(){this.$route.params.sampTaskId&&(this.searchForm.sampTaskId=this.$route.params.sampTaskId,this.handleSearch())},methods:{handleSearch:function(){var e=this;s["y"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.sampleData=t.result.records||[],e.total=t.result.total)}))},handleSelectionChange:function(e){this.multipleSelection=e},tabPrint:function(){var e=this;this.multipleSelection&&this.multipleSelection.length>0?(this.printList=this.multipleSelection,this.$nextTick((function(){e.tagPrint()}))):this.$message.info("最少选择一条记录信息")},tagPrint:function(){var e=this,t=d();setTimeout((function(){e.$nextTick((function(){void 0!==t?(t.PRINT_INIT("标签"),t.ADD_PRINT_HTM(0,0,"60mm","40mm",document.getElementById("labelPrint").innerHTML),t.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",!0),t.PREVIEW()):e.showTitle=!0,e.showPrint=!1}))}),1e3)},pageBack:function(){this.$router.back()},fileDownLoad:function(){var e=this.$store.getters.sysBaseUrl+"/downLoad/CLodop_Setup_for_Win32NT.exe";window.open(e)}}},h=m,f=(a("b5d4"),a("2877")),b=Object(f["a"])(h,r,o,!1,null,"2db5cd3d",null);t["default"]=b.exports},e8a9:function(e,t,a){},eab1:function(e,t,a){},eb74:function(e,t,a){"use strict";a("1735")},eb76:function(e,t,a){},ecac:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6,xs:24}},[a("el-card",{staticClass:"box-card",staticStyle:{height:"550px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("个人信息")])]),a("div",[a("div",{staticClass:"text-center"},[a("userAvatar",{attrs:{user:e.user}})],1),a("ul",{staticClass:"list-group list-group-striped"},[a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"user"}}),e._v("员工工号\n              "),a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.empCode))])],1),a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"user"}}),e._v("员工姓名\n              "),a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.empName))])],1),a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"user"}}),e._v("登录账号\n              "),a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.username))])],1),a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"phone"}}),e._v("手机号码\n              "),a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.phonenumber))])],1),a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"email"}}),e._v("个人邮箱\n              "),a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.email))])],1),a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"tree"}}),e._v("所属部门\n              "),e.user.deptName?a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.deptName)+" ")]):e._e()],1),a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"peoples"}}),e._v("所属岗位\n              "),a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.postNames?e.user.postNames:""))])],1),a("li",{staticClass:"list-group-item"},[a("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"date"}}),e._v("创建日期\n              "),a("div",{staticClass:"pull-right"},[e._v(e._s(e.user.createTime))])],1)])])])],1),a("el-col",{attrs:{span:18,xs:24}},[a("el-card",{staticStyle:{height:"550px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("修改信息")])]),a("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"修改手机号",name:"userinfo"}},[a("userInfo",{attrs:{user:e.user,"old-phone":e.user.phonenumber}})],1),a("el-tab-pane",{attrs:{label:"修改密码",name:"resetPwd"}},[a("resetPwd",{attrs:{user:e.user}})],1)],1)],1)],1)],1)],1)},o=[],s=a("88c9"),l=a("2dde"),n=a("3823"),i=a("c0c7"),c={name:"Profile",components:{userAvatar:s["default"],userInfo:l["default"],resetPwd:n["default"]},data:function(){return{user:{},roleGroup:{},postGroup:{},activeTab:"userinfo"}},created:function(){this.getUser()},methods:{getUser:function(){var e=this;Object(i["d"])(this.$store.getters.userInfo.userId).then((function(t){e.user=t.result.user,e.$set(e.user,"oldPhone",t.result.user.phonenumber)}))}}},d=c,u=a("2877"),p=Object(u["a"])(d,r,o,!1,null,null,null);t["default"]=p.exports},ed0f:function(e,t,a){"use strict";a("84c2")},ed89:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"报价单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.sampleData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无样品审核历史信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",fixed:"left",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handlePrint(t.row)}}},[e._v(" 标签打印")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.taskTitle+" 任务详情",visible:e.taskVisible,center:"",width:"70%",top:"5vh"},on:{"update:visible":function(t){e.taskVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("合同编号: "+e._s(e.taskForm.contCode))])]),a("el-col",{attrs:{span:12}},[a("span",[e._v("报价单号: "+e._s(e.taskForm.offerId))])])],1),a("table",{staticClass:"info-table-new",attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("项目名称:")]),a("td",[e._v(e._s(e.taskForm.projectName))]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托单位:")]),a("td",[e._v(e._s(e.taskForm.consignorName))])]),a("tr",[a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人:")]),a("td",[e._v(e._s(e.taskForm.consignorLinker)+" ")]),a("td",{staticStyle:{background:"#f5f5f5"}},[e._v("委托联系人方式:")]),a("td",[e._v(e._s(e.taskForm.consignorLinkerPhone))])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},[e._v("\n          工作要求:\n        ")])]),a("tr",[a("td",{staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{colspan:"4"}},e._l(e.factorData,(function(t,r){return a("el-row",{key:r},[a("el-col",{attrs:{span:24}},[e._v(e._s(t.secdClassName))]),e._l(t.factList,(function(t){return a("el-col",{key:t.id,attrs:{span:24}},[e._v("\n              "+e._s(t.factorPoint+"（"+t.dayCount+"*"+t.frequency+"）: ")+e._s(t.showFactName)+"\n            ")])}))],2)})),1)])])],1)],1)},o=[],s=(a("7514"),a("ac6a"),a("5df3"),a("f400"),a("47bc")),l=a("333d"),n={0:"待分配",1:"采样中",2:"已完成"},i={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"success"};return t[e]}},data:function(){return{SAMPLE_STATUS:n,sampleData:[],searchForm:{jobId:"",projectName:"",sampTaskStatus:"0",pageNumber:1,pageSize:50},total:0,taskTitle:"",taskVisible:!1,factorData:[],factorDetailData:[],factorOldDetailData:[],taskForm:{projectName:"",offerId:"",contCode:"",consignorName:"",consignorLinker:"",consignorLinkerPhone:""},sampleTaskVisible:!1,currentRow:{},multipleSelection:[],mergeData:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["o"](this.searchForm).then((function(t){200===t.code&&(e.sampleData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.taskTitle=e.projectName,this.taskForm=Object.assign({},e),s["w"](e.jobId).then((function(e){200===e.code&&e.result&&(t.factorData=t.doProcessData(e.result),t.taskVisible=!0)}))},doProcessData:function(e){var t=this,a=[];if(e.length>0){var r=new Map;e.forEach((function(e){var t=a.find((function(t){return t.secdClassName===e.secdClassName}));if(t||a.push({secdClassName:e.secdClassName,factList:[]}),r.get(e.secdClassName)){var o=r.get(e.secdClassName);o.push(e)}else{var s=[];s.push(e),r.set(e.secdClassName,s)}})),a&&a.forEach((function(e){var a=r.get(e.secdClassName),o=[];a&&(a.forEach((function(e){var a=o.find((function(t){return t.factorPoint===e.factorPoint&&t.frequency===e.frequency&&t.dayCount===e.dayCount?(t.showFactName=t.showFactName+","+e.factorName,t):null}));a||(t.$set(e,"showFactName",e.factorName),o.push(e))})),e.factList=o)}))}return a},handlePrint:function(e){this.$router.push("/sampleDetail/".concat(e.sampTaskId))}}},c=i,d=(a("cb8d"),a("847b"),a("89df"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"ca7352d4",null);t["default"]=u.exports},edd6:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:19}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"项目名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"项目名称"},model:{value:e.searchForm.projectName,callback:function(t){e.$set(e.searchForm,"projectName",t)},expression:"searchForm.projectName"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:5}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{attrs:{border:"",data:e.reportData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"reportCode",label:"报告编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{prop:"consignorName",label:"委托单位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"commitCheckTime",label:"提交审核时间",width:"160px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"185px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),r.reportMakeUserId===e.userId||e.checkPermission(["sqqzi"])?e._e():a("div",{staticClass:"erc-divider-vertical"}),r.reportMakeUserId===e.userId||e.checkPermission(["sqqzi"])?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r)}}},[e._v("审核")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v("\n            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleDownload(r)}}},[a("el-dropdown-item",[e._v("最新报告下载")])],1),a("el-link",{attrs:{underline:!1},on:{click:function(t){return e.handleOldDownload(r)}}},[a("el-dropdown-item",[e._v("原始报告下载")])],1)],1)],1)]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"报告审核",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=a("db72"),l=a("333d"),n=a("1c31"),i=a("2f62"),c=a("6724"),d=a("e350"),u={1:"未生成",2:"制作中",3:"待提交审批",4:"待审核",5:"待签发",6:"完成",7:"已驳回"},p={components:{Pagination:l["a"]},directives:{waves:c["a"]},filters:{statusQualityFilter:function(e){return e<3?"info":e<6?"":"6"===e?"success":"danger"}},data:function(){return{REPORT_STATUS:u,searchForm:{jobId:"",projectName:"",pageNumber:1,pageSize:10},total:0,reportData:[],approveVisible:!1,approveForm:{reportId:"",auditFlag:"1",remark:""},issueVisible:!1,issueForm:{reportId:"",auditFlag:"1",remark:""},basicForm:{cmaNumber:"",cnasNumber:"",tel:"",fax:"",address:"",website:"",postCode:"",logoImageId:"",watermarkImageId:""},basicRules:{cmaNumber:[{required:!0,message:"请录入CMA证书号",trigger:"blur"}],cnasNumber:[{required:!0,message:"请录入CNAS证书号",trigger:"blur"}],tel:[{required:!0,message:"请录入电话",trigger:"blur"}],fax:[{required:!0,message:"请录入传真",trigger:"blur"}],postCode:[{required:!0,message:"请录入邮政编码",trigger:"blur"}],website:[{required:!0,message:"请录入网址",trigger:"blur"}],address:[{required:!0,message:"请录入详细地址",trigger:"blur"}],logoImageId:[{required:!0,message:"请上传企业Logo图片",trigger:"blur"}],watermarkImageId:[{required:!0,message:"请上传报告水印图片",trigger:"blur"}]},logoImageList:[],waterImageList:[],dialogImageUrl:"",basicVisible:!1,dialogVisible:!1,logoFileList:[],waterFileList:[],uploadVisible:!1,uploadForm:{id:"",reportCode:"",reportFile:""},uploadRules:{reportFile:[{required:!0,message:"请上传报告信息",trigger:"blur"}]},fileList:[],hideLogoUploadEdit:!1,hideUploadEdit:!1,downloadLoading:!1}},computed:Object(s["a"])({},Object(i["b"])(["platformPositionId","userId"])),created:function(){this.handleSearch()},methods:{checkPermission:d["a"],handleSearch:function(){var e=this;n["b"](this.searchForm).then((function(t){200===t.code&&t.result&&(e.reportData=t.result.records||[],e.total=t.result.total)}))},handleDetail:function(e){var t=e.reportCode+".pdf";this.$router.push({name:"sysPdfView",params:{path:t,type:2}})},handleDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportFileId;window.open(t)},handleOldDownload:function(e){var t=this.$store.getters.sysBaseUrl+"/file/report/"+e.reportCode+".docx";window.open(t)},handleApprove:function(e){this.approveForm.reportId=e.reportId,this.approveForm.auditFlag="1",this.approveForm.remark="",this.approveVisible=!0},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["g"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.approveVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},m=p,h=(a("5def"),a("2877")),f=Object(h["a"])(m,r,o,!1,null,"72282f1b",null);t["default"]=f.exports},edea:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",{attrs:{label:"任务状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"请选择状态"},model:{value:e.searchForm.checkTaskStatus,callback:function(t){e.$set(e.searchForm,"checkTaskStatus",t)},expression:"searchForm.checkTaskStatus"}},e._l(Object.keys(e.FACTOR_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.FACTOR_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.factorData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无信息\n            ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"checkFactorCount",label:"检测因子数",align:"center"}}),a("el-table-column",{attrs:{label:"任务时间",align:"center",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.startDate)+"~"+e._s(a.endDate)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"checkTaskStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{effect:"dark",type:e._f("statusQualityFilter")(r.checkTaskStatus)}},[e._v("\n            "+e._s(e.FACTOR_STATUS[r.checkTaskStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{label:"检测进度",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.completeCheckFactorCount)+"/"+e._s(a.checkFactorCount)+"\n        ")]}}])},[a("template",{slot:"header"},[e._v("\n          检测进度 "),a("i",{staticClass:"el-input__icon "}),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"该任务经实验室负责人审核通过的样品数/该任务采集的总样品数"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1)],1)],2),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleSampleInfo(t.row)}}},[e._v(" 因子列表")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1)],1)},o=[],s=a("15d4"),l=a("333d"),n={1:"未完成",2:"已完成"},i={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){var t={1:"",2:"success"};return t[e]}},data:function(){return{FACTOR_STATUS:n,factorData:[],searchForm:{jobId:"",checkTaskStatus:"",pageNumber:1,pageSize:10},total:0}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;s["g"](this.searchForm).then((function(t){200===t.code&&(e.factorData=t.result.records,e.total=t.result.total)}))},handleSampleInfo:function(e){this.$router.push("/other/laboratorTask/".concat(e.checkTaskId))}}},c=i,d=(a("1feb"),a("13b6"),a("690f"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"4dcdd279",null);t["default"]=u.exports},ef67:function(e,t,a){},efb0:function(e,t,a){},efe3:function(e,t,a){},efeb:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待分配任务",name:"1"}},[a("laborTaskList")],1),a("el-tab-pane",{attrs:{label:"已分配任务",name:"2"}},[a("hisLaborTask")],1)],1)],1)},o=[],s=a("18f5"),l=a("3c3c"),n={components:{laborTaskList:s["default"],hisLaborTask:l["default"]},data:function(){return{activeName:"1"}},methods:{handleClick:function(){}}},i=n,c=a("2877"),d=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=d.exports},f0c6:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"工号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"员工工号"},model:{value:e.searchForm.empCode,callback:function(t){e.$set(e.searchForm,"empCode",t)},expression:"searchForm.empCode"}})],1),a("el-form-item",{attrs:{label:"名称:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"员工名称"},model:{value:e.searchForm.empName,callback:function(t){e.$set(e.searchForm,"empName",t)},expression:"searchForm.empName"}})],1),a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"账号状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(Object.keys(e.ACCOUNT_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.ACCOUNT_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.userData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无用户,\n            ")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"small"},on:{click:e.handleCreate}},[e._v("新建用户信息")])],1)])]),a("el-table-column",{attrs:{type:"index",width:"55",label:"序号",align:"center"}}),a("el-table-column",{attrs:{prop:"empCode",label:"员工工号",align:"center"}}),a("el-table-column",{attrs:{prop:"username",label:"登录账号",align:"center"}}),a("el-table-column",{attrs:{prop:"empName",label:"员工名称",align:"center"}}),a("el-table-column",{attrs:{prop:"deptName",label:"部门/角色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.deptName)+e._s(a.platformPositionName?"/"+a.platformPositionName:"")+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"兼职",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.positionNames)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"phone",label:"绑定手机号1",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"账号状态",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"0"===r.status?"success":"danger"}},[e._v(e._s("0"===r.status?"有效":"停用"))])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          asd\n          "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v(" 编辑")]),"-1"!==t.row.deptId?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"-1"!==t.row.deptId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleRelation(t.row)}}},[e._v(" 兼职")]):e._e(),"-1"!==t.row.deptId?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"-1"!==t.row.deptId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row.userId)}}},[e._v(" 离职注销")]):e._e(),"-1"!==t.row.deptId?a("div",{staticClass:"erc-divider-vertical"}):e._e(),"-1"!==t.row.deptId?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleResetPwd(t.row.userId)}}},[e._v(" 重置密码")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.titleMap[e.userDialogStatus],visible:e.userDialogVisible,width:"50%"},on:{"update:visible":function(t){e.userDialogVisible=t}}},[a("div",{staticStyle:{width:"550px",margin:"0 auto"}},[a("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules,"label-width":"140px"}},[a("el-form-item",{attrs:{prop:"empCode",label:"员工工号:"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"员工工号",maxlength:"15"},model:{value:e.userForm.empCode,callback:function(t){e.$set(e.userForm,"empCode",t)},expression:"userForm.empCode"}})],1),a("el-form-item",{attrs:{prop:"empName",label:"姓名:"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"用户姓名",maxlength:"15"},model:{value:e.userForm.empName,callback:function(t){e.$set(e.userForm,"empName",t)},expression:"userForm.empName"}})],1),a("el-form-item",{attrs:{prop:"deptId",label:"部门:"}},[a("el-select",{staticStyle:{width:"70%"},attrs:{filterable:"",placeholder:"主部门选择"},on:{change:e.handleChange},model:{value:e.userForm.deptId,callback:function(t){e.$set(e.userForm,"deptId",t)},expression:"userForm.deptId"}},e._l(e.deptArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.deptName,value:e.id}})})),1)],1),a("el-form-item",{attrs:{prop:"platformPositionId",label:"岗位:"}},[a("el-select",{staticStyle:{width:"70%"},attrs:{filterable:"",placeholder:"岗位选择"},model:{value:e.userForm.platformPositionId,callback:function(t){e.$set(e.userForm,"platformPositionId",t)},expression:"userForm.platformPositionId"}},e._l(Object.keys(e.postionArray),(function(t){return a("el-option",{key:t,attrs:{label:e.postionArray[t],value:t}})})),1)],1),a("el-form-item",{attrs:{prop:"phone",label:"手机号:"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"手机号",maxlength:"11"},model:{value:e.userForm.phone,callback:function(t){e.$set(e.userForm,"phone",t)},expression:"userForm.phone"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.userDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"兼职岗位信息",visible:e.postionVisible},on:{"update:visible":function(t){e.postionVisible=t}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"岗位:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{disabled:""},model:{value:e.currentRow.platformPositionName,callback:function(t){e.$set(e.currentRow,"platformPositionName",t)},expression:"currentRow.platformPositionName"}})],1),a("el-form-item",{attrs:{label:"兼职岗位:"}},[e.chosePosition&&e.chosePosition.length>0?e._l(e.chosePosition,(function(t){return a("el-tag",{key:t.platformPositionId,staticStyle:{margin:"2px 3px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t)}}},[e._v("\n            "+e._s(t.platformDeptName)+"\n          ")])})):e._e()],2),a("el-form-item",{attrs:{label:"岗位选择:"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-select",{staticStyle:{width:"98%"},attrs:{clearable:"",filterable:"",placeholder:"部门选择"},on:{change:e.handleDepartChange},model:{value:e.otherDeptId,callback:function(t){e.otherDeptId=t},expression:"otherDeptId"}},e._l(e.deptArray,(function(e){return a("el-option",{key:e.id,attrs:{label:e.deptName,value:e.id}})})),1)],1),a("el-col",{attrs:{span:6}},[a("el-select",{staticStyle:{width:"98%"},attrs:{clearable:"",filterable:"",placeholder:"请选择角色"},on:{change:e.handlePosChange},model:{value:e.otherPostId,callback:function(t){e.otherPostId=t},expression:"otherPostId"}},e._l(Object.keys(e.otherPositArray),(function(t){return a("el-option",{key:t,attrs:{label:e.otherPositArray[t],value:t}})})),1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.postionVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmOtherDialog}},[e._v("确认")])],1)],1)],1)},o=[],s=(a("ac6a"),a("28a5"),a("7514"),a("c24f")),l=a("fe05"),n=a("333d"),i=a("61f7"),c={0:"有效",1:"无效"},d={name:"UserList",components:{Pagination:n["a"]},data:function(){var e=function(e,t,a){t&&t.length>0?Object(i["d"])(t)?a():a(new Error("输入正确的电话号码")):a()};return{ACCOUNT_STATUS:c,userData:[],searchForm:{empCode:"",empName:"",deptId:"",status:"",pageNumber:1,pageSize:10},total:0,titleMap:{edit:"修改用户",create:"新增用户"},userForm:{empCode:"",userId:"",deptId:"",empName:"",platformPositionId:"",phone:""},userRules:{phone:[{required:!0,message:"请录入联系方式",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}],empName:[{required:!0,message:"请录入姓名信息",trigger:"blur"}],empCode:[{required:!0,message:"请录入员工编号",trigger:"blur"}],deptId:[{required:!0,message:"请选择部门",trigger:"change"}],platformPositionId:[{required:!0,message:"请选择岗位",trigger:"change"}]},userDialogStatus:"create",userDialogVisible:!1,deptArray:[],currentRow:{},postionVisible:!1,chosePosition:[],postionArray:{},otherPositArray:{},otherDeptId:"",otherPostId:""}},created:function(){this.getDeptTreeList(),this.handleSearch()},methods:{getDeptTreeList:function(){var e=this;l["getDeptList"]().then((function(t){e.deptArray=t.result||[]}))},handleSearch:function(){var e=this;s["e"](this.searchForm).then((function(t){200===t.code&&(e.userData=t.result.records||[],e.total=t.result.total)}))},handleCreate:function(){this.clearForm(),this.userDialogStatus="create",this.userDialogVisible=!0,void 0!==this.$refs.userForm&&this.$refs.userForm.resetFields()},handleUpdate:function(e){void 0!==this.$refs.userForm&&this.$refs.userForm.resetFields(),this.userForm.userId=e.id,this.userForm.empCode=e.empCode,this.userForm.empName=e.empName||"",this.userForm.deptId=e.deptId||"",this.userForm.phone=e.phone||"",this.handleChange(e.deptId),this.userForm.platformPositionId=e.platformPositionId||"",this.userDialogStatus="edit",this.userDialogVisible=!0},confirmDialog:function(){"create"===this.userDialogStatus?this.confirmCreate():this.confirmUpdate()},confirmOtherDialog:function(){var e=this;if(this.chosePosition&&this.chosePosition.length>0){var t={userId:this.currentRow.id,postIds:this.chosePosition.map((function(e){var t=e.deptId,a=e.platformPositionId;return{deptId:t,platformPositionId:a}}))};s["i"](t).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.postionVisible=!1):e.$notify({title:"失败",message:t.message,type:"error"})}))}else this.$message.warning("至少选择一个挂职的岗位")},confirmCreate:function(){var e=this;this.$refs.userForm.validate((function(t){if(!t)return!1;s["a"](e.userForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.userDialogVisible=!1,e.$refs.userForm.resetFields()})).catch((function(){}))}))},confirmUpdate:function(){var e=this;this.$refs.userForm.validate((function(t){if(!t)return!1;s["j"](e.userForm).then((function(t){e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch(),e.userDialogVisible=!1,e.$refs.userForm.resetFields()})).catch((function(){}))}))},handleDelete:function(e){var t=this;this.$confirm("确定注销?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["resetUser"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleResetPwd:function(e){var t=this;this.$confirm("确定重置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["resetUser"](e).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},clearForm:function(){this.userForm={userId:"",deptId:"",empCode:"",empName:"",platformPositionId:"",phone:""}},handleChange:function(e){var t=this;if(this.postionArray={},this.userForm.platformPositionId="",e){var a=this.deptArray.find((function(t){return t.id===e}));a&&l["dpfindPositionIdByDeptId"](a.platformDeptId).then((function(e){t.$nextTick((function(){t.postionArray=e.result||{}}))}))}},handleDepartChange:function(e){var t=this;if(this.otherPositArray={},this.otherPostId="",e){var a=this.deptArray.find((function(t){return t.id===e}));a&&l["dpfindPositionIdByDeptId"](a.platformDeptId).then((function(e){t.otherPositArray=e.result||{}}))}},handlePosChange:function(e){if(e){var t=this.chosePosition.find((function(t){return t.platformPositionId===e}));t||this.chosePosition.push({platformPositionId:e,deptId:this.otherDeptId,platformDeptName:this.otherPositArray[e]})}},handleRelation:function(e){var t=this;this.chosePosition=[],this.currentRow=Object.assign({},e);var a=[],r=[],o=[];if(e.positionNames&&e.positionNames.length>0){var s=e.positionNames.split(";"),l=e.positionIds.split(",");s&&s.length>0?(s.forEach((function(e){r.push(e.split("/")[0]),o.push(e.split("/")[1])})),a=l):(a.push(e.positionIds),r.push(e.positionNames.split("/")[0]),o.push(e.positionNames.split("/")[1])),a.forEach((function(e,a){var s={platformPositionId:e,deptId:t.getDepartIdForName(r[a]),platformDeptName:o[a]};t.chosePosition.push(s)}))}this.postionVisible=!0},getDepartIdForName:function(e){var t=this.deptArray.find((function(t){return t.deptName===e}));return t.id||""},handleClose:function(e){this.chosePosition.splice(this.chosePosition.indexOf(e),1)}}},u=d,p=(a("e18b"),a("2877")),m=Object(p["a"])(u,r,o,!1,null,"65bc7578",null);t["default"]=m.exports},f163:function(e,t,a){"use strict";a("e496")},f199:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.smapItemId,callback:function(t){e.$set(e.searchForm,"smapItemId",t)},expression:"searchForm.smapItemId"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleBatchApprove}},[e._v(" 批量审核")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkData,stripe:"",border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",width:"130",align:"center"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子","min-width":"200px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"200px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkRes",label:"检测结果","min-width":"160px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkRes&&r.checkRes.length>0?[e._v("\n          "+e._s(r.masterRes)+"\n          "),""!==r.exponRes&&0!==r.exponRes?[e._v("×10"),a("sup",[e._v(e._s(r.exponRes))])]:e._e(),e._v("\n          "+e._s(r.unitName&&"无量纲"!==r.unitName?" "+r.unitName:"")+"\n        ")]:void 0]}}])}),a("el-table-column",{attrs:{prop:"checkStatus",label:"状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.checkStatus)}},[e._v("\n          "+e._s(e.CHECK_STATUS[r.checkStatus])+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"assignUser",label:"分析员",align:"center"}}),a("el-table-column",{attrs:{prop:"collectTime",label:"采样时间",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.collectTime||a.collectDate?[e._v("\n          "+e._s(a.collectTime&&""!=a.collectTime?(a.collectDate?a.collectDate+" ":"")+a.collectTime:a.collectDate)+"\n        ")]:e._e()]}}])}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"endDate",label:"截止时间",width:"120px",align:"center"}}),a("el-table-column",{attrs:{label:"操作",width:"140px",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]),a("div",{staticClass:"erc-divider-vertical"}),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r)}}},[e._v(" 审核")])]}}])})],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"检测详情",visible:e.detailVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticStyle:{width:"800px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.sampleForm.sampleNo))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.sampleForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.sampleForm.standardName))]),a("el-form-item",{attrs:{label:"因子备注:"}},[e._v(e._s(e.sampleForm.factorRemark))]),a("el-form-item",{attrs:{label:"检测备注:"}},[e._v(e._s(e.sampleForm.remark))]),a("el-form-item",{attrs:{label:"检测结果:"}},[e.sampleForm.factorSubsetVos&&e.sampleForm.factorSubsetVos.length>0?[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sampleForm.factorSubsetVos,border:"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"factorName",label:"套餐因子",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v("\n                  "+e._s(r.factorName)+": "+e._s(r.factorInfo&&r.factorInfo.v1?r.factorInfo.v1:0)+"\n                  "),r.factorInfo&&""!==r.factorInfo.v2&&0!==r.factorInfo.v2?[e._v("\n                    ×10"),a("sup",[e._v(e._s(r.factorInfo.v2?Number(r.factorInfo.v2):0))])]:e._e(),e._v("\n                  "+e._s(r.unitName&&"无量纲"!==r.unitName&&null!=e.sampleForm.unitName?" "+r.unitName:"")+"\n                ")]}}],null,!1,1640266375)})],1)]:e.sampleForm.checkRes&&e.sampleForm.checkRes.length>0?[e._v("\n            "+e._s(e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v1?e.sampleForm.factorInfo.v1:0)+"\n            "),e.sampleForm.factorInfo&&""!==e.sampleForm.factorInfo.v2&&0!==e.sampleForm.factorInfo.v2?[e._v("\n              ×10"),a("sup",[e._v(e._s(e.sampleForm.factorInfo.v2?Number(e.sampleForm.factorInfo.v2):0))])]:e._e(),e._v("\n            "+e._s(e.sampleForm.unitName&&"无量纲"!==e.sampleForm.unitName&&null!=e.sampleForm.unitName?" "+e.sampleForm.unitName:"")+"\n          ")]:[e._v("暂无检测结果")]],2)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailVisible=!1}}},[e._v("关 闭")])],1)]),a("el-dialog",{attrs:{title:"检测结果审核",visible:e.approveVisible,center:""},on:{"update:visible":function(t){e.approveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.approveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.approveForm.auditFlag,callback:function(t){e.$set(e.approveForm,"auditFlag",t)},expression:"approveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.approveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.approveForm.auditReason,callback:function(t){e.$set(e.approveForm,"auditReason",t)},expression:"approveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确认")])],1)]),a("el-dialog",{attrs:{title:"检测结果审核",visible:e.batchApproveVisible,center:""},on:{"update:visible":function(t){e.batchApproveVisible=t}}},[a("div",{staticStyle:{width:"400px",margin:"0 auto"}},[a("el-form",{attrs:{model:e.batchApproveForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核结果:"}},[a("el-radio-group",{model:{value:e.batchApproveForm.auditFlag,callback:function(t){e.$set(e.batchApproveForm,"auditFlag",t)},expression:"batchApproveForm.auditFlag"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),a("el-radio",{attrs:{label:"2"}},[e._v("驳回")])],1)],1),"2"===e.batchApproveForm.auditFlag?a("el-form-item",{attrs:{label:"审核意见:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"审核意见"},model:{value:e.batchApproveForm.auditReason,callback:function(t){e.$set(e.batchApproveForm,"auditReason",t)},expression:"batchApproveForm.auditReason"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.batchApproveVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.batchConfirmDialog}},[e._v("确认")])],1)])],1)},o=[],s=(a("6b54"),a("ac6a"),a("db72")),l=a("15d4"),n=a("333d"),i={0:"待领样",1:"领样申请",2:"待检测",3:"已录入",4:"待审核",5:"审核通过",6:"审核失败"},c={components:{Pagination:n["a"]},filters:{statusQualityFilter:function(e){return"0"===e||"2"===e?"info":"1"===e||"3"===e||"4"===e?"":"5"===e?"success":"danger"}},data:function(){return{CHECK_STATUS:i,checkData:[],searchForm:{smapItemId:"",checkStatus:"4",pageNumber:1,pageSize:10},total:0,detailVisible:!1,sampleForm:{factorInfo:{},subFactors:{}},approveForm:{checkFactorId:"",auditFlag:"1",auditReason:""},approveVisible:!1,subSampleData:[],batchApproveVisible:!1,batchApproveForm:{checkFactorId:"",auditFlag:"1",auditReason:""},multipleSelection:[]}},created:function(){this.handleSearch()},methods:{handleSearch:function(){var e=this;l["f"](this.searchForm).then((function(t){200===t.code&&(e.checkData=t.result.records.map((function(t){if(t.checkRes&&""!==t.checkRes){var a=JSON.parse(t.checkRes);e.$set(t,"masterRes",a.v1?a.v1:0),e.$set(t,"exponRes",a.v2?a.v2:0)}else e.$set(t,"masterRes",0),e.$set(t,"exponRes",0);return t}))||[],e.total=t.result.total)}))},handleDetail:function(e){var t=this;if(this.sampleForm=Object(s["a"])({},e),e.factorSubsetVos&&e.factorSubsetVos.length>0&&this.sampleForm.factorSubsetVos.forEach((function(e){var a=JSON.parse(e.checkSubRes);t.$set(e,"factorInfo",a)})),e.checkRes&&e.checkRes.length>0){var a=JSON.parse(e.checkRes);this.$set(this.sampleForm,"factorInfo",a)}this.detailVisible=!0},handleApprove:function(e){this.approveForm.checkFactorId=e.checkFactorId,this.approveForm.auditFlag="1",this.approveForm.auditReason="",this.approveVisible=!0},batchConfirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["c"](e.batchApproveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.batchApproveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))},handleSelectionChange:function(e){this.multipleSelection=e},handleBatchApprove:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var e=this.multipleSelection.map((function(e){return e.checkFactorId}));this.batchApproveForm.checkFactorId=e.toString(),this.batchApproveForm.auditFlag="1",this.batchApproveForm.auditReason="",this.batchApproveVisible=!0}else this.$message.warning("至少选择一条记录进行审核")},confirmDialog:function(){var e=this;this.$confirm("确定提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["b"](e.approveForm).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.approveVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})).catch((function(){}))}}},d=c,u=(a("3204"),a("492b"),a("7bc4"),a("3de3"),a("2877")),p=Object(u["a"])(d,r,o,!1,null,"3b23d1a0",null);t["default"]=p.exports},f2c5:function(e,t,a){"use strict";a("745c")},f2c6:function(e,t,a){},f467:function(e,t,a){"use strict";a("70e3")},f564:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return d}));var r=a("b775");function o(e){return Object(r["a"])({url:"/equipment/findByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/equipment/add",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/equipment/updateById",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/equipment/removeById/".concat(e),method:"delete"})}function i(){return Object(r["a"])({url:"/equipment/findEquipmentFirstType",method:"get"})}function c(e){return Object(r["a"])({url:"/equipment/findEquipmentSecondType/".concat(e),method:"get"})}function d(){return Object(r["a"])({url:"/equipment/laboratoryEquipmentTree",method:"get"})}},f608:function(e,t,a){"use strict";a("6f52")},f6b0:function(e,t,a){"use strict";a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return c}));var r=a("b775");function o(e){return Object(r["a"])({url:"/cus/contract/findByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/cus/contract/addCusContBase",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/cus/contract/modifyCusContBaseById",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/cus/contract/removeById/".concat(e),method:"delete"})}function i(e){return Object(r["a"])({url:"/cus/contract/fuzzyQuery/".concat(e),method:"get"})}function c(e){return Object(r["a"])({url:"/cus/contract/findById/".concat(e),method:"get"})}},f76a:function(e,t,a){"use strict";a("5837")},f858:function(e,t,a){"use strict";a.d(t,"h",(function(){return o})),a.d(t,"k",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"d",(function(){return n})),a.d(t,"f",(function(){return i})),a.d(t,"j",(function(){return c})),a.d(t,"i",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"e",(function(){return h}));var r=a("b775");function o(e){return Object(r["a"])({url:"/factor/findCheckStandardsByCondition",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/factor/modifyCheckStandardById",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/factor/group/findPageByCondition",method:"get",params:e})}function n(){return Object(r["a"])({url:"/factor/group/findFreeFactorGroup",method:"get"})}function i(){return Object(r["a"])({url:"/factor/group/findHomFactorGroup",method:"get"})}function c(e){return Object(r["a"])({url:"/factor/group/saveFactorGroup",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/factor/group/modifyFactorGroupByGroupId",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/factor/group/delByGroupId/".concat(e),method:"get"})}function p(e){return Object(r["a"])({url:"/factor/group/copyByGroupId/".concat(e),method:"get"})}function m(e){return Object(r["a"])({url:"/factor/group/findCheckStandardsByGroupId/".concat(e),method:"get"})}function h(){return Object(r["a"])({url:"/factor/group/findList",method:"get"})}},f8c3:function(e,t,a){},f8e1:function(e,t,a){"use strict";a("96e9")},f9c0:function(e,t,a){"use strict";a("d430")},fa10:function(e,t,a){"use strict";a("1c91")},fbd7:function(e,t,a){},fc5a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampItemId,callback:function(t){e.$set(e.searchForm,"sampItemId",t)},expression:"searchForm.sampItemId"}})],1),a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"任务单号"},model:{value:e.searchForm.jobId,callback:function(t){e.$set(e.searchForm,"jobId",t)},expression:"searchForm.jobId"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.outStockLoading,expression:"outStockLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.handleBatchOutStock}},[e._v(" 批量出库")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.stockData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":e.handleSelectionChange}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{type:"index",width:"50",label:"序号",fixed:"left",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",fixed:"left","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样员",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",width:"100px",align:"center"}}),a("el-table-column",{attrs:{label:"样品状态",align:"center"}},[[a("el-tag",{attrs:{type:""}},[e._v("待出库")])]],2),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v(" 查看")]),t.row.collectUser&&t.row.collectUser.length>0?a("div",{staticClass:"erc-divider-vertical"}):e._e(),t.row.collectUser&&t.row.collectUser.length>0?a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.outStockLoading,expression:"outStockLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"text"},on:{click:function(a){return e.handleOutStock(t.row)}}},[e._v(" 出库")]):e._e()]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"80%",center:""},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleForm,"label-width":"90px"}},[a("el-divider",[e._v("样品基础信息")]),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"检测因子:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.factorName,callback:function(t){e.$set(e.sampleForm,"factorName",t)},expression:"sampleForm.factorName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"样品性状:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.sampleProperties,callback:function(t){e.$set(e.sampleForm,"sampleProperties",t)},expression:"sampleForm.sampleProperties"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"样品固定剂:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.sampleFixative,callback:function(t){e.$set(e.sampleForm,"sampleFixative",t)},expression:"sampleForm.sampleFixative"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"录样位置:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.collectLocation,callback:function(t){e.$set(e.sampleForm,"collectLocation",t)},expression:"sampleForm.collectLocation"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"采样时间:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.collectTime,callback:function(t){e.$set(e.sampleForm,"collectTime",t)},expression:"sampleForm.collectTime"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"送样员:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.sendUser,callback:function(t){e.$set(e.sampleForm,"sendUser",t)},expression:"sampleForm.sendUser"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"采样备注:"}},[a("el-input",{staticStyle:{width:"98%"},attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",disabled:""},model:{value:e.sampleForm.collectRemark,callback:function(t){e.$set(e.sampleForm,"collectRemark",t)},expression:"sampleForm.collectRemark"}})],1)],1)],1),a("el-divider",[e._v("库存信息")]),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"库存位置:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.storeLocation,callback:function(t){e.$set(e.sampleForm,"storeLocation",t)},expression:"sampleForm.storeLocation"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"入库时间:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.storeTime,callback:function(t){e.$set(e.sampleForm,"storeTime",t)},expression:"sampleForm.storeTime"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"可领次数:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.avalDrawCount,callback:function(t){e.$set(e.sampleForm,"avalDrawCount",t)},expression:"sampleForm.avalDrawCount"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"已领次数:"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{disabled:""},model:{value:e.sampleForm.drawCount,callback:function(t){e.$set(e.sampleForm,"drawCount",t)},expression:"sampleForm.drawCount"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},o=[],s=(a("6b54"),a("d43b")),l=a("333d"),n=a("4328"),i=a.n(n),c={0:"草稿",1:"待审核",2:"审核驳回",3:"审核通过",4:"审核通过",5:"审核通过",6:"审核通过"},d={0:"单次",1:"周",2:"月",3:"季度",4:"半年",5:"年"},u={components:{Pagination:l["a"]},filters:{statusQualityFilter:function(e){var t={0:"info",1:"",2:"danger",3:"success"};return t[e]}},data:function(){return{ACCOUNT_STATUS:c,CHECK_STATUS:d,stockData:[],searchForm:{jobId:"",sampItemId:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleForm:{collectUser:"",sampleProperties:"",sampleFixative:"",collectRemark:"",collectLocation:"",collectIamge1:"",collectIamge2:"",collectIamge3:"",collectIamge4:"",factorName:""},currentSample:"",approveForm:{sampItemId:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],factorVisible:!1,outStockLoading:!1,multipleSelection:[]}},created:function(){this.outStockLoading=!1,this.handleSearch()},methods:{handleSearch:function(){var e=this;s["e"](this.searchForm).then((function(t){200===t.code&&(e.stockData=t.result.records,e.total=t.result.total)}))},handleDetail:function(e){var t=this;this.currentSample=e.sampleNo,s["h"](e.sampItemId).then((function(e){200===e.code&&(t.sampleForm=e.result||{}),t.sampleVisible=!0}))},handleBatchOutStock:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var e=this.multipleSelection.map((function(e){return e.drawApplyId})),t={drawApplyId:e.toString()};this.handleOutStock(t)}else this.$message.warning("至少选择一条记录")},handleSelectionChange:function(e){this.multipleSelection=e},handleOutStock:function(e){var t=this;this.$confirm("确定出库?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.outStockLoading=!0,s["b"](i.a.stringify({drawApplyId:e.drawApplyId})).then((function(e){t.outStockLoading=!1,200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){t.outStockLoading=!1}))}}},p=u,m=(a("f76a"),a("7c1a"),a("59e0"),a("2877")),h=Object(m["a"])(p,r,o,!1,null,"29b0cfac",null);t["default"]=h.exports},fc70:function(e,t,a){"use strict";a("d4a9")},fce3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"样品编号:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.smapItemId,callback:function(t){e.$set(e.searchForm,"smapItemId",t)},expression:"searchForm.smapItemId"}})],1),a("el-form-item",{attrs:{label:"检测因子:"}},[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"因子名称"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",{attrs:{label:"检测状态:"}},[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"检测状态"},model:{value:e.searchForm.checkStatus,callback:function(t){e.$set(e.searchForm,"checkStatus",t)},expression:"searchForm.checkStatus"}},e._l(Object.keys(e.CHECK_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.CHECK_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:"primary"},on:{click:e.goBack}},[e._v(" 返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkData,stripe:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无信息\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",width:"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",width:"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准",width:"200px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkRes",label:"检测结果","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkRes&&r.checkRes.length>0?[e._v("\n          "+e._s(r.masterRes)+"\n          "),""!==r.exponRes&&0!==r.exponRes?[e._v("×10"),a("sup",[e._v(e._s(r.exponRes))])]:e._e(),e._v("\n          "+e._s(r.unitName&&"无量纲"!==r.unitName?" "+r.unitName:"")+"\n        ")]:void 0]}}])}),a("el-table-column",{attrs:{prop:"assignUser",label:"分析员",align:"center"}}),a("el-table-column",{attrs:{prop:"collectTime",label:"采样时间",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.collectTime&&a.collectTime.length>0?a.collectTime:a.collectDate)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"endDate",label:"任务截止时间",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"dataEntryStep",label:"样品归类",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.sampleType?"danger":""}},[e._v("\n          "+e._s("1"===r.sampleType?"样品分包":"样品自检")+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"checkStatus",label:"检测状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.checkStatus)}},[e._v("\n          "+e._s(e.CHECK_STATUS[r.checkStatus])+"\n        ")])]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"190",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkStatus>2?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]):e._e(),r.checkStatus>2?a("div",{staticClass:"erc-divider-vertical"}):e._e(),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleLocalDetail(r)}}},[e._v("采样记录")]),r.assignUserId===e.userId&&"0"===r.checkStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"0"===r.checkStatus&&"噪声"!==r.secdClassName?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApply(r)}}},[e._v("申请领样")]):e._e(),r.assignUserId!==e.userId||"2"!==r.checkStatus&&"6"!==r.checkStatus?e._e():a("div",{staticClass:"erc-divider-vertical"}),r.assignUserId!==e.userId||"2"!==r.checkStatus&&"6"!==r.checkStatus?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSetResult(r)}}},[e._v("结果录入")]),r.assignUserId===e.userId&&"3"===r.checkStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"3"===r.checkStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r.checkFactorId)}}},[e._v("提交审核")]):e._e()]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"检测详情",visible:e.detailVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticStyle:{width:"700px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.sampleForm.smapItemId))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.sampleForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.sampleForm.standardName))]),a("el-form-item",{attrs:{label:"备注:"}},[e._v(e._s(e.sampleForm.remark))]),a("el-form-item",{attrs:{label:"检测结果:"}},[e.sampleForm.checkRes&&e.sampleForm.checkRes.length>0?[e._v("\n            "+e._s(e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v1?e.sampleForm.factorInfo.v1:0)+"\n            "),e.sampleForm.factorInfo&&""!==e.sampleForm.factorInfo.v2&&0!==e.sampleForm.factorInfo.v2?[e._v("\n              ×10"),a("sup",[e._v(e._s(e.sampleForm.factorInfo.v2?Number(e.sampleForm.factorInfo.v2):0))])]:e._e(),e._v("\n            "+e._s(e.sampleForm.unitName&&"无量纲"!==e.sampleForm.unitName?" "+e.sampleForm.unitName:"")+"\n          ")]:[e._v("暂无检测结果")]],2)],1),e.sampleForm.subFactors&&e.sampleForm.subFactors.length>0?a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sampleForm.subFactors,border:"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"name",label:"检测因子",width:"130",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.v1?[e._v("\n                "+e._s(r.v1?r.v1:0)+"×10"),a("sup",[e._v(e._s(r.v2?Number(r.v2):0))]),e._v(e._s(e.sampleForm.unitName)+"\n              ")]:e._e()]}}],null,!1,1464253952)})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailVisible=!1}}},[e._v("关 闭")])],1)]),a("el-dialog",{attrs:{title:"样品结果录入",visible:e.testResultVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.testResultVisible=t}}},[a("div",{staticStyle:{width:"650px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.testResultForm.smapItemId))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.testResultForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.testResultForm.standardName))]),a("el-form-item",{attrs:{label:"检测结果:"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"结果值",oninput:"value=value.replace(/[^\\d\\.]/g,'')"},model:{value:e.testResultForm.masterRes,callback:function(t){e.$set(e.testResultForm,"masterRes",t)},expression:"testResultForm.masterRes"}},[a("template",{slot:"append"},[e._v("E")])],2)],1),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"幂数",oninput:"value=value.replace(/[^\\d\\-]/g, '')"},model:{value:e.testResultForm.subRes,callback:function(t){e.$set(e.testResultForm,"subRes",t)},expression:"testResultForm.subRes"}},[a("template",{slot:"append"},[e._v(e._s(e.testResultForm.unitName))])],2)],1)],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("例:3.45E2=3.45×10²  ;  234E0=234 ; 1.62E-3=1.62×10⁻³")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("无子因子的：输入0代表未检出")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("有子因子的：输入0代表未检出，不填代表未检查此项")])])],1)],1),a("el-form-item",{attrs:{label:"备注:"}},[a("el-input",{attrs:{type:"textarea",maxlength:"50","show-word-limit":"",placeholder:"备注信息",rows:3},model:{value:e.testResultForm.remark,callback:function(t){e.$set(e.testResultForm,"remark",t)},expression:"testResultForm.remark"}})],1)],1),e.subFactorData&&e.subFactorData.length>0?a("div",[a("el-table",{attrs:{data:e.subFactorData,border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"name",label:"检测因子",width:"130",align:"center"}}),a("el-table-column",{attrs:{label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"结果值",oninput:"value=value.replace(/[^\\d\\.]/g,'')"},model:{value:r.v1,callback:function(t){e.$set(r,"v1",t)},expression:"row.v1"}},[a("template",{slot:"append"},[e._v("E")])],2)],1),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"幂数",oninput:"value=value.replace(/[^\\d\\-]/g,'')"},model:{value:r.v2,callback:function(t){e.$set(r,"v2",t)},expression:"row.v2"}},[a("template",{slot:"append"},[e._v(e._s(e.testResultForm.unitName))])],2)],1)],1)]}}],null,!1,2990782521)})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.testResultVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChecks}},[e._v("保存")])],1)]),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},o=[],s=a("db72"),l=a("2f62"),n=a("d43b"),i=a("15d4"),c=a("333d"),d=a("4328"),u=a.n(d),p={0:"待领样",1:"领样已申请",2:"待检测",3:"已录入",4:"待审核",5:"审核通过",6:"审核失败"},m={components:{Pagination:c["a"]},filters:{statusQualityFilter:function(e){return"0"===e?"info":"2"===e||"1"===e||"4"===e?"":"3"===e||"5"===e?"success":"danger"}},data:function(){return{CHECK_STATUS:p,checkData:[],searchForm:{smapItemId:"",factorName:"",checkStatus:"",pageNumber:1,pageSize:10},total:0,detailVisible:!1,sampleForm:{factorInfo:{},subFactors:{}},subSampleData:[],testResultVisible:!1,testResultForm:{checkFactorId:"",checkRes:"",checkSubRes:"",remark:""},subFactorData:[],sampleVisible:!1,sampleDetails:[],sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",sampleImageList:[],sampleImage:"",sampleDataInfo:[],sampleSecInfo:[]}},computed:Object(s["a"])({},Object(l["b"])(["userId"])),created:function(){this.$route.params.checkTaskId&&(this.searchForm.checkTaskId=this.$route.params.checkTaskId,this.handleSearch())},methods:{handleSearch:function(){var e=this;this.searchForm.checkTaskId&&i["findCheckTaskDetailByCondition"](this.searchForm).then((function(t){200===t.code&&(e.checkData=t.result.records.map((function(t){if(t.checkRes&&""!==t.checkRes){var a=JSON.parse(t.checkRes);e.$set(t,"masterRes",a.v1?a.v1:""),e.$set(t,"exponRes",a.v2?a.v2:"")}else e.$set(t,"masterRes",""),e.$set(t,"exponRes","");return t}))||[],e.total=t.result.total)}))},handleDetail:function(e){if(this.sampleForm=Object(s["a"])({},e),e.checkSubRes&&e.checkSubRes.length>0){var t=JSON.parse(e.checkSubRes);this.$set(this.sampleForm,"subFactors",t)}if(e.checkRes&&e.checkRes.length>0){var a=JSON.parse(e.checkRes);this.$set(this.sampleForm,"factorInfo",a)}this.detailVisible=!0},handleLocalDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";n["g"](e.smapItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep&&!e.checkStandardId.indexOf("100004-")>-1}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleApply:function(e){var t=this;this.$confirm("确定申请领样?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["q"](u.a.stringify({checkFactorId:e.checkFactorId})).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleSetResult:function(e){var t=this;this.testResultForm=Object(s["a"])({},e),i["m"](e.checkStandardId).then((function(e){t.subFactorData=[],200===e.code&&e.result&&(t.subFactorData=e.result.map((function(e){return{name:e,v1:"",v2:""}}))||[]),t.testResultVisible=!0}))},handleApprove:function(e){var t=this;this.$confirm("确认提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["s"]({checkFactorId:e}).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))}))},confirmChecks:function(){var e=this;this.$confirm("确认提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t;t=e.subFactorData&&e.subFactorData.length>0?{checkFactorId:e.testResultForm.checkFactorId,checkRes:JSON.stringify({v1:e.testResultForm.masterRes,v2:e.testResultForm.subRes}),checkSubRes:JSON.stringify(e.subFactorData),remark:e.testResultForm.remark}:{checkFactorId:e.testResultForm.checkFactorId,checkRes:JSON.stringify({v1:e.testResultForm.masterRes,v2:e.testResultForm.subRes}),remark:e.testResultForm.remark},i["r"](t).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.testResultVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))}))},goBack:function(){this.$router.back()}}},h=m,f=(a("d471"),a("2877")),b=Object(f["a"])(h,r,o,!1,null,"5a1b7b12",null);t["default"]=b.exports},fd90:function(e,t,a){"use strict";a("8e68")},fd95:function(e,t,a){"use strict";a("2740")},fdde:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-continer"},[a("el-form",{attrs:{model:e.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"样品编号"},model:{value:e.searchForm.sampleNo,callback:function(t){e.$set(e.searchForm,"sampleNo",t)},expression:"searchForm.sampleNo"}})],1),a("el-form-item",[a("el-input",{staticStyle:{width:"165px"},attrs:{placeholder:"因子名称"},model:{value:e.searchForm.factorName,callback:function(t){e.$set(e.searchForm,"factorName",t)},expression:"searchForm.factorName"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"165px"},attrs:{clearable:"",filterable:"",placeholder:"检测状态"},model:{value:e.searchForm.checkStatus,callback:function(t){e.$set(e.searchForm,"checkStatus",t)},expression:"searchForm.checkStatus"}},e._l(Object.keys(e.CHECK_STATUS),(function(t){return a("el-option",{key:t,attrs:{label:e.CHECK_STATUS[t],value:t}})})),1)],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v(" 查询")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:"primary"},on:{click:e.goBack}},[e._v(" 返回")]),a("el-button",{attrs:{type:"primary"},on:{click:e.batchApply}},[e._v("一键申请领样")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleSearch}},[e._v("刷新")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkData,stripe:"",border:"","highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[e._v("\n            暂无信息\n          ")])])])]),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"factorName",label:"检测因子",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",width:"160px",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位",width:"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"dayAndCount",label:"频次(次/天)",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"standardName",label:"检测标准","min-width":"220px",align:"center"}}),a("el-table-column",{attrs:{prop:"checkRes",label:"检测结果","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkRes&&r.checkRes.length>0?[e._v("\n          "+e._s(r.masterRes)+"\n          "),""!==r.exponRes&&0!==r.exponRes?[e._v("×10"),a("sup",[e._v(e._s(r.exponRes))])]:e._e(),e._v("\n          "+e._s(r.unitName&&"无量纲"!==r.unitName?" "+r.unitName:"")+"\n        ")]:void 0]}}])}),a("el-table-column",{attrs:{prop:"assignUser",label:"分析员",align:"center"}}),a("el-table-column",{attrs:{prop:"collectTime",label:"采样时间",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.collectTime||a.collectDate?[e._v("\n          "+e._s(a.collectTime&&""!=a.collectTime?(a.collectDate?a.collectDate+" ":"")+a.collectTime:a.collectDate)+"\n        ")]:e._e()]}}])}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{prop:"dataEntryStep",label:"样品归类",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:"1"===r.sampleType?"danger":""}},[e._v("\n          "+e._s("1"===r.sampleType?"样品分包":"样品自检")+"\n        ")])]}}])}),a("el-table-column",{attrs:{prop:"checkStatus",label:"检测状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-tag",{attrs:{type:e._f("statusQualityFilter")(r.checkStatus)}},[e._v("\n          "+e._s(e.CHECK_STATUS[r.checkStatus])+"\n        ")])]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"190",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.checkStatus>2?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDetail(r)}}},[e._v("查看")]):e._e(),r.checkStatus>2?a("div",{staticClass:"erc-divider-vertical"}):e._e(),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleLocalDetail(r)}}},[e._v("采样记录")]),r.assignUserId===e.userId&&"0"===r.checkStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"0"===r.checkStatus&&"噪声"!==r.secdClassName?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApply(r)}}},[e._v("申请领样")]):e._e(),r.assignUserId!==e.userId||"2"!==r.checkStatus&&"6"!==r.checkStatus?e._e():a("div",{staticClass:"erc-divider-vertical"}),r.assignUserId!==e.userId||"2"!==r.checkStatus&&"3"!==r.checkStatus&&"6"!==r.checkStatus?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleSetResult(r)}}},[e._v("结果录入")]),r.assignUserId===e.userId&&"3"===r.checkStatus?a("div",{staticClass:"erc-divider-vertical"}):e._e(),r.assignUserId===e.userId&&"3"===r.checkStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleApprove(r.checkFactorId)}}},[e._v("提交审核")]):e._e()]}}])})],2),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.searchForm.pageNumber,limit:e.searchForm.pageSize},on:{"update:page":function(t){return e.$set(e.searchForm,"pageNumber",t)},"update:limit":function(t){return e.$set(e.searchForm,"pageSize",t)},pagination:e.handleSearch}})],1),a("el-dialog",{attrs:{title:"检测详情",visible:e.detailVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticStyle:{width:"700px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.sampleForm.sampleNo))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.sampleForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.sampleForm.standardName))]),a("el-form-item",{attrs:{label:"因子备注:"}},[e._v(e._s(e.sampleForm.factorRemark))]),a("el-form-item",{attrs:{label:"检测备注:"}},[e._v(e._s(e.sampleForm.remark))]),a("el-form-item",{attrs:{label:"检测结果:"}},[e.sampleForm.factorSubsetVos&&e.sampleForm.factorSubsetVos.length>0?[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sampleForm.factorSubsetVos,border:"","header-cell-style":{background:"#ECF3FC"}}},[a("el-table-column",{attrs:{prop:"factorName",label:"套餐因子",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v("\n                  "+e._s(r.factorInfo&&r.factorInfo.v1?r.factorInfo.v1:0)+"\n                  "),r.factorInfo&&""!==r.factorInfo.v2&&0!==r.factorInfo.v2?[e._v("\n                    ×10"),a("sup",[e._v(e._s(r.factorInfo.v2?Number(r.factorInfo.v2):0))])]:e._e(),e._v("\n                  "+e._s(r.unitName&&"无量纲"!==r.unitName&&null!=e.sampleForm.unitName?" "+r.unitName:"")+"\n                ")]}}],null,!1,74595198)})],1)]:e.sampleForm.checkRes&&e.sampleForm.checkRes.length>0?[e._v("\n            "+e._s(e.sampleForm.factorInfo&&e.sampleForm.factorInfo.v1?e.sampleForm.factorInfo.v1:0)+"\n            "),e.sampleForm.factorInfo&&""!==e.sampleForm.factorInfo.v2&&0!==e.sampleForm.factorInfo.v2?[e._v("\n              ×10"),a("sup",[e._v(e._s(e.sampleForm.factorInfo.v2?Number(e.sampleForm.factorInfo.v2):0))])]:e._e(),e._v("\n            "+e._s(e.sampleForm.unitName&&"无量纲"!==e.sampleForm.unitName&&null!=e.sampleForm.unitName?" "+e.sampleForm.unitName:"")+"\n          ")]:[e._v("暂无检测结果")]],2)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailVisible=!1}}},[e._v("关 闭")])],1)]),a("el-dialog",{attrs:{title:"样品结果录入",visible:e.testResultVisible,width:"70%",center:"",top:"5vh"},on:{"update:visible":function(t){e.testResultVisible=t}}},[a("div",{staticStyle:{width:"700px",margin:"0 auto"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"样品编号:"}},[e._v(e._s(e.testResultForm.sampleNo))]),a("el-form-item",{attrs:{label:"检测因子:"}},[e._v(e._s(e.testResultForm.factorName))]),a("el-form-item",{attrs:{label:"检测标准:"}},[e._v(e._s(e.testResultForm.standardName))]),a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            备注信息\n            "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"新建报价单时业务员录入的针对检测因子的备注信息"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n            :\n          ")],1),e._v("\n          "+e._s(e.testResultForm.factorRemark)+"\n        ")]),a("el-form-item",{attrs:{label:"检测结果:"}},[e._l(e.subFactorData,(function(t,r){return a("el-row",{key:r},[a("el-col",{staticStyle:{"text-align":"right","padding-bottom":"5px"},attrs:{span:4}},[e._v("\n              "+e._s(t.name)+":\n            ")]),a("el-col",{staticStyle:{"margin-left":"10px","padding-bottom":"5px"},attrs:{span:9}},[a("el-input",{attrs:{type:"Number","controls-position":"right",min:0,placeholder:"结果值"},model:{value:t.masterRes,callback:function(a){e.$set(t,"masterRes",a)},expression:"item.masterRes"}},[a("template",{slot:"append"},[e._v("E")])],2)],1),a("el-col",{staticStyle:{"margin-left":"10px","padding-bottom":"5px"},attrs:{span:9}},[a("el-input",{attrs:{type:"Number","controls-position":"right",min:0,placeholder:"幂数"},model:{value:t.subRes,callback:function(a){e.$set(t,"subRes",a)},expression:"item.subRes"}},[t.unitName?a("template",{slot:"append"},[e._v(e._s(t.unitName))]):e._e()],2)],1)],1)})),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("例:3.45E2=3.45×10²  ;  234E0=234 ; 1.62E-3=1.62×10⁻³")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("无子因子的：输入0代表未检出")])])],1),a("el-row",[a("el-col",{staticStyle:{height:"24px","font-size":"14px"},attrs:{span:24}},[a("span",{staticStyle:{color:"red"}},[e._v("有子因子的：输入0代表未检出，不填代表未检查此项")])])],1)],2),a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n            备注\n            "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"300",trigger:"hover",content:"分析员录入结果时录入的备注信息，可流转到实验室负责人和报告部门"}},[a("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{slot:"reference","icon-class":"help"},slot:"reference"})],1),e._v("\n            :\n          ")],1),a("el-input",{attrs:{type:"textarea",maxlength:"50","show-word-limit":"",placeholder:"备注信息",rows:3},model:{value:e.testResultForm.remark,callback:function(t){e.$set(e.testResultForm,"remark",t)},expression:"testResultForm.remark"}})],1),a("el-form-item",{attrs:{label:"检测设备:"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"170px"},attrs:{placeholder:"设备分类"},on:{change:e.handleChangeEqu},model:{value:e.equipmentType,callback:function(t){e.equipmentType=t},expression:"equipmentType"}},e._l(e.level,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"170px"},attrs:{clearable:"",placeholder:"请选择设备型号"},on:{change:e.handleChangeEquType},model:{value:e.equipmentClass,callback:function(t){e.equipmentClass=t},expression:"equipmentClass"}},e._l(e.levelTwo,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"170px"},attrs:{clearable:"",placeholder:"请选择设备编号"},model:{value:e.equipmentId,callback:function(t){e.equipmentId=t},expression:"equipmentId"}},e._l(e.levelThree,(function(e){return a("el-option",{key:e.id,attrs:{label:e.equipmentNumber,value:e.id}})})),1)],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.testResultVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmChecks}},[e._v("保存")])],1)]),a("el-dialog",{attrs:{title:e.currentSample+"-详情",visible:e.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(t){e.sampleVisible=t}}},[a("el-form",{attrs:{model:e.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.factorPoint))])])],1)],1),e._l(e.sampleSecInfo,(function(t){return a("el-card",{key:t.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[t.groupName&&""!=t.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v(e._s(t.groupName))])]):e._e(),e._l(t.params,(function(t,r){return a("el-col",{key:r,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name)+":")]),a("span",{staticClass:"showTile"},[e._v(e._s(t.value?t.value.toString():""))])])],1)}))],2)})),e.sampleDataInfo&&e.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场检测因子信息")])]),a("el-table",{attrs:{data:e.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.measuredForm?[e._v("\n                "+e._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[e._v("\n                "+e._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n              "+e._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):e._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[e._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[e._v(e._s(e.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[e.sampleImageList&&e.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},e._l(e.sampleImageList,(function(t,r){return a("el-image",{key:r,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:t,"preview-src-list":e.sampleImageList}})})),1):e._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sampleVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},o=[],s=(a("7f7f"),a("7514"),a("6b54"),a("ac6a"),a("db72")),l=a("2f62"),n=a("d43b"),i=a("15d4"),c=a("f564"),d=a("333d"),u=a("4328"),p=a.n(u),m={0:"待领样",1:"领样已申请",2:"待检测",6:"审核失败"},h={components:{Pagination:d["a"]},filters:{statusQualityFilter:function(e){return"0"===e?"info":"2"===e||"1"===e||"4"===e?"":"3"===e||"5"===e?"success":"danger"}},props:{checkTaskId:{type:String,default:""}},data:function(){return{props:{multiple:!0},CHECK_STATUS:m,checkData:[],searchForm:{checkTaskId:"",sampleNo:"",factorName:"",checkStatus:"",pageNumber:1,pageSize:10},total:0,detailVisible:!1,sampleForm:{factorInfo:{},subFactors:{}},subSampleData:[],testResultVisible:!1,testResultForm:{checkFactorId:"",checkRes:"",checkSubRes:"",remark:""},subFactorData:[],sampleVisible:!1,sampleDetails:[],sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",sampleImageList:[],sampleImage:"",multipleSelection:[],level:[],levelTwo:[],levelThree:[],equipmentType:"",equipmentClass:"",equipmentId:"",sampleDataInfo:[],sampleSecInfo:[]}},computed:Object(s["a"])({},Object(l["b"])(["userId"])),created:function(){this.checkTaskId&&this.checkTaskId.length>0&&(this.searchForm.checkTaskId=this.checkTaskId),this.getEquipment(),this.handleSearch()},methods:{handleSearch:function(){var e=this;this.checkTaskId&&this.checkTaskId.length>0&&i["i"](this.searchForm).then((function(t){200===t.code&&(e.checkData=t.result.records.map((function(t){if(t.checkRes&&""!==t.checkRes){var a=JSON.parse(t.checkRes);e.$set(t,"masterRes",a.v1?a.v1:""),e.$set(t,"exponRes",a.v2?a.v2:"")}else e.$set(t,"masterRes",""),e.$set(t,"exponRes","");return t}))||[],e.total=t.result.total)}))},handleDetail:function(e){var t=this;if(this.sampleForm=Object(s["a"])({},e),e.factorSubsetVos&&e.factorSubsetVos.length>0&&this.sampleForm.factorSubsetVos.forEach((function(e){var a=JSON.parse(e.checkSubRes);t.$set(e,"factorInfo",a)})),e.checkRes&&e.checkRes.length>0){var a=JSON.parse(e.checkRes);this.$set(this.sampleForm,"factorInfo",a)}this.detailVisible=!0},handleLocalDetail:function(e){var t=this;this.currentSample=e.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";n["g"](e.sampItemId).then((function(e){200===e.code&&e.result&&(t.sampleDetailForm=e.result||{},t.$nextTick((function(){t.sampleImageList=e.result.sampleDataVo.imageList.map((function(e){return a+e})),t.sampleSecInfo=e.result.sampleDataVo.sampleData||[];var r=e.result.factorDataVos.filter((function(e){return"1"===e.dataEntryStep}))||[];t.sampleDataInfo=r.map((function(e){return e.measuredFormVal&&e.measuredFormVal.length>0&&t.$set(e,"measuredForm",JSON.parse(e.measuredFormVal)),e}))})),t.sampleVisible=!0)}))},handleSelectionChange:function(e){this.multipleSelection=e},batchApply:function(){var e=this,t=this.checkData.filter((function(e){return"0"===e.checkStatus}));t&&0!==t.length?this.$confirm("确定批量申请领样?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.map((function(e){return e.checkFactorId}));i["d"](p.a.stringify({checkFactorId:a.toString()})).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))})):this.$message.error("当前样品不需要领样操作!")},handleApply:function(e){var t=this;this.$confirm("确定申请领样?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["q"](p.a.stringify({checkFactorId:e.checkFactorId})).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))})).catch((function(){}))},handleSetResult:function(e){this.testResultForm=Object(s["a"])({},e),this.subFactorData=[],e.factorSubsetVos&&e.factorSubsetVos.length>0?this.subFactorData=e.factorSubsetVos.map((function(e){return{id:e.id,name:e.factorName,masterRes:"",subRes:"",unitName:e.unitName}})):this.subFactorData=[{name:e.factorName,masterRes:"",subRes:"",unitName:e.unitName}],this.testResultVisible=!0},handleApprove:function(e){var t=this;this.$confirm("确认提交审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i["s"]({checkFactorId:e}).then((function(e){200===e.code?(t.$notify({title:"成功",message:e.message,type:"success"}),t.handleSearch()):t.$notify({title:"失败",message:e.message,type:"error"})}))}))},confirmChecks:function(){var e=this;this.$confirm("确认提交?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t,a=e.levelThree.find((function(t){return t.id===e.equipmentId}));if("0"===e.testResultForm.isFactor){var r={name:e.subFactorData[0].name,v1:e.subFactorData[0].masterRes,v2:e.subFactorData[0].subRes};t={checkFactorId:e.testResultForm.checkFactorId,checkRes:JSON.stringify(r),remark:e.testResultForm.remark,checkEquipment:JSON.stringify(a)}}else{var o=e.subFactorData.map((function(e){var t={name:e.name,v1:e.masterRes,v2:e.subRes};return{id:e.id,unitName:e.unitName,checkSubRes:JSON.stringify(t)}}));t={checkFactorId:e.testResultForm.checkFactorId,checkRes:"",factorSubsetVos:o,remark:e.testResultForm.remark,checkEquipment:JSON.stringify(a)}}i["r"](t).then((function(t){200===t.code?(e.$notify({title:"成功",message:t.message,type:"success"}),e.testResultVisible=!1,e.handleSearch()):e.$notify({title:"失败",message:t.message,type:"error"})}))}))},goBack:function(){this.$router.back()},getEquipment:function(){var e=this;this.level=[],this.levelTwo=[],this.levelThree=[],Object(c["e"])().then((function(t){if(t.result){var a=t.result?t.result:[];""!==a&&(e.level=a)}}))},handleChangeEqu:function(e){this.levelTwo=[],this.levelThree=[];var t=this.level.find((function(t){return t.name===e}));t&&(this.levelTwo=t.children||[])},handleChangeEquType:function(e){this.levelThree=[];var t=this.levelTwo.find((function(t){return t.name===e}));t&&(this.levelThree=t.children||[])}}},f=h,b=(a("6506"),a("2877")),g=Object(b["a"])(f,r,o,!1,null,"18b43c20",null);t["default"]=g.exports},fe05:function(e,t,a){"use strict";a.d(t,"l",(function(){return o}));var r=a("b775");function o(){return Object(r["a"])({url:"/dept/selectDeptTrees",method:"get"})}},fedf:function(e,t,a){"use strict";a("eab1")},ff4f:function(e,t,a){"use strict";a("3a2b")}}]);