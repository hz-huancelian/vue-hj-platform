(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f94f5786"],{24249:function(t,e,a){"use strict";a("6292")},6292:function(t,e,a){},"7eed":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:t.searchForm,inline:!0}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",[a("el-input",{staticStyle:{width:"145px"},attrs:{placeholder:"请录入样品编号"},model:{value:t.searchForm.sampleNo,callback:function(e){t.$set(t.searchForm,"sampleNo",e)},expression:"searchForm.sampleNo"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"145px"},attrs:{placeholder:"请选择库存状态"},model:{value:t.searchForm.sampStatus,callback:function(e){t.$set(t.searchForm,"sampStatus",e)},expression:"searchForm.sampStatus"}},[a("el-option",{attrs:{label:"已入库",value:6}}),a("el-option",{attrs:{label:"部分出库",value:7}}),a("el-option",{attrs:{label:"已出库",value:8}})],1)],1),a("el-form-item",{attrs:{prop:"signDate"}},[a("el-date-picker",{staticStyle:{width:"145px"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择入库日期"},model:{value:t.searchForm.date,callback:function(e){t.$set(t.searchForm,"date",e)},expression:"searchForm.date"}})],1),a("el-form-item",[a("el-button",{staticClass:"iconfont icon-chaxun1",attrs:{type:"primary",size:"small"},on:{click:t.handleSearch}},[t._v(" 查询")]),a("el-button",{staticClass:"iconfont icon-fanhui",attrs:{type:"primary",size:"small"},on:{click:t.goBack}},[t._v(" 返回")])],1)],1),a("el-col",{staticClass:"search-right",attrs:{span:4}},[a("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:t.handleDownlond}},[t._v("交接单下载")]),a("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:t.handleSearch}},[t._v("刷新")])],1)],1)],1),a("div",[a("el-table",{ref:"stockTable",staticClass:"table-item",staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:t.stockData,"highlight-current-row":"","header-cell-style":{background:"#ECF3FC"}},on:{"selection-change":t.handleSelectionChange,select:t.handleSelect}},[a("template",{slot:"empty"},[a("div",{staticClass:"table_empty"},[a("div",{staticClass:"empty_tips"},[a("span",[t._v("\n              暂无审核信息\n            ")])])])]),a("el-table-column",{attrs:{type:"selection",width:"55",selectable:t.checkSelectable,align:"center"}}),a("el-table-column",{attrs:{prop:"sampleNo",label:"样品编号",fixed:"left",width:"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"jobId",label:"任务单号",width:"130px",align:"center"}}),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"150px",align:"center"}}),a("el-table-column",{attrs:{prop:"secdClassName",label:"检测类别",align:"center"}}),a("el-table-column",{attrs:{prop:"factorPoint",label:"采样点位","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"collectUser",label:"采样人",align:"center"}}),a("el-table-column",{attrs:{prop:"reviewUser",label:"复核人",width:"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"storeLocation",label:"存放位置","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"inspectionName",label:"受检单位","min-width":"120px",align:"center"}}),a("el-table-column",{attrs:{label:"库存状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[a("el-tag",{attrs:{type:t._f("statusQualityFilter")(l.sampStatus)}},[t._v("\n            "+t._s(t.STOCK_STATUS[l.sampStatus])+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"storeTime",label:"入库时间",width:"160",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.handleDetail(e.row)}}},[t._v(" 查看")])]}}])})],2)],1),a("div",{staticStyle:{float:"right"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.searchForm.pageNumber,limit:t.searchForm.pageSize},on:{"update:page":function(e){return t.$set(t.searchForm,"pageNumber",e)},"update:limit":function(e){return t.$set(t.searchForm,"pageSize",e)},pagination:t.handleSearch}})],1),a("el-dialog",{attrs:{title:t.currentSample+"-详情",visible:t.sampleVisible,width:"85%",center:"",top:"5vh"},on:{"update:visible":function(e){t.sampleVisible=e}}},[a("el-form",{attrs:{model:t.sampleDetailForm,"label-width":"180px","label-position":"right"}},[a("el-card",{staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[t._v("基础信息")])]),a("el-col",{staticStyle:{height:"32px"},attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"100",label:"检测因子:"}},[a("span",{staticClass:"showTile"},[t._v(t._s(t.sampleDetailForm.factorName))])])],1),a("el-col",{staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100",label:"点位:"}},[a("span",{staticClass:"showTile"},[t._v(t._s(t.sampleDetailForm.factorPoint))])])],1)],1),t._l(t.sampleSecInfo,(function(e){return a("el-card",{key:e.groupKey,staticStyle:{"margin-top":"5px","padding-bottom":"20px"}},[e.groupName&&""!=e.groupName?a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[t._v(t._s(e.groupName))])]):t._e(),t._l(e.params,(function(e,l){return a("el-col",{key:l,staticStyle:{height:"32px"},attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"100"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(t._s(e.name)+":")]),a("span",{staticClass:"showTile"},[t._v(t._s(e.value?e.value.toString():""))])])],1)}))],2)})),t.sampleDataInfo&&t.sampleDataInfo.length>0?a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[t._v("现场检测因子信息")])]),a("el-table",{attrs:{data:t.sampleDataInfo,stripe:""}},[a("el-table-column",{attrs:{prop:"factorName",label:"检测因子项目"}}),a("el-table-column",{attrs:{label:"因子结果集"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[a.measuredForm?[t._v("\n                "+t._s("第一值: "+a.measuredForm.firstVal+" 第二值: "+a.measuredForm.secondVal+" 均值: "+a.measuredForm.avgVal)+"\n              ")]:[t._v("\n                "+t._s(a.factorData?a.factorData:"")+"\n              ")]]}}],null,!1,3613769334)}),a("el-table-column",{attrs:{prop:"checkEquipment",label:"检测设备"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n              "+t._s(a.checkEquipment&&a.checkEquipment.length>0?a.checkEquipment.replaceAll("^_^"," "):"")+"\n            ")]}}],null,!1,2289891611)}),a("el-table-column",{attrs:{prop:"theoreticalVal",label:"理论值"}}),a("el-table-column",{attrs:{prop:"groundConditions",label:"测定值"}})],1)],1):t._e(),a("el-card",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticStyle:{width:"3px",margin:"auto 3px",height:"20px","background-color":"steelblue"}}),a("span",[t._v("现场信息")])]),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样地址:"}},[a("span",{staticClass:"showTile"},[t._v(t._s(t.sampleDetailForm.sampleDataVo.collectLocation))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"100",label:"采样日期:"}},[a("span",{staticClass:"showTile"},[t._v(t._s(t.sampleDetailForm.sampleDataVo.collectDate))])])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"100",label:"现场图片:"}},[t.sampleImageList&&t.sampleImageList.length>0?a("div",{staticClass:"demo-image__lazy"},t._l(t.sampleImageList,(function(e,l){return a("el-image",{key:l,staticStyle:{width:"100px",height:"100px","margin-left":"10px"},attrs:{src:e,"preview-src-list":t.sampleImageList}})})),1):t._e()])],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.sampleVisible=!1}}},[t._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"交接单下载",visible:t.downVisible,center:""},on:{"update:visible":function(e){t.downVisible=e}}},[a("div",{staticStyle:{width:"500px",margin:"0 auto"}},[a("el-form",{attrs:{model:t.recordForm,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"任务单号:"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请录入任务单号"},model:{value:t.recordForm.taskId,callback:function(e){t.$set(t.recordForm,"taskId",e)},expression:"recordForm.taskId"}})],1),a("el-form-item",{attrs:{label:"检测对象:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测对象"},on:{change:t.findSecClass},model:{value:t.recordForm.classId,callback:function(e){t.$set(t.recordForm,"classId",e)},expression:"recordForm.classId"}},t._l(t.classArray,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"检测类别:"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",placeholder:"检测类别"},model:{value:t.recordForm.secClassId,callback:function(e){t.$set(t.recordForm,"secClassId",e)},expression:"recordForm.secClassId"}},t._l(t.secClassArray,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"采样信息记录时间:"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"采样信息记录时间","value-format":"yyyy-MM-dd"},model:{value:t.recordForm.sampleDate,callback:function(e){t.$set(t.recordForm,"sampleDate",e)},expression:"recordForm.sampleDate"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.downVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmDownload}},[t._v("确认")])],1)])],1)},s=[],r=(a("6b54"),a("d43b")),o=a("b705"),n=a("ed08"),i=a("333d"),c={0:"待采样",1:"已采样",2:"待组长审核",3:"待负责人审核",4:"审核通过",5:"审核失败",6:"已入库",7:"部分出库",8:"已出库",9:"入库中",10:"待复核"},m={components:{Pagination:i["a"]},filters:{statusQualityFilter:function(t){var e={6:"",7:"success",8:"success"};return e[t]}},data:function(){return{STOCK_STATUS:c,stockData:[],searchForm:{sampTaskId:"",sampleNo:"",sampStatus:"",date:"",pageNumber:1,pageSize:10},total:0,approveVisible:!1,sampleVisible:!1,sampleDetailForm:{factorName:"",factorPoint:"",secdClassName:"",factorDataVos:[],sampleDataVo:{collectDate:"",collectLocation:"",imageList:[],sampleData:[],specialNote:""},sampleJobVo:{projectName:"",jobRemark:""}},currentSample:"",approveForm:{sampleNo:"",auditFlag:"1",auditReason:""},sampleImage:"",sampleImageList:[],multipleSelection:[],downVisible:!1,recordForm:{taskId:"",classId:"",secClassId:"",sampleDate:""},classArray:[],secClassArray:[],sampleDetails:[],sampleDataInfo:[],sampleSecInfo:[],currentSelectionRow:{jobId:"",secdClassName:"",storeData:""}}},created:function(){this.$route.params.sampTaskId&&(this.searchForm.sampTaskId=this.$route.params.sampTaskId,this.getClassList(),this.handleSearch())},methods:{handleSearch:function(){var t=this;""!==this.searchForm.jobId&&(this.clearSelectionRow(),r["i"](this.searchForm).then((function(e){200===e.code&&e.result&&(t.stockData=e.result.records.map((function(e){var a=Object(n["c"])(e.storeTime,"{y}-{m}-{d}");return t.$set(e,"storeData",a),e}))||[],t.total=e.result.total)})))},handleDetail:function(t){var e=this;this.currentSample=t.sampleNo,this.sampleImageList=[],this.sampleDataInfo=[],this.sampleSecInfo=[],this.sampleImage="";var a=this.$store.getters.sysBaseUrl+"/cyImg/";r["g"](t.sampItemId).then((function(t){200===t.code&&t.result&&(e.sampleDetailForm=t.result||{},e.$nextTick((function(){e.sampleImageList=t.result.sampleDataVo.imageList.map((function(t){return a+t})),e.sampleSecInfo=t.result.sampleDataVo.sampleData||[];var l=t.result.factorDataVos.filter((function(t){return"1"===t.dataEntryStep}))||[];e.sampleDataInfo=l.map((function(t){return t.measuredFormVal&&t.measuredFormVal.length>0&&e.$set(t,"measuredForm",JSON.parse(t.measuredFormVal)),t}))})),e.sampleVisible=!0)}))},handleSelectionChange:function(t){this.multipleSelection=t},handleDownlond:function(){if(this.multipleSelection&&this.multipleSelection.length>0){var t=this.multipleSelection.map((function(t){return t.sampleNo})),e="/api/word/downLoadHandover?secdClassId="+this.multipleSelection[0].secdClassId+"&sampleNos="+t.toString();window.open(e)}else this.$message.warning("至少选择一条记录")},getClassList:function(){var t=this;o["a"]().then((function(e){t.classArray=e.result||[]}))},findSecClass:function(t){var e=this;this.recordForm.secClassId="",o["d"](t).then((function(t){e.secClassArray=t.result||[]}))},confirmDownload:function(){if(this.recordForm.taskId&&this.recordForm.secClassId&&this.recordForm.sampleDate){var t="/api/word/downLoadHandover?taskId="+this.recordForm.taskId+"&secdClassId="+this.recordForm.secClassId+"&sampleDate="+this.recordForm.sampleDate;window.open(t),this.downVisible=!1}else this.$message.warning("任务单号和检测类别不能为空")},handleSelect:function(t,e){t.length>0?(this.currentSelectionRow.jobId=e.jobId,this.currentSelectionRow.secdClassName=e.secdClassName,this.currentSelectionRow.storeData=e.storeData):this.clearSelectionRow()},clearSelectionRow:function(){this.currentSelectionRow={jobId:"",secdClassName:"",storeData:""}},checkRow:function(t){return!this.currentSelectionRow.jobId||""===this.currentSelectionRow.jobId||t.jobId===this.currentSelectionRow.jobId&&t.secdClassName===this.currentSelectionRow.secdClassName&&t.storeData===this.currentSelectionRow.storeData},checkSelectable:function(t){return this.checkRow(t)},goBack:function(){this.$router.back()}}},d=m,u=(a("24249"),a("2877")),p=Object(u["a"])(d,l,s,!1,null,"dd708c08",null);e["default"]=p.exports},b705:function(t,e,a){"use strict";a.d(e,"g",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"f",(function(){return n})),a.d(e,"a",(function(){return i})),a.d(e,"d",(function(){return c})),a.d(e,"e",(function(){return m})),a.d(e,"h",(function(){return d})),a.d(e,"i",(function(){return u}));var l=a("b775");function s(t){return Object(l["a"])({url:"/common/findDictMap/".concat(t),method:"get"})}function r(){return Object(l["a"])({url:"/common/findSampLeaders",method:"get"})}function o(){return Object(l["a"])({url:"/common/findMonitorFreq",method:"get"})}function n(){return Object(l["a"])({url:"/judge/organ/findValidList",method:"get"})}function i(){return Object(l["a"])({url:"/platform/factor/findFstClasses",method:"get"})}function c(t){return Object(l["a"])({url:"/platform/factor/findSecdClassByClassId/".concat(t),method:"get"})}function m(){return Object(l["a"])({url:"/platform/factor/findClassTrees",method:"get"})}function d(){return Object(l["a"])({url:"/sysRegion/getFirstLevel",method:"get"})}function u(t){return Object(l["a"])({url:"/sysRegion/getSubRegionByRegionCode/".concat(t),method:"get"})}},d43b:function(t,e,a){"use strict";a.d(e,"d",(function(){return s})),a.d(e,"i",(function(){return r})),a.d(e,"g",(function(){return o})),a.d(e,"h",(function(){return n})),a.d(e,"f",(function(){return i})),a.d(e,"e",(function(){return c})),a.d(e,"c",(function(){return m})),a.d(e,"b",(function(){return d})),a.d(e,"a",(function(){return u}));var l=a("b775");function s(t){return Object(l["a"])({url:"/sample/findByCondition",method:"get",params:t})}function r(t){return Object(l["a"])({url:"/sample/getSamplesBySampTaskId",method:"get",params:t})}function o(t){return Object(l["a"])({url:"/sample/getSampleDataBySampItemId/".concat(t),method:"get"})}function n(t){return Object(l["a"])({url:"/sample/getSampleDetailBySampItemId/".concat(t),method:"get"})}function i(t){return Object(l["a"])({url:"/sample/getSampStoreApplyList",method:"get",params:t})}function c(t){return Object(l["a"])({url:"/sample/getSampDrawApplyList",method:"get",params:t})}function m(t){return Object(l["a"])({url:"/sample/doStoreSample",method:"post",data:t})}function d(t){return Object(l["a"])({url:"/sample/doDrawSample",method:"post",data:t})}function u(t){return Object(l["a"])({url:"/sample/batchDoStoreSample",method:"post",data:t})}}}]);