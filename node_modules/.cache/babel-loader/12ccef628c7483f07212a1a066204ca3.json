{"remainingRequest":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js!F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjects\\vue-hj-platform\\src\\views\\order\\factor\\mealList.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\webstormProjects\\vue-hj-platform\\src\\views\\order\\factor\\mealList.vue","mtime":1652335460000},{"path":"F:\\webstormProjects\\vue-hj-platform\\babel.config.js","mtime":1637214064000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireDefault.js\");\n\nvar _interopRequireWildcard = require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireWildcard.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.array.find\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.map\");\n\nvar factorServer = _interopRequireWildcard(require(\"@/api/factor\"));\n\nvar dictServer = _interopRequireWildcard(require(\"@/api/dict\"));\n\nvar _Pagination = _interopRequireDefault(require(\"@/components/Pagination\"));\n\nvar _FactorList = _interopRequireDefault(require(\"@/components/FactorList\"));\n\nvar _FactorSameList = _interopRequireDefault(require(\"@/components/FactorSameList\"));\n\nvar _vueUuid = require(\"vue-uuid\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// Secondary package based on el-pagination\nvar STOKEN_STUTS = {\n  '0': '现行',\n  '1': '自定义标准',\n  '2': '试行'\n};\nvar _default = {\n  components: {\n    Pagination: _Pagination.default,\n    FactorList: _FactorList.default,\n    FactorSameList: _FactorSameList.default\n  },\n  data: function data() {\n    debugger;\n    return {\n      STOKEN_STUTS: STOKEN_STUTS,\n      factorGroupData: [],\n      searchForm: {\n        groupName: '',\n        groupType: '',\n        authType: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      titleMap: {\n        edit: '修改套餐',\n        create: '新增套餐'\n      },\n      factorGroupForm: {\n        groupId: '',\n        groupName: '',\n        authType: '0',\n        groupType: '',\n        groupCost: '',\n        remark: '',\n        factorStandardIds: []\n      },\n      factorGroupRules: {\n        groupName: [{\n          required: true,\n          message: '套餐名称',\n          trigger: 'blur'\n        }]\n      },\n      factorGroupDialogStatus: 'create',\n      factorGroupDialogVisible: false,\n      factorGroupVisible: false,\n      factorChoseData: [],\n      showGroupData: [],\n      secdItems: {},\n      currentRow: {},\n      choseMealVisible: false,\n      factorSameVisible: false,\n      cleanAttr: ''\n    };\n  },\n  created: function created() {\n    this.getFactorDict();\n    this.handleSearch();\n  },\n  methods: {\n    getFactorDict: function getFactorDict() {\n      var _this = this;\n\n      dictServer.findTreeClasses().then(function (res) {\n        if (res.code === 200 && res.result) {\n          var resMap = new Map();\n          res.result.forEach(function (i) {\n            resMap.set(i.id, i.children);\n          });\n          console.log(resMap);\n          _this.secdItems = resMap;\n        }\n      });\n    },\n    handleSearch: function handleSearch() {\n      var _this2 = this;\n\n      factorServer.findPageByCondition(this.searchForm).then(function (res) {\n        if (res.code === 200) {\n          _this2.factorGroupData = res.result.records || [];\n          _this2.total = res.result.total;\n        }\n      });\n    },\n    // 重置\n    handleCreate: function handleCreate() {\n      this.choseMealVisible = true;\n    },\n    // 重置\n    handleFreeCreate: function handleFreeCreate() {\n      this.choseMealVisible = false;\n      this.clearForm();\n      this.cleanAttr = _vueUuid.uuid.v4().replaceAll('-', '');\n      this.factorGroupForm.groupType = '0';\n      this.factorGroupDialogStatus = 'create';\n      this.factorGroupDialogVisible = true;\n      Object.assign({\n        classId: '',\n        factorName: '',\n        authType: '',\n        pageNumber: 1,\n        pageSize: 10\n      }, this.$options.data().innerSearchForm);\n    },\n    handleSameCreate: function handleSameCreate() {\n      this.clearForm();\n      this.factorGroupDialogStatus = 'create';\n      this.cleanAttr = _vueUuid.uuid.v4().replaceAll('-', '');\n      this.factorGroupForm.groupType = '1';\n      this.factorSameVisible = true;\n      Object.assign({\n        classId: '',\n        factorName: '',\n        authType: '',\n        pageNumber: 1,\n        pageSize: 10\n      }, this.$options.data().innerSearchForm);\n    },\n    handleUpdate: function handleUpdate(row) {\n      this.factorGroupDialogStatus = 'edit';\n      this.factorGroupForm.groupId = row.groupId;\n      this.factorGroupForm.groupName = row.groupName;\n      this.factorGroupForm.groupType = row.groupType;\n      this.factorGroupForm.groupCost = row.groupCost ? row.groupCost : '';\n      this.factorGroupForm.authType = row.authType;\n      this.factorGroupForm.remark = row.remark;\n\n      if (row.groupType === '0') {\n        // 自由套餐\n        this.getFactorChoses(row.groupId);\n      } else {\n        // 同系套餐\n        this.getFactorSameChoses(row.groupId);\n      }\n\n      this.$store.dispatch('user/resetCompForm', '1');\n    },\n    getFactorChoses: function getFactorChoses(groupId) {\n      var _this3 = this;\n\n      factorServer.findCheckStandardsByGroupId(groupId).then(function (res) {\n        if (res.code === 200) {\n          _this3.factorChoseData = res.result || [];\n        }\n\n        _this3.factorGroupDialogVisible = true;\n      });\n    },\n    getFactorSameChoses: function getFactorSameChoses(groupId) {\n      var _this4 = this;\n\n      factorServer.findCheckStandardsByGroupId(groupId).then(function (res) {\n        if (res.code === 200) {\n          _this4.factorChoseData = res.result || [];\n        }\n\n        _this4.factorSameVisible = true;\n      });\n    },\n    confirmDialog: function confirmDialog() {\n      if (!this.factorGroupForm.groupName || this.factorChoseData.length <= 0) {\n        this.$message.warning('套餐名称、因子项不能为空');\n        return;\n      }\n\n      var oo = this.factorChoseData.find(function (i) {\n        return i.secdClassId;\n      });\n\n      if (!oo) {\n        this.$message.warning('二级类别不能为空');\n        return;\n      }\n\n      if (this.factorGroupForm.groupType === '1') {\n        var checks = [];\n        this.factorChoseData.forEach(function (e) {\n          var fas = checks.find(function (f) {\n            return f.standardNo === e.standardNo;\n          });\n\n          if (!fas) {\n            checks.push(e);\n          }\n        });\n\n        if (checks.length > 1) {\n          this.$message.error('同系套餐只能针对一个标准号配置');\n          return;\n        }\n      }\n\n      if (this.factorChoseData.length <= 1) {\n        this.$message.error('同系套餐因子必须超过1个');\n        return;\n      }\n\n      if (this.factorGroupDialogStatus === 'create') {\n        this.confirmCreate();\n      } else {\n        this.confirmUpdate();\n      }\n    },\n    confirmCreate: function confirmCreate() {\n      var _this5 = this;\n\n      var totalPrice = 0;\n      var data = {\n        groupName: this.factorGroupForm.groupName,\n        remark: this.factorGroupForm.remark,\n        authType: this.factorGroupForm.authType,\n        groupType: this.factorGroupForm.groupType,\n        groupCost: this.factorGroupForm.groupCost !== '' ? this.factorGroupForm.groupCost : '',\n        factorStandardIds: this.factorChoseData.map(function (i) {\n          totalPrice = parseFloat(totalPrice + i.price);\n          return {\n            checkStandardId: i.standardCode,\n            secdClassId: i.secdClassId,\n            factorName: i.factorName\n          };\n        })\n      };\n\n      if (this.factorGroupForm.groupType === '1') {\n        if (totalPrice <= this.factorGroupForm.groupCost) {\n          data.groupCost = totalPrice;\n        }\n      }\n\n      factorServer.saveFactorGroup(data).then(function (request) {\n        _this5.$notify({\n          title: '成功',\n          message: request.message,\n          type: 'success'\n        });\n\n        _this5.handleSearch();\n\n        _this5.factorGroupDialogVisible = false;\n        _this5.factorSameVisible = false;\n      }).catch(function () {});\n    },\n    confirmUpdate: function confirmUpdate() {\n      var _this6 = this;\n\n      var totalPrice = 0;\n      var data = {\n        groupId: this.factorGroupForm.groupId,\n        groupName: this.factorGroupForm.groupName,\n        authType: this.factorGroupForm.authType,\n        remark: this.factorGroupForm.remark,\n        groupType: this.factorGroupForm.groupType,\n        groupCost: this.factorGroupForm.groupCost !== '' ? this.factorGroupForm.groupCost : '',\n        factorStandardIds: this.factorChoseData.map(function (i) {\n          totalPrice = parseFloat(totalPrice + i.price);\n          return {\n            checkStandardId: i.standardCode,\n            secdClassId: i.secdClassId,\n            factorName: i.factorName\n          };\n        })\n      };\n\n      if (this.factorGroupForm.groupType === '1') {\n        if (totalPrice <= this.factorGroupForm.groupCost) {\n          data.groupCost = totalPrice;\n        }\n      }\n\n      factorServer.modifyFactorGroupByGroupId(data).then(function (request) {\n        _this6.$notify({\n          title: '成功',\n          message: request.message,\n          type: 'success'\n        });\n\n        _this6.handleSearch();\n\n        _this6.factorGroupDialogVisible = false;\n        _this6.factorSameVisible = false;\n      }).catch(function () {});\n    },\n    handleDelete: function handleDelete(id) {\n      var _this7 = this;\n\n      this.$confirm('确定删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        factorServer.delByGroupId(id).then(function (result) {\n          if (result.code === 200) {\n            _this7.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            });\n\n            _this7.handleSearch();\n          } else {\n            _this7.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            });\n          }\n        });\n      }).catch(function () {});\n    },\n    handleCopy: function handleCopy(id) {\n      var _this8 = this;\n\n      this.$confirm('确定复制?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        factorServer.copyByGroupId(id).then(function (result) {\n          if (result.code === 200) {\n            _this8.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            });\n\n            _this8.handleSearch();\n          } else {\n            _this8.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            });\n          }\n        });\n      }).catch(function () {});\n    },\n    clearForm: function clearForm() {\n      this.factorGroupForm = {\n        groupId: '',\n        groupName: '',\n        authType: '0',\n        groupType: '',\n        groupCost: '',\n        remark: '',\n        factorStandardIds: []\n      };\n      this.factorChoseData = [];\n    },\n    handleChose: function handleChose(val) {\n      var _this9 = this;\n\n      if (val) {\n        val.forEach(function (i) {\n          var obj = _this9.factorChoseData.find(function (j) {\n            return j.id === i.id && i.secdClassId && j.secdClassId === i.secdClassId;\n          });\n\n          debugger;\n\n          if (!obj && i.secdClassId) {\n            _this9.factorChoseData.push(i);\n          }\n        });\n      }\n    },\n    handleSameChose: function handleSameChose(val) {\n      var _this10 = this;\n\n      if (val) {\n        val.forEach(function (i) {\n          var obj = _this10.factorChoseData.find(function (j) {\n            return j.id === i.id && i.secdClassId && j.secdClassId === i.secdClassId && i.standardNo === j.standardNo;\n          });\n\n          debugger;\n\n          if (!obj && i.secdClassId) {\n            _this10.factorChoseData.push(i);\n          }\n        });\n      }\n    },\n    checkAutype: function checkAutype() {\n      this.factorChoseData = [];\n    },\n    handleRowDel: function handleRowDel(row, index) {\n      this.factorChoseData.splice(index, 1);\n      this.currentRow = row;\n    },\n    handleDetail: function handleDetail(groupId) {\n      var _this11 = this;\n\n      factorServer.findCheckStandardsByGroupId(groupId).then(function (res) {\n        _this11.showGroupData = res.result || [];\n        _this11.factorGroupVisible = true;\n      });\n    },\n    handleDialogClose: function handleDialogClose(done) {\n      this.factorGroupDialogVisible = false;\n      this.$store.dispatch('user/resetCompForm', '');\n      done();\n    },\n    handleSameDialogClose: function handleSameDialogClose(done) {\n      this.factorGroupDialogVisible = false;\n      this.$store.dispatch('user/resetCompForm', '');\n      done();\n    }\n  }\n};\nexports.default = _default;",{"version":3,"sources":["mealList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form :model=\"searchForm\" :inline=\"true\">\n      <el-row>\n        <el-col :span=\"20\">\n          <el-form-item label=\"套餐名称:\">\n            <el-input v-model=\"searchForm.groupName\" style=\"width:180px\" placeholder=\"套餐名称\" />\n          </el-form-item>\n          <el-form-item label=\"套餐类型:\">\n            <el-select v-model=\"searchForm.groupType\" clearable style=\"width: 100%;\" placeholder=\"套餐类型\">\n              <el-option value=\"0\" label=\"自由因子套餐\" />\n              <el-option value=\"1\" label=\"同系因子套餐\" />\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" class=\"iconfont icon-chaxun1\" @click=\"handleSearch\"> 查询</el-button>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"4\" class=\"search-right\">\n          <el-button type=\"text\" icon=\"el-icon-plus\" @click=\"handleCreate\">新增</el-button>\n          <el-button type=\"text\" icon=\"el-icon-refresh\" @click=\"handleSearch\">刷新</el-button>\n        </el-col>\n      </el-row>\n    </el-form>\n    <el-table\n      stripe\n      :data=\"factorGroupData\"\n      highlight-current-row\n      :header-cell-style=\"{background:'#ECF3FC'}\"\n      border\n      style=\"width: 100%\"\n    >\n      <template slot=\"empty\">\n        <div class=\"table_empty\">\n          <div class=\"empty_tips\">\n            <span>\n              暂无套餐,\n            </span>\n            <el-button type=\"text\" size=\"small\" style=\"font-size:14px;\" @click=\"handleCreate\">新建因子套餐</el-button>\n          </div>\n        </div>\n      </template>\n      <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n      <el-table-column prop=\"groupName\" label=\"套餐名称\" align=\"center\" />\n      <el-table-column label=\"套餐类型\" align=\"center\" width=\"130px\">\n        <template slot-scope=\"{row}\">\n          {{ row.groupType === '0'?\"自由因子套餐\":\"同系因子套餐\" }}\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"remark\" label=\"套餐说明\" :show-overflow-tooltip=\"true\" align=\"center\" />\n      <el-table-column prop=\"groupDesc\" label=\"检测因子\" :show-overflow-tooltip=\"true\" align=\"center\" />\n      <el-table-column prop=\"createTime\" label=\"创建时间\" width=\"160\" align=\"center\" />\n\n      <el-table-column fixed=\"right\" align=\"center\" label=\"操作\" width=\"180\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"text\" @click=\"handleDetail(scope.row.groupId)\"> 查看</el-button>\n          <div class=\"erc-divider-vertical\" />\n          <el-button type=\"text\" @click=\"handleUpdate(scope.row)\"> 编辑</el-button>\n          <div class=\"erc-divider-vertical\" />\n          <el-button type=\"text\" @click=\"handleDelete(scope.row.groupId)\">删除</el-button>\n          <div class=\"erc-divider-vertical\" />\n          <el-button type=\"text\" @click=\"handleCopy(scope.row.groupId)\">复制</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"float: right\">\n      <pagination\n        v-show=\"total>0\"\n        :total=\"total\"\n        :page.sync=\"searchForm.pageNumber\"\n        :limit.sync=\"searchForm.pageSize\"\n        @pagination=\"handleSearch\"\n      />\n    </div>\n\n    <el-dialog :visible.sync=\"choseMealVisible\" top=\"35vh\" width=\"400px\">\n\n      <span slot=\"title\">\n        选择新增套餐类型\n        <el-popover\n          placement=\"top-start\"\n          title=\"\"\n          width=\"500\"\n          trigger=\"hover\"\n        >\n          <div>\n            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;同系因子套餐：可以将某个检测标准中可同时检测的多个因子进行打包（要求标准号相同）\n            如： 苯系物、挥发性卤代烃、有机氯农药等，并可对该同系因子套餐进行总价设定，\n            若该同系因子套餐中所含因子单价合计大于等于设定的总价，则以设定的总价作为该套餐的报价，\n            若小于则以所含因子单价合计作为该套餐的报价。同时报价时可以选择该套餐内的部分或全部因子作为一个单因子属性进行点位和频次的设置，\n            在采样分配时该套餐内的因子无需进行合样操作，实验室分析时该套餐内的因子作为一组进行实验室数据录入。\n            <br>\n            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自由因子套餐：该类型套餐可用于具有固定或相似监测方案的项目，可自由选择因子库中的因子进行组合，后续套餐内所选因子会分拆独立出来，后续流程与因子库中的其他因子无异。\n          </div>\n          <svg-icon slot=\"reference\" icon-class=\"help\" style=\"font-size:16px\" />\n        </el-popover>\n      </span>\n      <ul class=\"icon-list\">\n        <li @click=\"handleSameCreate\">\n          <span>\n            <svg-icon icon-class=\"dcqrs\" />\n            <span class=\"icon-name\">同系因子套餐</span>\n          </span>\n        </li>\n        <li @click=\"handleFreeCreate\">\n          <span>\n            <svg-icon icon-class=\"ddrw\" />\n            <span class=\"icon-name\">自由因子套餐</span>\n          </span>\n        </li>\n      </ul>\n    </el-dialog>\n\n    <el-dialog :title=\"titleMap[factorGroupDialogStatus]\" :visible.sync=\"factorGroupDialogVisible\" fullscreen :modal-append-to-body=\"false\" :before-close=\"handleDialogClose\" center>\n      <el-card shadow=\"never\">\n        <div slot=\"header\">\n          <span>套餐基础信息<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-form ref=\"factorGroupForm\" :model=\"factorGroupForm\" inline label-width=\"90px\">\n          <el-form-item prop=\"groupName\" label=\"套餐名称:\">\n            <el-input v-model=\"factorGroupForm.groupName\" placeholder=\"套餐名称\" style=\"width: 250px;\" maxlength=\"10\" show-word-limit />\n          </el-form-item>\n          <el-form-item prop=\"authType\" label=\"认证类型:\">\n            <el-select v-model=\"factorGroupForm.authType\" style=\"width: 250px;\" placeholder=\"检测类型\" :disabled=\"factorGroupDialogStatus==='edit'\" @change=\"checkAutype\">\n              <el-option value=\"0\" label=\"CMA\" />\n              <el-option value=\"1\" label=\"CNAS\" />\n            </el-select>\n          </el-form-item>\n          <el-form-item prop=\"remark\" label=\"套餐说明:\">\n            <el-input v-model=\"factorGroupForm.remark\" placeholder=\"套餐说明\" type=\"textarea\" :rows=\"3\" maxlength=\"50\" />\n          </el-form-item>\n        </el-form>\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>待选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <factor-list :auth-type=\"factorGroupForm.authType\" :chose-row=\"currentRow\" @pageChose=\"handleChose\" />\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>已选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-table\n          :data=\"factorChoseData\"\n          size=\"small\"\n          stripe\n          highlight-current-row\n          max-height=\"400\"\n          :header-cell-style=\"{background:'#ECF3FC'}\"\n        >\n          <template slot=\"empty\">\n            <div class=\"table_empty\">\n              <div class=\"empty_tips\">\n                <span>\n                  暂无因子\n                </span>\n              </div>\n            </div>\n          </template>\n          <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n          <el-table-column prop=\"className\" label=\"检测对象\" min-width=\"100\" align=\"center\" />\n          <el-table-column prop=\"factorName\" label=\"检测因子\" align=\"center\" />\n          <el-table-column prop=\"standardNo\" label=\"标准号\" align=\"center\" />\n          <el-table-column prop=\"standardName\" label=\"标准名称\" min-width=\"160\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"分析方法\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"标准有效性\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              {{ STOKEN_STUTS[row.methodStatus] }}\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"price\" label=\"检测费用\" align=\"center\" />\n          <el-table-column prop=\"cmaFlg\" label=\"CMA\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cmaFlg==='1'?'success':'danger'\">{{ row.cmaFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"cnasFlg\" label=\"CNAS\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cnasFlg==='1'?'success':'danger'\">{{ row.cnasFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"extAssistFlg\" label=\"检测能力\" width=\"80\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"(row.extAssistFlg&&row.extAssistFlg==='0')?'success':'danger'\">{{ (row.extAssistFlg&&row.extAssistFlg==='0')?'有':'无' }}</el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column fixed=\"right\" align=\"center\" label=\"操作\">\n            <template slot-scope=\"scope\">\n              <el-button type=\"text\" @click=\"handleRowDel(scope.row,scope.$index)\"> 删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-card>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"factorGroupDialogVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"同系因子套餐\" :visible.sync=\"factorSameVisible\" fullscreen :modal-append-to-body=\"false\" :before-close=\"handleSameDialogClose\" center>\n      <el-card shadow=\"never\">\n        <div slot=\"header\">\n          <span>套餐基础信息<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-form ref=\"factorGroupForm\" :model=\"factorGroupForm\" inline label-width=\"90px\">\n          <el-form-item prop=\"groupName\" label=\"套餐名称:\">\n            <el-input v-model=\"factorGroupForm.groupName\" placeholder=\"同系套餐名称\" style=\"width: 250px;\" maxlength=\"10\" show-word-limit />\n          </el-form-item>\n          <el-form-item prop=\"groupCost\" label=\"套餐价格:\">\n            <el-input v-model=\"factorGroupForm.groupCost\" type=\"number\" placeholder=\"套餐价格\" style=\"width: 250px;\" />\n          </el-form-item>\n\n          <el-form-item prop=\"remark\" label=\"套餐说明:\">\n            <el-input v-model=\"factorGroupForm.remark\" placeholder=\"套餐说明\" type=\"textarea\" :rows=\"3\" maxlength=\"50\" show-word-limit />\n          </el-form-item>\n        </el-form>\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>待选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <factor-same-list :clear-type=\"cleanAttr\" :chose-row=\"currentRow\" @pageChose=\"handleSameChose\" />\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>已选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-table\n          :data=\"factorChoseData\"\n          size=\"small\"\n          stripe\n          highlight-current-row\n          max-height=\"400\"\n          :header-cell-style=\"{background:'#ECF3FC'}\"\n        >\n          <template slot=\"empty\">\n            <div class=\"table_empty\">\n              <div class=\"empty_tips\">\n                <span>\n                  暂无因子\n                </span>\n              </div>\n            </div>\n          </template>\n          <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n          <el-table-column prop=\"className\" label=\"检测对象\" width=\"80\" align=\"center\" />\n          <el-table-column prop=\"factorName\" label=\"检测因子\" align=\"center\" />\n          <el-table-column prop=\"standardNo\" label=\"标准号\" align=\"center\" />\n          <el-table-column prop=\"standardName\" label=\"标准名称\" min-width=\"160\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"分析方法\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"标准有效性\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              {{ STOKEN_STUTS[row.methodStatus] }}\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"price\" label=\"检测费用\" align=\"center\" />\n          <el-table-column prop=\"cmaFlg\" label=\"CMA\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cmaFlg==='1'?'success':'danger'\">{{ row.cmaFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"cnasFlg\" label=\"CNAS\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cnasFlg==='1'?'success':'danger'\">{{ row.cnasFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"extAssistFlg\" label=\"检测能力\" width=\"80\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"(row.extAssistFlg&&row.extAssistFlg==='0')?'success':'danger'\">{{ (row.extAssistFlg&&row.extAssistFlg==='0')?'有':'无' }}</el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column fixed=\"right\" align=\"center\" label=\"操作\">\n            <template slot-scope=\"scope\">\n              <el-button type=\"text\" @click=\"handleRowDel(scope.row,scope.$index)\"> 删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-card>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"factorSameVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"套餐详情\" :visible.sync=\"factorGroupVisible\" width=\"75%\" top=\"5vh\">\n      <el-table :data=\"showGroupData\" stripe highlight-current-row>\n        <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n        <el-table-column prop=\"className\" label=\"检测对象\" align=\"center\" />\n        <el-table-column prop=\"secdClassName\" label=\"检测类别\" align=\"center\" />\n        <el-table-column prop=\"factorName\" label=\"检测因子\" align=\"center\" />\n        <el-table-column prop=\"standardName\" label=\"检测标准\" min-width=\"160\" align=\"center\" />\n        <el-table-column prop=\"price\" label=\"检测费用\" align=\"center\" />\n        <el-table-column prop=\"cmaFlg\" label=\"CMA\" width=\"60px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.cmaFlg==='1'?'success':'danger'\">{{ row.cmaFlg==='1'?'Y':'N' }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"cnasFlg\" label=\"CNAS\" width=\"60px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.cnasFlg==='1'?'success':'danger'\">{{ row.cnasFlg==='1'?'Y':'N' }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"extAssistFlg\" label=\"检测能力\" width=\"80px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"(row.extAssistFlg&&row.extAssistFlg==='0')?'success':'danger'\">{{ (row.extAssistFlg&&row.extAssistFlg==='0')?'有':'无' }}</el-tag>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport * as factorServer from '@/api/factor'\nimport * as dictServer from '@/api/dict'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nimport FactorList from '@/components/FactorList'\nimport FactorSameList from '@/components/FactorSameList'\nimport { uuid } from 'vue-uuid'\nconst STOKEN_STUTS = {\n  '0': '现行',\n  '1': '自定义标准',\n  '2': '试行'\n}\nexport default {\n  components: { Pagination, FactorList, FactorSameList },\n  data() {\n    debugger\n    return {\n      STOKEN_STUTS,\n      factorGroupData: [],\n      searchForm: {\n        groupName: '',\n        groupType: '',\n        authType: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      titleMap: {\n        edit: '修改套餐',\n        create: '新增套餐'\n      },\n      factorGroupForm: {\n        groupId: '',\n        groupName: '',\n        authType: '0',\n        groupType: '',\n        groupCost: '',\n        remark: '',\n        factorStandardIds: []\n      },\n      factorGroupRules: {\n        groupName: [{ required: true, message: '套餐名称', trigger: 'blur' }]\n      },\n      factorGroupDialogStatus: 'create',\n      factorGroupDialogVisible: false,\n      factorGroupVisible: false,\n      factorChoseData: [],\n      showGroupData: [],\n      secdItems: {},\n      currentRow: {},\n      choseMealVisible: false,\n      factorSameVisible: false,\n      cleanAttr: ''\n    }\n  },\n  created() {\n    this.getFactorDict()\n    this.handleSearch()\n  },\n  methods: {\n    getFactorDict() {\n      dictServer.findTreeClasses().then(res => {\n        if (res.code === 200 && res.result) {\n          var resMap = new Map()\n          res.result.forEach(i => {\n            resMap.set(i.id, i.children)\n          })\n          console.log(resMap)\n\n          this.secdItems = resMap\n        }\n      })\n    },\n    handleSearch() {\n      factorServer.findPageByCondition(this.searchForm).then(res => {\n        if (res.code === 200) {\n          this.factorGroupData = res.result.records || []\n          this.total = res.result.total\n        }\n      })\n    },\n    // 重置\n    handleCreate() {\n      this.choseMealVisible = true\n    },\n    // 重置\n    handleFreeCreate() {\n      this.choseMealVisible = false\n      this.clearForm()\n      this.cleanAttr = uuid.v4().replaceAll('-', '')\n      this.factorGroupForm.groupType = '0'\n      this.factorGroupDialogStatus = 'create'\n      this.factorGroupDialogVisible = true\n      Object.assign({ classId: '', factorName: '', authType: '', pageNumber: 1, pageSize: 10 }, this.$options.data().innerSearchForm)\n    },\n    handleSameCreate() {\n      this.clearForm()\n      this.factorGroupDialogStatus = 'create'\n      this.cleanAttr = uuid.v4().replaceAll('-', '')\n      this.factorGroupForm.groupType = '1'\n      this.factorSameVisible = true\n      Object.assign({ classId: '', factorName: '', authType: '', pageNumber: 1, pageSize: 10 }, this.$options.data().innerSearchForm)\n    },\n    handleUpdate(row) {\n      this.factorGroupDialogStatus = 'edit'\n      this.factorGroupForm.groupId = row.groupId\n      this.factorGroupForm.groupName = row.groupName\n      this.factorGroupForm.groupType = row.groupType\n      this.factorGroupForm.groupCost = row.groupCost ? row.groupCost : ''\n      this.factorGroupForm.authType = row.authType\n      this.factorGroupForm.remark = row.remark\n      if (row.groupType === '0') { // 自由套餐\n        this.getFactorChoses(row.groupId)\n      } else { // 同系套餐\n        this.getFactorSameChoses(row.groupId)\n      }\n      this.$store.dispatch('user/resetCompForm', '1')\n    },\n    getFactorChoses(groupId) {\n      factorServer.findCheckStandardsByGroupId(groupId).then(res => {\n        if (res.code === 200) {\n          this.factorChoseData = res.result || []\n        }\n        this.factorGroupDialogVisible = true\n      })\n    },\n    getFactorSameChoses(groupId) {\n      factorServer.findCheckStandardsByGroupId(groupId).then(res => {\n        if (res.code === 200) {\n          this.factorChoseData = res.result || []\n        }\n        this.factorSameVisible = true\n      })\n    },\n    confirmDialog() {\n      if (!this.factorGroupForm.groupName || this.factorChoseData.length <= 0) {\n        this.$message.warning('套餐名称、因子项不能为空')\n        return\n      }\n      const oo = this.factorChoseData.find(i => i.secdClassId)\n      if (!oo) {\n        this.$message.warning('二级类别不能为空')\n        return\n      }\n      if (this.factorGroupForm.groupType === '1') {\n        const checks = []\n        this.factorChoseData.forEach(e => {\n          const fas = checks.find(f => f.standardNo === e.standardNo)\n          if (!fas) {\n            checks.push(e)\n          }\n        })\n        if (checks.length > 1) {\n          this.$message.error('同系套餐只能针对一个标准号配置')\n          return\n        }\n      }\n      if (this.factorChoseData.length <= 1) {\n        this.$message.error('同系套餐因子必须超过1个')\n        return\n      }\n      if (this.factorGroupDialogStatus === 'create') {\n        this.confirmCreate()\n      } else {\n        this.confirmUpdate()\n      }\n    },\n    confirmCreate() {\n      var totalPrice = 0\n      const data = {\n        groupName: this.factorGroupForm.groupName,\n        remark: this.factorGroupForm.remark,\n        authType: this.factorGroupForm.authType,\n        groupType: this.factorGroupForm.groupType,\n        groupCost: this.factorGroupForm.groupCost !== '' ? this.factorGroupForm.groupCost : '',\n        factorStandardIds: this.factorChoseData.map(i => {\n          totalPrice = parseFloat(totalPrice + i.price)\n          return {\n            checkStandardId: i.standardCode,\n            secdClassId: i.secdClassId,\n            factorName: i.factorName\n          }\n        })\n      }\n      if (this.factorGroupForm.groupType === '1') {\n        if (totalPrice <= this.factorGroupForm.groupCost) {\n          data.groupCost = totalPrice\n        }\n      }\n\n      factorServer.saveFactorGroup(data).then(request => {\n        this.$notify({\n          title: '成功',\n          message: request.message,\n          type: 'success'\n        })\n        this.handleSearch()\n        this.factorGroupDialogVisible = false\n        this.factorSameVisible = false\n      }).catch(() => {})\n    },\n    confirmUpdate() {\n      var totalPrice = 0\n      const data = {\n        groupId: this.factorGroupForm.groupId,\n        groupName: this.factorGroupForm.groupName,\n        authType: this.factorGroupForm.authType,\n        remark: this.factorGroupForm.remark,\n        groupType: this.factorGroupForm.groupType,\n        groupCost: this.factorGroupForm.groupCost !== '' ? this.factorGroupForm.groupCost : '',\n        factorStandardIds: this.factorChoseData.map(i => {\n          totalPrice = parseFloat(totalPrice + i.price)\n          return {\n            checkStandardId: i.standardCode,\n            secdClassId: i.secdClassId,\n            factorName: i.factorName\n          }\n        })\n      }\n      if (this.factorGroupForm.groupType === '1') {\n        if (totalPrice <= this.factorGroupForm.groupCost) {\n          data.groupCost = totalPrice\n        }\n      }\n      factorServer.modifyFactorGroupByGroupId(data).then(request => {\n        this.$notify({\n          title: '成功',\n          message: request.message,\n          type: 'success'\n        })\n        this.handleSearch()\n        this.factorGroupDialogVisible = false\n        this.factorSameVisible = false\n      }).catch(() => {})\n    },\n    handleDelete(id) {\n      this.$confirm('确定删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        factorServer.delByGroupId(id).then(result => {\n          if (result.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            })\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    handleCopy(id) {\n      this.$confirm('确定复制?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        factorServer.copyByGroupId(id).then(result => {\n          if (result.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            })\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    clearForm() {\n      this.factorGroupForm = {\n        groupId: '',\n        groupName: '',\n        authType: '0',\n        groupType: '',\n        groupCost: '',\n        remark: '',\n        factorStandardIds: []\n      }\n      this.factorChoseData = []\n    },\n\n    handleChose(val) {\n      if (val) {\n        val.forEach(i => {\n          const obj = this.factorChoseData.find(j => j.id === i.id && i.secdClassId && j.secdClassId === i.secdClassId)\n          debugger\n          if (!obj && i.secdClassId) {\n            this.factorChoseData.push(i)\n          }\n        })\n      }\n    },\n    handleSameChose(val) {\n      if (val) {\n        val.forEach(i => {\n          const obj = this.factorChoseData.find(j => j.id === i.id && i.secdClassId && j.secdClassId === i.secdClassId && i.standardNo === j.standardNo)\n          debugger\n          if (!obj && i.secdClassId) {\n            this.factorChoseData.push(i)\n          }\n        })\n      }\n    },\n    checkAutype() {\n      this.factorChoseData = []\n    },\n    handleRowDel(row, index) {\n      this.factorChoseData.splice(index, 1)\n      this.currentRow = row\n    },\n    handleDetail(groupId) {\n      factorServer.findCheckStandardsByGroupId(groupId).then(res => {\n        this.showGroupData = res.result || []\n        this.factorGroupVisible = true\n      })\n    },\n    handleDialogClose(done) {\n      this.factorGroupDialogVisible = false\n      this.$store.dispatch('user/resetCompForm', '')\n      done()\n    },\n    handleSameDialogClose(done) {\n      this.factorGroupDialogVisible = false\n      this.$store.dispatch('user/resetCompForm', '')\n      done()\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n    background: #F3F2F2;\n  }\n  .el-card {\n    overflow: auto;\n  }\n  ::v-deep .el-tooltip__popper {\n    max-width: 800px;\n  }\n  .icon-list {\n    overflow: hidden;\n    list-style: none;\n    padding: 0!important;\n    li {\n      float: left;\n      width: 50%;\n      text-align: center;\n      color: #666;\n      font-size: 13px;\n      height: 90px;\n      padding: 15px auto;\n      margin-right: -1px;\n      margin-bottom: -1px;\n      cursor: pointer;\n      span {\n        display: inline-block;\n        vertical-align: middle;\n        svg {\n          display: block;\n          font-size: 45px;\n          color: #606266;\n          width: 100%;\n          transition: color .15s linear;\n        }\n        .icon-name {\n          display: inline-block;\n          padding: 5px 3px;\n          height: 1em;\n        }\n      }\n    }\n    li:hover {\n      color: rgba($color: #409EFF, $alpha: 0.7);\n    }\n  }\n\n  ::v-deep .el-table__header-wrapper  .el-checkbox{\n    display:none\n  }\n</style>\n"],"sourceRoot":"src/views/order/factor"}]}