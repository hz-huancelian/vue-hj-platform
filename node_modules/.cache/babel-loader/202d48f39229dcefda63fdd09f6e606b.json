{"remainingRequest":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js!F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjects\\vue-hj-platform\\src\\views\\laboratoryTask\\components\\laborTaskList.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\webstormProjects\\vue-hj-platform\\src\\views\\laboratoryTask\\components\\laborTaskList.vue","mtime":1652690748000},{"path":"F:\\webstormProjects\\vue-hj-platform\\babel.config.js","mtime":1637214064000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireWildcard.js\");\n\nvar _interopRequireDefault = require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireDefault.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.array.find\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\toConsumableArray.js\"));\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nvar checkServer = _interopRequireWildcard(require(\"@/api/check\"));\n\nvar _checkSample = _interopRequireDefault(require(\"./checkSample\"));\n\nvar _Pagination = _interopRequireDefault(require(\"@/components/Pagination\"));\n\nvar _qs = _interopRequireDefault(require(\"qs\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// Secondary package based on el-pagination\nvar SAMPLE_STATUS = {\n  '0': '待分配',\n  '1': '检测中'\n};\nvar _default = {\n  components: {\n    Pagination: _Pagination.default,\n    checkSample: _checkSample.default\n  },\n  filters: {\n    statusQualityFilter: function statusQualityFilter(status) {\n      var statusMap = {\n        '0': 'info',\n        '1': '',\n        '2': 'success'\n      };\n      return statusMap[status];\n    }\n  },\n  data: function data() {\n    return {\n      SAMPLE_STATUS: SAMPLE_STATUS,\n      sampleData: [],\n      searchForm: {\n        jobId: '',\n        projectName: '',\n        checkTaskStatus: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      checkTaskId: '',\n      detailVisible: false,\n      userData: [],\n      laborTaskVisible: false,\n      currentRow: {},\n      multipleSelection: [],\n      factorData: [],\n      choseData: [],\n      loading: false\n    };\n  },\n  created: function created() {\n    this.getPersons();\n    this.handleSearch();\n  },\n  methods: {\n    handleSearch: function handleSearch() {\n      var _this = this;\n\n      checkServer.findByCondition(this.searchForm).then(function (res) {\n        if (res.code === 200) {\n          _this.sampleData = res.result.records;\n          _this.total = res.result.total;\n        }\n      });\n    },\n    getPersons: function getPersons() {\n      var _this2 = this;\n\n      checkServer.getCheckUsers().then(function (res) {\n        _this2.userData = res.result || [];\n      });\n    },\n    handleDetail: function handleDetail(row) {\n      this.checkTaskId = row.checkTaskId;\n      this.detailVisible = true;\n    },\n    handleSchedTask: function handleSchedTask(row) {\n      var _this3 = this;\n\n      this.currentRow = Object.assign({}, row);\n      this.choseData = [];\n      this.factorData = []; // 获取因子列表\n\n      checkServer.getOfferFactorsByTaskId(row.checkTaskId).then(function (result) {\n        if (result.code === 200 && result.result) {\n          _this3.factorData = result.result || [];\n        }\n\n        _this3.laborTaskVisible = true;\n      });\n    },\n    confirmDialog: function confirmDialog() {\n      var _this4 = this;\n\n      if (this.factorData.length > 0) {\n        this.$message.warning('因子需要一次分配完成');\n        return;\n      }\n\n      if (!this.choseData || this.choseData.length === 0) {\n        this.$message.warning('分配列表不能为空');\n        return;\n      }\n\n      this.loading = true;\n      var resdata = this.choseData.map(function (i) {\n        var offerFactorId = '';\n\n        if (i.factorNames) {\n          i.factorNames.forEach(function (j) {\n            if (offerFactorId === '') {\n              offerFactorId = j.jobPlanFactorId;\n            } else {\n              offerFactorId += ',' + j.jobPlanFactorId;\n            }\n          });\n        }\n\n        return {\n          checkUser: i.userId,\n          jobPlanFactorId: offerFactorId\n        };\n      });\n      var data = {\n        checkTaskId: this.currentRow.checkTaskId,\n        params: resdata\n      };\n      checkServer.assignmentsFactor(_qs.default.stringify({\n        param: JSON.stringify(data)\n      })).then(function (result) {\n        if (result.code === 200) {\n          _this4.$notify({\n            title: '成功',\n            message: result.message,\n            type: 'success'\n          });\n\n          _this4.handleSearch();\n\n          _this4.laborTaskVisible = false;\n        } else {\n          _this4.$notify({\n            title: '失败',\n            message: result.message,\n            type: 'error'\n          });\n        }\n\n        _this4.loading = false;\n      }).finally(function () {\n        _this4.loading = false;\n      });\n    },\n    handleSelectionChange: function handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    handleDelFactor: function handleDelFactor(row, index) {\n      var items = (0, _toConsumableArray2.default)(row.factorNames);\n      this.factorData = this.factorData.concat(items);\n      this.choseData.splice(index, 1);\n    },\n    checkPerson: function checkPerson(row) {\n      var _this5 = this;\n\n      if (this.multipleSelection && this.multipleSelection.length > 0) {\n        var obj = this.choseData.find(function (i) {\n          return i.userId === row.userId;\n        });\n\n        if (obj) {\n          // 存在进行追加\n          obj.factorNames = obj.factorNames.concat(this.multipleSelection);\n        } else {\n          // 不存在新增\n          this.choseData.push({\n            userId: row.userId,\n            empName: row.empName,\n            username: row.username,\n            factorNames: this.multipleSelection\n          });\n        } // 移除因子列表信息\n\n\n        this.multipleSelection.forEach(function (item) {\n          var index = _this5.factorData.indexOf(item);\n\n          _this5.factorData.splice(index, 1);\n        });\n        this.multipleSelection = [];\n      } else {\n        this.$message.warning('至少选择一个因子');\n      }\n    }\n  }\n};\nexports.default = _default;",{"version":3,"sources":["laborTaskList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <el-form :model=\"searchForm\" :inline=\"true\">\n      <el-row>\n        <el-col :span=\"20\">\n          <el-form-item label=\"任务单号:\">\n            <el-input v-model=\"searchForm.jobId\" style=\"width:165px\" placeholder=\"任务单号\" />\n          </el-form-item>\n          <el-form-item label=\"项目名称:\">\n            <el-input v-model=\"searchForm.projectName\" style=\"width:165px\" placeholder=\"项目名称\" />\n          </el-form-item>\n\n          <el-form-item label=\"任务状态\">\n            <el-select v-model=\"searchForm.checkTaskStatus\" clearable filterable style=\"width:165px\" placeholder=\"请选择状态\">\n              <el-option\n                v-for=\"item in Object.keys(SAMPLE_STATUS)\"\n                :key=\"item\"\n                :label=\"SAMPLE_STATUS[item]\"\n                :value=\"item\"\n              />\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" class=\"iconfont icon-chaxun1\" @click=\"handleSearch\"> 查询</el-button>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"4\" class=\"search-right\">\n          <el-button type=\"text\" icon=\"el-icon-refresh\" @click=\"handleSearch\">刷新</el-button>\n        </el-col>\n      </el-row>\n    </el-form>\n    <div>\n      <el-table\n        stripe\n        border\n        :data=\"sampleData\"\n        highlight-current-row\n        :header-cell-style=\"{background:'#ECF3FC'}\"\n        style=\"width: 100%\"\n      >\n        <template slot=\"empty\">\n          <div class=\"table_empty\">\n            <div class=\"empty_tips\">\n              <span>\n                暂无信息\n              </span>\n            </div>\n          </div>\n        </template>\n        <el-table-column type=\"index\" width=\"50\" label=\"序号\" fixed=\"left\" align=\"center\" />\n        <el-table-column prop=\"jobId\" label=\"任务单号\" fixed=\"left\" width=\"130px\" align=\"center\" />\n        <el-table-column prop=\"projectName\" label=\"项目名称\" width=\"150px\" align=\"center\" />\n        <el-table-column prop=\"inspectionName\" label=\"受检单位\" align=\"center\" />\n        <el-table-column label=\"任务时间\" align=\"center\" width=\"190px\">\n          <template slot-scope=\"{row}\">\n            {{ row.startDate }}~{{ row.endDate }}\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"checkTaskStatus\" label=\"状态\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag effect=\"dark\" :type=\"row.checkTaskStatus | statusQualityFilter\">\n              {{ SAMPLE_STATUS[row.checkTaskStatus] }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"scheduUser\" label=\"任务下发人\" width=\"135\" align=\"center\" />\n        <el-table-column prop=\"jobRemark\" label=\"备注\" align=\"center\" />\n        <el-table-column prop=\"createTime\" label=\"创建时间\" width=\"160\" align=\"center\" />\n\n        <el-table-column fixed=\"right\" align=\"center\" label=\"操作\" width=\"100px\">\n          <template slot-scope=\"scope\">\n            <el-button v-if=\"scope.row.checkTaskStatus > 0\" type=\"text\" @click=\"handleDetail(scope.row)\"> 查看</el-button>\n            <el-button v-if=\"scope.row.checkTaskStatus === '0'\" type=\"text\" @click=\"handleSchedTask(scope.row)\"> 任务分配</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n    <div style=\"float: right\">\n      <pagination\n        v-show=\"total>0\"\n        :total=\"total\"\n        :page.sync=\"searchForm.pageNumber\"\n        :limit.sync=\"searchForm.pageSize\"\n        @pagination=\"handleSearch\"\n      />\n    </div>\n\n    <el-dialog title=\"因子详情\" :visible.sync=\"detailVisible\" width=\"80%\" style=\"max-height; 600px\" top=\"5vh\">\n      <checkSample :task-id=\"checkTaskId\" />\n    </el-dialog>\n\n    <el-dialog title=\"任务分配\" :visible.sync=\"laborTaskVisible\" width=\"75%\" top=\"2vh\" :close-on-click-modal=\"false\">\n      <el-row :gutter=\"10\" style=\"height: 400px\">\n        <el-col :span=\"10\">\n          <el-card shadow=\"never\" style=\"height:400px\">\n            <div slot=\"header\" class=\"clearfix\">\n              <span>待分配检测因子<i class=\"el-input__icon\" /></span>\n            </div>\n            <el-table\n              :data=\"factorData\"\n              stripe\n              border\n              max-height=\"300\"\n              size=\"small\"\n              highlight-current-row\n              :header-cell-style=\"{background:'#ECF3FC'}\"\n              style=\"width: 100%\"\n              @selection-change=\"handleSelectionChange\"\n            >\n              <el-table-column type=\"selection\" width=\"45\" align=\"center\" />\n              <el-table-column prop=\"secdClassName\" label=\"检测对象\" align=\"center\" />\n              <el-table-column prop=\"factorName\" label=\"检测因子\" min-width=\"100px\" align=\"center\" />\n              <el-table-column prop=\"fbFlag\" label=\"状态\" align=\"center\" width=\"70\">\n                <template slot-scope=\"{row}\">\n                  <el-tag :type=\"row.fbFlag==='0'?'success':'danger'\">{{ row.fbFlag==='0'?'自检':'分包' }}</el-tag>\n\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-card>\n        </el-col>\n        <el-col :span=\"14\">\n          <el-card shadow=\"never\" style=\"height:400px\">\n            <div slot=\"header\" class=\"clearfix\">\n              <span>实验室人员列表<i class=\"el-input__icon\" /></span>\n            </div>\n            <el-table\n              :data=\"userData\"\n              stripe\n              border\n              size=\"small\"\n              max-height=\"380\"\n              highlight-current-row\n              :header-cell-style=\"{background:'#ECF3FC'}\"\n              style=\"width: 100%\"\n            >\n              <el-table-column type=\"index\" width=\"50\" align=\"center\" label=\"序号\" />\n              <el-table-column prop=\"empName\" align=\"center\" label=\"员工姓名\" />\n              <el-table-column prop=\"username\" align=\"center\" label=\"员工账号\" />\n              <el-table-column prop=\"cnt\" align=\"center\" label=\"待完成因子数\" />\n              <el-table-column label=\"操作\" align=\"center\">\n                <template slot-scope=\"{row}\">\n                  <el-button type=\"text\" size=\"small\" @click=\"checkPerson(row)\">因子分配</el-button>\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-card>\n        </el-col>\n      </el-row>\n      <el-row style=\"margin-top: 5px\">\n        <el-table\n          :data=\"choseData\"\n          stripe\n          border\n          highlight-current-row\n          :header-cell-style=\"{background:'#ECF3FC'}\"\n          style=\"width: 100%\"\n        >\n          <el-table-column type=\"index\" width=\"50\" label=\"序号\" align=\"center\" />\n          <el-table-column prop=\"empName\" label=\"员工姓名\" align=\"center\" />\n          <el-table-column prop=\"username\" label=\"员工账号\" align=\"center\" />\n          <el-table-column prop=\"factorNames\" label=\"检测因子\" min-width=\"100px\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <template v-if=\"row.factorNames\">\n                <el-row v-for=\"(item, index) in row.factorNames\" :key=\"index\" style=\"width:100%;height: 25px;\">\n                  <el-col :span=\"24\">\n                    {{ item.factorName }}\n                  </el-col>\n                </el-row>\n              </template>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" align=\"center\" width=\"100\">\n            <template slot-scope=\"{row, $index}\">\n              <el-button type=\"text\" @click=\"handleDelFactor(row, $index)\">移除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-row>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"laborTaskVisible=false\">取消</el-button>\n        <el-button :loading=\"loading\" type=\"primary\" @click=\"confirmDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport * as checkServer from '@/api/check'\nimport checkSample from './checkSample'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nimport qs from 'qs'\nconst SAMPLE_STATUS = {\n  '0': '待分配',\n  '1': '检测中'\n}\nexport default {\n  components: { Pagination, checkSample },\n  filters: {\n    statusQualityFilter(status) {\n      const statusMap = {\n        '0': 'info',\n        '1': '',\n        '2': 'success'\n      }\n      return statusMap[status]\n    }\n  },\n  data() {\n    return {\n      SAMPLE_STATUS,\n      sampleData: [],\n      searchForm: {\n        jobId: '',\n        projectName: '',\n        checkTaskStatus: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      checkTaskId: '',\n      detailVisible: false,\n      userData: [],\n      laborTaskVisible: false,\n      currentRow: {},\n      multipleSelection: [],\n      factorData: [],\n      choseData: [],\n      loading: false\n    }\n  },\n  created() {\n    this.getPersons()\n    this.handleSearch()\n  },\n  methods: {\n    handleSearch() {\n      checkServer.findByCondition(this.searchForm).then(res => {\n        if (res.code === 200) {\n          this.sampleData = res.result.records\n          this.total = res.result.total\n        }\n      })\n    },\n    getPersons() {\n      checkServer.getCheckUsers().then(res => {\n        this.userData = res.result || []\n      })\n    },\n    handleDetail(row) {\n      this.checkTaskId = row.checkTaskId\n      this.detailVisible = true\n    },\n    handleSchedTask(row) {\n      this.currentRow = Object.assign({}, row)\n      this.choseData = []\n      this.factorData = []\n      // 获取因子列表\n      checkServer.getOfferFactorsByTaskId(row.checkTaskId).then(result => {\n        if (result.code === 200 && result.result) {\n          this.factorData = result.result || []\n        }\n        this.laborTaskVisible = true\n      })\n    },\n    confirmDialog() {\n      if (this.factorData.length > 0) {\n        this.$message.warning('因子需要一次分配完成')\n        return\n      }\n\n      if (!this.choseData || this.choseData.length === 0) {\n        this.$message.warning('分配列表不能为空')\n        return\n      }\n      this.loading = true\n      const resdata = this.choseData.map(i => {\n        let offerFactorId = ''\n        if (i.factorNames) {\n          i.factorNames.forEach(j => {\n            if (offerFactorId === '') {\n              offerFactorId = j.jobPlanFactorId\n            } else {\n              offerFactorId += ',' + j.jobPlanFactorId\n            }\n          })\n        }\n        return { checkUser: i.userId, jobPlanFactorId: offerFactorId }\n      })\n      const data = {\n        checkTaskId: this.currentRow.checkTaskId,\n        params: resdata\n      }\n\n      checkServer.assignmentsFactor(qs.stringify({ param: JSON.stringify(data) })).then(result => {\n        if (result.code === 200) {\n          this.$notify({\n            title: '成功',\n            message: result.message,\n            type: 'success'\n          })\n          this.handleSearch()\n          this.laborTaskVisible = false\n        } else {\n          this.$notify({\n            title: '失败',\n            message: result.message,\n\n            type: 'error'\n          })\n        }\n        this.loading = false\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val\n    },\n    handleDelFactor(row, index) {\n      const items = [...row.factorNames]\n\n      this.factorData = this.factorData.concat(items)\n      this.choseData.splice(index, 1)\n    },\n    checkPerson(row) {\n      if (this.multipleSelection && this.multipleSelection.length > 0) {\n        const obj = this.choseData.find(i => i.userId === row.userId)\n        if (obj) { // 存在进行追加\n          obj.factorNames = obj.factorNames.concat(this.multipleSelection)\n        } else { // 不存在新增\n          this.choseData.push({\n            userId: row.userId,\n            empName: row.empName,\n            username: row.username,\n            factorNames: this.multipleSelection\n          })\n        }\n        // 移除因子列表信息\n        this.multipleSelection.forEach(item => {\n          const index = this.factorData.indexOf(item)\n          this.factorData.splice(index, 1)\n        })\n        this.multipleSelection = []\n      } else {\n        this.$message.warning('至少选择一个因子')\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  .item {\n    font-size: 16px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n    background: #F3F2F2;\n  }\n   .info-table-new {\n    font-size: 14px;\n    width: 100%;\n    text-align: center;\n    margin-top: 10px;\n    border-top: 1px solid #ececec;\n    border-left: 1px solid #ececec;\n    line-height: 35px;\n    td {\n      border-bottom: 1px solid #ececec;\n      border-right: 1px solid #ececec;\n      width: 25%;\n      height: 35px;\n      // &:nth-child(2n + 1) {\n      //   width: 25%;\n      //   background: #f5f5f5;\n      // }\n    }\n  }\n</style>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  .item {\n    font-size: 16px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n    background: #F3F2F2;\n  }\n  .block-flex {\n    position: relative;\n    display: flex;\n    &>div{\n      border: 1px solid #B7B7B7;\n      width: 100px;\n      margin: 0;\n      line-height: 30px;\n      text-align: center;\n    }\n    &>div:first-child {\n      background: #B7B7B7;\n    }\n  }\n  .card-left {\n    width: 100%;\n    min-height: 200px;\n    max-height: 400px;\n  }\n  .card-right {\n    width: 100%;\n    min-height: 200px;\n    max-height: 400px;\n  }\n  .el-card {\n    overflow: auto;\n  }\n  .el-dropdown-link {\n    cursor: pointer;\n    color: #409EFF;\n  }\n  .el-icon-arrow-down {\n    font-size: 12px;\n  }\n  // /deep/.el-table__header-wrapper  .el-checkbox{\n  //   display:none\n  // }\n\n</style>\n<style scoped>\n\ntable {\n    background-color: transparent\n}\n\ncaption {\n    padding-top: 8px;\n    padding-bottom: 8px;\n    color: #777;\n    text-align: left\n}\n\nth {\n    text-align: left\n}\n\n.table {\n    width: 100%;\n    max-width: 100%;\n    margin-bottom: 20px\n}\n\n.table>tbody>tr>td,.table>tbody>tr>th,.table>tfoot>tr>td,.table>tfoot>tr>th,.table>thead>tr>td,.table>thead>tr>th {\n    padding: 8px;\n    line-height: 1.42857143;\n    vertical-align: middle;\n    border-top: 1px solid #ddd\n}\n\n.table>thead>tr>th {\n    vertical-align: bottom;\n    border-bottom: 2px solid #ddd\n}\n\n.table>caption+thead>tr:first-child>td,.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>td,.table>thead:first-child>tr:first-child>th {\n    border-left: 1px solid #F1F2F4\n}\n\n.table>tbody+tbody {\n    border-top: 2px solid #ddd\n}\n\n.table .table {\n    background-color: #fff\n}\n\n.table-condensed>tbody>tr>td,.table-condensed>tbody>tr>th,.table-condensed>tfoot>tr>td,.table-condensed>tfoot>tr>th,.table-condensed>thead>tr>td,.table-condensed>thead>tr>th {\n    padding: 5px\n}\n\n.table-bordered {\n    border: 1px solid #ddd\n}\n\n.table-bordered>tbody>tr>td,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>td,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>thead>tr>th {\n    border: 1px solid #ddd\n}\n\n.table-bordered>thead>tr>td,.table-bordered>thead>tr>th {\n    border-bottom-width: 2px\n}\n\n.table-striped>tbody>tr:nth-of-type(odd) {\n    background-color: #f9f9f9\n}\n\n.table-hover>tbody>tr:hover {\n    background-color: #f5f5f5\n}\n\ntable col[class*=col-] {\n    position: static;\n    display: table-column;\n    float: none\n}\n\ntable td[class*=col-],table th[class*=col-] {\n    position: static;\n    display: table-cell;\n    float: none\n}\n\n.table>tbody>tr.active>td,.table>tbody>tr.active>th,.table>tbody>tr>td.active,.table>tbody>tr>th.active,.table>tfoot>tr.active>td,.table>tfoot>tr.active>th,.table>tfoot>tr>td.active,.table>tfoot>tr>th.active,.table>thead>tr.active>td,.table>thead>tr.active>th,.table>thead>tr>td.active,.table>thead>tr>th.active {\n    background-color: #f5f5f5\n}\n\n.table-hover>tbody>tr.active:hover>td,.table-hover>tbody>tr.active:hover>th,.table-hover>tbody>tr:hover>.active,.table-hover>tbody>tr>td.active:hover,.table-hover>tbody>tr>th.active:hover {\n    background-color: #e8e8e8\n}\n\n.table>tbody>tr.success>td,.table>tbody>tr.success>th,.table>tbody>tr>td.success,.table>tbody>tr>th.success,.table>tfoot>tr.success>td,.table>tfoot>tr.success>th,.table>tfoot>tr>td.success,.table>tfoot>tr>th.success,.table>thead>tr.success>td,.table>thead>tr.success>th,.table>thead>tr>td.success,.table>thead>tr>th.success {\n    background-color: #dff0d8\n}\n\n.table-hover>tbody>tr.success:hover>td,.table-hover>tbody>tr.success:hover>th,.table-hover>tbody>tr:hover>.success,.table-hover>tbody>tr>td.success:hover,.table-hover>tbody>tr>th.success:hover {\n    background-color: #d0e9c6\n}\n\n.table>tbody>tr.info>td,.table>tbody>tr.info>th,.table>tbody>tr>td.info,.table>tbody>tr>th.info,.table>tfoot>tr.info>td,.table>tfoot>tr.info>th,.table>tfoot>tr>td.info,.table>tfoot>tr>th.info,.table>thead>tr.info>td,.table>thead>tr.info>th,.table>thead>tr>td.info,.table>thead>tr>th.info {\n    background-color: #d9edf7\n}\n\n.table-hover>tbody>tr.info:hover>td,.table-hover>tbody>tr.info:hover>th,.table-hover>tbody>tr:hover>.info,.table-hover>tbody>tr>td.info:hover,.table-hover>tbody>tr>th.info:hover {\n    background-color: #c4e3f3\n}\n\n.table>tbody>tr.warning>td,.table>tbody>tr.warning>th,.table>tbody>tr>td.warning,.table>tbody>tr>th.warning,.table>tfoot>tr.warning>td,.table>tfoot>tr.warning>th,.table>tfoot>tr>td.warning,.table>tfoot>tr>th.warning,.table>thead>tr.warning>td,.table>thead>tr.warning>th,.table>thead>tr>td.warning,.table>thead>tr>th.warning {\n    background-color: #fcf8e3\n}\n\n.table-hover>tbody>tr.warning:hover>td,.table-hover>tbody>tr.warning:hover>th,.table-hover>tbody>tr:hover>.warning,.table-hover>tbody>tr>td.warning:hover,.table-hover>tbody>tr>th.warning:hover {\n    background-color: #faf2cc\n}\n\n.table>tbody>tr.danger>td,.table>tbody>tr.danger>th,.table>tbody>tr>td.danger,.table>tbody>tr>th.danger,.table>tfoot>tr.danger>td,.table>tfoot>tr.danger>th,.table>tfoot>tr>td.danger,.table>tfoot>tr>th.danger,.table>thead>tr.danger>td,.table>thead>tr.danger>th,.table>thead>tr>td.danger,.table>thead>tr>th.danger {\n    background-color: #f2dede\n}\n\n.table-hover>tbody>tr.danger:hover>td,.table-hover>tbody>tr.danger:hover>th,.table-hover>tbody>tr:hover>.danger,.table-hover>tbody>tr>td.danger:hover,.table-hover>tbody>tr>th.danger:hover {\n    background-color: #ebcccc\n}\n\n.table-responsive {\n  min-height: 3.01%;\n  overflow-x: auto;\n}\n\n.table-bordered, .table-bordered > tbody > tr > td, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > td, .table-bordered > tfoot > tr > th, .table-bordered > thead > tr > td, .table-bordered > thead > tr > th {\n    border: 1px solid #e9ecef;\n    text-align: center;\n}\n\n.table-bordered, td, th {\n    border-radius: 0 !important;\n}\n\n.table-bordered > tbody > tr:last-child > td {\n    border-bottom: 1px solid #e9ecef;\n}\n\n.bootstrap-table .fixed-table-container .fixed-table-header {\n    overflow: hidden;\n    background: rgba(0, 0, 0, .05);\n}\n\n.fixed-table-header .table > thead > tr {\n    background: none !important;\n}\n\n.table > thead > tr {\n    color: #636363;\n    font-weight: 400;\n    background: rgba(0, 0, 0, .05);\n    /*   background: repeat-x #fafafa;\n  background-image: -webkit-linear-gradient(top,#F8F8F8 0,#fafafa 100%);\n  background-image: -o-linear-gradient(top,#F8F8F8 0,#fafafa 100%);\n  background-image: linear-gradient(to bottom,#F8F8F8 0,#fafafa 100%);\n  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fff8f8f8', endColorstr='#ffececec', GradientType=0); */\n}\n\n.table > thead > tr > th {\n    border-color: #e9ecef;\n    font-weight: 700;\n    border-right-color: transparent;\n}\n\n.table > thead > tr > th .ace-icon:first-child {\n    margin-right: 2px;\n}\n\n.table > thead > tr > th:first-child {\n    border-left-color: #F1F1F1;\n}\n\n.table > thead > tr > th:last-child {\n    border-right-color: #F1F1F1;\n}\n\n.table.table-bordered > thead > tr > th {\n    vertical-align: middle;\n}\n\ntd.center, th.center {\n    text-align: center;\n}\n\ntd .lbl, th .lbl {\n    margin-bottom: 0;\n}\n\ntd .lbl:only-child, th .lbl:only-child {\n    vertical-align: top;\n}\n\n.table-header {\n    background-color: #307ECC;\n    color: #FFF;\n    font-size: 14px;\n    line-height: 30px;\n    padding-left: 12px;\n    margin-bottom: 1px;\n}\n\n.table-header .close {\n    margin-right: 8px;\n    margin-top: 0;\n    opacity: .45;\n    filter: alpha(opacity=45);\n}\n\n.table-header .close:hover {\n    opacity: .75;\n    filter: alpha(opacity=75);\n}\n\nth.detail-col {\n    width: 48px;\n    text-align: center;\n}\n\ntr.detail-row {\n    display: none;\n}\n\ntr.detail-row.open {\n    display: block;\n    display: table-row;\n}\n\ntr.detail-row > td {\n    background-color: #f1f6f8;\n    border-top: 3px solid #d1e1ea !important;\n}\n\n.table-detail {\n    background-color: #fff;\n    border: 1px solid #dcebf7;\n    width: 100%;\n    padding: 12px;\n}\n\n.table-detail td > .profile-user-info {\n    width: 100%;\n}\n\n</style>\n"],"sourceRoot":"src/views/laboratoryTask/components"}]}