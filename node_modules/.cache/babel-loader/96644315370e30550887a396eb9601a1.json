{"remainingRequest":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js!F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjectsJiu\\vue-hj-platform\\src\\views\\contract\\subContract.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\src\\views\\contract\\subContract.vue","mtime":1653457903000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\babel.config.js","mtime":1637214064000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"F:\\\\webstormProjectsJiu\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireDefault.js\");\n\nvar _interopRequireWildcard = require(\"F:\\\\webstormProjectsJiu\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireWildcard.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nvar contractServer = _interopRequireWildcard(require(\"@/api/contract\"));\n\nvar cusServer = _interopRequireWildcard(require(\"@/api/customer\"));\n\nvar _Pagination = _interopRequireDefault(require(\"@/components/Pagination\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// Secondary package based on el-pagination\nvar CONTRACT_STATUS = {\n  '0': '待完善',\n  '1': '待审核',\n  '2': '审核失败',\n  '3': '待制作',\n  '4': '已制作',\n  '5': '已作废'\n};\nvar _default = {\n  components: {\n    Pagination: _Pagination.default\n  },\n  filters: {\n    statusQualityFilter: function statusQualityFilter(status) {\n      if (status === '0' || status === '2') {\n        return '';\n      } else if (status === '3' || status === '1') {\n        return 'info';\n      } else if (status === '4') {\n        return 'success';\n      } else {\n        return 'danger';\n      }\n    }\n  },\n  data: function data() {\n    return {\n      CONTRACT_STATUS: CONTRACT_STATUS,\n      contractData: [],\n      searchForm: {\n        contCode: '',\n        contName: '',\n        contStatus: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      contractVisible: false,\n      contractForm: {\n        contId: '',\n        contractInfoTdo: {\n          signDate: '',\n          signLocation: '',\n          payMethod: '0',\n          payMethodDesc: '',\n          validity: ''\n        },\n        cusContBaseInfoId: '',\n        addTdo: {\n          companyName: '',\n          address: '',\n          postCode: '',\n          jurPerson: '',\n          agentPerson: '',\n          telFax: '',\n          bankName: '',\n          bankNo: '',\n          taxNumber: ''\n        }\n      },\n      contractStatus: 'create',\n      contractRules: {\n        contractInfoTdo: {\n          validity: [{\n            required: true,\n            message: '请录入有效期',\n            trigger: 'blur'\n          }],\n          signDate: [{\n            required: true,\n            message: '请录入签订日期',\n            trigger: 'blur'\n          }],\n          signLocation: [{\n            required: true,\n            message: '请录入地址',\n            trigger: 'blur'\n          }],\n          payMethod: [{\n            required: true,\n            message: '请选择支付方式',\n            trigger: 'blur'\n          }],\n          payMethodDesc: [{\n            required: true,\n            message: '请录支付说明',\n            trigger: 'blur'\n          }]\n        },\n        addTdo: {\n          companyName: [{\n            required: true,\n            message: '请录入客户名称',\n            trigger: 'blur'\n          }],\n          address: [{\n            required: true,\n            message: '请录入单位地址',\n            trigger: 'blur'\n          }],\n          postCode: [{\n            required: true,\n            message: '请录入电话/传真',\n            trigger: 'blur'\n          }],\n          jurPerson: [{\n            required: true,\n            message: '请录入邮政编码',\n            trigger: 'blur'\n          }],\n          agentPerson: [{\n            required: true,\n            message: '请录入法定代表人',\n            trigger: 'blur'\n          }],\n          telFax: [{\n            required: true,\n            message: '请录入委托代理人',\n            trigger: 'blur'\n          }],\n          bankName: [{\n            required: true,\n            message: '请录入开户银行',\n            trigger: 'blur'\n          }],\n          bankNo: [{\n            required: true,\n            message: '请录入银行账号',\n            trigger: 'blur'\n          }],\n          taxNumber: [{\n            required: true,\n            message: '请录入税号',\n            trigger: 'blur'\n          }]\n        }\n      },\n      restaurants: [],\n      contarctUploadForm: {\n        contId: '',\n        contFileId: '',\n        signDate: '',\n        validity: 1\n      },\n      fileList: [],\n      activeName: 'maker',\n      companyMap: {},\n      approveVisible: false,\n      currentItem: {},\n      approveForm: {\n        contId: '',\n        auditFlag: '1',\n        auditReason: ''\n      }\n    };\n  },\n  created: function created() {\n    this.handleSearch();\n  },\n  methods: {\n    handleSearch: function handleSearch() {\n      var _this = this;\n\n      contractServer.findSubContInfosByCondition(this.searchForm).then(function (res) {\n        if (res.code === 200 && res.result) {\n          _this.contractData = res.result.records || [];\n          _this.total = res.result.total;\n        }\n      });\n    },\n    querySearchAsync: function querySearchAsync(queryString, cb) {\n      var _this2 = this;\n\n      var restaurants = this.restaurants;\n\n      if (queryString) {\n        // 调用远程接口获取数据信息\n        cusServer.fuzzyQuery(queryString).then(function (res) {\n          if (res.result) {\n            _this2.companyMap = res.result || {};\n            cb(Object.keys(res.result));\n          } else {\n            cb([]);\n          }\n        }).catch(function () {\n          cb([]);\n        });\n      } else {\n        cb(restaurants);\n      }\n    },\n    confirmDialog: function confirmDialog() {\n      // 合同上传\n      if (!this.contarctUploadForm.signDate) {\n        this.$message.warning('完成日期不能为空');\n        return;\n      }\n\n      this.$refs.upload.submit();\n      setTimeout(function () {\n        this.handleSearch();\n      }, 1500); // if (this.contarctUploadForm.signDate && this.contarctUploadForm.validity) {\n      //   contractServer.saveLocalContract(this.contarctUploadForm).then(result => {\n      //     if (result.code === 200) {\n      //       this.$notify({\n      //         title: '成功',\n      //         message: result.message,\n      //         type: 'success'\n      //       })\n      //       this.contractVisible = false\n      //       this.handleSearch()\n      //     } else {\n      //       this.$notify({\n      //         title: '失败',\n      //         message: result.message,\n      //         type: 'error'\n      //       })\n      //     }\n      //   })\n      // } else {\n      //   this.$message.error('签订时间和周期不能为空')\n      // }\n    },\n    handleDetail: function handleDetail(row) {\n      if (row.contFileId !== '' || row.contFileId !== '--') {\n        this.$router.push({\n          name: 'sysPdfView',\n          params: {\n            path: row.contFileId,\n            type: 1\n          }\n        });\n      } else {\n        this.$message.error('合同文件还未上传');\n      }\n    },\n    onUploadChange: function onUploadChange(file) {\n      if (file.status === 'ready') return;\n\n      if (file.status === 'success') {\n        var res = file.response || {};\n\n        if (res && res.code === 200) {\n          this.contarctUploadForm.contFileId = file.response.result;\n          this.$message({\n            type: 'success',\n            message: '上传成功!'\n          });\n          this.contractVisible = false;\n        } else {\n          this.$message.error('上传失败!');\n        }\n      } else {\n        this.$message.error('上传失败!');\n      }\n    },\n    onExceed: function onExceed() {\n      this.$message.error('最多上传一个文件');\n    },\n    onUploadRemove: function onUploadRemove() {\n      this.contarctUploadForm.contFileId = '';\n    },\n    handleDwonload: function handleDwonload(row) {\n      var url = this.$store.getters.sysBaseUrl + '/file/ht/upload/' + row.contFileId;\n      window.open(url);\n    },\n    handleUpload: function handleUpload(row) {\n      this.contarctUploadForm.contId = row.id;\n      this.contractVisible = true;\n    },\n    confirmApproveDialog: function confirmApproveDialog() {\n      var _this3 = this;\n\n      this.$confirm('确定提交?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        contractServer.auditCont(_this3.approveForm).then(function (res) {\n          if (res.code === 200) {\n            _this3.$notify({\n              title: '成功',\n              message: res.message,\n              type: 'success'\n            });\n\n            _this3.approveVisible = false;\n\n            _this3.handleSearch();\n          } else {\n            _this3.$notify({\n              title: '失败',\n              message: res.message,\n              type: 'error'\n            });\n          }\n        });\n      }).catch(function () {});\n    }\n  }\n};\nexports.default = _default;",{"version":3,"sources":["subContract.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form :model=\"searchForm\" :inline=\"true\">\n      <el-row>\n        <el-col :span=\"20\">\n          <el-form-item label=\"合同编号:\">\n            <el-input v-model=\"searchForm.contCode\" style=\"width:180px\" placeholder=\"合同编号\" />\n          </el-form-item>\n          <el-form-item label=\"项目名称:\">\n            <el-input v-model=\"searchForm.contName\" style=\"width:180px\" placeholder=\"项目名称\" />\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" class=\"iconfont icon-chaxun1\" @click=\"handleSearch\"> 查询</el-button>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"4\" class=\"search-right\">\n          <el-button type=\"text\" icon=\"el-icon-refresh\" @click=\"handleSearch\">刷新</el-button>\n        </el-col>\n      </el-row>\n    </el-form>\n    <div>\n      <el-table\n        stripe\n        border\n        :data=\"contractData\"\n        highlight-current-row\n        :header-cell-style=\"{background:'#ECF3FC'}\"\n        style=\"width: 100%\"\n      >\n        <template slot=\"empty\">\n          <div class=\"table_empty\">\n            <div class=\"empty_tips\">\n              <span>\n                暂无合同信息\n              </span>\n            </div>\n          </div>\n        </template>\n        <el-table-column type=\"index\" width=\"55\" label=\"序号\" fixed=\"left\" align=\"center\" />\n        <el-table-column prop=\"contCode\" label=\"合同编号\" width=\"190px\" align=\"center\" />\n        <el-table-column prop=\"offerId\" label=\"报价单号\" width=\"170px\" align=\"center\" />\n        <el-table-column prop=\"projectName\" label=\"项目名称\" min-width=\"140px\" align=\"center\" />\n        <el-table-column prop=\"judgeOrganName\" label=\"分包机构名称\" min-width=\"120px\" align=\"center\" />\n        <el-table-column prop=\"signDate\" label=\"签订时间\" width=\"160px\" align=\"center\" />\n        <!-- <el-table-column prop=\"makeUserId\" label=\"合同制作人\" width=\"110\" align=\"center\" /> -->\n\n        <el-table-column fixed=\"right\" align=\"center\" label=\"操作\" width=\"160px\">\n          <template slot-scope=\"{row}\">\n            <!-- <el-button v-if=\"row.signDate && row.signDate.length > 0\" type=\"text\" @click=\"handleDetail(row)\"> 查看</el-button>\n            <div v-if=\"row.signDate && row.signDate.length > 0\" class=\"erc-divider-vertical\" /> -->\n            <el-button v-if=\"row.signDate && row.signDate.length\" type=\"text\" @click=\"handleDwonload(row)\"> 下载</el-button>\n            <div v-if=\"row.signDate && row.signDate.length > 0\" class=\"erc-divider-vertical\" />\n            <el-button type=\"text\" @click=\"handleUpload(row)\">合同上传</el-button>\n\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n    <div style=\"float: right\">\n      <pagination\n        v-show=\"total>0\"\n        :total=\"total\"\n        :page.sync=\"searchForm.pageNumber\"\n        :limit.sync=\"searchForm.pageSize\"\n        @pagination=\"handleSearch\"\n      />\n    </div>\n    <el-dialog title=\"合同信息上传\" :visible.sync=\"contractVisible\" top=\"5vh\">\n      <el-form :model=\"contarctUploadForm\" label-width=\"110px\">\n        <el-form-item prop=\"signDate\" label=\"签订时间:\">\n          <el-date-picker\n            v-model=\"contarctUploadForm.signDate\"\n            type=\"date\"\n            value-format=\"yyyy-MM-dd\"\n            placeholder=\"签订日期\"\n            style=\"width: 260px;\"\n          />\n        </el-form-item>\n        <el-form-item label=\"有效期(年):\">\n          <el-input-number v-model=\"contarctUploadForm.validity\" controls-position=\"right\" style=\"width: 260px;\" :min=\"1\" :step=\"1\" :precision=\"0\" />\n        </el-form-item>\n        <el-form-item label=\"合同附件上传:\">\n          <el-upload\n            ref=\"upload\"\n            drag\n            class=\"upload-demo\"\n            :data=\"{'id':contarctUploadForm.contId,'signDate':contarctUploadForm.signDate, 'validity':contarctUploadForm.validity}\"\n            action=\"/api/cont/uploadSubContFile\"\n            :on-change=\"onUploadChange\"\n            :on-exceed=\"onExceed\"\n            :on-remove=\"onUploadRemove\"\n            accept=\".doc,.docx,.pdf\"\n\n            :auto-upload=\"false\"\n            :limit=\"1\"\n            :file-list=\"fileList\"\n          >\n            <i class=\"el-icon-upload\" />\n            <div class=\"el-upload__text\">\n              将文件拖到此处，或\n              <em>点击上传</em>\n            </div>\n            <div slot=\"tip\" class=\"el-upload__tip\" />\n            <div slot=\"tip\" class=\"el-upload__tip\" style=\"color:red\">注:您只能上传.doc,.docx,.pdf格式的文件</div>\n          </el-upload>\n\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"contractVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport * as contractServer from '@/api/contract'\nimport * as cusServer from '@/api/customer'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nconst CONTRACT_STATUS = {\n  '0': '待完善',\n  '1': '待审核',\n  '2': '审核失败',\n  '3': '待制作',\n  '4': '已制作',\n  '5': '已作废'\n}\nexport default {\n  components: { Pagination },\n  filters: {\n    statusQualityFilter(status) {\n      if (status === '0' || status === '2') {\n        return ''\n      } else if (status === '3' || status === '1') {\n        return 'info'\n      } else if (status === '4') {\n        return 'success'\n      } else {\n        return 'danger'\n      }\n    }\n  },\n  data() {\n    return {\n      CONTRACT_STATUS,\n      contractData: [],\n      searchForm: {\n        contCode: '',\n        contName: '',\n        contStatus: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      contractVisible: false,\n      contractForm: {\n        contId: '',\n        contractInfoTdo: {\n          signDate: '',\n          signLocation: '',\n          payMethod: '0',\n          payMethodDesc: '',\n          validity: ''\n        },\n        cusContBaseInfoId: '',\n        addTdo: {\n          companyName: '',\n          address: '',\n          postCode: '',\n          jurPerson: '',\n          agentPerson: '',\n          telFax: '',\n          bankName: '',\n          bankNo: '',\n          taxNumber: ''\n        }\n      },\n      contractStatus: 'create',\n      contractRules: {\n        contractInfoTdo: {\n          validity: [{ required: true, message: '请录入有效期', trigger: 'blur' }],\n          signDate: [{ required: true, message: '请录入签订日期', trigger: 'blur' }],\n          signLocation: [{ required: true, message: '请录入地址', trigger: 'blur' }],\n          payMethod: [{ required: true, message: '请选择支付方式', trigger: 'blur' }],\n          payMethodDesc: [{ required: true, message: '请录支付说明', trigger: 'blur' }]\n        },\n        addTdo: {\n          companyName: [{ required: true, message: '请录入客户名称', trigger: 'blur' }],\n          address: [{ required: true, message: '请录入单位地址', trigger: 'blur' }],\n          postCode: [{ required: true, message: '请录入电话/传真', trigger: 'blur' }],\n          jurPerson: [{ required: true, message: '请录入邮政编码', trigger: 'blur' }],\n          agentPerson: [{ required: true, message: '请录入法定代表人', trigger: 'blur' }],\n          telFax: [{ required: true, message: '请录入委托代理人', trigger: 'blur' }],\n          bankName: [{ required: true, message: '请录入开户银行', trigger: 'blur' }],\n          bankNo: [{ required: true, message: '请录入银行账号', trigger: 'blur' }],\n          taxNumber: [{ required: true, message: '请录入税号', trigger: 'blur' }]\n        }\n      },\n\n      restaurants: [],\n      contarctUploadForm: {\n        contId: '',\n        contFileId: '',\n        signDate: '',\n        validity: 1\n      },\n      fileList: [],\n      activeName: 'maker',\n      companyMap: {},\n      approveVisible: false,\n      currentItem: {},\n      approveForm: {\n        contId: '',\n        auditFlag: '1',\n        auditReason: ''\n      }\n    }\n  },\n  created() {\n    this.handleSearch()\n  },\n  methods: {\n    handleSearch() {\n      contractServer.findSubContInfosByCondition(this.searchForm).then(res => {\n        if (res.code === 200 && res.result) {\n          this.contractData = res.result.records || []\n          this.total = res.result.total\n        }\n      })\n    },\n    querySearchAsync(queryString, cb) {\n      var restaurants = this.restaurants\n\n      if (queryString) {\n        // 调用远程接口获取数据信息\n        cusServer.fuzzyQuery(queryString).then(res => {\n          if (res.result) {\n            this.companyMap = res.result || {}\n            cb(Object.keys(res.result))\n          } else {\n            cb([])\n          }\n        }).catch(() => {\n          cb([])\n        })\n      } else {\n        cb(restaurants)\n      }\n    },\n    confirmDialog() {\n      // 合同上传\n      if (!this.contarctUploadForm.signDate) {\n        this.$message.warning('完成日期不能为空')\n        return\n      }\n      this.$refs.upload.submit()\n      setTimeout(function() {\n        this.handleSearch()\n      }, 1500)\n      // if (this.contarctUploadForm.signDate && this.contarctUploadForm.validity) {\n      //   contractServer.saveLocalContract(this.contarctUploadForm).then(result => {\n      //     if (result.code === 200) {\n      //       this.$notify({\n      //         title: '成功',\n      //         message: result.message,\n      //         type: 'success'\n      //       })\n      //       this.contractVisible = false\n      //       this.handleSearch()\n      //     } else {\n      //       this.$notify({\n      //         title: '失败',\n      //         message: result.message,\n      //         type: 'error'\n      //       })\n      //     }\n      //   })\n      // } else {\n      //   this.$message.error('签订时间和周期不能为空')\n      // }\n    },\n    handleDetail(row) {\n      if (row.contFileId !== '' || row.contFileId !== '--') {\n        this.$router.push({ name: 'sysPdfView', params: { path: row.contFileId, type: 1 }})\n      } else {\n        this.$message.error('合同文件还未上传')\n      }\n    },\n\n    onUploadChange(file) {\n      if (file.status === 'ready') return\n      if (file.status === 'success') {\n        const res = file.response || {}\n        if (res && res.code === 200) {\n          this.contarctUploadForm.contFileId = file.response.result\n          this.$message({\n            type: 'success',\n            message: '上传成功!'\n          })\n          this.contractVisible = false\n        } else {\n          this.$message.error('上传失败!')\n        }\n      } else {\n        this.$message.error('上传失败!')\n      }\n    },\n    onExceed() {\n      this.$message.error('最多上传一个文件')\n    },\n    onUploadRemove() {\n      this.contarctUploadForm.contFileId = ''\n    },\n\n    handleDwonload(row) {\n      var url = this.$store.getters.sysBaseUrl + '/file/ht/upload/' + row.contFileId\n      window.open(url)\n    },\n    handleUpload(row) {\n      this.contarctUploadForm.contId = row.id\n      this.contractVisible = true\n    },\n\n    confirmApproveDialog() {\n      this.$confirm('确定提交?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        contractServer.auditCont(this.approveForm).then(res => {\n          if (res.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: res.message,\n              type: 'success'\n            })\n            this.approveVisible = false\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: res.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  .item {\n    font-size: 16px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n    background: #F3F2F2;\n  }\n</style>\n"],"sourceRoot":"src/views/contract"}]}