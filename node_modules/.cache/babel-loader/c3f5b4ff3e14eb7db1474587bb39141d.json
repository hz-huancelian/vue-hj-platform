{"remainingRequest":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js!F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjects\\vue-hj-platform\\src\\views\\profile\\userAvatar.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\webstormProjects\\vue-hj-platform\\src\\views\\profile\\userAvatar.vue","mtime":1637214064000},{"path":"F:\\webstormProjects\\vue-hj-platform\\babel.config.js","mtime":1637214064000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireDefault.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _store = _interopRequireDefault(require(\"@/store\"));\n\nvar _vueCropper = require(\"vue-cropper\");\n\nvar _user = require(\"@/api/system/user\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  components: {\n    VueCropper: _vueCropper.VueCropper\n  },\n  props: {\n    // eslint-disable-next-line vue/require-default-prop\n    user: {\n      type: Object\n    }\n  },\n  data: function data() {\n    return {\n      // 是否显示弹出层\n      open: false,\n      // 是否显示cropper\n      visible: false,\n      // 弹出层标题\n      title: '修改头像',\n      options: {\n        img: _store.default.getters.avatar,\n        // 裁剪图片的地址\n        autoCrop: true,\n        // 是否默认生成截图框\n        autoCropWidth: 200,\n        // 默认生成截图框宽度\n        autoCropHeight: 200,\n        // 默认生成截图框高度\n        fixedBox: true // 固定截图框大小 不允许改变\n\n      },\n      previews: {}\n    };\n  },\n  methods: {\n    // 编辑头像\n    editCropper: function editCropper() {\n      this.open = true;\n    },\n    // 打开弹出层结束时的回调\n    modalOpened: function modalOpened() {\n      this.visible = true;\n    },\n    // 覆盖默认的上传行为\n    requestUpload: function requestUpload() {},\n    // 向左旋转\n    rotateLeft: function rotateLeft() {\n      this.$refs.cropper.rotateLeft();\n    },\n    // 向右旋转\n    rotateRight: function rotateRight() {\n      this.$refs.cropper.rotateRight();\n    },\n    // 图片缩放\n    changeScale: function changeScale(num) {\n      num = num || 1;\n      this.$refs.cropper.changeScale(num);\n    },\n    // 上传预处理\n    beforeUpload: function beforeUpload(file) {\n      var _this = this;\n\n      if (file.type.indexOf('image/') === -1) {\n        this.msgError('文件格式错误，请上传图片类型,如：JPG，PNG后缀的文件。');\n      } else {\n        var reader = new FileReader();\n        reader.readAsDataURL(file);\n\n        reader.onload = function () {\n          _this.options.img = reader.result;\n        };\n      }\n    },\n    // 上传图片\n    uploadImg: function uploadImg() {\n      var _this2 = this;\n\n      this.$refs.cropper.getCropBlob(function (data) {\n        var formData = new FormData();\n        formData.append('file', data, 'file.png');\n        (0, _user.uploadAvatar)(formData).then(function (response) {\n          _this2.open = false; // this.options.img = process.env.VUE_APP_BASE_API + response.imgUrl\n\n          debugger;\n\n          _this2.$store.dispatch('user/resetAttrPath', response.result); // store.commit('SET_AVATAR', this.options.img)\n\n\n          _this2.msgSuccess('修改成功');\n\n          _this2.visible = false;\n        });\n      });\n    },\n    // 实时预览\n    realTime: function realTime(data) {\n      this.previews = data;\n    },\n    // 关闭窗口\n    closeDialog: function closeDialog() {\n      this.options.img = _store.default.getters.avatar;\n      this.visible = false;\n    }\n  }\n};\nexports.default = _default;",{"version":3,"sources":["userAvatar.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div class=\"user-info-head\" @click=\"editCropper()\">\n      <template v-if=\"options.img\">\n        <img :src=\"options.img\" title=\"点击上传头像\" class=\"img-circle img-lg\">\n      </template>\n      <template v-else>\n        <img src=\"@/assets/image/default.jpg\" class=\"img-circle img-lg\">\n      </template>\n    </div>\n    <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"800px\" append-to-body @opened=\"modalOpened\" @close=\"closeDialog()\">\n      <el-row>\n        <el-col :xs=\"24\" :md=\"12\" :style=\"{height: '350px'}\">\n          <vue-cropper\n            v-if=\"visible\"\n            ref=\"cropper\"\n            :img=\"options.img\"\n            :info=\"true\"\n            :auto-crop=\"options.autoCrop\"\n            :auto-crop-width=\"options.autoCropWidth\"\n            :auto-crop-height=\"options.autoCropHeight\"\n            :fixed-box=\"options.fixedBox\"\n            @realTime=\"realTime\"\n          />\n        </el-col>\n        <el-col :xs=\"24\" :md=\"12\" :style=\"{height: '350px'}\">\n          <div class=\"avatar-upload-preview\">\n            <img :src=\"previews.url\" :style=\"previews.img\">\n          </div>\n        </el-col>\n      </el-row>\n      <br>\n      <el-row>\n        <el-col :lg=\"2\" :md=\"2\">\n          <el-upload action=\"#\" :http-request=\"requestUpload\" :show-file-list=\"false\" :before-upload=\"beforeUpload\">\n            <el-button size=\"small\">\n              选择\n              <i class=\"el-icon-upload el-icon--right\" />\n            </el-button>\n          </el-upload>\n        </el-col>\n        <el-col :lg=\"{span: 1, offset: 2}\" :md=\"2\">\n          <el-button icon=\"el-icon-plus\" size=\"small\" @click=\"changeScale(1)\" />\n        </el-col>\n        <el-col :lg=\"{span: 1, offset: 1}\" :md=\"2\">\n          <el-button icon=\"el-icon-minus\" size=\"small\" @click=\"changeScale(-1)\" />\n        </el-col>\n        <el-col :lg=\"{span: 1, offset: 1}\" :md=\"2\">\n          <el-button icon=\"el-icon-refresh-left\" size=\"small\" @click=\"rotateLeft()\" />\n        </el-col>\n        <el-col :lg=\"{span: 1, offset: 1}\" :md=\"2\">\n          <el-button icon=\"el-icon-refresh-right\" size=\"small\" @click=\"rotateRight()\" />\n        </el-col>\n        <el-col :lg=\"{span: 2, offset: 6}\" :md=\"2\">\n          <el-button type=\"primary\" size=\"small\" @click=\"uploadImg()\">提 交</el-button>\n        </el-col>\n      </el-row>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport store from '@/store'\nimport { VueCropper } from 'vue-cropper'\nimport { uploadAvatar } from '@/api/system/user'\n\nexport default {\n  components: { VueCropper },\n  props: {\n    // eslint-disable-next-line vue/require-default-prop\n    user: {\n      type: Object\n    }\n  },\n  data() {\n    return {\n      // 是否显示弹出层\n      open: false,\n      // 是否显示cropper\n      visible: false,\n      // 弹出层标题\n      title: '修改头像',\n      options: {\n        img: store.getters.avatar, // 裁剪图片的地址\n        autoCrop: true, // 是否默认生成截图框\n        autoCropWidth: 200, // 默认生成截图框宽度\n        autoCropHeight: 200, // 默认生成截图框高度\n        fixedBox: true // 固定截图框大小 不允许改变\n      },\n      previews: {}\n    }\n  },\n  methods: {\n    // 编辑头像\n    editCropper() {\n      this.open = true\n    },\n    // 打开弹出层结束时的回调\n    modalOpened() {\n      this.visible = true\n    },\n    // 覆盖默认的上传行为\n    requestUpload() {\n    },\n    // 向左旋转\n    rotateLeft() {\n      this.$refs.cropper.rotateLeft()\n    },\n    // 向右旋转\n    rotateRight() {\n      this.$refs.cropper.rotateRight()\n    },\n    // 图片缩放\n    changeScale(num) {\n      num = num || 1\n      this.$refs.cropper.changeScale(num)\n    },\n    // 上传预处理\n    beforeUpload(file) {\n      if (file.type.indexOf('image/') === -1) {\n        this.msgError('文件格式错误，请上传图片类型,如：JPG，PNG后缀的文件。')\n      } else {\n        const reader = new FileReader()\n        reader.readAsDataURL(file)\n        reader.onload = () => {\n          this.options.img = reader.result\n        }\n      }\n    },\n    // 上传图片\n    uploadImg() {\n      this.$refs.cropper.getCropBlob(data => {\n        const formData = new FormData()\n        formData.append('file', data, 'file.png')\n\n        uploadAvatar(formData).then(response => {\n          this.open = false\n          // this.options.img = process.env.VUE_APP_BASE_API + response.imgUrl\n          debugger\n          this.$store.dispatch('user/resetAttrPath', response.result)\n          // store.commit('SET_AVATAR', this.options.img)\n          this.msgSuccess('修改成功')\n          this.visible = false\n        })\n      })\n    },\n    // 实时预览\n    realTime(data) {\n      this.previews = data\n    },\n    // 关闭窗口\n    closeDialog() {\n      this.options.img = store.getters.avatar\n      this.visible = false\n    }\n  }\n}\n</script>\n<style scoped lang=\"scss\">\n.user-info-head {\n  position: relative;\n  display: inline-block;\n  height: 120px;\n}\n\n.user-info-head:hover:after {\n  content: '+';\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  color: #eee;\n  background: rgba(0, 0, 0, 0.5);\n  font-size: 24px;\n  font-style: normal;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  cursor: pointer;\n  line-height: 110px;\n  border-radius: 50%;\n}\n</style>\n"],"sourceRoot":"src/views/profile"}]}