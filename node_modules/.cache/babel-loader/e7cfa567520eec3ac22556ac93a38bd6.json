{"remainingRequest":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js!F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjects\\vue-hj-platform\\src\\views\\system\\dept\\deptList.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\webstormProjects\\vue-hj-platform\\src\\views\\system\\dept\\deptList.vue","mtime":1638252990000},{"path":"F:\\webstormProjects\\vue-hj-platform\\babel.config.js","mtime":1637214064000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireWildcard.js\");\n\nvar _interopRequireDefault = require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\interopRequireDefault.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _objectSpread2 = _interopRequireDefault(require(\"F:\\\\webstormProjects\\\\vue-hj-platform\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\objectSpread2.js\"));\n\nvar deptServer = _interopRequireWildcard(require(\"@/api/dept\"));\n\nvar _dict = require(\"@/api/dict\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'DeptList',\n  data: function data() {\n    return {\n      deptTreeData: [],\n      defaultProps: {\n        children: 'children',\n        label: 'deptName',\n        id: 'id'\n      },\n      titleMap: {\n        edit: '修改部门',\n        create: '新增部门'\n      },\n      posTitleMap: {\n        edit: '修改岗位',\n        create: '新增岗位'\n      },\n      deptDialogStatus: 'create',\n      currentDeptId: '',\n      currentDeptName: '',\n      departData: [],\n      filterText: '',\n      departVisible: false,\n      departForm: {\n        parentDeptId: '',\n        platformDeptId: '',\n        deptId: '',\n        deptName: '',\n        deptDesc: ''\n      },\n      departRules: {\n        deptName: [{\n          required: true,\n          message: '部门名称',\n          trigger: 'blur'\n        }],\n        platformDeptId: [{\n          required: true,\n          message: '请选择平台流转权限',\n          trigger: 'change'\n        }]\n      },\n      currentTreeItem: {},\n      departName: '',\n      roleListArray: [],\n      currentNode: {},\n      currentResolve: {},\n      plDeptmentArray: []\n    };\n  },\n  watch: {\n    filterText: function filterText(val) {\n      this.$refs.tree.filter(val);\n    }\n  },\n  created: function created() {\n    this.getDicKey('plDeptmentArray', 1001);\n    this.getDeptTreeList();\n  },\n  methods: {\n    getDicKey: function getDicKey(type, code) {\n      var _this = this;\n\n      (0, _dict.getDicKey)(code).then(function (result) {\n        if (result.code === 200) {\n          _this[type] = result.result;\n        }\n      });\n    },\n    getDeptTreeList: function getDeptTreeList() {\n      var _this2 = this;\n\n      this.deptTreeData = [];\n      deptServer.getDeptTreeList().then(function (res) {\n        var resObj = res.result || {};\n\n        _this2.deptTreeData.push(resObj);\n      });\n    },\n    getPlDepartList: function getPlDepartList() {},\n    filterNode: function filterNode(value, data) {\n      if (!value) return true;\n      return data.deptName.indexOf(value) !== -1;\n    },\n    loadNode: function loadNode(node, resolve) {\n      var _this3 = this;\n\n      this.currentNode = node;\n      this.currentResolve = resolve;\n      var obj = node.data;\n      this.currentDeptId = obj.id;\n      this.currentDeptName = obj.deptName;\n\n      if (node.level === 0) {\n        return resolve([{\n          id: -1001,\n          deptName: this.$store.getters.userInfo.organName || '当前机构',\n          children: []\n        }]);\n      }\n\n      if (this.currentDeptId) {\n        this.departData = [];\n        deptServer.findTopDeptListByParentId(this.currentDeptId).then(function (res) {\n          if (res.code === 200 && res.result) {\n            _this3.departData = res.result.map(function (i) {\n              return (0, _objectSpread2.default)((0, _objectSpread2.default)({}, i), {}, {\n                parentName: _this3.currentDeptName\n              });\n            }) || [];\n            resolve(res.result);\n          } else {\n            resolve([]);\n          }\n        }).catch(function () {\n          resolve([]);\n        });\n      } else {\n        resolve([]);\n      }\n    },\n    onSelectDepart: function onSelectDepart(even) {\n      var _this4 = this;\n\n      if (even.id === this.currentDeptId) {\n        return;\n      }\n\n      this.currentDeptId = even.id;\n      this.currentDeptName = even.deptName;\n      this.$nextTick(function () {\n        _this4.handleSearch();\n      });\n    },\n    confirmDepart: function confirmDepart() {\n      var _this5 = this;\n\n      this.$refs.departForm.validate(function (valid) {\n        if (valid) {\n          if (_this5.deptDialogStatus === 'create') {\n            var params = {\n              parentDeptId: _this5.departForm.parentDeptId,\n              platformDeptId: _this5.departForm.platformDeptId,\n              deptName: _this5.departForm.deptName,\n              deptDesc: _this5.departForm.deptDesc\n            };\n            deptServer.createDeptInfo(params).then(function (res) {\n              if (res.code === 200) {\n                _this5.handleSearch();\n\n                _this5.getDeptTreeList();\n\n                _this5.departVisible = false;\n              }\n            });\n          } else {\n            var _params = {\n              deptId: _this5.departForm.deptId,\n              platformDeptId: _this5.departForm.platformDeptId,\n              deptName: _this5.departForm.deptName,\n              deptDesc: _this5.departForm.deptDesc\n            };\n            deptServer.updateDeptInfo(_params).then(function (res) {\n              if (res.code === 200) {\n                _this5.handleSearch();\n\n                _this5.getDeptTreeList();\n\n                _this5.departVisible = false;\n              }\n            });\n          }\n        }\n      });\n    },\n    handleSearch: function handleSearch() {\n      var _this6 = this;\n\n      if (this.currentDeptId) {\n        this.departData = [];\n        deptServer.findTopDeptListByParentId(this.currentDeptId).then(function (res) {\n          if (res.code === 200 && res.result) {\n            _this6.departData = res.result.map(function (i) {\n              return (0, _objectSpread2.default)((0, _objectSpread2.default)({}, i), {}, {\n                parentName: _this6.currentDeptName\n              });\n            }) || [];\n          }\n        }).catch(function () {});\n      }\n    },\n    // 重置\n    handleCreate: function handleCreate() {\n      this.clearForm();\n      this.departForm.parentDeptId = this.currentDeptId;\n      this.deptDialogStatus = 'create';\n      this.departVisible = true;\n    },\n    handleUpdate: function handleUpdate(row) {\n      this.clearForm();\n      this.departForm.deptId = row.id;\n      this.departForm.platformDeptId = row.platformDeptId;\n      this.departForm.deptName = row.deptName || '';\n      this.departForm.deptDesc = row.deptDesc || '';\n      this.deptDialogStatus = 'edit';\n      this.departVisible = true;\n    },\n    handleDelete: function handleDelete(id) {\n      var _this7 = this;\n\n      this.$confirm('确定删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        deptServer.delDeptById(id).then(function (result) {\n          if (result.code === 200) {\n            _this7.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            });\n\n            _this7.handleSearch();\n\n            _this7.getDeptTreeList();\n          } else {\n            _this7.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            });\n          }\n        });\n      }).catch(function () {});\n    },\n    appendDepart: function appendDepart(data) {\n      this.currentTreeItem = data;\n      this.deptDialogStatus = 'create';\n      this.departName = '';\n      this.departVisible = true;\n    },\n    updateDepart: function updateDepart(data) {\n      this.currentTreeItem = data;\n      this.deptDialogStatus = 'edit';\n      this.departName = data.deptName;\n      this.departVisible = true;\n    },\n    removeDepart: function removeDepart(node, data) {\n      var _this8 = this;\n\n      this.$confirm('确定删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        deptServer.delDeptById(data.id).then(function (res) {\n          if (res.code === 200) {\n            _this8.getDepartList();\n\n            _this8.currentDeptId = '';\n            _this8.positionData = [];\n          }\n        });\n      });\n    },\n    clearForm: function clearForm() {\n      this.departForm = {\n        parentDeptId: '',\n        platformDeptId: '',\n        deptId: '',\n        deptName: '',\n        deptDesc: ''\n      };\n    }\n  }\n};\nexports.default = _default;",{"version":3,"sources":["deptList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-row :gutter=\"10\">\n      <el-col :span=\"7\">\n        <el-card class=\"card-left\" shadow=\"never\">\n          <el-input\n            v-model=\"filterText\"\n            placeholder=\"输入名称\"\n          />\n          <el-tree\n            ref=\"tree\"\n            class=\"filter-tree\"\n            :data=\"deptTreeData\"\n            :props=\"defaultProps\"\n            highlight-current\n            default-expand-all\n            :filter-node-method=\"filterNode\"\n            :expand-on-click-node=\"false\"\n            @node-click=\"onSelectDepart\"\n          >\n            <!-- <span slot-scope=\"{ node, data }\" class=\"custom-tree-node\">\n              <span>{{ node.label }}</span>\n              <span>\n                <el-button\n                  type=\"text\"\n                  size=\"mini\"\n                  @click=\"() => appendDepart(data)\"\n                >\n                  添加\n                </el-button>\n                <el-button\n                  v-if=\"data.id !== '-1001'\"\n                  type=\"text\"\n                  size=\"mini\"\n                  @click=\"() => updateDepart(data)\"\n                >\n                  修改\n                </el-button>\n                <el-button\n                  v-if=\"data.id !== '-1001'\"\n                  type=\"text\"\n                  size=\"mini\"\n                  @click=\"() => removeDepart(node, data)\"\n                >\n                  删除\n                </el-button>\n              </span>\n            </span> -->\n          </el-tree>\n        </el-card>\n      </el-col>\n      <el-col :span=\"17\">\n        <el-card class=\"card-right\" shadow=\"never\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>当前部门: <i class=\"el-input__icon\" /></span>{{ currentDeptName }}\n            <el-button v-if=\"currentDeptId && currentDeptId.length > 0\" style=\"float: right; margin:4px 2px;\" type=\"text\" icon=\"el-icon-plus\" @click=\"handleCreate\">新增</el-button>\n            <el-button style=\"float: right; margin:4px 2px;\" type=\"text\" icon=\"el-icon-refresh\" @click=\"handleSearch\">刷新</el-button>\n          </div>\n          <div>\n            <el-table\n              stripe\n              :data=\"departData\"\n              border\n              highlight-current-row\n              :header-cell-style=\"{background:'#ECF3FC'}\"\n              style=\"width: 100%\"\n            >\n              <template slot=\"empty\">\n                <div class=\"table_empty\">\n                  <div class=\"empty_tips\">\n                    <span>\n                      暂无部门\n                    </span>\n                  </div>\n                </div>\n              </template>\n              <el-table-column type=\"index\" width=\"50\" label=\"序号\" align=\"center\" />\n              <el-table-column prop=\"deptName\" label=\"下级部门名称\" align=\"center\" />\n              <el-table-column prop=\"platformDeptName\" label=\"部门职能\" align=\"center\">\n                <template slot-scope=\"{row}\">\n                  <el-tag>{{ row.platformDeptName }}</el-tag>\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"deptDesc\" label=\"描述\" align=\"center\" />\n              <el-table-column fixed=\"right\" align=\"center\" width=\"140px\" label=\"操作\">\n                <template slot-scope=\"scope\">\n                  <el-button type=\"text\" @click=\"handleUpdate(scope.row)\">编辑</el-button>\n                  <div class=\"erc-divider-vertical\" />\n                  <el-button type=\"text\" @click=\"handleDelete(scope.row.id)\">删除</el-button>\n                </template>\n              </el-table-column>\n            </el-table>\n          </div>\n        </el-card>\n      </el-col>\n    </el-row>\n    <el-dialog :title=\"titleMap[deptDialogStatus]\" :visible.sync=\"departVisible\" center>\n      <div style=\"width: 400px;margin:0 auto;\">\n        <el-form ref=\"departForm\" :model=\"departForm\" :rules=\"departRules\" label-width=\"110px\">\n          <el-form-item prop=\"deptName\" label=\"部门名称:\">\n            <el-input\n              v-model=\"departForm.deptName\"\n              placeholder=\"请录入部门名称\"\n              maxlength=\"15\"\n              show-word-limit\n              style=\"width:90%\"\n            />\n          </el-form-item>\n          <el-form-item prop=\"platformDeptId\" label=\"部门职能:\">\n            <el-select\n              v-model=\"departForm.platformDeptId\"\n              style=\"width:90%\"\n              placeholder=\"业务流转权限关联\"\n            >\n              <el-option\n                v-for=\"item in Object.keys(plDeptmentArray)\"\n                :key=\"item\"\n                :label=\"plDeptmentArray[item]\"\n                :value=\"item\"\n              />\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"部门描述:\">\n            <el-input\n              v-model=\"departForm.deptDesc\"\n              type=\"textarea\"\n              :rows=\"4\"\n              maxlength=\"50\"\n              show-word-limit\n              placeholder=\"请录入部门描述\"\n              style=\"width:90%\"\n            />\n          </el-form-item>\n        </el-form>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"departVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmDepart\">保存</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport * as deptServer from '@/api/dept'\nimport { getDicKey } from '@/api/dict'\nexport default {\n  name: 'DeptList',\n  data() {\n    return {\n      deptTreeData: [],\n      defaultProps: {\n        children: 'children',\n        label: 'deptName',\n        id: 'id'\n      },\n      titleMap: {\n        edit: '修改部门',\n        create: '新增部门'\n      },\n      posTitleMap: {\n        edit: '修改岗位',\n        create: '新增岗位'\n      },\n      deptDialogStatus: 'create',\n      currentDeptId: '',\n      currentDeptName: '',\n      departData: [],\n      filterText: '',\n      departVisible: false,\n      departForm: {\n        parentDeptId: '',\n        platformDeptId: '',\n        deptId: '',\n        deptName: '',\n        deptDesc: ''\n      },\n      departRules: {\n        deptName: [{ required: true, message: '部门名称', trigger: 'blur' }],\n        platformDeptId: [{ required: true, message: '请选择平台流转权限', trigger: 'change' }]\n      },\n      currentTreeItem: {},\n      departName: '',\n      roleListArray: [],\n      currentNode: {},\n      currentResolve: {},\n      plDeptmentArray: []\n    }\n  },\n  watch: {\n    filterText(val) {\n      this.$refs.tree.filter(val)\n    }\n  },\n  created() {\n    this.getDicKey('plDeptmentArray', 1001)\n    this.getDeptTreeList()\n  },\n  methods: {\n    getDicKey(type, code) {\n      getDicKey(code).then(result => {\n        if (result.code === 200) {\n          this[type] = result.result\n        }\n      })\n    },\n    getDeptTreeList() {\n      this.deptTreeData = []\n      deptServer.getDeptTreeList().then(res => {\n        const resObj = res.result || {}\n        this.deptTreeData.push(resObj)\n      })\n    },\n    getPlDepartList() {\n\n    },\n    filterNode(value, data) {\n      if (!value) return true\n\n      return data.deptName.indexOf(value) !== -1\n    },\n    loadNode(node, resolve) {\n      this.currentNode = node\n      this.currentResolve = resolve\n      const obj = node.data\n      this.currentDeptId = obj.id\n      this.currentDeptName = obj.deptName\n      if (node.level === 0) {\n        return resolve([{\n          id: -1001,\n          deptName: this.$store.getters.userInfo.organName || '当前机构',\n          children: []\n        }])\n      }\n      if (this.currentDeptId) {\n        this.departData = []\n        deptServer.findTopDeptListByParentId(this.currentDeptId).then(res => {\n          if (res.code === 200 && res.result) {\n            this.departData = res.result.map(i => {\n              return { ...i, parentName: this.currentDeptName }\n            }) || []\n            resolve(res.result)\n          } else {\n            resolve([])\n          }\n        }).catch(() => {\n          resolve([])\n        })\n      } else {\n        resolve([])\n      }\n    },\n    onSelectDepart(even) {\n      if (even.id === this.currentDeptId) {\n        return\n      }\n      this.currentDeptId = even.id\n      this.currentDeptName = even.deptName\n      this.$nextTick(() => {\n        this.handleSearch()\n      })\n    },\n    confirmDepart() {\n      this.$refs.departForm.validate(valid => {\n        if (valid) {\n          if (this.deptDialogStatus === 'create') {\n            const params = {\n              parentDeptId: this.departForm.parentDeptId,\n              platformDeptId: this.departForm.platformDeptId,\n              deptName: this.departForm.deptName,\n              deptDesc: this.departForm.deptDesc\n            }\n            deptServer.createDeptInfo(params).then(res => {\n              if (res.code === 200) {\n                this.handleSearch()\n                this.getDeptTreeList()\n                this.departVisible = false\n              }\n            })\n          } else {\n            const params = {\n              deptId: this.departForm.deptId,\n              platformDeptId: this.departForm.platformDeptId,\n              deptName: this.departForm.deptName,\n              deptDesc: this.departForm.deptDesc\n            }\n            deptServer.updateDeptInfo(params).then(res => {\n              if (res.code === 200) {\n                this.handleSearch()\n                this.getDeptTreeList()\n                this.departVisible = false\n              }\n            })\n          }\n        }\n      })\n    },\n    handleSearch() {\n      if (this.currentDeptId) {\n        this.departData = []\n        deptServer.findTopDeptListByParentId(this.currentDeptId).then(res => {\n          if (res.code === 200 && res.result) {\n            this.departData = res.result.map(i => {\n              return { ...i, parentName: this.currentDeptName }\n            }) || []\n          }\n        }).catch(() => {\n        })\n      }\n    },\n    // 重置\n    handleCreate() {\n      this.clearForm()\n      this.departForm.parentDeptId = this.currentDeptId\n      this.deptDialogStatus = 'create'\n      this.departVisible = true\n    },\n    handleUpdate(row) {\n      this.clearForm()\n      this.departForm.deptId = row.id\n      this.departForm.platformDeptId = row.platformDeptId\n      this.departForm.deptName = row.deptName || ''\n      this.departForm.deptDesc = row.deptDesc || ''\n      this.deptDialogStatus = 'edit'\n      this.departVisible = true\n    },\n    handleDelete(id) {\n      this.$confirm('确定删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        deptServer.delDeptById(id).then(result => {\n          if (result.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            })\n            this.handleSearch()\n            this.getDeptTreeList()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    appendDepart(data) {\n      this.currentTreeItem = data\n      this.deptDialogStatus = 'create'\n      this.departName = ''\n      this.departVisible = true\n    },\n    updateDepart(data) {\n      this.currentTreeItem = data\n      this.deptDialogStatus = 'edit'\n      this.departName = data.deptName\n      this.departVisible = true\n    },\n    removeDepart(node, data) {\n      this.$confirm('确定删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        deptServer.delDeptById(data.id).then(res => {\n          if (res.code === 200) {\n            this.getDepartList()\n            this.currentDeptId = ''\n            this.positionData = []\n          }\n        })\n      })\n    },\n    clearForm() {\n      this.departForm = {\n        parentDeptId: '',\n        platformDeptId: '',\n        deptId: '',\n        deptName: '',\n        deptDesc: ''\n      }\n    }\n\n  }\n}\n</script>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  .info-container {\n    padding: 0;\n    margin: 0;\n    height: auto;\n    width: 100%;\n  }\n  .card-left {\n    width: 100%;\n    min-height: 600px;\n  }\n  .card-right {\n    width: 100%;\n    min-height: 600px;\n  }\n  .card-right {\n    right: 0px;\n    width: 100%;\n    height: 100%;\n  }\n  .filter-tree {\n    margin-top: 15px;\n    line-height: 10px;;\n  }\n  .custom-tree-node {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 14px;\n    padding-right: 8px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n  }\n  .block-flex {\n    position: relative;\n    display: flex;\n    &>div{\n      border: 1px solid #B7B7B7;\n      width: 100px;\n      margin: 0;\n      line-height: 30px;\n      text-align: center;\n    }\n    &>div:first-child {\n      background: #B7B7B7;\n    }\n  }\n</style>\n"],"sourceRoot":"src/views/system/dept"}]}