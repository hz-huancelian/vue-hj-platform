{"remainingRequest":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjectsJiu\\vue-hj-platform\\src\\views\\order\\factor\\mealList.vue?vue&type=style&index=0&id=ac1c3d54&scoped=true&lang=scss&","dependencies":[{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\src\\views\\order\\factor\\mealList.vue","mtime":1652335460000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjectsJiu\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.search_div {\n  >div {\n    &:nth-child(1){\n      margin-right: 10px;\n    }\n    display: inline-block;\n  }\n}\n\n.search_input {\n  width: 200px;\n  margin-bottom: 5px;\n}\n.search-right {\n  text-align: right;\n  padding-right: 25px;\n}\n::v-deep .el-card .el-card__header {\n  padding: 5px 20px;\n  background: #F3F2F2;\n}\n.el-card {\n  overflow: auto;\n}\n::v-deep .el-tooltip__popper {\n  max-width: 800px;\n}\n.icon-list {\n  overflow: hidden;\n  list-style: none;\n  padding: 0!important;\n  li {\n    float: left;\n    width: 50%;\n    text-align: center;\n    color: #666;\n    font-size: 13px;\n    height: 90px;\n    padding: 15px auto;\n    margin-right: -1px;\n    margin-bottom: -1px;\n    cursor: pointer;\n    span {\n      display: inline-block;\n      vertical-align: middle;\n      svg {\n        display: block;\n        font-size: 45px;\n        color: #606266;\n        width: 100%;\n        transition: color .15s linear;\n      }\n      .icon-name {\n        display: inline-block;\n        padding: 5px 3px;\n        height: 1em;\n      }\n    }\n  }\n  li:hover {\n    color: rgba($color: #409EFF, $alpha: 0.7);\n  }\n}\n\n::v-deep .el-table__header-wrapper  .el-checkbox{\n  display:none\n}\n",{"version":3,"sources":["mealList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"mealList.vue","sourceRoot":"src/views/order/factor","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form :model=\"searchForm\" :inline=\"true\">\n      <el-row>\n        <el-col :span=\"20\">\n          <el-form-item label=\"套餐名称:\">\n            <el-input v-model=\"searchForm.groupName\" style=\"width:180px\" placeholder=\"套餐名称\" />\n          </el-form-item>\n          <el-form-item label=\"套餐类型:\">\n            <el-select v-model=\"searchForm.groupType\" clearable style=\"width: 100%;\" placeholder=\"套餐类型\">\n              <el-option value=\"0\" label=\"自由因子套餐\" />\n              <el-option value=\"1\" label=\"同系因子套餐\" />\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" class=\"iconfont icon-chaxun1\" @click=\"handleSearch\"> 查询</el-button>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"4\" class=\"search-right\">\n          <el-button type=\"text\" icon=\"el-icon-plus\" @click=\"handleCreate\">新增</el-button>\n          <el-button type=\"text\" icon=\"el-icon-refresh\" @click=\"handleSearch\">刷新</el-button>\n        </el-col>\n      </el-row>\n    </el-form>\n    <el-table\n      stripe\n      :data=\"factorGroupData\"\n      highlight-current-row\n      :header-cell-style=\"{background:'#ECF3FC'}\"\n      border\n      style=\"width: 100%\"\n    >\n      <template slot=\"empty\">\n        <div class=\"table_empty\">\n          <div class=\"empty_tips\">\n            <span>\n              暂无套餐,\n            </span>\n            <el-button type=\"text\" size=\"small\" style=\"font-size:14px;\" @click=\"handleCreate\">新建因子套餐</el-button>\n          </div>\n        </div>\n      </template>\n      <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n      <el-table-column prop=\"groupName\" label=\"套餐名称\" align=\"center\" />\n      <el-table-column label=\"套餐类型\" align=\"center\" width=\"130px\">\n        <template slot-scope=\"{row}\">\n          {{ row.groupType === '0'?\"自由因子套餐\":\"同系因子套餐\" }}\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"remark\" label=\"套餐说明\" :show-overflow-tooltip=\"true\" align=\"center\" />\n      <el-table-column prop=\"groupDesc\" label=\"检测因子\" :show-overflow-tooltip=\"true\" align=\"center\" />\n      <el-table-column prop=\"createTime\" label=\"创建时间\" width=\"160\" align=\"center\" />\n\n      <el-table-column fixed=\"right\" align=\"center\" label=\"操作\" width=\"180\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"text\" @click=\"handleDetail(scope.row.groupId)\"> 查看</el-button>\n          <div class=\"erc-divider-vertical\" />\n          <el-button type=\"text\" @click=\"handleUpdate(scope.row)\"> 编辑</el-button>\n          <div class=\"erc-divider-vertical\" />\n          <el-button type=\"text\" @click=\"handleDelete(scope.row.groupId)\">删除</el-button>\n          <div class=\"erc-divider-vertical\" />\n          <el-button type=\"text\" @click=\"handleCopy(scope.row.groupId)\">复制</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"float: right\">\n      <pagination\n        v-show=\"total>0\"\n        :total=\"total\"\n        :page.sync=\"searchForm.pageNumber\"\n        :limit.sync=\"searchForm.pageSize\"\n        @pagination=\"handleSearch\"\n      />\n    </div>\n\n    <el-dialog :visible.sync=\"choseMealVisible\" top=\"35vh\" width=\"400px\">\n\n      <span slot=\"title\">\n        选择新增套餐类型\n        <el-popover\n          placement=\"top-start\"\n          title=\"\"\n          width=\"500\"\n          trigger=\"hover\"\n        >\n          <div>\n            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;同系因子套餐：可以将某个检测标准中可同时检测的多个因子进行打包（要求标准号相同）\n            如： 苯系物、挥发性卤代烃、有机氯农药等，并可对该同系因子套餐进行总价设定，\n            若该同系因子套餐中所含因子单价合计大于等于设定的总价，则以设定的总价作为该套餐的报价，\n            若小于则以所含因子单价合计作为该套餐的报价。同时报价时可以选择该套餐内的部分或全部因子作为一个单因子属性进行点位和频次的设置，\n            在采样分配时该套餐内的因子无需进行合样操作，实验室分析时该套餐内的因子作为一组进行实验室数据录入。\n            <br>\n            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自由因子套餐：该类型套餐可用于具有固定或相似监测方案的项目，可自由选择因子库中的因子进行组合，后续套餐内所选因子会分拆独立出来，后续流程与因子库中的其他因子无异。\n          </div>\n          <svg-icon slot=\"reference\" icon-class=\"help\" style=\"font-size:16px\" />\n        </el-popover>\n      </span>\n      <ul class=\"icon-list\">\n        <li @click=\"handleSameCreate\">\n          <span>\n            <svg-icon icon-class=\"dcqrs\" />\n            <span class=\"icon-name\">同系因子套餐</span>\n          </span>\n        </li>\n        <li @click=\"handleFreeCreate\">\n          <span>\n            <svg-icon icon-class=\"ddrw\" />\n            <span class=\"icon-name\">自由因子套餐</span>\n          </span>\n        </li>\n      </ul>\n    </el-dialog>\n\n    <el-dialog :title=\"titleMap[factorGroupDialogStatus]\" :visible.sync=\"factorGroupDialogVisible\" fullscreen :modal-append-to-body=\"false\" :before-close=\"handleDialogClose\" center>\n      <el-card shadow=\"never\">\n        <div slot=\"header\">\n          <span>套餐基础信息<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-form ref=\"factorGroupForm\" :model=\"factorGroupForm\" inline label-width=\"90px\">\n          <el-form-item prop=\"groupName\" label=\"套餐名称:\">\n            <el-input v-model=\"factorGroupForm.groupName\" placeholder=\"套餐名称\" style=\"width: 250px;\" maxlength=\"10\" show-word-limit />\n          </el-form-item>\n          <el-form-item prop=\"authType\" label=\"认证类型:\">\n            <el-select v-model=\"factorGroupForm.authType\" style=\"width: 250px;\" placeholder=\"检测类型\" :disabled=\"factorGroupDialogStatus==='edit'\" @change=\"checkAutype\">\n              <el-option value=\"0\" label=\"CMA\" />\n              <el-option value=\"1\" label=\"CNAS\" />\n            </el-select>\n          </el-form-item>\n          <el-form-item prop=\"remark\" label=\"套餐说明:\">\n            <el-input v-model=\"factorGroupForm.remark\" placeholder=\"套餐说明\" type=\"textarea\" :rows=\"3\" maxlength=\"50\" />\n          </el-form-item>\n        </el-form>\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>待选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <factor-list :auth-type=\"factorGroupForm.authType\" :chose-row=\"currentRow\" @pageChose=\"handleChose\" />\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>已选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-table\n          :data=\"factorChoseData\"\n          size=\"small\"\n          stripe\n          highlight-current-row\n          max-height=\"400\"\n          :header-cell-style=\"{background:'#ECF3FC'}\"\n        >\n          <template slot=\"empty\">\n            <div class=\"table_empty\">\n              <div class=\"empty_tips\">\n                <span>\n                  暂无因子\n                </span>\n              </div>\n            </div>\n          </template>\n          <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n          <el-table-column prop=\"className\" label=\"检测对象\" min-width=\"100\" align=\"center\" />\n          <el-table-column prop=\"factorName\" label=\"检测因子\" align=\"center\" />\n          <el-table-column prop=\"standardNo\" label=\"标准号\" align=\"center\" />\n          <el-table-column prop=\"standardName\" label=\"标准名称\" min-width=\"160\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"分析方法\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"标准有效性\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              {{ STOKEN_STUTS[row.methodStatus] }}\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"price\" label=\"检测费用\" align=\"center\" />\n          <el-table-column prop=\"cmaFlg\" label=\"CMA\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cmaFlg==='1'?'success':'danger'\">{{ row.cmaFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"cnasFlg\" label=\"CNAS\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cnasFlg==='1'?'success':'danger'\">{{ row.cnasFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"extAssistFlg\" label=\"检测能力\" width=\"80\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"(row.extAssistFlg&&row.extAssistFlg==='0')?'success':'danger'\">{{ (row.extAssistFlg&&row.extAssistFlg==='0')?'有':'无' }}</el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column fixed=\"right\" align=\"center\" label=\"操作\">\n            <template slot-scope=\"scope\">\n              <el-button type=\"text\" @click=\"handleRowDel(scope.row,scope.$index)\"> 删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-card>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"factorGroupDialogVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"同系因子套餐\" :visible.sync=\"factorSameVisible\" fullscreen :modal-append-to-body=\"false\" :before-close=\"handleSameDialogClose\" center>\n      <el-card shadow=\"never\">\n        <div slot=\"header\">\n          <span>套餐基础信息<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-form ref=\"factorGroupForm\" :model=\"factorGroupForm\" inline label-width=\"90px\">\n          <el-form-item prop=\"groupName\" label=\"套餐名称:\">\n            <el-input v-model=\"factorGroupForm.groupName\" placeholder=\"同系套餐名称\" style=\"width: 250px;\" maxlength=\"10\" show-word-limit />\n          </el-form-item>\n          <el-form-item prop=\"groupCost\" label=\"套餐价格:\">\n            <el-input v-model=\"factorGroupForm.groupCost\" type=\"number\" placeholder=\"套餐价格\" style=\"width: 250px;\" />\n          </el-form-item>\n\n          <el-form-item prop=\"remark\" label=\"套餐说明:\">\n            <el-input v-model=\"factorGroupForm.remark\" placeholder=\"套餐说明\" type=\"textarea\" :rows=\"3\" maxlength=\"50\" show-word-limit />\n          </el-form-item>\n        </el-form>\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>待选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <factor-same-list :clear-type=\"cleanAttr\" :chose-row=\"currentRow\" @pageChose=\"handleSameChose\" />\n      </el-card>\n      <el-card shadow=\"never\" style=\"margin-top: 10px\">\n        <div slot=\"header\">\n          <span>已选因子<i class=\"el-input__icon\" /></span>\n        </div>\n        <el-table\n          :data=\"factorChoseData\"\n          size=\"small\"\n          stripe\n          highlight-current-row\n          max-height=\"400\"\n          :header-cell-style=\"{background:'#ECF3FC'}\"\n        >\n          <template slot=\"empty\">\n            <div class=\"table_empty\">\n              <div class=\"empty_tips\">\n                <span>\n                  暂无因子\n                </span>\n              </div>\n            </div>\n          </template>\n          <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n          <el-table-column prop=\"className\" label=\"检测对象\" width=\"80\" align=\"center\" />\n          <el-table-column prop=\"factorName\" label=\"检测因子\" align=\"center\" />\n          <el-table-column prop=\"standardNo\" label=\"标准号\" align=\"center\" />\n          <el-table-column prop=\"standardName\" label=\"标准名称\" min-width=\"160\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"分析方法\" align=\"center\" />\n          <el-table-column prop=\"analysisMethod\" label=\"标准有效性\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              {{ STOKEN_STUTS[row.methodStatus] }}\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"price\" label=\"检测费用\" align=\"center\" />\n          <el-table-column prop=\"cmaFlg\" label=\"CMA\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cmaFlg==='1'?'success':'danger'\">{{ row.cmaFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"cnasFlg\" label=\"CNAS\" width=\"60\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"row.cnasFlg==='1'?'success':'danger'\">{{ row.cnasFlg==='1'?'Y':'N' }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"extAssistFlg\" label=\"检测能力\" width=\"80\" align=\"center\">\n            <template slot-scope=\"{row}\">\n              <el-tag :type=\"(row.extAssistFlg&&row.extAssistFlg==='0')?'success':'danger'\">{{ (row.extAssistFlg&&row.extAssistFlg==='0')?'有':'无' }}</el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column fixed=\"right\" align=\"center\" label=\"操作\">\n            <template slot-scope=\"scope\">\n              <el-button type=\"text\" @click=\"handleRowDel(scope.row,scope.$index)\"> 删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-card>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"factorSameVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"套餐详情\" :visible.sync=\"factorGroupVisible\" width=\"75%\" top=\"5vh\">\n      <el-table :data=\"showGroupData\" stripe highlight-current-row>\n        <el-table-column type=\"index\" width=\"55\" label=\"序号\" align=\"center\" />\n        <el-table-column prop=\"className\" label=\"检测对象\" align=\"center\" />\n        <el-table-column prop=\"secdClassName\" label=\"检测类别\" align=\"center\" />\n        <el-table-column prop=\"factorName\" label=\"检测因子\" align=\"center\" />\n        <el-table-column prop=\"standardName\" label=\"检测标准\" min-width=\"160\" align=\"center\" />\n        <el-table-column prop=\"price\" label=\"检测费用\" align=\"center\" />\n        <el-table-column prop=\"cmaFlg\" label=\"CMA\" width=\"60px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.cmaFlg==='1'?'success':'danger'\">{{ row.cmaFlg==='1'?'Y':'N' }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"cnasFlg\" label=\"CNAS\" width=\"60px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.cnasFlg==='1'?'success':'danger'\">{{ row.cnasFlg==='1'?'Y':'N' }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"extAssistFlg\" label=\"检测能力\" width=\"80px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"(row.extAssistFlg&&row.extAssistFlg==='0')?'success':'danger'\">{{ (row.extAssistFlg&&row.extAssistFlg==='0')?'有':'无' }}</el-tag>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport * as factorServer from '@/api/factor'\nimport * as dictServer from '@/api/dict'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nimport FactorList from '@/components/FactorList'\nimport FactorSameList from '@/components/FactorSameList'\nimport { uuid } from 'vue-uuid'\nconst STOKEN_STUTS = {\n  '0': '现行',\n  '1': '自定义标准',\n  '2': '试行'\n}\nexport default {\n  components: { Pagination, FactorList, FactorSameList },\n  data() {\n    debugger\n    return {\n      STOKEN_STUTS,\n      factorGroupData: [],\n      searchForm: {\n        groupName: '',\n        groupType: '',\n        authType: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      titleMap: {\n        edit: '修改套餐',\n        create: '新增套餐'\n      },\n      factorGroupForm: {\n        groupId: '',\n        groupName: '',\n        authType: '0',\n        groupType: '',\n        groupCost: '',\n        remark: '',\n        factorStandardIds: []\n      },\n      factorGroupRules: {\n        groupName: [{ required: true, message: '套餐名称', trigger: 'blur' }]\n      },\n      factorGroupDialogStatus: 'create',\n      factorGroupDialogVisible: false,\n      factorGroupVisible: false,\n      factorChoseData: [],\n      showGroupData: [],\n      secdItems: {},\n      currentRow: {},\n      choseMealVisible: false,\n      factorSameVisible: false,\n      cleanAttr: ''\n    }\n  },\n  created() {\n    this.getFactorDict()\n    this.handleSearch()\n  },\n  methods: {\n    getFactorDict() {\n      dictServer.findTreeClasses().then(res => {\n        if (res.code === 200 && res.result) {\n          var resMap = new Map()\n          res.result.forEach(i => {\n            resMap.set(i.id, i.children)\n          })\n          console.log(resMap)\n\n          this.secdItems = resMap\n        }\n      })\n    },\n    handleSearch() {\n      factorServer.findPageByCondition(this.searchForm).then(res => {\n        if (res.code === 200) {\n          this.factorGroupData = res.result.records || []\n          this.total = res.result.total\n        }\n      })\n    },\n    // 重置\n    handleCreate() {\n      this.choseMealVisible = true\n    },\n    // 重置\n    handleFreeCreate() {\n      this.choseMealVisible = false\n      this.clearForm()\n      this.cleanAttr = uuid.v4().replaceAll('-', '')\n      this.factorGroupForm.groupType = '0'\n      this.factorGroupDialogStatus = 'create'\n      this.factorGroupDialogVisible = true\n      Object.assign({ classId: '', factorName: '', authType: '', pageNumber: 1, pageSize: 10 }, this.$options.data().innerSearchForm)\n    },\n    handleSameCreate() {\n      this.clearForm()\n      this.factorGroupDialogStatus = 'create'\n      this.cleanAttr = uuid.v4().replaceAll('-', '')\n      this.factorGroupForm.groupType = '1'\n      this.factorSameVisible = true\n      Object.assign({ classId: '', factorName: '', authType: '', pageNumber: 1, pageSize: 10 }, this.$options.data().innerSearchForm)\n    },\n    handleUpdate(row) {\n      this.factorGroupDialogStatus = 'edit'\n      this.factorGroupForm.groupId = row.groupId\n      this.factorGroupForm.groupName = row.groupName\n      this.factorGroupForm.groupType = row.groupType\n      this.factorGroupForm.groupCost = row.groupCost ? row.groupCost : ''\n      this.factorGroupForm.authType = row.authType\n      this.factorGroupForm.remark = row.remark\n      if (row.groupType === '0') { // 自由套餐\n        this.getFactorChoses(row.groupId)\n      } else { // 同系套餐\n        this.getFactorSameChoses(row.groupId)\n      }\n      this.$store.dispatch('user/resetCompForm', '1')\n    },\n    getFactorChoses(groupId) {\n      factorServer.findCheckStandardsByGroupId(groupId).then(res => {\n        if (res.code === 200) {\n          this.factorChoseData = res.result || []\n        }\n        this.factorGroupDialogVisible = true\n      })\n    },\n    getFactorSameChoses(groupId) {\n      factorServer.findCheckStandardsByGroupId(groupId).then(res => {\n        if (res.code === 200) {\n          this.factorChoseData = res.result || []\n        }\n        this.factorSameVisible = true\n      })\n    },\n    confirmDialog() {\n      if (!this.factorGroupForm.groupName || this.factorChoseData.length <= 0) {\n        this.$message.warning('套餐名称、因子项不能为空')\n        return\n      }\n      const oo = this.factorChoseData.find(i => i.secdClassId)\n      if (!oo) {\n        this.$message.warning('二级类别不能为空')\n        return\n      }\n      if (this.factorGroupForm.groupType === '1') {\n        const checks = []\n        this.factorChoseData.forEach(e => {\n          const fas = checks.find(f => f.standardNo === e.standardNo)\n          if (!fas) {\n            checks.push(e)\n          }\n        })\n        if (checks.length > 1) {\n          this.$message.error('同系套餐只能针对一个标准号配置')\n          return\n        }\n      }\n      if (this.factorChoseData.length <= 1) {\n        this.$message.error('同系套餐因子必须超过1个')\n        return\n      }\n      if (this.factorGroupDialogStatus === 'create') {\n        this.confirmCreate()\n      } else {\n        this.confirmUpdate()\n      }\n    },\n    confirmCreate() {\n      var totalPrice = 0\n      const data = {\n        groupName: this.factorGroupForm.groupName,\n        remark: this.factorGroupForm.remark,\n        authType: this.factorGroupForm.authType,\n        groupType: this.factorGroupForm.groupType,\n        groupCost: this.factorGroupForm.groupCost !== '' ? this.factorGroupForm.groupCost : '',\n        factorStandardIds: this.factorChoseData.map(i => {\n          totalPrice = parseFloat(totalPrice + i.price)\n          return {\n            checkStandardId: i.standardCode,\n            secdClassId: i.secdClassId,\n            factorName: i.factorName\n          }\n        })\n      }\n      if (this.factorGroupForm.groupType === '1') {\n        if (totalPrice <= this.factorGroupForm.groupCost) {\n          data.groupCost = totalPrice\n        }\n      }\n\n      factorServer.saveFactorGroup(data).then(request => {\n        this.$notify({\n          title: '成功',\n          message: request.message,\n          type: 'success'\n        })\n        this.handleSearch()\n        this.factorGroupDialogVisible = false\n        this.factorSameVisible = false\n      }).catch(() => {})\n    },\n    confirmUpdate() {\n      var totalPrice = 0\n      const data = {\n        groupId: this.factorGroupForm.groupId,\n        groupName: this.factorGroupForm.groupName,\n        authType: this.factorGroupForm.authType,\n        remark: this.factorGroupForm.remark,\n        groupType: this.factorGroupForm.groupType,\n        groupCost: this.factorGroupForm.groupCost !== '' ? this.factorGroupForm.groupCost : '',\n        factorStandardIds: this.factorChoseData.map(i => {\n          totalPrice = parseFloat(totalPrice + i.price)\n          return {\n            checkStandardId: i.standardCode,\n            secdClassId: i.secdClassId,\n            factorName: i.factorName\n          }\n        })\n      }\n      if (this.factorGroupForm.groupType === '1') {\n        if (totalPrice <= this.factorGroupForm.groupCost) {\n          data.groupCost = totalPrice\n        }\n      }\n      factorServer.modifyFactorGroupByGroupId(data).then(request => {\n        this.$notify({\n          title: '成功',\n          message: request.message,\n          type: 'success'\n        })\n        this.handleSearch()\n        this.factorGroupDialogVisible = false\n        this.factorSameVisible = false\n      }).catch(() => {})\n    },\n    handleDelete(id) {\n      this.$confirm('确定删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        factorServer.delByGroupId(id).then(result => {\n          if (result.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            })\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    handleCopy(id) {\n      this.$confirm('确定复制?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        factorServer.copyByGroupId(id).then(result => {\n          if (result.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            })\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    clearForm() {\n      this.factorGroupForm = {\n        groupId: '',\n        groupName: '',\n        authType: '0',\n        groupType: '',\n        groupCost: '',\n        remark: '',\n        factorStandardIds: []\n      }\n      this.factorChoseData = []\n    },\n\n    handleChose(val) {\n      if (val) {\n        val.forEach(i => {\n          const obj = this.factorChoseData.find(j => j.id === i.id && i.secdClassId && j.secdClassId === i.secdClassId)\n          debugger\n          if (!obj && i.secdClassId) {\n            this.factorChoseData.push(i)\n          }\n        })\n      }\n    },\n    handleSameChose(val) {\n      if (val) {\n        val.forEach(i => {\n          const obj = this.factorChoseData.find(j => j.id === i.id && i.secdClassId && j.secdClassId === i.secdClassId && i.standardNo === j.standardNo)\n          debugger\n          if (!obj && i.secdClassId) {\n            this.factorChoseData.push(i)\n          }\n        })\n      }\n    },\n    checkAutype() {\n      this.factorChoseData = []\n    },\n    handleRowDel(row, index) {\n      this.factorChoseData.splice(index, 1)\n      this.currentRow = row\n    },\n    handleDetail(groupId) {\n      factorServer.findCheckStandardsByGroupId(groupId).then(res => {\n        this.showGroupData = res.result || []\n        this.factorGroupVisible = true\n      })\n    },\n    handleDialogClose(done) {\n      this.factorGroupDialogVisible = false\n      this.$store.dispatch('user/resetCompForm', '')\n      done()\n    },\n    handleSameDialogClose(done) {\n      this.factorGroupDialogVisible = false\n      this.$store.dispatch('user/resetCompForm', '')\n      done()\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n    background: #F3F2F2;\n  }\n  .el-card {\n    overflow: auto;\n  }\n  ::v-deep .el-tooltip__popper {\n    max-width: 800px;\n  }\n  .icon-list {\n    overflow: hidden;\n    list-style: none;\n    padding: 0!important;\n    li {\n      float: left;\n      width: 50%;\n      text-align: center;\n      color: #666;\n      font-size: 13px;\n      height: 90px;\n      padding: 15px auto;\n      margin-right: -1px;\n      margin-bottom: -1px;\n      cursor: pointer;\n      span {\n        display: inline-block;\n        vertical-align: middle;\n        svg {\n          display: block;\n          font-size: 45px;\n          color: #606266;\n          width: 100%;\n          transition: color .15s linear;\n        }\n        .icon-name {\n          display: inline-block;\n          padding: 5px 3px;\n          height: 1em;\n        }\n      }\n    }\n    li:hover {\n      color: rgba($color: #409EFF, $alpha: 0.7);\n    }\n  }\n\n  ::v-deep .el-table__header-wrapper  .el-checkbox{\n    display:none\n  }\n</style>\n"]}]}