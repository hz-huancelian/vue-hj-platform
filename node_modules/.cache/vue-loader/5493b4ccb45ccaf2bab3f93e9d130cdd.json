{"remainingRequest":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjects\\vue-hj-platform\\src\\views\\contract\\components\\contractList.vue?vue&type=style&index=0&id=626bd746&scoped=true&lang=scss&","dependencies":[{"path":"F:\\webstormProjects\\vue-hj-platform\\src\\views\\contract\\components\\contractList.vue","mtime":1652432914000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.search_div {\n  >div {\n    &:nth-child(1){\n      margin-right: 10px;\n    }\n    display: inline-block;\n  }\n}\n\n.search_input {\n  width: 200px;\n  margin-bottom: 5px;\n}\n.search-right {\n  text-align: right;\n  padding-right: 25px;\n}\n.item {\n  font-size: 16px;\n}\n::v-deep .el-card .el-card__header {\n  padding: 5px 20px;\n  background: #F3F2F2;\n}\n",{"version":3,"sources":["contractList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAi0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"contractList.vue","sourceRoot":"src/views/contract/components","sourcesContent":["<template>\n  <div>\n    <el-form :model=\"searchForm\" :inline=\"true\">\n      <el-row>\n        <el-col :span=\"20\">\n          <el-form-item label=\"合同编号:\">\n            <el-input v-model=\"searchForm.contCode\" style=\"width:180px\" placeholder=\"合同编号\" />\n          </el-form-item>\n          <el-form-item label=\"项目名称:\">\n            <el-input v-model=\"searchForm.contName\" style=\"width:180px\" placeholder=\"项目名称\" />\n          </el-form-item>\n          <el-form-item label=\"合同状态:\">\n            <el-select v-model=\"searchForm.contStatus\" clearable style=\"width:170px\" filterable placeholder=\"合同状态\">\n              <el-option\n                v-for=\"item in Object.keys(CONTRACT_STATUS)\"\n                :key=\"item\"\n                :label=\"CONTRACT_STATUS[item]\"\n                :value=\"item\"\n              />\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" class=\"iconfont icon-chaxun1\" @click=\"handleSearch\"> 查询</el-button>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"4\" class=\"search-right\">\n          <el-button type=\"text\" icon=\"el-icon-refresh\" @click=\"handleSearch\">刷新</el-button>\n        </el-col>\n      </el-row>\n    </el-form>\n    <div>\n      <el-table\n        stripe\n        border\n        :data=\"contractData\"\n        highlight-current-row\n        :header-cell-style=\"{background:'#ECF3FC'}\"\n        style=\"width: 100%\"\n      >\n        <template slot=\"empty\">\n          <div class=\"table_empty\">\n            <div class=\"empty_tips\">\n              <span>\n                暂无合同信息\n              </span>\n            </div>\n          </div>\n        </template>\n        <el-table-column type=\"index\" width=\"55\" label=\"序号\" fixed=\"left\" align=\"center\" />\n        <el-table-column prop=\"contCode\" label=\"合同编号\" width=\"185px\" align=\"center\" />\n        <el-table-column prop=\"offerId\" label=\"报价单号\" width=\"170px\" align=\"center\" />\n        <el-table-column prop=\"projectName\" label=\"项目名称\" min-width=\"120px\" align=\"center\" />\n        <el-table-column prop=\"partA\" label=\"客户名称\" width=\"120px\" align=\"center\" />\n        <el-table-column prop=\"signDate\" label=\"签订日期\" width=\"120px\" align=\"center\" />\n        <el-table-column prop=\"validity\" label=\"有效期(年)\" width=\"100px\" align=\"center\" />\n        <el-table-column prop=\"contStatus\" label=\"合同状态\" width=\"110px\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.contStatus|statusQualityFilter\">\n              {{ CONTRACT_STATUS[row.contStatus] }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <!-- <el-table-column prop=\"auditReason\" label=\"驳回原因\" :show-overflow-tooltip=\"true\" width=\"100px\" align=\"center\" /> -->\n\n        <el-table-column fixed=\"right\" align=\"center\" label=\"操作\" width=\"210px\">\n          <template slot-scope=\"{row}\">\n\n            <el-button v-if=\"row.contStatus>0\" type=\"text\" @click=\"handleDetail(row)\"> 查看</el-button>\n            <div v-if=\"row.contStatus==='6' || row.contStatus==='2'\" class=\"erc-divider-vertical\" />\n\n            <el-button v-if=\"row.contStatus==='0'\" v-hasPermi=\"['contract:list:add']\" type=\"text\" @click=\"handleEdit(row)\"> 完善</el-button>\n            <el-button v-if=\"row.contStatus==='6' || row.contStatus==='2'\" v-hasPermi=\"['contract:list:update']\" type=\"text\" @click=\"handleEdit(row)\"> 编辑</el-button>\n\n            <div v-if=\"row.signDate && row.contStatus>= 1\" class=\"erc-divider-vertical\" />\n            <el-button v-if=\"row.signDate && row.contStatus>= 1\" type=\"text\" @click=\"handleDwonload(row)\"> 下载</el-button>\n\n            <div v-if=\"row.signDate && row.contStatus==='6'\" v-hasPermi=\"['contract:list:update']\" class=\"erc-divider-vertical\" />\n            <el-button v-if=\"row.signDate && row.contStatus==='6' \" v-hasPermi=\"['contract:list:update']\" type=\"text\" @click=\"handleApprove(row)\"> 提交审核</el-button>\n\n            <div v-if=\"row.contStatus==='0'|| row.contStatus==='2'\" v-hasPermi=\"['contract:list:del']\" class=\"erc-divider-vertical\" />\n            <el-button v-if=\"row.contStatus==='0'|| row.contStatus==='2'\" v-hasPermi=\"['contract:list:del']\" type=\"text\" @click=\"handleDelete(row)\"> 作废</el-button>\n\n            <div v-if=\"row.contStatus==='2'\" class=\"erc-divider-vertical\" />\n            <el-button v-if=\"row.contStatus==='2'\" type=\"text\" @click=\"handleApproveDetail(row)\"> 审核历史</el-button>\n\n            <!-- <div v-if=\"row.contStatus==='1'\" class=\"erc-divider-vertical\" />\n            <el-button v-if=\"row.contStatus==='1'\" type=\"text\" @click=\"handleApproveRes(row)\"> 审核</el-button> -->\n\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n    <div style=\"float: right\">\n      <pagination\n        v-show=\"total>0\"\n        :total=\"total\"\n        :page.sync=\"searchForm.pageNumber\"\n        :limit.sync=\"searchForm.pageSize\"\n        @pagination=\"handleSearch\"\n      />\n    </div>\n    <el-dialog title=\"合同信息完善\" :visible.sync=\"contractVisible\" width=\"85%\" top=\"5vh\" :close-on-click-modal=\"false\">\n      <el-tabs v-model=\"activeName\" type=\"border-card\">\n        <el-tab-pane name=\"maker\" label=\"在线制作\">\n          <el-form ref=\"contractForm\" :model=\"contractForm\" :rules=\"contractRules\" label-width=\"120px\" label-position=\"right\">\n            <el-divider content-position=\"left\">合同信息</el-divider>\n            <el-row>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"contractInfoTdo.validity\" label=\"有效期(年):\">\n                  <el-input-number v-model=\"contractForm.contractInfoTdo.validity\" controls-position=\"right\" style=\"width: 90%;\" :min=\"1\" :step=\"1\" :precision=\"0\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"contractInfoTdo.signDate\" label=\"签订日期:\">\n                  <el-date-picker\n                    v-model=\"contractForm.contractInfoTdo.signDate\"\n                    type=\"date\"\n                    value-format=\"yyyy-MM-dd\"\n                    placeholder=\"签订日期\"\n                    style=\"width: 90%;\"\n                  />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"contractInfoTdo.signLocation\" label=\"签订地址:\">\n                  <el-input v-model=\"contractForm.contractInfoTdo.signLocation\" style=\"width: 90%;\" placeholder=\"签订地址\" />\n                </el-form-item>\n              </el-col>\n            </el-row>\n            <el-row>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"contractInfoTdo.payMethod\" label=\"支付方式:\">\n                  <el-select v-model=\"contractForm.contractInfoTdo.payMethod\" style=\"width: 90%;\" placeholder=\"支付方式\">\n                    <el-option value=\"1\" label=\"一次付清\">一次付清</el-option>\n                    <el-option value=\"2\" label=\"分期支付\">分期支付</el-option>\n                    <el-option value=\"3\" label=\"其他方式\">其他方式</el-option>\n                  </el-select>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"16\">\n                <el-form-item prop=\"contractInfoTdo.payMethodDesc\" label=\"支付说明:\">\n                  <el-input v-model=\"contractForm.contractInfoTdo.payMethodDesc\" style=\"width: 90%;\" placeholder=\"支付说明\" />\n                </el-form-item>\n              </el-col>\n            </el-row>\n            <el-divider content-position=\"left\">客户信息</el-divider>\n            <el-row>\n              <el-col :span=\"8\">\n                <el-form-item label=\"合同属性:\">\n                  <el-switch\n                    v-model=\"masterSwitch\"\n                    active-text=\"子合同\"\n                    inactive-text=\"主合同\"\n                  />\n                </el-form-item>\n              </el-col>\n              <el-col v-if=\"masterSwitch\" :span=\"16\">\n                <el-form-item label=\"关联主合同:\">\n                  <el-input v-model=\"contractForm.addTdo.supContCode\" placeholder=\"合同编号\" style=\"width: 200px;\" />\n                  <el-button type=\"primary\" size=\"mini\" style=\"margin-left: 10px;\" @click=\"checkContractInfo\">验证</el-button>\n                  <span v-if=\"checkFlag\" style=\"color:green;margin-left: 10px;\">\n                    {{ checkText }}\n                  </span>\n                  <span v-if=\"!checkFlag\" style=\"color:red;margin-left: 10px;\">\n                    {{ checkText }}\n                  </span>\n                </el-form-item>\n              </el-col>\n            </el-row>\n            <el-row>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.companyName\" label=\"单位名称:\">\n                  <!-- <el-autocomplete\n                    v-model=\"contractForm.addTdo.companyName\"\n                    :fetch-suggestions=\"querySearchAsync\"\n                    placeholder=\"请输入内容\"\n                    style=\"width: 90%;\"\n                    @select=\"handleSelectCom\"\n                  >\n                    <i\n                      slot=\"suffix\"\n                      class=\"el-icon-edit el-input__icon\"\n                    />\n                    <template slot-scope=\"{ item }\">\n                      <div class=\"name\">{{ companyMap[item] }}</div>\n                    </template>\n                  </el-autocomplete> -->\n\n                  <el-select\n                    v-model=\"contractForm.addTdo.companyName\"\n                    filterable\n                    remote\n                    placeholder=\"请输入客户\"\n                    :remote-method=\"querySearchAsync\"\n                    style=\"width: 90%;\"\n                    @change=\"handleSelectCom\"\n                  >\n                    <el-option\n                      v-for=\"item in Object.keys(companyMap)\"\n                      :key=\"item\"\n                      :label=\"companyMap[item]\"\n                      :value=\"item\"\n                    />\n                  </el-select>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.address\" label=\"通讯地址:\">\n                  <el-input v-model=\"contractForm.addTdo.address\" style=\"width: 90%;\" maxlength=\"35\" placeholder=\"通讯地址\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.postCode\" label=\"邮政编码:\">\n                  <el-input v-model=\"contractForm.addTdo.postCode\" style=\"width: 90%;\" :maxlength=\"6\" placeholder=\"邮政编码\" />\n                </el-form-item>\n              </el-col>\n            </el-row>\n            <el-row>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.jurPerson\" label=\"法定代表人:\">\n                  <el-input v-model=\"contractForm.addTdo.jurPerson\" style=\"width: 90%;\" maxlength=\"40\" placeholder=\"法定代表人\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.agentPerson\" label=\"委托代理人:\">\n                  <el-input v-model=\"contractForm.addTdo.agentPerson\" style=\"width: 90%;\" maxlength=\"40\" placeholder=\"委托代理人\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.telFax\" label=\"电话/传真:\">\n                  <el-input v-model=\"contractForm.addTdo.telFax\" style=\"width: 90%;\" maxlength=\"15\" placeholder=\"电话/传真\" />\n                </el-form-item>\n              </el-col>\n            </el-row>\n            <el-row>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.bankName\" label=\"开户银行:\">\n                  <el-input v-model=\"contractForm.addTdo.bankName\" style=\"width: 90%;\" maxlength=\"15\" placeholder=\"开户银行\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.bankNo\" label=\"银行账号:\">\n                  <el-input v-model=\"contractForm.addTdo.bankNo\" style=\"width: 90%;\" maxlength=\"20\" placeholder=\"银行账号\" @input=\"bankNumCheck\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"8\">\n                <el-form-item prop=\"addTdo.taxNumber\" label=\"税号:\">\n                  <el-input v-model=\"contractForm.addTdo.taxNumber\" style=\"width: 90%;\" maxlength=\"20\" placeholder=\"税号\" />\n                </el-form-item>\n              </el-col>\n            </el-row>\n\n          </el-form>\n        </el-tab-pane>\n        <el-tab-pane name=\"upload\" label=\"合同上传\">\n          <el-form :model=\"contarctUploadForm\" label-width=\"110px\">\n            <el-form-item prop=\"signDate\" label=\"签订时间:\">\n              <el-date-picker\n                v-model=\"contarctUploadForm.signDate\"\n                type=\"date\"\n                value-format=\"yyyy-MM-dd\"\n                placeholder=\"签订日期\"\n                style=\"width: 260px;\"\n              />\n            </el-form-item>\n            <el-form-item label=\"合同属性:\">\n              <el-switch\n                v-model=\"masterUpSwitch\"\n                active-text=\"子合同\"\n                inactive-text=\"主合同\"\n              />\n            </el-form-item>\n            <el-form-item v-if=\"masterUpSwitch\" label=\"关联主合同:\">\n              <el-input v-model=\"contarctUploadForm.supContCode\" placeholder=\"合同编号\" style=\"width: 200px;\" />\n              <el-button type=\"primary\" size=\"mini\" style=\"margin-left: 10px;\" @click=\"checkUpContractInfo\">验证</el-button>\n              <span v-if=\"checkUpFlag\" style=\"color:green;margin-left: 10px;\">\n                {{ checkUpText }}\n              </span>\n              <span v-if=\"!checkUpFlag\" style=\"color:red;margin-left: 10px;\">\n                {{ checkUpText }}\n              </span>\n            </el-form-item>\n            <el-form-item label=\"有效期(年):\">\n              <el-input-number v-model=\"contarctUploadForm.validity\" controls-position=\"right\" style=\"width: 260px;\" :min=\"1\" :step=\"1\" :precision=\"0\" />\n            </el-form-item>\n            <el-form-item label=\"合同附件上传:\">\n              <el-upload\n                ref=\"upload\"\n                drag\n                class=\"upload-demo\"\n                action=\"/api/cont/uploadContFile\"\n                :on-change=\"onUploadChange\"\n                :on-exceed=\"onExceed\"\n                :on-remove=\"onUploadRemove\"\n                :limit=\"1\"\n                :file-list=\"fileList\"\n                accept=\".doc,.docx,.pdf\"\n              >\n                <i class=\"el-icon-upload\" />\n                <div class=\"el-upload__text\">\n                  将文件拖到此处，或\n                  <em>点击上传</em>\n                </div>\n                <div slot=\"tip\" class=\"el-upload__tip\" />\n                <div slot=\"tip\" class=\"el-upload__tip\" style=\"color:red\">注:您只能上传.doc,.docx,.pdf格式的文件</div>\n              </el-upload>\n\n            </el-form-item>\n          </el-form>\n        </el-tab-pane>\n      </el-tabs>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"contractVisible=false\">取消</el-button>\n        <el-button v-loading.fullscreen.lock=\"processLoading\" type=\"primary\" @click=\"confirmDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"合同审核\" :visible.sync=\"approveVisible\" center>\n      <div style=\"width: 400px;margin:0 auto\">\n        <el-form :model=\"approveForm\" label-width=\"100px\">\n          <el-form-item label=\"审核结果:\">\n            <el-radio-group v-model=\"approveForm.auditFlag\">\n              <el-radio label=\"1\">通过</el-radio>\n              <el-radio label=\"2\">驳回</el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-form-item v-if=\"approveForm.auditFlag === '2'\" label=\"审核意见:\">\n            <el-input v-model=\"approveForm.auditReason\" type=\"textarea\" :rows=\"3\" maxlength=\"50\" show-word-limit placeholder=\"审核意见\" />\n          </el-form-item>\n        </el-form>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"approveVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmApproveDialog\">确认</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"审核历史\" :visible.sync=\"appHisVisible\" width=\"75%\">\n      <el-table :data=\"approveDetails\" border stripe>\n        <el-table-column type=\"index\" label=\"序号\" width=\"50\" align=\"center\" />\n        <el-table-column label=\"状态\" align=\"center\">\n          <template slot-scope=\"{row}\">\n            <el-tag :type=\"row.auditFlag==='1'?'success':'danger'\">{{ row.auditFlag==='1'?'通过':'不通过' }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"auditReason\" label=\"审核说明\" align=\"center\" />\n        <el-table-column prop=\"auditUserName\" label=\"审批用户\" align=\"center\" />\n        <el-table-column prop=\"createTime\" label=\"审批时间\" align=\"center\" />\n      </el-table>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport * as contractServer from '@/api/contract'\nimport * as cusServer from '@/api/customer'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nconst CONTRACT_STATUS = {\n  '0': '待完善',\n  '6': '待提交',\n  '1': '待审核',\n  '2': '审核驳回'\n}\nexport default {\n  components: { Pagination },\n  filters: {\n    statusQualityFilter(status) {\n      if (status === '0' || status === '2') {\n        return ''\n      } else if (status === '3' || status === '1') {\n        return 'info'\n      } else if (status === '4') {\n        return 'success'\n      } else {\n        return 'danger'\n      }\n    }\n  },\n  data() {\n    return {\n      CONTRACT_STATUS,\n      contractData: [],\n      searchForm: {\n        contCode: '',\n        contName: '',\n        contStatus: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      masterSwitch: false,\n      masterUpSwitch: false,\n      checkFlag: false,\n      checkText: '',\n      total: 0,\n      contractVisible: false,\n      contractForm: {\n        contId: '',\n        contractInfoTdo: {\n          signDate: '',\n          signLocation: '',\n          payMethod: '0',\n          payMethodDesc: '',\n          validity: ''\n        },\n        cusContBaseInfoId: '',\n        addTdo: {\n          supContCode: '',\n          companyName: '',\n          address: '',\n          postCode: '',\n          jurPerson: '',\n          agentPerson: '',\n          telFax: '',\n          bankName: '',\n          bankNo: '',\n          taxNumber: ''\n        }\n      },\n      contractStatus: 'create',\n      contractRules: {\n        contractInfoTdo: {\n          validity: [{ required: true, message: '请录入有效期', trigger: 'blur' }],\n          signDate: [{ required: true, message: '请录入签订日期', trigger: 'blur' }],\n          signLocation: [{ required: true, message: '请录入地址', trigger: 'blur' }],\n          payMethod: [{ required: true, message: '请选择支付方式', trigger: 'blur' }],\n          payMethodDesc: [{ required: true, message: '请录支付说明', trigger: 'blur' }]\n        },\n        addTdo: {\n          companyName: [{ required: true, message: '请录入单位名称', trigger: 'blur' }],\n          address: [{ required: true, message: '请录入通讯地址', trigger: 'blur' }],\n          postCode: [{ required: true, message: '请录入邮政编码', trigger: 'blur' }],\n          jurPerson: [{ required: true, message: '请录入法定代表人', trigger: 'blur' }],\n          agentPerson: [{ required: true, message: '请录入委托代理人', trigger: 'blur' }],\n          telFax: [{ required: true, message: '请录入电话/传真', trigger: 'blur' }],\n          bankName: [{ required: true, message: '请录入开户银行', trigger: 'blur' }],\n          bankNo: [{ required: true, message: '请录入银行账号', trigger: 'blur' }],\n          taxNumber: [{ required: true, message: '请录入税号', trigger: 'blur' }]\n        }\n      },\n      uploadContractForm: {\n        contId: '',\n        signDate: '',\n        contFileId: '',\n        validity: ''\n      },\n      restaurants: [],\n      contarctUploadForm: {\n        contId: '',\n        contFileId: '',\n        supContCode: '',\n        signDate: '',\n        validity: ''\n      },\n      fileList: [],\n      activeName: 'maker',\n      companyMap: {},\n      approveVisible: false,\n      currentItem: {},\n      approveForm: {\n        contId: '',\n        auditFlag: '1',\n        auditReason: ''\n      },\n      appHisVisible: false,\n      approveDetails: [],\n      processLoading: false,\n      checkUpFlag: false,\n      checkUpText: '',\n      customerList: []\n    }\n  },\n  created() {\n    this.handleSearch()\n  },\n  methods: {\n    handleSearch() {\n      contractServer.findContInfosByCondition(this.searchForm).then(res => {\n        if (res.code === 200 && res.result) {\n          this.contractData = res.result.records || []\n          this.total = res.result.total\n        }\n      })\n    },\n    querySearchAsync(queryString) {\n      debugger\n      if (queryString && queryString.trim().length > 0) {\n        // 调用远程接口获取数据信息\n        cusServer.fuzzyQuery(queryString).then(res => {\n          if (res.result) {\n            this.companyMap = res.result || {}\n          }\n        }).catch(() => {\n        })\n      }\n    },\n    confirmDialog() {\n      this.processLoading = true\n      if (this.activeName === 'maker') {\n        if (this.masterSwitch) {\n          if (this.contractForm.addTdo.supContCode.length <= 0 || !this.checkFlag) {\n            this.$message.error('请录入关联主合同信息且通过验证！')\n            this.processLoading = false\n            return\n          }\n        }\n        // 在线制作\n        this.$refs.contractForm.validate(valid => {\n          if (valid) {\n            debugger\n            if (this.contractForm.addTdo && this.contractForm.addTdo.id !== '') {\n              this.contractForm.cusContBaseInfoId = this.contractForm.addTdo.id || ''\n            }\n            contractServer.saveContract(this.contractForm).then(result => {\n              if (result.code === 200) {\n                this.$notify({\n                  title: '成功',\n                  message: result.message,\n                  type: 'success'\n                })\n                this.contractVisible = false\n                this.handleSearch()\n              } else {\n                this.$notify({\n                  title: '失败',\n                  message: result.message,\n                  type: 'error'\n                })\n              }\n              this.processLoading = false\n            }).catch(() => {\n              this.contractVisible = false\n              this.processLoading = false\n              this.handleSearch()\n            }).finally(() => {\n              this.contractVisible = false\n              this.processLoading = false\n              this.handleSearch()\n            })\n          } else {\n            this.processLoading = false\n          }\n        })\n      } else {\n        if (this.masterUpSwitch) {\n          if (this.contarctUploadForm.supContCode.length <= 0 || !this.checkUpFlag) {\n            this.$message.error('请录入关联主合同信息且通过验证！')\n            this.processLoading = false\n            return\n          }\n        }\n        // 合同上传\n        if (this.contarctUploadForm.signDate && this.contarctUploadForm.validity) {\n          contractServer.saveLocalContract(this.contarctUploadForm).then(result => {\n            if (result.code === 200) {\n              this.$notify({\n                title: '成功',\n                message: result.message,\n                type: 'success'\n              })\n              this.contractVisible = false\n              this.handleSearch()\n            } else {\n              this.$notify({\n                title: '失败',\n                message: result.message,\n                type: 'error'\n              })\n            }\n            this.contractVisible = false\n            this.processLoading = false\n            this.handleSearch()\n          }).finally(() => {\n            this.processLoading = false\n          })\n        } else {\n          this.$message.error('签订时间和周期不能为空')\n          this.processLoading = false\n        }\n      }\n    },\n    handleDetail(row) {\n      contractServer.findContFileById(row.id).then(res => {\n        if (res.code === 200 && res.result && res.result.length > 0) {\n          const path = res.result // 合同文件存放地址\n          // this.$router.push(`/report/pdfView/${path}/1`)\n          this.$router.push({ name: 'sysPdfView', params: { path: path, type: 1 }})\n        } else {\n          this.$message.error('合同PDF还未生成')\n        }\n      })\n    },\n    handleEdit(row) {\n      this.clearForm()\n      this.checkFlag = false\n      this.checkUpFlag = false\n      this.checkText = ''\n      this.checkUpText = ''\n\n      this.contarctUploadForm.contId = row.id\n      if (row.makeType === '0') {\n        this.contractForm.contId = row.id\n        contractServer.findContPerfectInfoById(row.id).then(res => {\n          if (res.code === 200 && res.result) {\n            debugger\n            this.contractForm.contractInfoTdo.signDate = res.result.signDate\n            this.contractForm.contractInfoTdo.signLocation = res.result.signLocation\n            this.contractForm.contractInfoTdo.payMethod = res.result.payMethod\n            this.contractForm.contractInfoTdo.payMethodDesc = res.result.payMethodDesc\n            this.contractForm.contractInfoTdo.validity = res.result.validity\n            if (res.result.cusContBaseInfoVo && res.result.cusContBaseInfoVo.id) {\n              this.contractForm.cusContBaseInfoId = res.result.cusContBaseInfoVo.id\n            } else {\n              this.contractForm.cusContBaseInfoId = ''\n            }\n            this.contractForm.addTdo = res.result.cusContBaseInfoVo || {}\n            if (row.contStatus === '6') {\n              this.currentItem = res.result.cusContBaseInfoVo || {}\n            }\n            this.contractVisible = true\n          }\n        })\n      } else {\n        // 文件上传信息 通过列表获取\n        // TODO\n        this.contarctUploadForm.contFileId = row.contFileId\n        this.contarctUploadForm.signDate = row.signDate\n        this.contarctUploadForm.validity = row.validity\n        this.contarctUploadForm.supContCode = row.supContCode\n        this.contractVisible = true\n      }\n    },\n    clearForm() {\n      this.contractForm = {\n        contId: '',\n        contractInfoTdo: {\n          signDate: '',\n          signLocation: '',\n          payMethod: '0',\n          payMethodDesc: '',\n          validity: '1'\n        },\n        cusContBaseInfoId: '',\n        addTdo: {\n          id: '',\n          organId: '',\n          companyName: '',\n          address: '',\n          postCode: '',\n          jurPerson: '',\n          agentPerson: '',\n          telFax: '',\n          bankName: '',\n          bankNo: '',\n          taxNumber: '',\n          supContCode: ''\n        }\n      }\n      this.contarctUploadForm = {\n        contId: '',\n        contFileId: '',\n        supContCode: '',\n        signDate: '',\n        validity: '1'\n      }\n      this.masterSwitch = false\n      this.masterUpSwitch = false\n    },\n    bankNumCheck(val) {\n      this.contractForm.addTdo.bankNo = val.replace(/[^\\d]/g, '')\n    },\n    handleSelectCom(item) {\n      cusServer.findById(item).then(res => {\n        if (res.code === 200 && res.result) {\n          this.currentItem = { ...res.result }\n          this.contractForm.cusContBaseInfoId = res.result.id\n          this.contractForm.addTdo = res.result\n        }\n      })\n    },\n    onUploadChange(file) {\n      if (file.status === 'ready') return\n      if (file.status === 'success') {\n        const res = file.response || {}\n        if (res && res.code === 200) {\n          this.contarctUploadForm.contFileId = file.response.result\n          this.$message({\n            type: 'success',\n            message: '上传成功!'\n          })\n        } else {\n          this.$message.error('上传失败!')\n        }\n      } else {\n        this.$message.error('上传失败!')\n      }\n    },\n    onExceed() {\n      this.$message.error('最多上传一个文件')\n    },\n    onUploadRemove() {\n      this.contarctUploadForm.contFileId = ''\n    },\n    handleApprove(row) {\n      this.$confirm('确定提交审核?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        contractServer.submitCont(row.id).then(result => {\n          if (result.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: result.message,\n              type: 'success'\n            })\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: result.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    handleDwonload(row) {\n      if (row.contFileId && row.contFileId.length > 0) {\n        var url = this.$store.getters.sysBaseUrl + '/file/ht/upload/' + row.contFileId\n        window.open(url)\n      } else {\n        this.$message.warning('合同生成异常，请联系管理员')\n      }\n    },\n    handleApproveDetail(row) {\n      contractServer.findAuditRecordsByContId(row.id).then(res => {\n        this.approveDetails = res.result || []\n      })\n      this.appHisVisible = true\n    },\n    handleDelete(row) {\n      this.$confirm('确定作废?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        contractServer.invalidCont(row.id).then(res => {\n          if (res.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: res.message,\n              type: 'success'\n            })\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: res.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    handleApproveRes(row) {\n      this.approveForm.contId = row.id\n      this.approveForm.auditFlag = '1'\n      this.approveForm.auditReason = ''\n      this.approveVisible = true\n    },\n    confirmApproveDialog() {\n      this.$confirm('确定提交?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        contractServer.auditCont(this.approveForm).then(res => {\n          if (res.code === 200) {\n            this.$notify({\n              title: '成功',\n              message: res.message,\n              type: 'success'\n            })\n            this.approveVisible = false\n            this.handleSearch()\n          } else {\n            this.$notify({\n              title: '失败',\n              message: res.message,\n              type: 'error'\n            })\n          }\n        })\n      }).catch(() => {})\n    },\n    checkContractInfo() {\n      if (this.contractForm.addTdo.supContCode && this.contractForm.addTdo.supContCode.length > 0) {\n        contractServer.checkSupContCode({ supContCode: this.contractForm.addTdo.supContCode }).then(res => {\n          debugger\n          if (res.code === 200) {\n            this.checkFlag = true\n            this.checkText = '校验通过'\n          } else {\n            this.checkFlag = false\n            this.checkText = '校验不通过'\n          }\n        }).catch(() => {\n          this.checkFlag = false\n          this.checkText = '校验不通过'\n        })\n      }\n    },\n    checkUpContractInfo() {\n      if (this.contarctUploadForm.supContCode && this.contarctUploadForm.supContCode.length > 0) {\n        contractServer.checkSupContCode({ supContCode: this.contarctUploadForm.supContCode }).then(res => {\n          if (res.code === 200) {\n            this.checkUpFlag = true\n            this.checkUpText = '校验通过'\n          } else {\n            this.checkUpFlag = false\n            this.checkUpText = '校验不通过'\n          }\n        }).catch(() => {\n          this.checkUpFlag = false\n          this.checkUpText = '校验不通过'\n        })\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  .item {\n    font-size: 16px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n    background: #F3F2F2;\n  }\n</style>\n"]}]}