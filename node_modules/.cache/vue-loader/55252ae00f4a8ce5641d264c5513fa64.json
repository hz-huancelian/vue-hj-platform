{"remainingRequest":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjects\\vue-hj-platform\\src\\views\\outLaboratory\\components\\hisOutLaborList.vue?vue&type=style&index=0&id=4b87f4c1&scoped=true&lang=scss&","dependencies":[{"path":"F:\\webstormProjects\\vue-hj-platform\\src\\views\\outLaboratory\\components\\hisOutLaborList.vue","mtime":1652691565000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\vue-hj-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.search_div {\n  >div {\n    &:nth-child(1){\n      margin-right: 10px;\n    }\n    display: inline-block;\n  }\n}\n\n.search_input {\n  width: 200px;\n  margin-bottom: 5px;\n}\n.search-right {\n  text-align: right;\n  padding-right: 25px;\n}\n.item {\n  font-size: 16px;\n}\n::v-deep .el-card .el-card__header {\n  padding: 5px 20px;\n  background: #F3F2F2;\n}\n.block-flex {\n  position: relative;\n  display: flex;\n  &>div{\n    border: 1px solid #B7B7B7;\n    width: 100px;\n    margin: 0;\n    line-height: 30px;\n    text-align: center;\n  }\n  &>div:first-child {\n    background: #B7B7B7;\n  }\n}\n.card-left {\n  width: 100%;\n  min-height: 200px;\n  max-height: 400px;\n}\n.card-right {\n  width: 100%;\n  min-height: 200px;\n  max-height: 400px;\n}\n.el-card {\n  overflow: auto;\n}\n.el-dropdown-link {\n  cursor: pointer;\n  color: #409EFF;\n}\n.el-icon-arrow-down {\n  font-size: 12px;\n}\n/deep/ .el-input.is-disabled .el-input__inner {\n  color:unset\n}\n.demo-image__lazy {\n  height: 300px;\n  overflow-y: auto;\n}\n.demo-image__lazy .el-image {\n  display: block;\n  max-height: 300px;\n  width: 100%;\n  margin-bottom: 10px;\n}\n.clearfix {\n  line-height: 40px;\n  display: flex;\n}\n",{"version":3,"sources":["hisOutLaborList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"hisOutLaborList.vue","sourceRoot":"src/views/outLaboratory/components","sourcesContent":["<template>\n  <div class=\"app-continer\">\n    <el-form :model=\"searchForm\" :inline=\"true\">\n      <el-row>\n        <el-col :span=\"20\">\n          <el-form-item label=\"样品编号:\">\n            <el-input v-model=\"searchForm.smapItemId\" style=\"width:165px\" placeholder=\"样品编号\" />\n          </el-form-item>\n          <el-form-item label=\"因子名称:\">\n            <el-input v-model=\"searchForm.factorName\" style=\"width:165px\" placeholder=\"因子名称\" />\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" class=\"iconfont icon-chaxun1\" @click=\"handleSearch\"> 查询</el-button>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"4\" class=\"search-right\">\n          <el-button type=\"text\" icon=\"el-icon-refresh\" @click=\"handleSearch\">刷新</el-button>\n        </el-col>\n      </el-row>\n    </el-form>\n    <el-table\n      :data=\"checkData\"\n      stripe\n      highlight-current-row\n      :header-cell-style=\"{background:'#ECF3FC'}\"\n      style=\"width: 100%\"\n    >\n      <el-table-column type=\"index\" width=\"50\" align=\"center\" label=\"序号\" />\n      <el-table-column prop=\"factorName\" label=\"检测因子\" align=\"center\" />\n      <el-table-column prop=\"secdClassName\" label=\"检测类别\" width=\"100px\" align=\"center\" />\n      <el-table-column prop=\"factorPoint\" label=\"采样点位\" align=\"center\" />\n      <el-table-column prop=\"sampleNo\" label=\"样品编号\" width=\"150px\" align=\"center\" />\n      <el-table-column prop=\"dayAndCount\" label=\"频次(次/天)\" width=\"120px\" align=\"center\" />\n      <el-table-column prop=\"standardName\" label=\"检测标准\" min-width=\"220px\" align=\"center\" />\n      <el-table-column prop=\"checkRes\" label=\"检测结果\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <template v-if=\"row.checkRes && row.checkRes.length >0\">\n            {{ row.masterRes }}<template v-if=\"row.exponRes>0\">×10<sup>{{ row.exponRes }}</sup></template>\n          </template>\n          <template v-else />\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"checkStatus\" label=\"状态\" width=\"120px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <el-tag :type=\"row.checkStatus|statusQualityFilter\">\n            已完成\n          </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"dataEntryStep\" label=\"数据操作\" width=\"120\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <el-tag :type=\"row.dataEntryStep ==='1'?'danger':''\">\n            {{ row.dataEntryStep ==='1'?\"采样录入\":\"检测录入\" }}\n          </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"assignUser\" label=\"分析员\" align=\"center\" />\n      <el-table-column prop=\"collectTime\" label=\"采样时间\" width=\"160\" align=\"center\" />\n      <el-table-column prop=\"storeTime\" label=\"入库时间\" width=\"160\" align=\"center\" />\n      <el-table-column prop=\"endDate\" label=\"任务截止时间\" width=\"120px\" align=\"center\" />\n      <el-table-column label=\"操作\" fixed=\"right\" width=\"140px\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <el-button type=\"text\" @click=\"handleDetail(row)\">查看</el-button>\n          <div class=\"erc-divider-vertical\" />\n          <el-button type=\"text\" @click=\"handleLocalDetail(row)\">现场记录</el-button>\n\n        </template>\n      </el-table-column>\n    </el-table>\n    <div style=\"float: right\">\n      <pagination\n        v-show=\"total>0\"\n        :total=\"total\"\n        :page.sync=\"searchForm.pageNumber\"\n        :limit.sync=\"searchForm.pageSize\"\n        @pagination=\"handleSearch\"\n      />\n    </div>\n\n    <el-dialog title=\"样品详情\" :visible.sync=\"detailVisible\" width=\"70%\" center top=\"5vh\">\n      <div style=\"width: 700px;margin:0 auto;\">\n        <el-form label-width=\"100px\" label-position=\"left\">\n          <el-form-item label=\"样品编号:\">{{ sampleForm.smapItemId }}</el-form-item>\n          <el-form-item label=\"检测因子:\">{{ sampleForm.factorName }}</el-form-item>\n          <el-form-item label=\"检测标准:\">{{ sampleForm.standardName }}</el-form-item>\n          <el-form-item label=\"备注:\">{{ sampleForm.remark }}</el-form-item>\n          <el-form-item label=\"检测结果:\">\n            <template v-if=\"sampleForm.checkRes && sampleForm.checkRes.length > 0\">\n              {{ sampleForm.factorInfo&&sampleForm.factorInfo.v1?sampleForm.factorInfo.v1:0 }}\n              <template v-if=\"sampleForm.factorInfo&&sampleForm.factorInfo.v2>0\">\n                ×10<sup>{{ sampleForm.factorInfo.v2?Number(sampleForm.factorInfo.v2):0 }}</sup>\n              </template>\n            </template>\n            <template v-else>暂无检测结果</template>\n          </el-form-item>\n        </el-form>\n        <div v-if=\"sampleForm.subFactors && sampleForm.subFactors.length > 0\">\n          <el-table\n            :data=\"sampleForm.subFactors\"\n            border\n            style=\"width:100%\"\n            :header-cell-style=\"{background:'#ECF3FC'}\"\n          >\n            <el-table-column prop=\"name\" label=\"检测因子\" width=\"130\" align=\"center\" />\n            <el-table-column prop=\"name\" label=\"检测结果\" align=\"center\">\n              <template slot-scope=\"{row}\">\n                <template v-if=\"row.v1\">\n                  {{ row.v1?row.v1:0 }}×10<sup>{{ row.v2?Number(row.v2):0 }}</sup>{{ sampleForm.unitName }}\n                </template>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"detailVisible = false\">关 闭</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog :title=\"currentSample + '-详情'\" :visible.sync=\"sampleVisible\" width=\"85%\" center top=\"5vh\">\n      <el-form :model=\"sampleDetailForm\" label-width=\"180px\" label-position=\"right\">\n        <el-card style=\"margin-top: 5px;padding-bottom: 20px;\">\n          <div slot=\"header\" class=\"clearfix\">\n            <div style=\"width: 3px;margin:auto 3px; height: 20px;background-color:steelblue;\" />\n            <span>基础信息</span>\n          </div>\n          <el-col :span=\"16\" style=\"height:32px;\">\n            <el-form-item label-width=\"100\" label=\"检测因子:\">\n              <span class=\"showTile\">{{ sampleDetailForm.factorName }}</span>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"8\" style=\"height:32px;\">\n            <el-form-item label-width=\"100\" label=\"点位:\">\n              <span class=\"showTile\">{{ sampleDetailForm.factorPoint }}</span>\n            </el-form-item>\n          </el-col>\n          <!--动态二级类别信息-->\n        </el-card>\n        <el-card v-for=\"item in sampleSecInfo\" :key=\"item.groupKey\" style=\"margin-top: 5px;padding-bottom: 20px;\">\n          <div v-if=\"item.groupName && item.groupName != ''\" slot=\"header\" class=\"clearfix\">\n            <div style=\"width: 3px;margin:auto 3px; height: 20px;background-color:steelblue;\" />\n            <span>{{ item.groupName }}</span>\n          </div>\n          <el-col v-for=\"(sitem,index) in item.params\" :key=\"index\" :span=\"8\" style=\"height:32px;\">\n            <el-form-item label-width=\"100\">\n              <span slot=\"label\">{{ sitem.name }}:</span>\n              <span class=\"showTile\">{{ sitem.value?sitem.value.toString():'' }}</span>\n            </el-form-item>\n          </el-col>\n        </el-card>\n\n        <el-card v-if=\"sampleDataInfo && sampleDataInfo.length > 0\" style=\"margin-top: 5px\">\n          <div slot=\"header\" class=\"clearfix\">\n            <div style=\"width: 3px;margin:auto 3px; height: 20px;background-color:steelblue;\" />\n            <span>现场检测因子信息</span>\n          </div>\n          <el-table :data=\"sampleDataInfo\" stripe>\n            <el-table-column prop=\"factorName\" label=\"检测因子项目\" />\n            <el-table-column label=\"因子结果集\">\n              <template slot-scope=\"{row}\">\n                <template v-if=\"row.measuredForm\">\n                  {{ '第一值: ' +row.measuredForm.firstVal + ' 第二值: ' + row.measuredForm.secondVal + \" 均值: \" + row.measuredForm.avgVal }}\n                </template>\n                <template v-else>\n                  {{ row.factorData?row.factorData:'' }}\n                </template>\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"checkEquipment\" label=\"检测设备\">\n              <template slot-scope=\"{row}\">\n                {{ row.checkEquipment&&row.checkEquipment.length>0?row.checkEquipment.replaceAll('^_^',' '):'' }}\n              </template>\n            </el-table-column>\n            <el-table-column prop=\"theoreticalVal\" label=\"理论值\" />\n            <el-table-column prop=\"groundConditions\" label=\"测定值\" />\n          </el-table>\n        </el-card>\n\n        <el-card style=\"margin-top: 5px\">\n          <div slot=\"header\" class=\"clearfix\">\n            <div style=\"width: 3px;margin:auto 3px; height: 20px;background-color:steelblue;\" />\n            <span>现场信息</span>\n          </div>\n          <el-col :span=\"12\">\n            <el-form-item label-width=\"100\" label=\"采样地址:\">\n              <span class=\"showTile\">{{ sampleDetailForm.sampleDataVo.collectLocation }}</span>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label-width=\"100\" label=\"采样日期:\">\n              <span class=\"showTile\">{{ sampleDetailForm.sampleDataVo.collectDate }}</span>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"24\">\n            <el-form-item label-width=\"100\" label=\"现场图片:\">\n              <div v-if=\"sampleImageList && sampleImageList.length > 0\" class=\"demo-image__lazy\">\n                <el-image v-for=\"(url, index) in sampleImageList\" :key=\"index\" :src=\"url\" :preview-src-list=\"sampleImageList\" style=\"width: 100px; height: 100px;margin-left: 10px;\" />\n              </div>\n            </el-form-item>\n          </el-col>\n        </el-card>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"sampleVisible=false\">关 闭</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport * as checkServer from '@/api/check'\nimport * as stockServer from '@/api/stock'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nconst CHECK_STATUS = {\n  '0': '待领样',\n  '1': '领样申请',\n  '2': '待检测',\n  '3': '已录入',\n  '4': '待审核',\n  '5': '审核通过',\n  '6': '审核失败'\n}\nexport default {\n  components: { Pagination },\n  filters: {\n    statusQualityFilter(status) {\n      if (status === '0' || status === '2') {\n        return 'info'\n      } else if (status === '1' || status === '3' || status === '4') {\n        return ''\n      } else if (status === '5') {\n        return 'success'\n      } else {\n        return 'danger'\n      }\n    }\n  },\n  data() {\n    return {\n      CHECK_STATUS,\n      checkData: [],\n      searchForm: {\n        smapItemId: '',\n        factorName: '',\n        checkStatus: '5',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      detailVisible: false,\n      sampleForm: {\n        factorInfo: {},\n        subFactors: {}\n      },\n\n      sampleVisible: false,\n      sampleDetails: [],\n      sampleDetailForm: {\n        factorName: '',\n        factorPoint: '',\n        secdClassName: '',\n        factorDataVos: [],\n        sampleDataVo: {\n          collectDate: '',\n          collectLocation: '',\n          imageList: [],\n          sampleData: [],\n          specialNote: ''\n        },\n        sampleJobVo: {\n          projectName: '',\n          jobRemark: ''\n        }\n      },\n      currentSample: '',\n      sampleImageList: [],\n      sampleImage: '',\n      sampleDataInfo: [],\n      sampleSecInfo: []\n\n    }\n  },\n  created() {\n    this.handleSearch()\n  },\n  methods: {\n    handleSearch() {\n      checkServer.findHisFactorByCondition(this.searchForm).then(res => {\n        if (res.code === 200) {\n          this.checkData = res.result.records.map(i => {\n            if (i.checkRes && i.checkRes !== '') {\n              const ob = JSON.parse(i.checkRes)\n              this.$set(i, 'masterRes', ob.v1)\n              this.$set(i, 'exponRes', ob.v2)\n            } else {\n              this.$set(i, 'masterRes', 0)\n              this.$set(i, 'exponRes', 0)\n            }\n\n            return i\n          }) || []\n          this.total = res.result.total\n        }\n      })\n    },\n    handleDetail(row) {\n      this.sampleForm = { ...row }\n      if (row.checkSubRes && row.checkSubRes.length > 0) {\n        const subArray = JSON.parse(row.checkSubRes)\n        this.$set(this.sampleForm, 'subFactors', subArray)\n      }\n      if (row.checkRes && row.checkRes.length > 0) {\n        const factorInfo = JSON.parse(row.checkRes)\n        this.$set(this.sampleForm, 'factorInfo', factorInfo)\n      }\n      this.detailVisible = true\n    },\n    handleLocalDetail(row) {\n      this.currentSample = row.sampleNo\n      this.sampleImageList = []\n      this.sampleDataInfo = [] // 因子信息\n      this.sampleSecInfo = [] // 二级类别信息\n      this.sampleImage = ''\n      var baseUrl = this.$store.getters.sysBaseUrl + '/cyImg/'\n      stockServer.getSampleDataBySampItemId(row.smapItemId).then(res => {\n        if (res.code === 200 && res.result) {\n          this.sampleDetailForm = res.result || {}\n          this.$nextTick(() => {\n            // 提取图片\n            this.sampleImageList = res.result.sampleDataVo.imageList.map(i => {\n              return baseUrl + i\n            })\n            // 二级类别\n            this.sampleSecInfo = res.result.sampleDataVo.sampleData || []\n\n            // 因子\n            var nfactorDataVos = res.result.factorDataVos.filter(i => i.dataEntryStep === '1') || []\n            // 因子\n            this.sampleDataInfo = nfactorDataVos.map(i => {\n              if (i.measuredFormVal && i.measuredFormVal.length > 0) {\n                this.$set(i, 'measuredForm', JSON.parse(i.measuredFormVal))\n              }\n              return i\n            })\n          })\n          this.sampleVisible = true\n        }\n      })\n    }\n\n  }\n}\n</script>\n\n<style scoped lang=\"scss\" type=\"text/scss\">\n  .search_div {\n    >div {\n      &:nth-child(1){\n        margin-right: 10px;\n      }\n      display: inline-block;\n    }\n  }\n\n  .search_input {\n    width: 200px;\n    margin-bottom: 5px;\n  }\n  .search-right {\n    text-align: right;\n    padding-right: 25px;\n  }\n  .item {\n    font-size: 16px;\n  }\n  ::v-deep .el-card .el-card__header {\n    padding: 5px 20px;\n    background: #F3F2F2;\n  }\n  .block-flex {\n    position: relative;\n    display: flex;\n    &>div{\n      border: 1px solid #B7B7B7;\n      width: 100px;\n      margin: 0;\n      line-height: 30px;\n      text-align: center;\n    }\n    &>div:first-child {\n      background: #B7B7B7;\n    }\n  }\n  .card-left {\n    width: 100%;\n    min-height: 200px;\n    max-height: 400px;\n  }\n  .card-right {\n    width: 100%;\n    min-height: 200px;\n    max-height: 400px;\n  }\n  .el-card {\n    overflow: auto;\n  }\n  .el-dropdown-link {\n    cursor: pointer;\n    color: #409EFF;\n  }\n  .el-icon-arrow-down {\n    font-size: 12px;\n  }\n  /deep/ .el-input.is-disabled .el-input__inner {\n    color:unset\n  }\n  .demo-image__lazy {\n    height: 300px;\n    overflow-y: auto;\n  }\n  .demo-image__lazy .el-image {\n    display: block;\n    max-height: 300px;\n    width: 100%;\n    margin-bottom: 10px;\n  }\n  .clearfix {\n    line-height: 40px;\n    display: flex;\n  }\n</style>\n"]}]}